(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+K+b":function(Ue,y,o){var x=o("JHRd");function m(Y){var z=new Y.constructor(Y.byteLength);return new x(z).set(new x(Y)),z}Ue.exports=m},"+Qka":function(Ue,y,o){var x=o("fmRc"),m=o("t2Dn"),Y=o("cq/+"),z=o("T1AV"),i=o("GoyQ"),W=o("mTTR"),D=o("itsj");function Q(ee,ce,K,je,pe){if(ee===ce)return;Y(ce,function(Ke,Pe){if(pe||(pe=new x),i(Ke))z(ee,ce,Pe,K,Q,je,pe);else{var ht=je?je(D(ee,Pe),Ke,Pe+"",ee,ce,pe):void 0;ht===void 0&&(ht=Ke),m(ee,Pe,ht)}},W)}Ue.exports=Q},"+VLl":function(Ue,y,o){"use strict";o.d(y,"a",function(){return Ke});var x=o("lSNA"),m=o.n(x),Y=o("J4zp"),z=o.n(Y),i=o("Hel2"),W=Math.PI/3,D=[0,W,2*W,3*W,4*W,5*W];function Q(Pe){return Pe[0]}function ee(Pe){return Pe[1]}var ce=function(){var Pe=0,ht=0,Le=1,_t=1,ot=Q,et=ee,Ze,At,St;function De(Ge){var dt={},we=[],pt,Wt=Ge.length;for(pt=0;pt<Wt;++pt){if(isNaN(ur=+ot.call(null,Qt=Ge[pt],pt,Ge))||isNaN(oe=+et.call(null,Qt,pt,Ge)))continue;var Qt,ur,oe,J=Math.round(oe=oe/St),H=Math.round(ur=ur/At-(J&1)/2),Se=oe-J;if(Math.abs(Se)*3>1){var be=ur-H,Te=H+(ur<H?-1:1)/2,me=J+(oe<J?-1:1),at=ur-Te,Jt=oe-me;be*be+Se*Se>at*at+Jt*Jt&&(H=Te+(J&1?1:-1)/2,J=me)}var Mt=H+"-"+J,ve=dt[Mt];ve?ve.push(Qt):(we.push(ve=dt[Mt]=[Qt]),ve.x=(H+(J&1)/2)*At,ve.y=J*St)}return we}function Ie(Ge){var dt=0,we=0;return D.map(function(pt){var Wt=Math.sin(pt)*Ge,Qt=-Math.cos(pt)*Ge,ur=Wt-dt,oe=Qt-we;return dt=Wt,we=Qt,[ur,oe]})}return De.hexagon=function(Ge){return"m"+Ie(Ge==null?Ze:+Ge).join("l")+"z"},De.centers=function(){for(var Ge=[],dt=Math.round(ht/St),we=Math.round(Pe/At),pt=dt*St;pt<_t+Ze;pt+=St,++dt)for(var Wt=we*At+(dt&1)*At/2;Wt<Le+At/2;Wt+=At)Ge.push([Wt,pt]);return Ge},De.mesh=function(){var Ge=Ie(Ze).slice(0,4).join("l");return De.centers().map(function(dt){return"M"+dt+"m"+Ge}).join("")},De.x=function(Ge){return arguments.length?(ot=Ge,De):ot},De.y=function(Ge){return arguments.length?(et=Ge,De):et},De.radius=function(Ge){return arguments.length?(Ze=+Ge,At=Ze*2*Math.sin(W),St=Ze*1.5,De):Ze},De.size=function(Ge){return arguments.length?(Pe=ht=0,Le=+Ge[0],_t=+Ge[1],De):[Le-Pe,_t-ht]},De.extent=function(Ge){return arguments.length?(Pe=+Ge[0][0],ht=+Ge[0][1],Le=+Ge[1][0],_t=+Ge[1][1],De):[[Pe,ht],[Le,_t]]},De.radius(1)};function K(Pe,ht){var Le=Object.keys(Pe);if(Object.getOwnPropertySymbols){var _t=Object.getOwnPropertySymbols(Pe);ht&&(_t=_t.filter(function(ot){return Object.getOwnPropertyDescriptor(Pe,ot).enumerable})),Le.push.apply(Le,_t)}return Le}function je(Pe){for(var ht=1;ht<arguments.length;ht++){var Le=arguments[ht]!=null?arguments[ht]:{};ht%2?K(Object(Le),!0).forEach(function(_t){m()(Pe,_t,Le[_t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pe,Object.getOwnPropertyDescriptors(Le)):K(Object(Le)).forEach(function(_t){Object.defineProperty(Pe,_t,Object.getOwnPropertyDescriptor(Le,_t))})}return Pe}var pe=6378e3;function Ke(Pe,ht){var Le=Pe.dataArray,_t=ht.size,ot=_t===void 0?10:_t,et=ht.method,Ze=et===void 0?"sum":et,At=ot/(2*Math.PI*pe)*(256<<20)/2,St=Le.map(function(dt){var we=Object(i.d)(dt.coordinates),pt=z()(we,2),Wt=pt[0],Qt=pt[1];return je(je({},dt),{},{coordinates:[Wt,Qt]})}),De=ce().radius(At).x(function(dt){return dt.coordinates[0]}).y(function(dt){return dt.coordinates[1]}),Ie=De(St),Ge={dataArray:Ie.map(function(dt,we){var pt;if(ht.field&&Ze){var Wt=i.c.getColumn(dt,ht.field);dt[Ze]=i.c.statMap[Ze](Wt)}return pt={},m()(pt,ht.method,dt[Ze]),m()(pt,"count",dt.length),m()(pt,"rawData",dt),m()(pt,"coordinates",[dt.x,dt.y]),m()(pt,"_id",we),pt}),radius:At,xOffset:At,yOffset:At,type:"hexagon"};return Ge}},"+em5":function(Ue,y,o){"use strict";o.d(y,"a",function(){return oe});var x=o("lSNA"),m=o.n(x),Y=o("yG8O"),z=o.n(Y),i=o("lwsE"),W=o.n(i),D=o("W8MJ"),Q=o.n(D),ee=o("U+yc"),ce=o.n(ee),K=o("1ABj"),je=o.n(K),pe=o("gQMU"),Ke=o.n(pe),Pe=o("J2iB"),ht=o.n(Pe),Le=o("u6S6"),_t=o.n(Le),ot=o("4cb6"),et=o.n(ot),Ze=o("h1nZ"),At=o("bB6j"),St=o("bPkA"),De,Ie,Ge,dt,we,pt;function Wt(J,H){var Se=Object.keys(J);if(Object.getOwnPropertySymbols){var be=Object.getOwnPropertySymbols(J);H&&(be=be.filter(function(Te){return Object.getOwnPropertyDescriptor(J,Te).enumerable})),Se.push.apply(Se,be)}return Se}function Qt(J){for(var H=1;H<arguments.length;H++){var Se=arguments[H]!=null?arguments[H]:{};H%2?Wt(Object(Se),!0).forEach(function(be){m()(J,be,Se[be])}):Object.getOwnPropertyDescriptors?Object.defineProperties(J,Object.getOwnPropertyDescriptors(Se)):Wt(Object(Se)).forEach(function(be){Object.defineProperty(J,be,Object.getOwnPropertyDescriptor(Se,be))})}return J}var ur=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oe=(De=Object(ot.injectable)(),Ie=Object(ot.inject)(At.a.IShaderModuleService),De(Ge=(dt=(pt=function(){function J(){W()(this,J),z()(this,"shaderModuleService",we,this),this.rendererService=void 0,this.config=void 0,this.quad=ur,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return Q()(J,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Se){this.name=Se}},{key:"getType",value:function(){return St.a.PostProcessing}},{key:"init",value:function(Se,be){this.config=be,this.rendererService=Se.getContainer().get(At.a.IRendererService);var Te=this.rendererService,me=Te.createAttribute,at=Te.createBuffer,Jt=Te.createModel,Mt=this.setupShaders(),ve=Mt.vs,ge=Mt.fs,He=Mt.uniforms;this.model=Jt({vs:ve,fs:ge,attributes:{a_Position:me({buffer:at({data:[-4,-4,4,-4,0,4],type:Ze.gl.FLOAT}),size:2})},uniforms:Qt(Qt({u_Texture:null},He),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Se){var be=this,Te=Se.multiPassRenderer.getPostProcessor(),me=this.rendererService,at=me.useFramebuffer,Jt=me.getViewportSize,Mt=me.clear,ve=Jt(),ge=ve.width,He=ve.height;at(this.renderToScreen?null:Te.getWriteFBO(),function(){Mt({framebuffer:Te.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),be.model.draw({uniforms:Qt({u_Texture:Te.getReadFBO(),u_ViewportSize:[ge,He]},be.convertOptionsToUniforms(be.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Se){this.enabled=Se}},{key:"setRenderToScreen",value:function(Se){this.renderToScreen=Se}},{key:"updateOptions",value:function(Se){this.optionsToUpdate=Qt(Qt({},this.optionsToUpdate),Se)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Se){var be={};return Object.keys(Se).forEach(function(Te){ht()(Se[Te])||(be["u_".concat(Ke()(_t()(Te)))]=Se[Te])}),be}}]),J}(),pt),we=ce()(dt.prototype,"shaderModuleService",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt))||Ge)},"+iFO":function(Ue,y,o){var x=o("dTAl"),m=o("LcsW"),Y=o("6sVZ");function z(i){return typeof i.constructor=="function"&&!Y(i)?x(m(i)):{}}Ue.exports=z},"/33/":function(Ue,y){},"/Uc5":function(Ue,y){},"/ezw":function(Ue,y,o){"use strict";var x=o("lSNA"),m=o.n(x),Y=o("pVnL"),z=o.n(Y),i=o("cDf5"),W=o.n(i),D=o("q1tI"),Q=o("TSYQ"),ee=o.n(Q),ce=function(be){var Te=be.prefixCls,me=be.className,at=be.width,Jt=be.style;return D.createElement("h3",{className:ee()(Te,me),style:z()({width:at},Jt)})},K=ce,je=o("RIqP"),pe=o.n(je),Ke=function(be){var Te=function(He){var st=be.width,Oe=be.rows,gt=Oe===void 0?2:Oe;return Array.isArray(st)?st[He]:gt-1===He?st:void 0},me=be.prefixCls,at=be.className,Jt=be.style,Mt=be.rows,ve=pe()(Array(Mt)).map(function(ge,He){return D.createElement("li",{key:He,style:{width:Te(He)}})});return D.createElement("ul",{className:ee()(me,at),style:Jt},ve)},Pe=Ke,ht=o("H84U"),Le=function(be){var Te,me,at=be.prefixCls,Jt=be.className,Mt=be.style,ve=be.size,ge=be.shape,He=ee()((Te={},m()(Te,"".concat(at,"-lg"),ve==="large"),m()(Te,"".concat(at,"-sm"),ve==="small"),Te)),st=ee()((me={},m()(me,"".concat(at,"-circle"),ge==="circle"),m()(me,"".concat(at,"-square"),ge==="square"),m()(me,"".concat(at,"-round"),ge==="round"),me)),Oe=typeof ve=="number"?{width:ve,height:ve,lineHeight:"".concat(ve,"px")}:{};return D.createElement("span",{className:ee()(at,He,st,Jt),style:z()(z()({},Oe),Mt)})},_t=Le,ot=o("BGR+"),et=function(be){var Te=function(at){var Jt=at.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.active,He=Jt("skeleton",Mt),st=Object(ot.a)(be,["prefixCls"]),Oe=ee()(He,"".concat(He,"-element"),m()({},"".concat(He,"-active"),ge),ve);return D.createElement("div",{className:Oe},D.createElement(_t,z()({prefixCls:"".concat(He,"-avatar")},st)))};return D.createElement(ht.a,null,Te)};et.defaultProps={size:"default",shape:"circle"};var Ze=et,At=function(be){var Te=function(at){var Jt=at.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.active,He=Jt("skeleton",Mt),st=Object(ot.a)(be,["prefixCls"]),Oe=ee()(He,"".concat(He,"-element"),m()({},"".concat(He,"-active"),ge),ve);return D.createElement("div",{className:Oe},D.createElement(_t,z()({prefixCls:"".concat(He,"-button")},st)))};return D.createElement(ht.a,null,Te)};At.defaultProps={size:"default"};var St=At,De=function(be){var Te=function(at){var Jt=at.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.active,He=Jt("skeleton",Mt),st=Object(ot.a)(be,["prefixCls"]),Oe=ee()(He,"".concat(He,"-element"),m()({},"".concat(He,"-active"),ge),ve);return D.createElement("div",{className:Oe},D.createElement(_t,z()({prefixCls:"".concat(He,"-input")},st)))};return D.createElement(ht.a,null,Te)};De.defaultProps={size:"default"};var Ie=De,Ge="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",dt=function(be){var Te=function(at){var Jt=at.getPrefixCls,Mt=be.prefixCls,ve=be.className,ge=be.style,He=Jt("skeleton",Mt),st=ee()(He,"".concat(He,"-element"),ve);return D.createElement("div",{className:st},D.createElement("div",{className:ee()("".concat(He,"-image"),ve),style:ge},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(He,"-image-svg")},D.createElement("path",{d:Ge,className:"".concat(He,"-image-path")}))))};return D.createElement(ht.a,null,Te)},we=dt;function pt(Se){return Se&&W()(Se)==="object"?Se:{}}function Wt(Se,be){return Se&&!be?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Qt(Se,be){return!Se&&be?{width:"38%"}:Se&&be?{width:"50%"}:{}}function ur(Se,be){var Te={};return(!Se||!be)&&(Te.width="61%"),!Se&&be?Te.rows=3:Te.rows=2,Te}var oe=function(be){var Te=function(at){var Jt=at.getPrefixCls,Mt=at.direction,ve=be.prefixCls,ge=be.loading,He=be.className,st=be.children,Oe=be.avatar,gt=be.title,C=be.paragraph,R=be.active,q=be.round,fe=Jt("skeleton",ve);if(ge||!("loading"in be)){var We,qe=!!Oe,Tt=!!gt,it=!!C,Ut;if(qe){var $=z()(z()({prefixCls:"".concat(fe,"-avatar")},Wt(Tt,it)),pt(Oe));Ut=D.createElement("div",{className:"".concat(fe,"-header")},D.createElement(_t,$))}var Qe;if(Tt||it){var ne;if(Tt){var tt=z()(z()({prefixCls:"".concat(fe,"-title")},Qt(qe,it)),pt(gt));ne=D.createElement(K,tt)}var kt;if(it){var dr=z()(z()({prefixCls:"".concat(fe,"-paragraph")},ur(qe,Tt)),pt(C));kt=D.createElement(Pe,dr)}Qe=D.createElement("div",{className:"".concat(fe,"-content")},ne,kt)}var Ye=ee()(fe,(We={},m()(We,"".concat(fe,"-with-avatar"),qe),m()(We,"".concat(fe,"-active"),R),m()(We,"".concat(fe,"-rtl"),Mt==="rtl"),m()(We,"".concat(fe,"-round"),q),We),He);return D.createElement("div",{className:Ye},Ut,Qe)}return st};return D.createElement(ht.a,null,Te)};oe.defaultProps={avatar:!1,title:!0,paragraph:!0},oe.Button=St,oe.Avatar=Ze,oe.Input=Ie,oe.Image=we;var J=oe,H=y.a=J},"/rf6":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.earthRadius=63710088e-1,y.factors={centimeters:y.earthRadius*100,centimetres:y.earthRadius*100,degrees:y.earthRadius/111325,feet:y.earthRadius*3.28084,inches:y.earthRadius*39.37,kilometers:y.earthRadius/1e3,kilometres:y.earthRadius/1e3,meters:y.earthRadius,metres:y.earthRadius,miles:y.earthRadius/1609.344,millimeters:y.earthRadius*1e3,millimetres:y.earthRadius*1e3,nauticalmiles:y.earthRadius/1852,radians:1,yards:y.earthRadius/1.0936},y.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/y.earthRadius,yards:1/1.0936},y.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function x(J,H,Se){Se===void 0&&(Se={});var be={type:"Feature"};return(Se.id===0||Se.id)&&(be.id=Se.id),Se.bbox&&(be.bbox=Se.bbox),be.properties=H||{},be.geometry=J,be}y.feature=x;function m(J,H,Se){Se===void 0&&(Se={});switch(J){case"Point":return Y(H).geometry;case"LineString":return D(H).geometry;case"Polygon":return i(H).geometry;case"MultiPoint":return K(H).geometry;case"MultiLineString":return ce(H).geometry;case"MultiPolygon":return je(H).geometry;default:throw new Error(J+" is invalid")}}y.geometry=m;function Y(J,H,Se){Se===void 0&&(Se={});var be={type:"Point",coordinates:J};return x(be,H,Se)}y.point=Y;function z(J,H,Se){return Se===void 0&&(Se={}),ee(J.map(function(be){return Y(be,H)}),Se)}y.points=z;function i(J,H,Se){Se===void 0&&(Se={});for(var be=0,Te=J;be<Te.length;be++){var me=Te[be];if(me.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var at=0;at<me[me.length-1].length;at++)if(me[me.length-1][at]!==me[0][at])throw new Error("First and last Position are not equivalent.")}var Jt={type:"Polygon",coordinates:J};return x(Jt,H,Se)}y.polygon=i;function W(J,H,Se){return Se===void 0&&(Se={}),ee(J.map(function(be){return i(be,H)}),Se)}y.polygons=W;function D(J,H,Se){if(Se===void 0&&(Se={}),J.length<2)throw new Error("coordinates must be an array of two or more positions");var be={type:"LineString",coordinates:J};return x(be,H,Se)}y.lineString=D;function Q(J,H,Se){return Se===void 0&&(Se={}),ee(J.map(function(be){return D(be,H)}),Se)}y.lineStrings=Q;function ee(J,H){H===void 0&&(H={});var Se={type:"FeatureCollection"};return H.id&&(Se.id=H.id),H.bbox&&(Se.bbox=H.bbox),Se.features=J,Se}y.featureCollection=ee;function ce(J,H,Se){Se===void 0&&(Se={});var be={type:"MultiLineString",coordinates:J};return x(be,H,Se)}y.multiLineString=ce;function K(J,H,Se){Se===void 0&&(Se={});var be={type:"MultiPoint",coordinates:J};return x(be,H,Se)}y.multiPoint=K;function je(J,H,Se){Se===void 0&&(Se={});var be={type:"MultiPolygon",coordinates:J};return x(be,H,Se)}y.multiPolygon=je;function pe(J,H,Se){Se===void 0&&(Se={});var be={type:"GeometryCollection",geometries:J};return x(be,H,Se)}y.geometryCollection=pe;function Ke(J,H){if(H===void 0&&(H=0),H&&!(H>=0))throw new Error("precision must be a positive number");var Se=Math.pow(10,H||0);return Math.round(J*Se)/Se}y.round=Ke;function Pe(J,H){H===void 0&&(H="kilometers");var Se=y.factors[H];if(!Se)throw new Error(H+" units is invalid");return J*Se}y.radiansToLength=Pe;function ht(J,H){H===void 0&&(H="kilometers");var Se=y.factors[H];if(!Se)throw new Error(H+" units is invalid");return J/Se}y.lengthToRadians=ht;function Le(J,H){return ot(ht(J,H))}y.lengthToDegrees=Le;function _t(J){var H=J%360;return H<0&&(H+=360),H}y.bearingToAzimuth=_t;function ot(J){var H=J%(2*Math.PI);return H*180/Math.PI}y.radiansToDegrees=ot;function et(J){var H=J%360;return H*Math.PI/180}y.degreesToRadians=et;function Ze(J,H,Se){if(H===void 0&&(H="kilometers"),Se===void 0&&(Se="kilometers"),!(J>=0))throw new Error("length must be a positive number");return Pe(ht(J,H),Se)}y.convertLength=Ze;function At(J,H,Se){if(H===void 0&&(H="meters"),Se===void 0&&(Se="kilometers"),!(J>=0))throw new Error("area must be a positive number");var be=y.areaFactors[H];if(!be)throw new Error("invalid original units");var Te=y.areaFactors[Se];if(!Te)throw new Error("invalid final units");return J/be*Te}y.convertArea=At;function St(J){return!isNaN(J)&&J!==null&&!Array.isArray(J)&&!/^\s*$/.test(J)}y.isNumber=St;function De(J){return!!J&&J.constructor===Object}y.isObject=De;function Ie(J){if(!J)throw new Error("bbox is required");if(!Array.isArray(J))throw new Error("bbox must be an Array");if(J.length!==4&&J.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");J.forEach(function(H){if(!St(H))throw new Error("bbox must only contain numbers")})}y.validateBBox=Ie;function Ge(J){if(!J)throw new Error("id is required");if(["string","number"].indexOf(typeof J)===-1)throw new Error("id must be a number or a string")}y.validateId=Ge;function dt(){throw new Error("method has been renamed to `radiansToDegrees`")}y.radians2degrees=dt;function we(){throw new Error("method has been renamed to `degreesToRadians`")}y.degrees2radians=we;function pt(){throw new Error("method has been renamed to `lengthToDegrees`")}y.distanceToDegrees=pt;function Wt(){throw new Error("method has been renamed to `lengthToRadians`")}y.distanceToRadians=Wt;function Qt(){throw new Error("method has been renamed to `radiansToLength`")}y.radiansToDistance=Qt;function ur(){throw new Error("method has been renamed to `bearingToAzimuth`")}y.bearingToAngle=ur;function oe(){throw new Error("method has been renamed to `convertLength`")}y.convertDistance=oe},"0JQy":function(Ue,y){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+m+Y,i="\\ufe0e\\ufe0f",W="["+o+"]",D="["+z+"]",Q="\\ud83c[\\udffb-\\udfff]",ee="(?:"+D+"|"+Q+")",ce="[^"+o+"]",K="(?:\\ud83c[\\udde6-\\uddff]){2}",je="[\\ud800-\\udbff][\\udc00-\\udfff]",pe="\\u200d",Ke=ee+"?",Pe="["+i+"]?",ht="(?:"+pe+"(?:"+[ce,K,je].join("|")+")"+Pe+Ke+")*",Le=Pe+Ke+ht,_t="(?:"+[ce+D+"?",D,K,je,W].join("|")+")",ot=RegExp(Q+"(?="+Q+")|"+_t+Le,"g");function et(Ze){return Ze.match(ot)||[]}Ue.exports=et},"0ZTe":function(Ue,y,o){var x=o("wy8a"),m=o("quyA"),Y=o("Em2t"),z=o("dt0z");function i(W){return function(D){D=z(D);var Q=m(D)?Y(D):void 0,ee=Q?Q[0]:D.charAt(0),ce=Q?x(Q,1).join(""):D.slice(1);return ee[W]()+ce}}Ue.exports=i},"0eqD":function(Ue,y){},"0gSV":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.tagged=void 0;var x=o("GXnB"),m=o("Ztfv");function Y(z,i){return function(W,D,Q){var ee=new x.Metadata(z,i);typeof Q=="number"?m.tagParameter(W,D,Q,ee):m.tagProperty(W,D,ee)}}y.tagged=Y},"1+5i":function(Ue,y,o){var x=o("w/wX"),m=o("sEf8"),Y=o("mdPL"),z=Y&&Y.isSet,i=z?m(z):x;Ue.exports=i},"14J3":function(Ue,y,o){"use strict";var x=o("cIOH"),m=o("1GLa")},"1ABj":function(Ue,y){function o(x,m){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Ue.exports=o},"1gqn":function(Ue,y){Ue.exports=function(x){return x&&typeof x=="object"&&typeof x.copy=="function"&&typeof x.fill=="function"&&typeof x.readUInt8=="function"}},"1jvM":function(Ue,y){},2:function(Ue,y){},"2ajD":function(Ue,y){function o(x){return x!==x}Ue.exports=o},"3DfO":function(Ue,y){function o(x){return x==null}Ue.exports=o},"3L66":function(Ue,y,o){var x=o("MMmD"),m=o("ExA7");function Y(z){return m(z)&&x(z)}Ue.exports=Y},"3cYt":function(Ue,y){function o(x){return function(m){return x==null?void 0:x[m]}}Ue.exports=o},"406g":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingOnSyntax=void 0;var x=o("z4Hk"),m=function(){function Y(z){this._binding=z}return Y.prototype.onActivation=function(z){return this._binding.onActivation=z,new x.BindingWhenSyntax(this._binding)},Y}();y.BindingOnSyntax=m},"4U9+":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.default=function(Pe){return(0,m.default)((0,Q.default)(Pe)&&Pe.length>=1,"Must merge at least 1 JSON schema."),z.default.apply(void 0,[{}].concat(Ke(Pe),[function(ht,Le,_t){if((0,W.default)(ht))return;if(_t==="required")return(0,ce.default)(ht.concat(Le));if((0,je.default)(ht)){if(!(0,je.default)(Le))throw new Error('Failed to merge schemas because "'+_t+'" has different values.');return}m.default.deepEqual(ht,Le,'Failed to merge schemas because "'+_t+'" has different values: '+JSON.stringify(ht)+" and "+JSON.stringify(Le)+".")}]))};var x=o("9lTW"),m=pe(x),Y=o("qd8s"),z=pe(Y),i=o("3DfO"),W=pe(i),D=o("WFAs"),Q=pe(D),ee=o("w26f"),ce=pe(ee),K=o("zZPE"),je=pe(K);function pe(Pe){return Pe&&Pe.__esModule?Pe:{default:Pe}}function Ke(Pe){if(Array.isArray(Pe)){for(var ht=0,Le=Array(Pe.length);ht<Pe.length;ht++)Le[ht]=Pe[ht];return Le}else return Array.from(Pe)}Ue.exports=y.default},"4ZJM":function(Ue,y,o){(function(x,m){Ue.exports=m()})(this,function(){"use strict";var x,m,Y;function z(i,W){if(!x)x=W;else if(!m)m=W;else{var D="var sharedChunk = {}; ("+x+")(sharedChunk); ("+m+")(sharedChunk);",Q={};x(Q),Y=W(Q),typeof window!="undefined"&&(Y.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return z(["exports"],function(i){"use strict";function W(e,t){return e(t={exports:{}},t.exports),t.exports}var D=Q;function Q(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}Q.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},Q.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},Q.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},Q.prototype.solveCurveX=function(e,t){var r,u,f,v,S;for(t===void 0&&(t=1e-6),f=e,S=0;S<8;S++){if(v=this.sampleCurveX(f)-e,Math.abs(v)<t)return f;var P=this.sampleCurveDerivativeX(f);if(Math.abs(P)<1e-6)break;f-=v/P}if((f=e)<(r=0))return r;if(f>(u=1))return u;for(;r<u;){if(v=this.sampleCurveX(f),Math.abs(v-e)<t)return f;e>v?r=f:u=f,f=.5*(u-r)+r}return f},Q.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var ee=ce;function ce(e,t){this.x=e,this.y=t}ce.prototype={clone:function(){return new ce(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),f=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=f,this},_rotateAround:function(t,r){var u=Math.cos(t),f=Math.sin(t),v=r.y+f*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-f*(this.y-r.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ce.convert=function(e){return e instanceof ce?e:Array.isArray(e)?new ce(e[0],e[1]):e};var K=typeof self!="undefined"?self:{},je=Math.pow(2,53)-1;function pe(e,t,r,u){var f=new D(e,t,r,u);return function(v){return f.solve(v)}}var Ke=pe(.25,.1,.25,1);function Pe(e,t,r){return Math.min(r,Math.max(t,e))}function ht(e,t,r){var u=r-t,f=((e-t)%u+u)%u+t;return f===t?r:f}function Le(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var v=f[u];for(var S in v)e[S]=v[S]}return e}var _t=1;function ot(){return _t++}function et(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ze(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function At(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function St(e,t){return e.indexOf(t,e.length-t.length)!==-1}function De(e,t,r){var u={};for(var f in e)u[f]=t.call(r||this,e[f],f,e);return u}function Ie(e,t,r){var u={};for(var f in e)t.call(r||this,e[f],f,e)&&(u[f]=e[f]);return u}function Ge(e){return Array.isArray(e)?e.map(Ge):typeof e=="object"&&e?De(e,Ge):e}var dt={};function we(e){dt[e]||(typeof console!="undefined"&&console.warn(e),dt[e]=!0)}function pt(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Wt(e){for(var t=0,r=0,u=e.length,f=u-1,v=void 0,S=void 0;r<u;f=r++)t+=((S=e[f]).x-(v=e[r]).x)*(v.y+S.y);return t}function Qt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ur(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,v,S){var P=v||S;return t[f]=!P||P.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var oe=null;function J(e){if(oe==null){var t=e.navigator?e.navigator.userAgent:null;oe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return oe}function H(e){try{var t=K[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Se,be,Te,me,at=K.performance&&K.performance.now?K.performance.now.bind(K.performance):Date.now.bind(Date),Jt=K.requestAnimationFrame||K.mozRequestAnimationFrame||K.webkitRequestAnimationFrame||K.msRequestAnimationFrame,Mt=K.cancelAnimationFrame||K.mozCancelAnimationFrame||K.webkitCancelAnimationFrame||K.msCancelAnimationFrame,ve={now:at,frame:function(t){var r=Jt(t);return{cancel:function(){return Mt(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=K.document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Se||(Se=K.document.createElement("a")),Se.href=t,Se.href},hardwareConcurrency:K.navigator&&K.navigator.hardwareConcurrency||4,get devicePixelRatio(){return K.devicePixelRatio},get prefersReducedMotion(){return!!K.matchMedia&&(be==null&&(be=K.matchMedia("(prefers-reduced-motion: reduce)")),be.matches)}},ge={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},He={supported:!1,testSupport:function(t){!st&&me&&(Oe?gt(t):Te=t)}},st=!1,Oe=!1;function gt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,me),e.isContextLost())return;He.supported=!0}catch(r){}e.deleteTexture(t),st=!0}K.document&&((me=K.document.createElement("img")).onload=function(){Te&&gt(Te),Te=null,Oe=!0},me.onerror=function(){st=!0,Te=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var C="01",R=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}R.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",C,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},R.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},R.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},R.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSpriteURL=function(e,t,r,u){var f=Tt(e);return q(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+r,it(f))},R.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=Tt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ve.devicePixelRatio>=2||t===512?"@2x":"")+(He.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(f){for(var v=0,S=f;v<S.length;v+=1){var P=S[v].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(r.params)||ge.ACCESS_TOKEN;return ge.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},R.prototype.canonicalizeTileURL=function(e,t){var r=Tt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(v){return!v.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},R.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),u=[],f=0,v=e.tiles||[];f<v.length;f+=1){var S=v[f];We(S)?u.push(this.canonicalizeTileURL(S,r)):u.push(S)}return u},R.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=Tt(ge.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!ge.REQUIRE_ACCESS_TOKEN)return it(e);if(!(t=t||ge.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(v){return v.indexOf("access_token")===-1}),e.params.push("access_token="+t),it(e)};var fe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function We(e){return fe.test(e)}var qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Tt(e){var t=e.match(qe);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function it(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ut(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(K.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var $=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(e){var t,r=Ut(ge.ACCESS_TOKEN);return t=r&&r.u?K.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(Number("0x"+f))})):ge.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},$.prototype.fetchEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=K.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=K.localStorage.getItem(r);f&&(this.anonId=f)}catch(v){we("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{K.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&K.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){we("Unable to write to LocalStorage")}},$.prototype.processRequests=function(e){},$.prototype.postEvent=function(e,t,r,u){var f=this;if(ge.EVENTS_URL){var v=Tt(ge.EVENTS_URL);v.params.push("access_token="+(u||ge.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:C,userId:this.anonId},P=t?Le(S,t):S,V={url:it(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=On(V,function(te){f.pendingRequest=null,r(te),f.saveEventData(),f.processRequests(u)})}},$.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Qe,ne,tt=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,f,v){this.skuToken=f,(ge.EVENTS_URL&&v||ge.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(S){return q(S)||We(S)}))&&this.queueRequest({id:u,timestamp:Date.now()},v)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),v=f.id,S=f.timestamp;v&&this.success[v]||(this.anonId||this.fetchEventData(),Ze(this.anonId)||(this.anonId=et()),this.postEvent(S,{skuToken:this.skuToken},function(P){P||v&&(u.success[v]=!0)},r))}},t}($),kt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){ge.EVENTS_URL&&ge.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return q(f)||We(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=Ut(ge.ACCESS_TOKEN),v=f?f.u:ge.ACCESS_TOKEN,S=v!==this.eventData.tokenU;Ze(this.anonId)||(this.anonId=et(),S=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var V=new Date(this.eventData.lastSuccess),te=new Date(P),he=(P-this.eventData.lastSuccess)/864e5;S=S||he>=1||he<-1||V.getDate()!==te.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(_e){_e||(u.eventData.lastSuccess=P,u.eventData.tokenU=v)},r)}},t}($)),dr=kt.postTurnstileEvent.bind(kt),Ye=new tt,xt=Ye.postMapLoadEvent.bind(Ye),bt=500,Et=50;function ze(){K.caches&&!Qe&&(Qe=K.caches.open("mapbox-tiles"))}function vt(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var yt,Ht=1/0;function hr(){return yt==null&&(yt=K.OffscreenCanvas&&new K.OffscreenCanvas(1,1).getContext("2d")&&typeof K.createImageBitmap=="function"),yt}var Hr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Hr);var gr=function(e){function t(r,u,f){u===401&&We(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Bn=Qt()?function(){return self.worker&&self.worker.referrer}:function(){return(K.location.protocol==="blob:"?K.parent:K).location.href},zn,oa,$n=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(Bn())&&!/^\w+:/.test(u))){if(K.fetch&&K.Request&&K.AbortController&&K.Request.prototype.hasOwnProperty("signal"))return function(f,v){var S,P=new K.AbortController,V=new K.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Bn(),signal:P.signal}),te=!1,he=!1,_e=(S=V.url).indexOf("sku=")>0&&We(S);f.type==="json"&&V.headers.set("Accept","application/json");var Ce=function(Ct,Yt,Zt){if(!he){if(Ct&&Ct.message!=="SecurityError"&&we(Ct),Yt&&Zt)return lt(Yt);var ir=Date.now();K.fetch(V).then(function(yr){if(yr.ok){var _r=_e?yr.clone():null;return lt(yr,_r,ir)}return v(new gr(yr.statusText,yr.status,f.url))}).catch(function(yr){yr.code!==20&&v(new Error(yr.message))})}},lt=function(Ct,Yt,Zt){(f.type==="arrayBuffer"?Ct.arrayBuffer():f.type==="json"?Ct.json():Ct.text()).then(function(ir){he||(Yt&&Zt&&function(yr,_r,kr){if(ze(),Qe){var Dr={status:_r.status,statusText:_r.statusText,headers:new K.Headers};_r.headers.forEach(function(fn,Rn){return Dr.headers.set(Rn,fn)});var pn=ur(_r.headers.get("Cache-Control")||"");pn["no-store"]||(pn["max-age"]&&Dr.headers.set("Expires",new Date(kr+1e3*pn["max-age"]).toUTCString()),new Date(Dr.headers.get("Expires")).getTime()-kr<42e4||function(fn,Rn){if(ne===void 0)try{new Response(new ReadableStream),ne=!0}catch(Qn){ne=!1}ne?Rn(fn.body):fn.blob().then(Rn)}(_r,function(fn){var Rn=new K.Response(fn,Dr);ze(),Qe&&Qe.then(function(Qn){return Qn.put(vt(yr.url),Rn)}).catch(function(Qn){return we(Qn.message)})}))}}(V,Yt,Zt),te=!0,v(null,ir,Ct.headers.get("Cache-Control"),Ct.headers.get("Expires")))}).catch(function(ir){he||v(new Error(ir.message))})};return _e?function(Pt,Ct){if(ze(),!Qe)return Ct(null);var Yt=vt(Pt.url);Qe.then(function(Zt){Zt.match(Yt).then(function(ir){var yr=function(_r){if(!_r)return!1;var kr=new Date(_r.headers.get("Expires")||0),Dr=ur(_r.headers.get("Cache-Control")||"");return kr>Date.now()&&!Dr["no-cache"]}(ir);Zt.delete(Yt),yr&&Zt.put(Yt,ir.clone()),Ct(null,ir,yr)}).catch(Ct)}).catch(Ct)}(V,Ce):Ce(null,null),{cancel:function(){he=!0,te||P.abort()}}}(t,r);if(Qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(f,v){var S=new K.XMLHttpRequest;for(var P in S.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(S.responseType="arraybuffer"),f.headers)S.setRequestHeader(P,f.headers[P]);return f.type==="json"&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials=f.credentials==="include",S.onerror=function(){v(new Error(S.statusText))},S.onload=function(){if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){var V=S.response;if(f.type==="json")try{V=JSON.parse(S.response)}catch(te){return v(te)}v(null,V,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else v(new gr(S.statusText,S.status,f.url))},S.send(f.body),{cancel:function(){return S.abort()}}}(t,r)},Yn=function(t,r){return $n(Le(t,{type:"arrayBuffer"}),r)},On=function(t,r){return $n(Le(t,{method:"POST"}),r)},U="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";zn=[],oa=0;var Z=function e(t,r){if(He.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),oa>=ge.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return zn.push(u),u}oa++;var f=!1,v=function(){if(!f)for(f=!0,oa--;zn.length&&oa<ge.MAX_PARALLEL_IMAGE_REQUESTS;){var V=zn.shift();V.cancelled||(V.cancel=e(V.requestParameters,V.callback).cancel)}},S=Yn(t,function(P,V,te,he){v(),P?r(P):V&&(hr()?function(_e,Ce){var lt=new K.Blob([new Uint8Array(_e)],{type:"image/png"});K.createImageBitmap(lt).then(function(Pt){Ce(null,Pt)}).catch(function(Pt){Ce(new Error("Could not load image because of "+Pt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(V,r):function(_e,Ce,lt,Pt){var Ct=new K.Image,Yt=K.URL;Ct.onload=function(){Ce(null,Ct),Yt.revokeObjectURL(Ct.src),Ct.onload=null,Ct.src=U},Ct.onerror=function(){return Ce(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Zt=new K.Blob([new Uint8Array(_e)],{type:"image/png"});Ct.cacheControl=lt,Ct.expires=Pt,Ct.src=_e.byteLength?Yt.createObjectURL(Zt):U}(V,r,te,he))});return{cancel:function(){S.cancel(),v()}}};function le(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function xe(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var ut=function(t,r){r===void 0&&(r={}),Le(this,r),this.type=t},wt=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",Le({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ut),Bt=function(){};Bt.prototype.on=function(e,t){return this._listeners=this._listeners||{},le(e,t,this._listeners),this},Bt.prototype.off=function(e,t){return xe(e,t,this._listeners),xe(e,t,this._oneTimeListeners),this},Bt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,t,this._oneTimeListeners),this},Bt.prototype.fire=function(e,t){typeof e=="string"&&(e=new ut(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var v=0,S=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];v<S.length;v+=1){var P=S[v];xe(r,P,this._oneTimeListeners),P.call(this,e)}var V=this._eventedParent;V&&(Le(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),V.fire(e))}else e instanceof wt&&console.error(e.error);return this},Bt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Bt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Lt=function(t,r,u,f){this.message=(t?t+": ":"")+u,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function lr(e){var t=e.value;return t?[new Lt(e.key,t,"constants have been deprecated as of v8")]:[]}function zr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var v=f[u];for(var S in v)e[S]=v[S]}return e}function Vr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function cr(e){if(Array.isArray(e))return e.map(cr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=cr(e[r]);return t}return Vr(e)}var Ur=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Mn=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,f=r;u<f.length;u+=1){var v=f[u];this.bindings[v[0]]=v[1]}};Mn.prototype.concat=function(e){return new Mn(this,e)},Mn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Mn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var ln={kind:"null"},er={kind:"number"},tn={kind:"string"},hn={kind:"boolean"},xn={kind:"color"},yn={kind:"object"},vn={kind:"value"},Pn={kind:"collator"},Va={kind:"formatted"},va={kind:"resolvedImage"};function Ma(e,t){return{kind:"array",itemType:e,N:t}}function Ia(e){if(e.kind==="array"){var t=Ia(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Zi=[ln,er,tn,hn,xn,Va,yn,Ma(vn),va];function da(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!da(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=Zi;r<u.length;r+=1)if(!da(u[r],t))return null}}return"Expected "+Ia(e)+" but found "+Ia(t)+" instead."}function di(e,t){return t.some(function(r){return r.kind===e.kind})}function ga(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var ya=W(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(P){return(P=Math.round(P))<0?0:P>255?255:P}function f(P){return u(P[P.length-1]==="%"?parseFloat(P)/100*255:parseInt(P))}function v(P){return(V=P[P.length-1]==="%"?parseFloat(P)/100:parseFloat(P))<0?0:V>1?1:V;var V}function S(P,V,te){return te<0?te+=1:te>1&&(te-=1),6*te<1?P+(V-P)*te*6:2*te<1?V:3*te<2?P+(V-P)*(2/3-te)*6:P}try{t.parseCSSColor=function(P){var V,te=P.replace(/ /g,"").toLowerCase();if(te in r)return r[te].slice();if(te[0]==="#")return te.length===4?(V=parseInt(te.substr(1),16))>=0&&V<=4095?[(3840&V)>>4|(3840&V)>>8,240&V|(240&V)>>4,15&V|(15&V)<<4,1]:null:te.length===7&&(V=parseInt(te.substr(1),16))>=0&&V<=16777215?[(16711680&V)>>16,(65280&V)>>8,255&V,1]:null;var he=te.indexOf("("),_e=te.indexOf(")");if(he!==-1&&_e+1===te.length){var Ce=te.substr(0,he),lt=te.substr(he+1,_e-(he+1)).split(","),Pt=1;switch(Ce){case"rgba":if(lt.length!==4)return null;Pt=v(lt.pop());case"rgb":return lt.length!==3?null:[f(lt[0]),f(lt[1]),f(lt[2]),Pt];case"hsla":if(lt.length!==4)return null;Pt=v(lt.pop());case"hsl":if(lt.length!==3)return null;var Ct=(parseFloat(lt[0])%360+360)%360/360,Yt=v(lt[1]),Zt=v(lt[2]),ir=Zt<=.5?Zt*(Yt+1):Zt+Yt-Zt*Yt,yr=2*Zt-ir;return[u(255*S(yr,ir,Ct+1/3)),u(255*S(yr,ir,Ct)),u(255*S(yr,ir,Ct-1/3)),Pt];default:return null}}return null}}catch(P){}}).parseCSSColor,fa=function(t,r,u,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=u,this.a=f};fa.parse=function(e){if(e){if(e instanceof fa)return e;if(typeof e=="string"){var t=ya(e);if(t)return new fa(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},fa.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},fa.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},fa.black=new fa(0,0,0,1),fa.white=new fa(1,1,1,1),fa.transparent=new fa(0,0,0,0),fa.red=new fa(1,0,0,1);var Si=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Si.prototype.compare=function(e,t){return this.collator.compare(e,t)},Si.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ns=function(t,r,u,f,v){this.text=t,this.image=r,this.scale=u,this.fontStack=f,this.textColor=v},Xi=function(t){this.sections=t};Xi.fromString=function(e){return new Xi([new ns(e,null,null,null,null)])},Xi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Xi.factory=function(e){return e instanceof Xi?e:Xi.fromString(e)},Xi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Xi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Vo=function(t){this.name=t.name,this.available=t.available};function ju(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ga(e){if(e===null)return!0;if(typeof e=="string")return!0;if(typeof e=="boolean")return!0;if(typeof e=="number")return!0;if(e instanceof fa)return!0;if(e instanceof Si)return!0;if(e instanceof Xi)return!0;if(e instanceof Vo)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ga(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!Ga(e[u]))return!1;return!0}return!1}function Ai(e){if(e===null)return ln;if(typeof e=="string")return tn;if(typeof e=="boolean")return hn;if(typeof e=="number")return er;if(e instanceof fa)return xn;if(e instanceof Si)return Pn;if(e instanceof Xi)return Va;if(e instanceof Vo)return va;if(Array.isArray(e)){for(var t,r=e.length,u=0,f=e;u<f.length;u+=1){var v=Ai(f[u]);if(t){if(t===v)continue;t=vn;break}t=v}return Ma(t||vn,r)}return yn}function Ko(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof fa||e instanceof Xi||e instanceof Vo?e.toString():JSON.stringify(e)}Vo.prototype.toString=function(){return this.name},Vo.fromString=function(e){return e?new Vo({name:e,available:!1}):null},Vo.prototype.serialize=function(){return["image",this.name]};var oi=function(t,r){this.type=t,this.value=r};oi.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ga(e[1]))return t.error("invalid value");var r=e[1],u=Ai(r),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new oi(u,r)},oi.prototype.evaluate=function(){return this.value},oi.prototype.eachChild=function(){},oi.prototype.outputDefined=function(){return!0},oi.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof fa?["rgba"].concat(this.value.toArray()):this.value instanceof Xi?this.value.serialize():this.value};var Yi=function(t){this.name="ExpressionEvaluationError",this.message=t};Yi.prototype.toJSON=function(){return this.message};var wo={string:tn,number:er,boolean:hn,object:yn},Ha=function(t,r){this.type=t,this.args=r};Ha.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,f=e[0];if(f==="array"){var v,S;if(e.length>2){var P=e[1];if(typeof P!="string"||!(P in wo)||P==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);v=wo[P],u++}else v=vn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);S=e[2],u++}r=Ma(v,S)}else r=wo[f];for(var V=[];u<e.length;u++){var te=t.parse(e[u],u,vn);if(!te)return null;V.push(te)}return new Ha(r,V)},Ha.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!da(this.type,Ai(r)))return r;if(t===this.args.length-1)throw new Yi("Expected value to be of type "+Ia(this.type)+", but found "+Ia(Ai(r))+" instead.")}return null},Ha.prototype.eachChild=function(e){this.args.forEach(e)},Ha.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ha.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var oo=function(t){this.type=Va,this.sections=t};oo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,v=1;v<=e.length-1;++v){var S=e[v];if(f&&typeof S=="object"&&!Array.isArray(S)){f=!1;var P=null;if(S["font-scale"]&&!(P=t.parse(S["font-scale"],1,er)))return null;var V=null;if(S["text-font"]&&!(V=t.parse(S["text-font"],1,Ma(tn))))return null;var te=null;if(S["text-color"]&&!(te=t.parse(S["text-color"],1,xn)))return null;var he=u[u.length-1];he.scale=P,he.font=V,he.textColor=te}else{var _e=t.parse(e[v],1,vn);if(!_e)return null;var Ce=_e.type.kind;if(Ce!=="string"&&Ce!=="value"&&Ce!=="null"&&Ce!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:_e,scale:null,font:null,textColor:null})}}return new oo(u)},oo.prototype.evaluate=function(e){return new Xi(this.sections.map(function(t){var r=t.content.evaluate(e);return Ai(r)===va?new ns("",r,null,null,null):new ns(Ko(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},oo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var so=function(t){this.type=va,this.input=t};so.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,tn);return r?new so(r):t.error("No image name provided.")},so.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Vo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},so.prototype.eachChild=function(e){e(this.input)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return["image",this.input.serialize()]};var Eu={"to-boolean":hn,"to-color":xn,"to-number":er,"to-string":tn},$o=function(t,r){this.type=t,this.args=r};$o.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=Eu[r],f=[],v=1;v<e.length;v++){var S=t.parse(e[v],v,vn);if(!S)return null;f.push(S)}return new $o(u,f)},$o.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,f=this.args;u<f.length;u+=1){if(r=null,(t=f[u].evaluate(e))instanceof fa)return t;if(typeof t=="string"){var v=e.parseColor(t);if(v)return v}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":ju(t[0],t[1],t[2],t[3])))return new fa(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Yi(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var S=null,P=0,V=this.args;P<V.length;P+=1){if((S=V[P].evaluate(e))===null)return 0;var te=Number(S);if(!isNaN(te))return te}throw new Yi("Could not convert "+JSON.stringify(S)+" to number.")}return this.type.kind==="formatted"?Xi.fromString(Ko(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Vo.fromString(Ko(this.args[0].evaluate(e))):Ko(this.args[0].evaluate(e))},$o.prototype.eachChild=function(e){this.args.forEach(e)},$o.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$o.prototype.serialize=function(){if(this.type.kind==="formatted")return new oo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new so(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Kl=["Unknown","Point","LineString","Polygon"],ks=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ks.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ks.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Kl[this.feature.type]:this.feature.type:null},ks.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ks.prototype.canonicalID=function(){return this.canonical},ks.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ks.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=fa.parse(e)),t};var ho=function(t,r,u,f){this.name=t,this.type=r,this._evaluate=u,this.args=f};ho.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ho.prototype.eachChild=function(e){this.args.forEach(e)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ho.parse=function(e,t){var r,u=e[0],f=ho.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var v=Array.isArray(f)?f[0]:f.type,S=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,P=S.filter(function(Xn){var Nn=Xn[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),V=null,te=0,he=P;te<he.length;te+=1){var _e=he[te],Ce=_e[0],lt=_e[1];V=new Ks(t.registry,t.path,null,t.scope);for(var Pt=[],Ct=!1,Yt=1;Yt<e.length;Yt++){var Zt=e[Yt],ir=Array.isArray(Ce)?Ce[Yt-1]:Ce.type,yr=V.parse(Zt,1+Pt.length,ir);if(!yr){Ct=!0;break}Pt.push(yr)}if(!Ct)if(Array.isArray(Ce)&&Ce.length!==Pt.length)V.error("Expected "+Ce.length+" arguments, but found "+Pt.length+" instead.");else{for(var _r=0;_r<Pt.length;_r++){var kr=Array.isArray(Ce)?Ce[_r]:Ce.type,Dr=Pt[_r];V.concat(_r+1).checkSubtype(kr,Dr.type)}if(V.errors.length===0)return new ho(u,v,lt,Pt)}}if(P.length===1)(r=t.errors).push.apply(r,V.errors);else{for(var pn=(P.length?P:S).map(function(Xn){var Nn;return Nn=Xn[0],Array.isArray(Nn)?"("+Nn.map(Ia).join(", ")+")":"("+Ia(Nn.type)+"...)"}).join(" | "),fn=[],Rn=1;Rn<e.length;Rn++){var Qn=t.parse(e[Rn],1+fn.length);if(!Qn)return null;fn.push(Ia(Qn.type))}t.error("Expected arguments of type "+pn+", but found ("+fn.join(", ")+") instead.")}return null},ho.register=function(e,t){for(var r in ho.definitions=t,t)e[r]=ho};var Vt=function(t,r,u){this.type=Pn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function Re(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Dt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function mr(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(u*f*8192)]}function Qr(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function En(e,t){for(var r,u,f,v,S,P,V,te=!1,he=0,_e=t.length;he<_e;he++)for(var Ce=t[he],lt=0,Pt=Ce.length;lt<Pt-1;lt++){if((v=(r=e)[0]-(u=Ce[lt])[0])*(V=r[1]-(f=Ce[lt+1])[1])-(P=r[0]-f[0])*(S=r[1]-u[1])==0&&v*P<=0&&S*V<=0)return!1;Qr(e,Ce[lt],Ce[lt+1])&&(te=!te)}return te}function Vn(e,t){for(var r=0;r<t.length;r++)if(En(e,t[r]))return!0;return!1}function Ci(e,t,r,u){var f=u[0]-r[0],v=u[1]-r[1],S=(e[0]-r[0])*v-f*(e[1]-r[1]),P=(t[0]-r[0])*v-f*(t[1]-r[1]);return S>0&&P<0||S<0&&P>0}function po(e,t,r){for(var u=0,f=r;u<f.length;u+=1)for(var v=f[u],S=0;S<v.length-1;++S)if((_e=[(he=v[S+1])[0]-(te=v[S])[0],he[1]-te[1]])[0]*(Ce=[(V=t)[0]-(P=e)[0],V[1]-P[1]])[1]-_e[1]*Ce[0]!=0&&Ci(P,V,te,he)&&Ci(te,he,P,V))return!0;var P,V,te,he,_e,Ce;return!1}function mo(e,t){for(var r=0;r<e.length;++r)if(!En(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(po(e[u],e[u+1],t))return!1;return!0}function Oo(e,t){for(var r=0;r<t.length;r++)if(mo(e,t[r]))return!0;return!1}function Fu(e,t,r){for(var u=[],f=0;f<e.length;f++){for(var v=[],S=0;S<e[f].length;S++){var P=mr(e[f][S],r);Re(t,P),v.push(P)}u.push(v)}return u}function Ml(e,t,r){for(var u=[],f=0;f<e.length;f++){var v=Fu(e[f],t,r);u.push(v)}return u}function bs(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var f=.5*u,v=e[0]-r[0]>f?-u:r[0]-e[0]>f?u:0;v===0&&(v=e[0]-r[2]>f?-u:r[2]-e[0]>f?u:0),e[0]+=v}Re(t,e)}function vc(e,t,r,u){for(var f=8192*Math.pow(2,u.z),v=[8192*u.x,8192*u.y],S=[],P=0,V=e;P<V.length;P+=1)for(var te=0,he=V[P];te<he.length;te+=1){var _e=he[te],Ce=[_e.x+v[0],_e.y+v[1]];bs(Ce,t,r,f),S.push(Ce)}return S}function Tu(e,t,r,u){for(var f,v=8192*Math.pow(2,u.z),S=[8192*u.x,8192*u.y],P=[],V=0,te=e;V<te.length;V+=1){for(var he=[],_e=0,Ce=te[V];_e<Ce.length;_e+=1){var lt=Ce[_e],Pt=[lt.x+S[0],lt.y+S[1]];Re(t,Pt),he.push(Pt)}P.push(he)}if(t[2]-t[0]<=v/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var Ct=0,Yt=P;Ct<Yt.length;Ct+=1)for(var Zt=0,ir=Yt[Ct];Zt<ir.length;Zt+=1)bs(ir[Zt],t,r,v)}return P}Vt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,hn);if(!u)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,hn);if(!f)return null;var v=null;return r.locale&&!(v=t.parse(r.locale,1,tn))?null:new Vt(u,f,v)},Vt.prototype.evaluate=function(e){return new Si(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Vt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Vt.prototype.outputDefined=function(){return!1},Vt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Mo=function(t,r){this.type=hn,this.geojson=t,this.geometries=r};function zu(e){if(e instanceof ho){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Mo)return!1;var t=!0;return e.eachChild(function(r){t&&!zu(r)&&(t=!1)}),t}function Eo(e){if(e instanceof ho&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!Eo(r)&&(t=!1)}),t}function Fi(e,t){if(e instanceof ho&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!Fi(u,t)&&(r=!1)}),r}Mo.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ga(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var f=r.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Mo(r,r.features[u].geometry)}else if(r.type==="Feature"){var v=r.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Mo(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Mo(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Mo.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],v=t.canonicalID();if(r.type==="Polygon"){var S=Fu(r.coordinates,f,v),P=vc(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var V=0,te=P;V<te.length;V+=1)if(!En(te[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ml(r.coordinates,f,v),_e=vc(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var Ce=0,lt=_e;Ce<lt.length;Ce+=1)if(!Vn(lt[Ce],he))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],v=t.canonicalID();if(r.type==="Polygon"){var S=Fu(r.coordinates,f,v),P=Tu(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var V=0,te=P;V<te.length;V+=1)if(!mo(te[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ml(r.coordinates,f,v),_e=Tu(t.geometry(),u,f,v);if(!Dt(u,f))return!1;for(var Ce=0,lt=_e;Ce<lt.length;Ce+=1)if(!Oo(lt[Ce],he))return!1}return!0}(e,this.geometries)}return!1},Mo.prototype.eachChild=function(){},Mo.prototype.outputDefined=function(){return!0},Mo.prototype.serialize=function(){return["within",this.geojson]};var Ys=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Ys.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Ys(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ys.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ys.prototype.eachChild=function(){},Ys.prototype.outputDefined=function(){return!1},Ys.prototype.serialize=function(){return["var",this.name]};var Ks=function(t,r,u,f,v){r===void 0&&(r=[]),f===void 0&&(f=new Mn),v===void 0&&(v=[]),this.registry=t,this.path=r,this.key=r.map(function(S){return"["+S+"]"}).join(""),this.scope=f,this.errors=v,this.expectedType=u};function js(e,t){for(var r,u=e.length-1,f=0,v=u,S=0;f<=v;)if((r=e[S=Math.floor((f+v)/2)])<=t){if(S===u||t<e[S+1])return S;f=S+1}else{if(!(r>t))throw new Yi("Input is not a number.");v=S-1}return 0}Ks.prototype.parse=function(e,t,r,u,f){return f===void 0&&(f={}),t?this.concat(t,r,u)._parse(e,f):this._parse(e,f)},Ks.prototype._parse=function(e,t){function r(te,he,_e){return _e==="assert"?new Ha(he,[te]):_e==="coerce"?new $o(he,[te]):te}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var v=f.parse(e,this);if(!v)return null;if(this.expectedType){var S=this.expectedType,P=v.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||P.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(S,P))return null}else v=r(v,S,t.typeAnnotation||"coerce");else v=r(v,S,t.typeAnnotation||"assert")}if(!(v instanceof oi)&&v.type.kind!=="resolvedImage"&&function te(he){if(he instanceof Ys)return te(he.boundExpression);if(he instanceof ho&&he.name==="error")return!1;if(he instanceof Vt)return!1;if(he instanceof Mo)return!1;var _e=he instanceof $o||he instanceof Ha,Ce=!0;return he.eachChild(function(lt){Ce=_e?Ce&&te(lt):Ce&&lt instanceof oi}),!!Ce&&zu(he)&&Fi(he,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(v)){var V=new ks;try{v=new oi(v.type,v.evaluate(V))}catch(te){return this.error(te.message),null}}return v}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ks.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new Ks(this.registry,u,t||null,f,this.errors)},Ks.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Ur(u,e))},Ks.prototype.checkSubtype=function(e,t){var r=da(e,t);return r&&this.error(r),r};var Ri=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,v=u;f<v.length;f+=1){var S=v[f],P=S[1];this.labels.push(S[0]),this.outputs.push(P)}};function Vi(e,t,r){return e*(1-r)+t*r}Ri.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,er);if(!r)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var v=1;v<e.length;v+=2){var S=v===1?-1/0:e[v],P=e[v+1],V=v,te=v+1;if(typeof S!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(u.length&&u[u.length-1][0]>=S)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);var he=t.parse(P,te,f);if(!he)return null;f=f||he.type,u.push([S,he])}return new Ri(f,r,u)},Ri.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;return u>=t[f-1]?r[f-1].evaluate(e):r[js(t,u)].evaluate(e)},Ri.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Ri.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ri.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var xs=Object.freeze({__proto__:null,number:Vi,color:function(t,r,u){return new fa(Vi(t.r,r.r,u),Vi(t.g,r.g,u),Vi(t.b,r.b,u),Vi(t.a,r.a,u))},array:function(t,r,u){return t.map(function(f,v){return Vi(f,r[v],u)})}}),vl=6/29*3*(6/29),Qu=Math.PI/180,Rt=180/Math.PI;function fr(e){return e>.008856451679035631?Math.pow(e,1/3):e/vl+4/29}function Mr(e){return e>6/29?e*e*e:vl*(e-4/29)}function Zn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Xa(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function vi(e){var t=Xa(e.r),r=Xa(e.g),u=Xa(e.b),f=fr((.4124564*t+.3575761*r+.1804375*u)/.95047),v=fr((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*v-16,a:500*(f-v),b:200*(v-fr((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function Ki(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*Mr(t),r=.95047*Mr(r),u=1.08883*Mr(u),new fa(Zn(3.2404542*r-1.5371385*t-.4985314*u),Zn(-.969266*r+1.8760108*t+.041556*u),Zn(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function Ya(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var Ii={forward:vi,reverse:Ki,interpolate:function(t,r,u){return{l:Vi(t.l,r.l,u),a:Vi(t.a,r.a,u),b:Vi(t.b,r.b,u),alpha:Vi(t.alpha,r.alpha,u)}}},Go={forward:function(t){var r=vi(t),u=r.l,f=r.a,v=r.b,S=Math.atan2(v,f)*Rt;return{h:S<0?S+360:S,c:Math.sqrt(f*f+v*v),l:u,alpha:t.a}},reverse:function(t){var r=t.h*Qu,u=t.c;return Ki({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:Ya(t.h,r.h,u),c:Vi(t.c,r.c,u),l:Vi(t.l,r.l,u),alpha:Vi(t.alpha,r.alpha,u)}}},Cs=Object.freeze({__proto__:null,lab:Ii,hcl:Go}),pi=function(t,r,u,f,v){this.type=t,this.operator=r,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(var S=0,P=v;S<P.length;S+=1){var V=P[S],te=V[1];this.labels.push(V[0]),this.outputs.push(te)}};function Pl(e,t,r,u){var f=u-r,v=e-r;return f===0?0:t===1?v/f:(Math.pow(t,v)-1)/(Math.pow(t,f)-1)}pi.interpolationFactor=function(e,t,r,u){var f=0;if(e.name==="exponential")f=Pl(t,e.base,r,u);else if(e.name==="linear")f=Pl(t,1,r,u);else if(e.name==="cubic-bezier"){var v=e.controlPoints;f=new D(v[0],v[1],v[2],v[3]).solve(Pl(t,1,r,u))}return f},pi.parse=function(e,t){var r=e[0],u=e[1],f=e[2],v=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var S=u[1];if(typeof S!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:S}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var P=u.slice(1);if(P.length!==4||P.some(function(Yt){return typeof Yt!="number"||Yt<0||Yt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:P}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,er)))return null;var V=[],te=null;r==="interpolate-hcl"||r==="interpolate-lab"?te=xn:t.expectedType&&t.expectedType.kind!=="value"&&(te=t.expectedType);for(var he=0;he<v.length;he+=2){var _e=v[he],Ce=v[he+1],lt=he+3,Pt=he+4;if(typeof _e!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',lt);if(V.length&&V[V.length-1][0]>=_e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',lt);var Ct=t.parse(Ce,Pt,te);if(!Ct)return null;te=te||Ct.type,V.push([_e,Ct])}return te.kind==="number"||te.kind==="color"||te.kind==="array"&&te.itemType.kind==="number"&&typeof te.N=="number"?new pi(te,r,u,f,V):t.error("Type "+Ia(te)+" is not interpolatable.")},pi.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;if(u>=t[f-1])return r[f-1].evaluate(e);var v=js(t,u),S=pi.interpolationFactor(this.interpolation,u,t[v],t[v+1]),P=r[v].evaluate(e),V=r[v+1].evaluate(e);return this.operator==="interpolate"?xs[this.type.kind.toLowerCase()](P,V,S):this.operator==="interpolate-hcl"?Go.reverse(Go.interpolate(Go.forward(P),Go.forward(V),S)):Ii.reverse(Ii.interpolate(Ii.forward(P),Ii.forward(V),S))},pi.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},pi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},pi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var $s=function(t,r){this.type=t,this.args=r};$s.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var f=[],v=0,S=e.slice(1);v<S.length;v+=1){var P=t.parse(S[v],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!P)return null;r=r||P.type,f.push(P)}var V=u&&f.some(function(te){return da(u,te.type)});return new $s(V?vn:r,f)},$s.prototype.evaluate=function(e){for(var t,r=null,u=0,f=0,v=this.args;f<v.length&&(u++,(r=v[f].evaluate(e))&&r instanceof Vo&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);f+=1);return r},$s.prototype.eachChild=function(e){this.args.forEach(e)},$s.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$s.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Es=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};Es.prototype.evaluate=function(e){return this.result.evaluate(e)},Es.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Es.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var v=t.parse(e[u+1],u+1);if(!v)return null;r.push([f,v])}var S=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return S?new Es(r,S):null},Es.prototype.outputDefined=function(){return this.result.outputDefined()},Es.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var gl=function(t,r,u){this.type=t,this.index=r,this.input=u};gl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,er),u=t.parse(e[2],2,Ma(t.expectedType||vn));return r&&u?new gl(u.type.itemType,r,u):null},gl.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Yi("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Yi("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Yi("Array index must be an integer, but found "+t+" instead.");return r[t]},gl.prototype.eachChild=function(e){e(this.index),e(this.input)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var cu=function(t,r){this.type=hn,this.needle=t,this.haystack=r};cu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,vn),u=t.parse(e[2],2,vn);return r&&u?di(r.type,[hn,tn,er,ln,vn])?new cu(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead"):null},cu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!ga(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Ai(t))+" instead.");if(!ga(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Ai(r))+" instead.");return r.indexOf(t)>=0},cu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},cu.prototype.outputDefined=function(){return!0},cu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var _u=function(t,r,u){this.type=er,this.needle=t,this.haystack=r,this.fromIndex=u};_u.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,vn),u=t.parse(e[2],2,vn);if(!r||!u)return null;if(!di(r.type,[hn,tn,er,ln,vn]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,er);return f?new _u(r,u,f):null}return new _u(r,u)},_u.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!ga(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Ai(t))+" instead.");if(!ga(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Ai(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},_u.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},_u.prototype.outputDefined=function(){return!1},_u.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fu=function(t,r,u,f,v,S){this.inputType=t,this.type=r,this.input=u,this.cases=f,this.outputs=v,this.otherwise=S};fu.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},v=[],S=2;S<e.length-1;S+=2){var P=e[S],V=e[S+1];Array.isArray(P)||(P=[P]);var te=t.concat(S);if(P.length===0)return te.error("Expected at least one branch label.");for(var he=0,_e=P;he<_e.length;he+=1){var Ce=_e[he];if(typeof Ce!="number"&&typeof Ce!="string")return te.error("Branch labels must be numbers or strings.");if(typeof Ce=="number"&&Math.abs(Ce)>Number.MAX_SAFE_INTEGER)return te.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Ce=="number"&&Math.floor(Ce)!==Ce)return te.error("Numeric branch labels must be integer values.");if(r){if(te.checkSubtype(r,Ai(Ce)))return null}else r=Ai(Ce);if(f[String(Ce)]!==void 0)return te.error("Branch labels must be unique.");f[String(Ce)]=v.length}var lt=t.parse(V,S,u);if(!lt)return null;u=u||lt.type,v.push(lt)}var Pt=t.parse(e[1],1,vn);if(!Pt)return null;var Ct=t.parse(e[e.length-1],e.length-1,u);return Ct?Pt.type.kind!=="value"&&t.concat(1).checkSubtype(r,Pt.type)?null:new fu(r,u,Pt,f,v,Ct):null},fu.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Ai(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fu.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fu.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fu.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},f=0,v=Object.keys(this.cases).sort();f<v.length;f+=1){var S=v[f];(_e=u[this.cases[S]])===void 0?(u[this.cases[S]]=r.length,r.push([this.cases[S],[S]])):r[_e][1].push(S)}for(var P=function(Pt){return e.inputType.kind==="number"?Number(Pt):Pt},V=0,te=r;V<te.length;V+=1){var he=te[V],_e=he[0],Ce=he[1];t.push(Ce.length===1?P(Ce[0]):Ce.map(P)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Uu=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};Uu.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var v=t.parse(e[f],f,hn);if(!v)return null;var S=t.parse(e[f+1],f+1,r);if(!S)return null;u.push([v,S]),r=r||S.type}var P=t.parse(e[e.length-1],e.length-1,r);return P?new Uu(r,u,P):null},Uu.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},Uu.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},Uu.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Uu.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Js=function(t,r,u,f){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=f};function Rc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function pf(e,t,r,u){return u.compare(t,r)===0}function ci(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function f(v,S,P){this.type=hn,this.lhs=v,this.rhs=S,this.collator=P,this.hasUntypedArgument=v.type.kind==="value"||S.type.kind==="value"}return f.parse=function(v,S){if(v.length!==3&&v.length!==4)return S.error("Expected two or three arguments.");var P=v[0],V=S.parse(v[1],1,vn);if(!V)return null;if(!Rc(P,V.type))return S.concat(1).error('"'+P+`" comparisons are not supported for type '`+Ia(V.type)+"'.");var te=S.parse(v[2],2,vn);if(!te)return null;if(!Rc(P,te.type))return S.concat(2).error('"'+P+`" comparisons are not supported for type '`+Ia(te.type)+"'.");if(V.type.kind!==te.type.kind&&V.type.kind!=="value"&&te.type.kind!=="value")return S.error("Cannot compare types '"+Ia(V.type)+"' and '"+Ia(te.type)+"'.");u&&(V.type.kind==="value"&&te.type.kind!=="value"?V=new Ha(te.type,[V]):V.type.kind!=="value"&&te.type.kind==="value"&&(te=new Ha(V.type,[te])));var he=null;if(v.length===4){if(V.type.kind!=="string"&&te.type.kind!=="string"&&V.type.kind!=="value"&&te.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(!(he=S.parse(v[3],3,Pn)))return null}return new f(V,te,he)},f.prototype.evaluate=function(v){var S=this.lhs.evaluate(v),P=this.rhs.evaluate(v);if(u&&this.hasUntypedArgument){var V=Ai(S),te=Ai(P);if(V.kind!==te.kind||V.kind!=="string"&&V.kind!=="number")throw new Yi('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+V.kind+", "+te.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var he=Ai(S),_e=Ai(P);if(he.kind!=="string"||_e.kind!=="string")return t(v,S,P)}return this.collator?r(v,S,P,this.collator.evaluate(v)):t(v,S,P)},f.prototype.eachChild=function(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var v=[e];return this.eachChild(function(S){v.push(S.serialize())}),v},f}()}Js.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,vn),u=t.parse(e[2],2,er);if(!r||!u)return null;if(!di(r.type,[Ma(vn),tn,vn]))return t.error("Expected first argument to be of type array or string, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,er);return f?new Js(r.type,r,u,f):null}return new Js(r.type,r,u)},Js.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!ga(t,["string","array"]))throw new Yi("Expected first argument to be of type array or string, but found "+Ia(Ai(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},Js.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ic=ci("==",function(e,t,r){return t===r},pf),gc=ci("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!pf(0,t,r,u)}),Qc=ci("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),yl=ci(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),qc=ci("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),$i=ci(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),Su=function(t,r,u,f,v){this.type=tn,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=v};Su.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,er);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,tn)))return null;var v=null;if(u.currency&&!(v=t.parse(u.currency,1,tn)))return null;var S=null;if(u["min-fraction-digits"]&&!(S=t.parse(u["min-fraction-digits"],1,er)))return null;var P=null;return u["max-fraction-digits"]&&!(P=t.parse(u["max-fraction-digits"],1,er))?null:new Su(r,f,v,S,P)},Su.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Su.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Su.prototype.outputDefined=function(){return!1},Su.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var bl=function(t){this.type=er,this.input=t};bl.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ia(r.type)+" instead."):new bl(r):null},bl.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new Yi("Expected value to be of type string or array, but found "+Ia(Ai(t))+" instead.")},bl.prototype.eachChild=function(e){e(this.input)},bl.prototype.outputDefined=function(){return!1},bl.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var as={"==":Ic,"!=":gc,">":yl,"<":Qc,">=":$i,"<=":qc,array:Ha,at:gl,boolean:Ha,case:Uu,coalesce:$s,collator:Vt,format:oo,image:so,in:cu,"index-of":_u,interpolate:pi,"interpolate-hcl":pi,"interpolate-lab":pi,length:bl,let:Es,literal:oi,match:fu,number:Ha,"number-format":Su,object:Ha,slice:Js,step:Ri,string:Ha,"to-boolean":$o,"to-color":$o,"to-number":$o,"to-string":$o,var:Ys,within:Mo};function Dc(e,t){var r=t[0],u=t[1],f=t[2],v=t[3];r=r.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var S=v?v.evaluate(e):1,P=ju(r,u,f,S);if(P)throw new Yi(P);return new fa(r/255*S,u/255*S,f/255*S,S)}function yc(e,t){return e in t}function Ll(e,t){var r=t[e];return r===void 0?null:r}function qu(e){return{type:e}}function Nc(e){return{result:"success",value:e}}function hu(e){return{result:"error",value:e}}function Au(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function ef(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function $l(e){return!!e.expression&&e.expression.interpolated}function Ti(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function tf(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function mf(e){return e}function Jl(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function kc(e,t,r,u,f){return Jl(typeof r===f?u[r]:void 0,e.default,t.default)}function Ql(e,t,r){if(Ti(r)!=="number")return Jl(e.default,t.default);var u=e.stops.length;if(u===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var f=js(e.stops.map(function(v){return v[0]}),r);return e.stops[f][1]}function el(e,t,r){var u=e.base!==void 0?e.base:1;if(Ti(r)!=="number")return Jl(e.default,t.default);var f=e.stops.length;if(f===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var v=js(e.stops.map(function(_e){return _e[0]}),r),S=function(_e,Ce,lt,Pt){var Ct=Pt-lt,Yt=_e-lt;return Ct===0?0:Ce===1?Yt/Ct:(Math.pow(Ce,Yt)-1)/(Math.pow(Ce,Ct)-1)}(r,u,e.stops[v][0],e.stops[v+1][0]),P=e.stops[v][1],V=e.stops[v+1][1],te=xs[t.type]||mf;if(e.colorSpace&&e.colorSpace!=="rgb"){var he=Cs[e.colorSpace];te=function(Ce,lt){return he.reverse(he.interpolate(he.forward(Ce),he.forward(lt),S))}}return typeof P.evaluate=="function"?{evaluate:function(){for(var Ce=[],lt=arguments.length;lt--;)Ce[lt]=arguments[lt];var Pt=P.evaluate.apply(void 0,Ce),Ct=V.evaluate.apply(void 0,Ce);if(Pt!==void 0&&Ct!==void 0)return te(Pt,Ct,S)}}:te(P,V,S)}function Bu(e,t,r){return t.type==="color"?r=fa.parse(r):t.type==="formatted"?r=Xi.fromString(r.toString()):t.type==="resolvedImage"?r=Vo.fromString(r.toString()):Ti(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Jl(r,e.default,t.default)}ho.register(as,{error:[{kind:"error"},[tn],function(e,t){throw new Yi(t[0].evaluate(e))}],typeof:[tn,[vn],function(e,t){return Ia(Ai(t[0].evaluate(e)))}],"to-rgba":[Ma(er,4),[xn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[xn,[er,er,er],Dc],rgba:[xn,[er,er,er,er],Dc],has:{type:hn,overloads:[[[tn],function(e,t){return yc(t[0].evaluate(e),e.properties())}],[[tn,yn],function(e,t){var r=t[1];return yc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:vn,overloads:[[[tn],function(e,t){return Ll(t[0].evaluate(e),e.properties())}],[[tn,yn],function(e,t){var r=t[1];return Ll(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[vn,[tn],function(e,t){return Ll(t[0].evaluate(e),e.featureState||{})}],properties:[yn,[],function(e){return e.properties()}],"geometry-type":[tn,[],function(e){return e.geometryType()}],id:[vn,[],function(e){return e.id()}],zoom:[er,[],function(e){return e.globals.zoom}],"heatmap-density":[er,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[er,[],function(e){return e.globals.lineProgress||0}],accumulated:[vn,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[er,qu(er),function(e,t){for(var r=0,u=0,f=t;u<f.length;u+=1)r+=f[u].evaluate(e);return r}],"*":[er,qu(er),function(e,t){for(var r=1,u=0,f=t;u<f.length;u+=1)r*=f[u].evaluate(e);return r}],"-":{type:er,overloads:[[[er,er],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[er],function(e,t){return-t[0].evaluate(e)}]]},"/":[er,[er,er],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[er,[er,er],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[er,[],function(){return Math.LN2}],pi:[er,[],function(){return Math.PI}],e:[er,[],function(){return Math.E}],"^":[er,[er,er],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[er,[er],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[er,[er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[er,[er],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[er,[er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[er,[er],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[er,[er],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[er,[er],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[er,[er],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[er,[er],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[er,[er],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[er,qu(er),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[er,qu(er),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[er,[er],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[er,[er],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[er,[er],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[er,[er],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[hn,[vn],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[hn,[tn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f<v}],"filter-id-<":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<f}],"filter->":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f>v}],"filter-id->":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>f}],"filter-<=":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<=f}],"filter->=":[hn,[tn,vn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],v=u.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[hn,[vn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>=f}],"filter-has":[hn,[vn],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[hn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[hn,[Ma(tn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[hn,[Ma(vn)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[hn,[tn,Ma(vn)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[hn,[tn,Ma(vn)],function(e,t){var r=t[0],u=t[1];return function(f,v,S,P){for(;S<=P;){var V=S+P>>1;if(v[V]===f)return!0;v[V]>f?P=V-1:S=V+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:hn,overloads:[[[hn,hn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[qu(hn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:hn,overloads:[[[hn,hn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[qu(hn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[hn,[hn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[hn,[tn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[tn,[tn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[tn,[tn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[tn,qu(vn),function(e,t){return t.map(function(r){return Ko(r.evaluate(e))}).join("")}],"resolved-locale":[tn,[Pn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var xl=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new ks,this._defaultValue=r?function(u){return u.type==="color"&&tf(u.default)?new fa(0,0,0,0):u.type==="color"?fa.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Po(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in as}function ql(e,t){var r=new Ks(as,[],t?function(f){var v={color:xn,string:tn,number:er,enum:tn,boolean:hn,formatted:Va,resolvedImage:va};return f.type==="array"?Ma(v[f.value]||vn,f.length):v[f.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Nc(new xl(u,t)):hu(r.errors)}xl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,v){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)},xl.prototype.evaluate=function(e,t,r,u,f,v){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=v||null;try{var S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Yi("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}};var Rl=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Eo(r.expression)};Rl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,v){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,v)},Rl.prototype.evaluate=function(e,t,r,u,f,v){return this._styleExpression.evaluate(e,t,r,u,f,v)};var Il=function(t,r,u,f){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Eo(r.expression),this.interpolationType=f};function jc(e,t){if((e=ql(e,t)).result==="error")return e;var r=e.value.expression,u=zu(r);if(!u&&!Au(t))return hu([new Ur("","data expressions not supported")]);var f=Fi(r,["zoom"]);if(!f&&!ef(t))return hu([new Ur("","zoom expressions not supported")]);var v=function S(P){var V=null;if(P instanceof Es)V=S(P.result);else if(P instanceof $s)for(var te=0,he=P.args;te<he.length&&!(V=S(he[te]));te+=1);else(P instanceof Ri||P instanceof pi)&&P.input instanceof ho&&P.input.name==="zoom"&&(V=P);return V instanceof Ur||P.eachChild(function(_e){var Ce=S(_e);Ce instanceof Ur?V=Ce:!V&&Ce?V=new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):V&&Ce&&V!==Ce&&(V=new Ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),V}(r);return v||f?v instanceof Ur?hu([v]):v instanceof pi&&!$l(t)?hu([new Ur("",'"interpolate" expressions cannot be used with this property')]):Nc(v?new Il(u?"camera":"composite",e.value,v.labels,v instanceof pi?v.interpolation:void 0):new Rl(u?"constant":"source",e.value)):hu([new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Il.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,v){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,v)},Il.prototype.evaluate=function(e,t,r,u,f,v){return this._styleExpression.evaluate(e,t,r,u,f,v)},Il.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?pi.interpolationFactor(this.interpolationType,e,t,r):0};var El=function(t,r){this._parameters=t,this._specification=r,zr(this,function u(f,v){var S,P,V,te=v.type==="color",he=f.stops&&typeof f.stops[0][0]=="object",_e=he||!(he||f.property!==void 0),Ce=f.type||($l(v)?"exponential":"interval");if(te&&((f=zr({},f)).stops&&(f.stops=f.stops.map(function(Xn){return[Xn[0],fa.parse(Xn[1])]})),f.default=fa.parse(f.default?f.default:v.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!Cs[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(Ce==="exponential")S=el;else if(Ce==="interval")S=Ql;else if(Ce==="categorical"){S=kc,P=Object.create(null);for(var lt=0,Pt=f.stops;lt<Pt.length;lt+=1){var Ct=Pt[lt];P[Ct[0]]=Ct[1]}V=typeof f.stops[0][0]}else{if(Ce!=="identity")throw new Error('Unknown function type "'+Ce+'"');S=Bu}if(he){for(var Yt={},Zt=[],ir=0;ir<f.stops.length;ir++){var yr=f.stops[ir],_r=yr[0].zoom;Yt[_r]===void 0&&(Yt[_r]={zoom:_r,type:f.type,property:f.property,default:f.default,stops:[]},Zt.push(_r)),Yt[_r].stops.push([yr[0].value,yr[1]])}for(var kr=[],Dr=0,pn=Zt;Dr<pn.length;Dr+=1){var fn=pn[Dr];kr.push([Yt[fn].zoom,u(Yt[fn],v)])}var Rn={name:"linear"};return{kind:"composite",interpolationType:Rn,interpolationFactor:pi.interpolationFactor.bind(void 0,Rn),zoomStops:kr.map(function(Xn){return Xn[0]}),evaluate:function(Nn,Ea){var ca=Nn.zoom;return el({stops:kr,base:f.base},v,ca).evaluate(ca,Ea)}}}if(_e){var Qn=Ce==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Qn,interpolationFactor:pi.interpolationFactor.bind(void 0,Qn),zoomStops:f.stops.map(function(Xn){return Xn[0]}),evaluate:function(Nn){return S(f,v,Nn.zoom,P,V)}}}return{kind:"source",evaluate:function(Nn,Ea){var ca=Ea&&Ea.properties?Ea.properties[f.property]:void 0;return ca===void 0?Jl(f.default,v.default):S(f,v,ca,P,V)}}}(this._parameters,this._specification))};function Qs(e){var t=e.key,r=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},v=e.style,S=e.styleSpec,P=[],V=Ti(r);if(V!=="object")return[new Lt(t,r,"object expected, "+V+" found")];for(var te in r){var he=te.split(".")[0],_e=u[he]||u["*"],Ce=void 0;if(f[he])Ce=f[he];else if(u[he])Ce=kn;else if(f["*"])Ce=f["*"];else{if(!u["*"]){P.push(new Lt(t,r[te],'unknown property "'+te+'"'));continue}Ce=kn}P=P.concat(Ce({key:(t&&t+".")+te,value:r[te],valueSpec:_e,style:v,styleSpec:S,object:r,objectKey:te},r))}for(var lt in u)f[lt]||u[lt].required&&u[lt].default===void 0&&r[lt]===void 0&&P.push(new Lt(t,r,'missing required property "'+lt+'"'));return P}function eo(e){var t=e.value,r=e.valueSpec,u=e.style,f=e.styleSpec,v=e.key,S=e.arrayElementValidator||kn;if(Ti(t)!=="array")return[new Lt(v,t,"array expected, "+Ti(t)+" found")];if(r.length&&t.length!==r.length)return[new Lt(v,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Lt(v,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var P={type:r.value,values:r.values};f.$version<7&&(P.function=r.function),Ti(r.value)==="object"&&(P=r.value);for(var V=[],te=0;te<t.length;te++)V=V.concat(S({array:t,arrayIndex:te,value:t[te],valueSpec:P,style:u,styleSpec:f,key:v+"["+te+"]"}));return V}function vf(e){var t=e.key,r=e.value,u=e.valueSpec,f=Ti(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new Lt(t,r,"number expected, "+f+" found")]:"minimum"in u&&r<u.minimum?[new Lt(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new Lt(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function gf(e){var t,r,u,f=e.valueSpec,v=Vr(e.value.type),S={},P=v!=="categorical"&&e.value.property===void 0,V=!P,te=Ti(e.value.stops)==="array"&&Ti(e.value.stops[0])==="array"&&Ti(e.value.stops[0][0])==="object",he=Qs({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Pt){if(v==="identity")return[new Lt(Pt.key,Pt.value,'identity function may not have a "stops" property')];var Ct=[],Yt=Pt.value;return Ct=Ct.concat(eo({key:Pt.key,value:Yt,valueSpec:Pt.valueSpec,style:Pt.style,styleSpec:Pt.styleSpec,arrayElementValidator:_e})),Ti(Yt)==="array"&&Yt.length===0&&Ct.push(new Lt(Pt.key,Yt,"array must have at least one stop")),Ct},default:function(Pt){return kn({key:Pt.key,value:Pt.value,valueSpec:f,style:Pt.style,styleSpec:Pt.styleSpec})}}});return v==="identity"&&P&&he.push(new Lt(e.key,e.value,'missing required property "property"')),v==="identity"||e.value.stops||he.push(new Lt(e.key,e.value,'missing required property "stops"')),v==="exponential"&&e.valueSpec.expression&&!$l(e.valueSpec)&&he.push(new Lt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(V&&!Au(e.valueSpec)?he.push(new Lt(e.key,e.value,"property functions not supported")):P&&!ef(e.valueSpec)&&he.push(new Lt(e.key,e.value,"zoom functions not supported"))),v!=="categorical"&&!te||e.value.property!==void 0||he.push(new Lt(e.key,e.value,'"property" property is required')),he;function _e(lt){var Pt=[],Ct=lt.value,Yt=lt.key;if(Ti(Ct)!=="array")return[new Lt(Yt,Ct,"array expected, "+Ti(Ct)+" found")];if(Ct.length!==2)return[new Lt(Yt,Ct,"array length 2 expected, length "+Ct.length+" found")];if(te){if(Ti(Ct[0])!=="object")return[new Lt(Yt,Ct,"object expected, "+Ti(Ct[0])+" found")];if(Ct[0].zoom===void 0)return[new Lt(Yt,Ct,"object stop key must have zoom")];if(Ct[0].value===void 0)return[new Lt(Yt,Ct,"object stop key must have value")];if(u&&u>Vr(Ct[0].zoom))return[new Lt(Yt,Ct[0].zoom,"stop zoom values must appear in ascending order")];Vr(Ct[0].zoom)!==u&&(u=Vr(Ct[0].zoom),r=void 0,S={}),Pt=Pt.concat(Qs({key:Yt+"[0]",value:Ct[0],valueSpec:{zoom:{}},style:lt.style,styleSpec:lt.styleSpec,objectElementValidators:{zoom:vf,value:Ce}}))}else Pt=Pt.concat(Ce({key:Yt+"[0]",value:Ct[0],valueSpec:{},style:lt.style,styleSpec:lt.styleSpec},Ct));return Po(cr(Ct[1]))?Pt.concat([new Lt(Yt+"[1]",Ct[1],"expressions are not allowed in function stops.")]):Pt.concat(kn({key:Yt+"[1]",value:Ct[1],valueSpec:f,style:lt.style,styleSpec:lt.styleSpec}))}function Ce(lt,Pt){var Ct=Ti(lt.value),Yt=Vr(lt.value),Zt=lt.value!==null?lt.value:Pt;if(t){if(Ct!==t)return[new Lt(lt.key,Zt,Ct+" stop domain type must match previous stop domain type "+t)]}else t=Ct;if(Ct!=="number"&&Ct!=="string"&&Ct!=="boolean")return[new Lt(lt.key,Zt,"stop domain value must be a number, string, or boolean")];if(Ct!=="number"&&v!=="categorical"){var ir="number expected, "+Ct+" found";return Au(f)&&v===void 0&&(ir+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Lt(lt.key,Zt,ir)]}return v!=="categorical"||Ct!=="number"||isFinite(Yt)&&Math.floor(Yt)===Yt?v!=="categorical"&&Ct==="number"&&r!==void 0&&Yt<r?[new Lt(lt.key,Zt,"stop domain values must appear in ascending order")]:(r=Yt,v==="categorical"&&Yt in S?[new Lt(lt.key,Zt,"stop domain values must be unique")]:(S[Yt]=!0,[])):[new Lt(lt.key,Zt,"integer expected, found "+Yt)]}}function Tl(e){var t=(e.expressionContext==="property"?jc:ql)(cr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new Lt(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Lt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Eo(r))return[new Lt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!Eo(r))return[new Lt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Fi(r,["zoom","feature-state"]))return[new Lt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!zu(r))return[new Lt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ec(e){var t=e.key,r=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Vr(r))===-1&&f.push(new Lt(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(Vr(r))===-1&&f.push(new Lt(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function tl(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!tl(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}El.deserialize=function(e){return new El(e._parameters,e._specification)},El.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Dl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function bc(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};tl(e)||(e=rl(e));var t=ql(e,Dl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,f,v){return t.value.evaluate(u,f,{},v)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(r(u[f]))return!0;return!1}(e)}}function xc(e,t){return e<t?-1:e>t?1:0}function rl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?rf(e[1],e[2],"=="):r==="!="?_l(rf(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?rf(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(rl))):r==="all"?["all"].concat(e.slice(1).map(rl)):r==="none"?["all"].concat(e.slice(1).map(rl).map(_l)):r==="in"?nl(e[1],e.slice(2)):r==="!in"?_l(nl(e[1],e.slice(2))):r==="has"?qs(e[1]):r==="!has"?_l(qs(e[1])):r!=="within"||e}function rf(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function nl(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(xc)]]:["filter-in-small",e,["literal",t]]}}function qs(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function _l(e){return["!",e]}function tc(e){return tl(cr(e.value))?Tl(zr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,f=r.key;if(Ti(u)!=="array")return[new Lt(f,u,"array expected, "+Ti(u)+" found")];var v,S=r.styleSpec,P=[];if(u.length<1)return[new Lt(f,u,"filter array must have at least 1 element")];switch(P=P.concat(ec({key:f+"[0]",value:u[0],valueSpec:S.filter_operator,style:r.style,styleSpec:r.styleSpec})),Vr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Vr(u[1])==="$type"&&P.push(new Lt(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&P.push(new Lt(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(v=Ti(u[1]))!=="string"&&P.push(new Lt(f+"[1]",u[1],"string expected, "+v+" found"));for(var V=2;V<u.length;V++)v=Ti(u[V]),Vr(u[1])==="$type"?P=P.concat(ec({key:f+"["+V+"]",value:u[V],valueSpec:S.geometry_type,style:r.style,styleSpec:r.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&P.push(new Lt(f+"["+V+"]",u[V],"string, number, or boolean expected, "+v+" found"));break;case"any":case"all":case"none":for(var te=1;te<u.length;te++)P=P.concat(t({key:f+"["+te+"]",value:u[te],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":v=Ti(u[1]),u.length!==2?P.push(new Lt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):v!=="string"&&P.push(new Lt(f+"[1]",u[1],"string expected, "+v+" found"));break;case"within":v=Ti(u[1]),u.length!==2?P.push(new Lt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):v!=="object"&&P.push(new Lt(f+"[1]",u[1],"object expected, "+v+" found"))}return P}(e)}function Fc(e,t){var r=e.key,u=e.style,f=e.styleSpec,v=e.value,S=e.objectKey,P=f[t+"_"+e.layerType];if(!P)return[];var V=S.match(/^(.*)-transition$/);if(t==="paint"&&V&&P[V[1]]&&P[V[1]].transition)return kn({key:r,value:v,valueSpec:f.transition,style:u,styleSpec:f});var te,he=e.valueSpec||P[S];if(!he)return[new Lt(r,v,'unknown property "'+S+'"')];if(Ti(v)==="string"&&Au(he)&&!he.tokens&&(te=/^{([^}]+)}$/.exec(v)))return[new Lt(r,v,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(te[1])+" }`.")];var _e=[];return e.layerType==="symbol"&&(S==="text-field"&&u&&!u.glyphs&&_e.push(new Lt(r,v,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&tf(cr(v))&&Vr(v.type)==="identity"&&_e.push(new Lt(r,v,'"text-font" does not support identity functions'))),_e.concat(kn({key:e.key,value:v,valueSpec:he,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:S}))}function nf(e){return Fc(e,"paint")}function Fs(e){return Fc(e,"layout")}function yf(e){var t=[],r=e.value,u=e.key,f=e.style,v=e.styleSpec;r.type||r.ref||t.push(new Lt(u,r,'either "type" or "ref" is required'));var S,P=Vr(r.type),V=Vr(r.ref);if(r.id)for(var te=Vr(r.id),he=0;he<e.arrayIndex;he++){var _e=f.layers[he];Vr(_e.id)===te&&t.push(new Lt(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+_e.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Pt){Pt in r&&t.push(new Lt(u,r[Pt],'"'+Pt+'" is prohibited for ref layers'))}),f.layers.forEach(function(Pt){Vr(Pt.id)===V&&(S=Pt)}),S?S.ref?t.push(new Lt(u,r.ref,"ref cannot reference another ref layer")):P=Vr(S.type):t.push(new Lt(u,r.ref,'ref layer "'+V+'" not found'));else if(P!=="background")if(r.source){var Ce=f.sources&&f.sources[r.source],lt=Ce&&Vr(Ce.type);Ce?lt==="vector"&&P==="raster"?t.push(new Lt(u,r.source,'layer "'+r.id+'" requires a raster source')):lt==="raster"&&P!=="raster"?t.push(new Lt(u,r.source,'layer "'+r.id+'" requires a vector source')):lt!=="vector"||r["source-layer"]?lt==="raster-dem"&&P!=="hillshade"?t.push(new Lt(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):P!=="line"||!r.paint||!r.paint["line-gradient"]||lt==="geojson"&&Ce.lineMetrics||t.push(new Lt(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Lt(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Lt(u,r.source,'source "'+r.source+'" not found'))}else t.push(new Lt(u,r,'missing required property "source"'));return t=t.concat(Qs({key:u,value:r,valueSpec:v.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return kn({key:u+".type",value:r.type,valueSpec:v.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:tc,layout:function(Ct){return Qs({layer:r,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(Zt){return Fs(zr({layerType:P},Zt))}}})},paint:function(Ct){return Qs({layer:r,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(Zt){return nf(zr({layerType:P},Zt))}}})}}}))}function al(e){var t=e.value,r=e.key,u=Ti(t);return u!=="string"?[new Lt(r,t,"string expected, "+u+" found")]:[]}var wi={promoteId:function(t){var r=t.key,u=t.value;if(Ti(u)==="string")return al({key:r,value:u});var f=[];for(var v in u)f.push.apply(f,al({key:r+"."+v,value:u[v]}));return f}};function il(e){var t=e.value,r=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new Lt(r,t,'"type" is required')];var v,S=Vr(t.type);switch(S){case"vector":case"raster":case"raster-dem":return Qs({key:r,value:t,valueSpec:u["source_"+S.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:wi});case"geojson":if(v=Qs({key:r,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:wi}),t.cluster)for(var P in t.clusterProperties){var V=t.clusterProperties[P],te=V[0],he=typeof te=="string"?[te,["accumulated"],["get",P]]:te;v.push.apply(v,Tl({key:r+"."+P+".map",value:V[1],expressionContext:"cluster-map"})),v.push.apply(v,Tl({key:r+"."+P+".reduce",value:he,expressionContext:"cluster-reduce"}))}return v;case"video":return Qs({key:r,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return Qs({key:r,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new Lt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ec({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function Vu(e){var t=e.value,r=e.styleSpec,u=r.light,f=e.style,v=[],S=Ti(t);if(t===void 0)return v;if(S!=="object")return v.concat([new Lt("light",t,"object expected, "+S+" found")]);for(var P in t){var V=P.match(/^(.*)-transition$/);v=v.concat(V&&u[V[1]]&&u[V[1]].transition?kn({key:P,value:t[P],valueSpec:r.transition,style:f,styleSpec:r}):u[P]?kn({key:P,value:t[P],valueSpec:u[P],style:f,styleSpec:r}):[new Lt(P,t[P],'unknown property "'+P+'"')])}return v}var ui={"*":function(){return[]},array:eo,boolean:function(t){var r=t.value,u=t.key,f=Ti(r);return f!=="boolean"?[new Lt(u,r,"boolean expected, "+f+" found")]:[]},number:vf,color:function(t){var r=t.key,u=t.value,f=Ti(u);return f!=="string"?[new Lt(r,u,"color expected, "+f+" found")]:ya(u)===null?[new Lt(r,u,'color expected, "'+u+'" found')]:[]},constants:lr,enum:ec,filter:tc,function:gf,layer:yf,object:Qs,source:il,light:Vu,string:al,formatted:function(t){return al(t).length===0?[]:Tl(t)},resolvedImage:function(t){return al(t).length===0?[]:Tl(t)}};function kn(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&tf(Vr(t))?gf(e):r.expression&&Po(cr(t))?Tl(e):r.type&&ui[r.type]?ui[r.type](e):Qs(zr({},e,{valueSpec:r.type?u[r.type]:r}))}function Oi(e){var t=e.value,r=e.key,u=al(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new Lt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new Lt(r,t,'"glyphs" url must include a "{range}" token'))),u}function ws(e,t){t===void 0&&(t=Xe);var r=[];return r=r.concat(kn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Oi,"*":function(){return[]}}})),e.constants&&(r=r.concat(lr({key:"constants",value:e.constants,style:e,styleSpec:t}))),Nl(r)}function Nl(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Gu(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Nl(e.apply(this,t))}}ws.source=Gu(il),ws.light=Gu(Vu),ws.layer=Gu(yf),ws.filter=Gu(tc),ws.paintProperty=Gu(nf),ws.layoutProperty=Gu(Fs);var ol=ws,bf=ol.light,is=ol.paintProperty,Sl=ol.layoutProperty;function sl(e,t){var r=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new wt(new Error(f[u].message))),r=!0;return r}var ul=zi;function zi(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var v=0;v<this.d*this.d;v++){var S=f[3+v],P=f[3+v+1];u.push(S===P?null:f.subarray(S,P))}var V=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],V),this.bboxes=f.subarray(V),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var te=0;te<this.d*this.d;te++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var he=r/t*e;this.min=-he,this.max=e+he}zi.prototype.insert=function(e,t,r,u,f){this._forEachCell(t,r,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(f)},zi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},zi.prototype._insertCell=function(e,t,r,u,f,v){this.cells[f].push(v)},zi.prototype.query=function(e,t,r,u,f){var v=this.min,S=this.max;if(e<=v&&t<=v&&S<=r&&S<=u&&!f)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(e,t,r,u,this._queryCell,P,{},f),P},zi.prototype._queryCell=function(e,t,r,u,f,v,S,P){var V=this.cells[f];if(V!==null)for(var te=this.keys,he=this.bboxes,_e=0;_e<V.length;_e++){var Ce=V[_e];if(S[Ce]===void 0){var lt=4*Ce;(P?P(he[lt+0],he[lt+1],he[lt+2],he[lt+3]):e<=he[lt+2]&&t<=he[lt+3]&&r>=he[lt+0]&&u>=he[lt+1])?(S[Ce]=!0,v.push(te[Ce])):S[Ce]=!1}}},zi.prototype._forEachCell=function(e,t,r,u,f,v,S,P){for(var V=this._convertToCellCoord(e),te=this._convertToCellCoord(t),he=this._convertToCellCoord(r),_e=this._convertToCellCoord(u),Ce=V;Ce<=he;Ce++)for(var lt=te;lt<=_e;lt++){var Pt=this.d*lt+Ce;if((!P||P(this._convertFromCellCoord(Ce),this._convertFromCellCoord(lt),this._convertFromCellCoord(Ce+1),this._convertFromCellCoord(lt+1)))&&f.call(this,e,t,r,u,Pt,v,S,P))return}},zi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},zi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},zi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var v=t,S=0;S<e.length;S++){var P=e[S];f[3+S]=v,f.set(P,v),v+=P.length}return f[3+e.length]=v,f.set(this.keys,v),f[3+e.length+1]=v+=this.keys.length,f.set(this.bboxes,v),v+=this.bboxes.length,f.buffer};var Ts=K.ImageData,kl=K.ImageBitmap,to={};function In(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),to[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var zs in In("Object",Object),ul.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},ul.deserialize=function(e){return new ul(e.buffer)},In("Grid",ul),In("Color",fa),In("Error",Error),In("ResolvedImage",Vo),In("StylePropertyFunction",El),In("StyleExpression",xl,{omit:["_evaluator"]}),In("ZoomDependentExpression",Il),In("ZoomConstantExpression",Rl),In("CompoundExpression",ho,{omit:["_evaluate"]}),as)as[zs]._classRegistryKey||In("Expression_"+zs,as[zs]);function ti(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function jl(e){return kl&&e instanceof kl}function du(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ti(e)||jl(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof Ts)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,v=e;f<v.length;f+=1)u.push(du(v[f],t));return u}if(typeof e=="object"){var S=e.constructor,P=S._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var V=S.serialize?S.serialize(e,t):{};if(!S.serialize){for(var te in e)if(e.hasOwnProperty(te)&&!(to[P].omit.indexOf(te)>=0)){var he=e[te];V[te]=to[P].shallow.indexOf(te)>=0?he:du(he,t)}e instanceof Error&&(V.message=e.message)}if(V.$name)throw new Error("$name property is reserved for worker serialization logic.");return P!=="Object"&&(V.$name=P),V}throw new Error("can't serialize object of type "+typeof e)}function Us(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ti(e)||jl(e)||ArrayBuffer.isView(e)||e instanceof Ts)return e;if(Array.isArray(e))return e.map(Us);if(typeof e=="object"){var t=e.$name||"Object",r=to[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),f=0,v=Object.keys(e);f<v.length;f+=1){var S=v[f];if(S!=="$name"){var P=e[S];u[S]=to[t].shallow.indexOf(S)>=0?P:Us(P)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var ll=function(){this.first=!0};ll.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var qr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Ec(e){for(var t=0,r=e;t<r.length;t+=1)if(os(r[t].charCodeAt(0)))return!0;return!1}function os(e){return!(e!==746&&e!==747&&(e<4352||!(qr["Bopomofo Extended"](e)||qr.Bopomofo(e)||qr["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||qr["CJK Compatibility Ideographs"](e)||qr["CJK Compatibility"](e)||qr["CJK Radicals Supplement"](e)||qr["CJK Strokes"](e)||!(!qr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||qr["CJK Unified Ideographs Extension A"](e)||qr["CJK Unified Ideographs"](e)||qr["Enclosed CJK Letters and Months"](e)||qr["Hangul Compatibility Jamo"](e)||qr["Hangul Jamo Extended-A"](e)||qr["Hangul Jamo Extended-B"](e)||qr["Hangul Jamo"](e)||qr["Hangul Syllables"](e)||qr.Hiragana(e)||qr["Ideographic Description Characters"](e)||qr.Kanbun(e)||qr["Kangxi Radicals"](e)||qr["Katakana Phonetic Extensions"](e)||qr.Katakana(e)&&e!==12540||!(!qr["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!qr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||qr["Unified Canadian Aboriginal Syllabics"](e)||qr["Unified Canadian Aboriginal Syllabics Extended"](e)||qr["Vertical Forms"](e)||qr["Yijing Hexagram Symbols"](e)||qr["Yi Syllables"](e)||qr["Yi Radicals"](e))))}function ro(e){return!(os(e)||function(t){return!!(qr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||qr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||qr["Letterlike Symbols"](t)||qr["Number Forms"](t)||qr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||qr["Control Pictures"](t)&&t!==9251||qr["Optical Character Recognition"](t)||qr["Enclosed Alphanumerics"](t)||qr["Geometric Shapes"](t)||qr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qr["CJK Symbols and Punctuation"](t)||qr.Katakana(t)||qr["Private Use Area"](t)||qr["CJK Compatibility Forms"](t)||qr["Small Form Variants"](t)||qr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function Jo(e){return e>=1424&&e<=2303||qr["Arabic Presentation Forms-A"](e)||qr["Arabic Presentation Forms-B"](e)}function Os(e,t){return!(!t&&Jo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||qr.Khmer(e))}function Fl(e){for(var t=0,r=e;t<r.length;t+=1)if(Jo(r[t].charCodeAt(0)))return!0;return!1}var zc=null,Bs="unavailable",Cu=null,zl=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Bs="error"),zc&&zc(t)};function Ul(){af.fire(new ut("pluginStateChange",{pluginStatus:Bs,pluginURL:Cu}))}var af=new Bt,Uc=function(){return Bs},Lo=function(){if(Bs!=="deferred"||!Cu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Bs="loading",Ul(),Cu&&Yn({url:Cu},function(t){t?zl(t):(Bs="loaded",Ul())})},ss={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Bs==="loaded"||ss.applyArabicShaping!=null},isLoading:function(){return Bs==="loading"},setState:function(t){Bs=t.pluginStatus,Cu=t.pluginURL},isParsed:function(){return ss.applyArabicShaping!=null&&ss.processBidirectionalText!=null&&ss.processStyledBidirectionalText!=null},getPluginURL:function(){return Cu}},Pa=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ll,this.transition={})};Pa.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,f=t;u<f.length;u+=1)if(!Os(f[u].charCodeAt(0),r))return!1;return!0}(e,ss.isLoaded())},Pa.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Pa.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var eu=function(t,r){this.property=t,this.value=r,this.expression=function(u,f){if(tf(u))return new El(u,f);if(Po(u)){var v=jc(u,f);if(v.result==="error")throw new Error(v.value.map(function(P){return P.key+": "+P.message}).join(", "));return v.value}var S=u;return typeof u=="string"&&f.type==="color"&&(S=fa.parse(u)),{kind:"constant",evaluate:function(){return S}}}(r===void 0?t.specification.default:r,t.specification)};eu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},eu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Ro=function(t){this.property=t,this.value=new eu(t,void 0)};Ro.prototype.transitioned=function(e,t){return new Al(this.property,this.value,t,Le({},e.transition,this.transition),e.now)},Ro.prototype.untransitioned=function(){return new Al(this.property,this.value,null,{},0)};var To=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};To.prototype.getValue=function(e){return Ge(this._values[e].value.value)},To.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ro(this._values[e].property)),this._values[e].value=new eu(this._values[e].property,t===null?void 0:Ge(t))},To.prototype.getTransition=function(e){return Ge(this._values[e].transition)},To.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ro(this._values[e].property)),this._values[e].transition=Ge(t)||void 0},To.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var v=this.getTransition(u);v!==void 0&&(e[u+"-transition"]=v)}return e},To.prototype.transitioned=function(e,t){for(var r=new cl(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var v=f[u];r._values[v]=this._values[v].transitioned(e,t._values[v])}return r},To.prototype.untransitioned=function(){for(var e=new cl(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var Al=function(t,r,u,f,v){this.property=t,this.value=r,this.begin=v+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=u)};Al.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,r),v=this.prior;if(v){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return v.possiblyEvaluate(e,t,r);var S=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,t,r),f,function(P){if(P<=0)return 0;if(P>=1)return 1;var V=P*P,te=V*P;return 4*(P<.5?te:3*(P-V)+te-.75)}(S))}return f};var cl=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};cl.prototype.possiblyEvaluate=function(e,t,r){for(var u=new Tc(this._properties),f=0,v=Object.keys(this._values);f<v.length;f+=1){var S=v[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u},cl.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var pu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};pu.prototype.getValue=function(e){return Ge(this._values[e].value)},pu.prototype.setValue=function(e,t){this._values[e]=new eu(this._values[e].property,t===null?void 0:Ge(t))},pu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},pu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new Tc(this._properties),f=0,v=Object.keys(this._values);f<v.length;f+=1){var S=v[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u};var _s=function(t,r,u){this.property=t,this.value=r,this.parameters=u};_s.prototype.isConstant=function(){return this.value.kind==="constant"},_s.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},_s.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var Tc=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Tc.prototype.get=function(e){return this._values[e]};var Jn=function(t){this.specification=t};Jn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Jn.prototype.interpolate=function(e,t,r){var u=xs[this.specification.type];return u?u(e,t,r):e};var jn=function(t,r){this.specification=t,this.overrides=r};jn.prototype.possiblyEvaluate=function(e,t,r,u){return new _s(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},jn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new _s(this,{kind:"constant",value:void 0},e.parameters);var u=xs[this.specification.type];return u?new _s(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},jn.prototype.evaluate=function(e,t,r,u,f,v){return e.kind==="constant"?e.value:e.evaluate(t,r,u,f,v)};var _c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,f,v){if(r.value===void 0)return new _s(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var S=r.expression.evaluate(u,null,{},f,v),P=r.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,V=this._calculate(P,P,P,u);return new _s(this,{kind:"constant",value:V},u)}if(r.expression.kind==="camera"){var te=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new _s(this,{kind:"constant",value:te},u)}return new _s(this,r.expression,u)},t.prototype.evaluate=function(r,u,f,v,S,P){if(r.kind==="source"){var V=r.evaluate(u,f,v,S,P);return this._calculate(V,V,V,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},f,v),r.evaluate({zoom:Math.floor(u.zoom)},f,v),r.evaluate({zoom:Math.floor(u.zoom)+1},f,v),u):r.value},t.prototype._calculate=function(r,u,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:f,to:u}},t.prototype.interpolate=function(r){return r},t}(jn),us=function(t){this.specification=t};us.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new Pa(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom+1),t)),t)}},us.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},us.prototype.interpolate=function(e){return e};var Io=function(t){this.specification=t};Io.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},Io.prototype.interpolate=function(){return!1};var vo=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new eu(u,void 0),v=this.defaultTransitionablePropertyValues[r]=new Ro(u);this.defaultTransitioningPropertyValues[r]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};In("DataDrivenProperty",jn),In("DataConstantProperty",Jn),In("CrossFadedDataDrivenProperty",_c),In("CrossFadedProperty",us),In("ColorRampProperty",Io);var Ss=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new pu(u.layout)),u.paint)){for(var f in this._transitionablePaint=new To(u.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var v in r.layout)this.setLayoutProperty(v,r.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Tc(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,f){f===void 0&&(f={}),u!=null&&this._validate(Sl,"layers."+this.id+".layout."+r,r,u,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return St(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(is,"layers."+this.id+".paint."+r,r,u,f))return!1;if(St(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var v=this._transitionablePaint._values[r],S=v.property.specification["property-type"]==="cross-faded-data-driven",P=v.value.isDataDriven(),V=v.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var te=this._transitionablePaint._values[r].value;return te.isDataDriven()||P||S||this._handleOverridablePaintPropertyUpdate(r,V,te)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Ie(r,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,f,v,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&sl(this,r.call(ol,{key:u,layerType:this.type,objectKey:f,value:v,styleSpec:Xe,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof _s&&Au(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(Bt),wu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},rc=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Ka=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function no(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(f){var v=wu[f.type].BYTES_PER_ELEMENT,S=r=fl(r,Math.max(t,v)),P=f.components||1;return u=Math.max(u,v),r+=v*P,{name:f.name,type:f.type,components:P,offset:S}}),size:fl(r,Math.max(u,t)),alignment:t}}function fl(e,t){return Math.ceil(e/t)*t}Ka.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Ka.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Ka.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ka.prototype.clear=function(){this.length=0},Ka.prototype.resize=function(e){this.reserve(e),this.length=e},Ka.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Ka.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var mu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var v=2*r;return this.int16[v+0]=u,this.int16[v+1]=f,r},t}(Ka);mu.prototype.bytesPerElement=4,In("StructArrayLayout2i4",mu);var hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,v)},t.prototype.emplace=function(r,u,f,v,S){var P=4*r;return this.int16[P+0]=u,this.int16[P+1]=f,this.int16[P+2]=v,this.int16[P+3]=S,r},t}(Ka);hl.prototype.bytesPerElement=8,In("StructArrayLayout4i8",hl);var Ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,v,S,P)},t.prototype.emplace=function(r,u,f,v,S,P,V){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.int16[te+2]=v,this.int16[te+3]=S,this.int16[te+4]=P,this.int16[te+5]=V,r},t}(Ka);Ou.prototype.bytesPerElement=12,In("StructArrayLayout2i4i12",Ou);var Ms=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,v,S,P)},t.prototype.emplace=function(r,u,f,v,S,P,V){var te=4*r,he=8*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.uint8[he+4]=v,this.uint8[he+5]=S,this.uint8[he+6]=P,this.uint8[he+7]=V,r},t}(Ka);Ms.prototype.bytesPerElement=8,In("StructArrayLayout2i4ub8",Ms);var Bc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var v=2*r;return this.float32[v+0]=u,this.float32[v+1]=f,r},t}(Ka);Bc.prototype.bytesPerElement=8,In("StructArrayLayout2f8",Bc);var Vs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,te,he,_e){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,r,u,f,v,S,P,V,te,he,_e)},t.prototype.emplace=function(r,u,f,v,S,P,V,te,he,_e,Ce){var lt=10*r;return this.uint16[lt+0]=u,this.uint16[lt+1]=f,this.uint16[lt+2]=v,this.uint16[lt+3]=S,this.uint16[lt+4]=P,this.uint16[lt+5]=V,this.uint16[lt+6]=te,this.uint16[lt+7]=he,this.uint16[lt+8]=_e,this.uint16[lt+9]=Ce,r},t}(Ka);Vs.prototype.bytesPerElement=20,In("StructArrayLayout10ui20",Vs);var xf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,te,he,_e,Ce,lt){var Pt=this.length;return this.resize(Pt+1),this.emplace(Pt,r,u,f,v,S,P,V,te,he,_e,Ce,lt)},t.prototype.emplace=function(r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt){var Ct=12*r;return this.int16[Ct+0]=u,this.int16[Ct+1]=f,this.int16[Ct+2]=v,this.int16[Ct+3]=S,this.uint16[Ct+4]=P,this.uint16[Ct+5]=V,this.uint16[Ct+6]=te,this.uint16[Ct+7]=he,this.int16[Ct+8]=_e,this.int16[Ct+9]=Ce,this.int16[Ct+10]=lt,this.int16[Ct+11]=Pt,r},t}(Ka);xf.prototype.bytesPerElement=24,In("StructArrayLayout4i4ui4i24",xf);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=3*r;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=v,r},t}(Ka);Bl.prototype.bytesPerElement=12,In("StructArrayLayout3f12",Bl);var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}(Ka);Vl.prototype.bytesPerElement=4,In("StructArrayLayout1ul4",Vl);var Sc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,te,he){var _e=this.length;return this.resize(_e+1),this.emplace(_e,r,u,f,v,S,P,V,te,he)},t.prototype.emplace=function(r,u,f,v,S,P,V,te,he,_e){var Ce=10*r,lt=5*r;return this.int16[Ce+0]=u,this.int16[Ce+1]=f,this.int16[Ce+2]=v,this.int16[Ce+3]=S,this.int16[Ce+4]=P,this.int16[Ce+5]=V,this.uint32[lt+3]=te,this.uint16[Ce+8]=he,this.uint16[Ce+9]=_e,r},t}(Ka);Sc.prototype.bytesPerElement=20,In("StructArrayLayout6i1ul2ui20",Sc);var ls=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,v,S,P)},t.prototype.emplace=function(r,u,f,v,S,P,V){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.int16[te+2]=v,this.int16[te+3]=S,this.int16[te+4]=P,this.int16[te+5]=V,r},t}(Ka);ls.prototype.bytesPerElement=12,In("StructArrayLayout2i2i2i12",ls);var Hu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S){var P=this.length;return this.resize(P+1),this.emplace(P,r,u,f,v,S)},t.prototype.emplace=function(r,u,f,v,S,P){var V=4*r,te=8*r;return this.float32[V+0]=u,this.float32[V+1]=f,this.float32[V+2]=v,this.int16[te+6]=S,this.int16[te+7]=P,r},t}(Ka);Hu.prototype.bytesPerElement=16,In("StructArrayLayout2f1f2i16",Hu);var Vc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,v)},t.prototype.emplace=function(r,u,f,v,S){var P=12*r,V=3*r;return this.uint8[P+0]=u,this.uint8[P+1]=f,this.float32[V+1]=v,this.float32[V+2]=S,r},t}(Ka);Vc.prototype.bytesPerElement=12,In("StructArrayLayout2ub2f12",Vc);var Cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=3*r;return this.uint16[S+0]=u,this.uint16[S+1]=f,this.uint16[S+2]=v,r},t}(Ka);Cl.prototype.bytesPerElement=6,In("StructArrayLayout3ui6",Cl);var Wu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct,Yt,Zt,ir){var yr=this.length;return this.resize(yr+1),this.emplace(yr,r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct,Yt,Zt,ir)},t.prototype.emplace=function(r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct,Yt,Zt,ir,yr){var _r=24*r,kr=12*r,Dr=48*r;return this.int16[_r+0]=u,this.int16[_r+1]=f,this.uint16[_r+2]=v,this.uint16[_r+3]=S,this.uint32[kr+2]=P,this.uint32[kr+3]=V,this.uint32[kr+4]=te,this.uint16[_r+10]=he,this.uint16[_r+11]=_e,this.uint16[_r+12]=Ce,this.float32[kr+7]=lt,this.float32[kr+8]=Pt,this.uint8[Dr+36]=Ct,this.uint8[Dr+37]=Yt,this.uint8[Dr+38]=Zt,this.uint32[kr+10]=ir,this.int16[_r+22]=yr,r},t}(Ka);Wu.prototype.bytesPerElement=48,In("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Wu);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct,Yt,Zt,ir,yr,_r,kr,Dr,pn,fn,Rn,Qn,Xn,Nn,Ea){var ca=this.length;return this.resize(ca+1),this.emplace(ca,r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct,Yt,Zt,ir,yr,_r,kr,Dr,pn,fn,Rn,Qn,Xn,Nn,Ea)},t.prototype.emplace=function(r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct,Yt,Zt,ir,yr,_r,kr,Dr,pn,fn,Rn,Qn,Xn,Nn,Ea,ca){var ra=34*r,$a=17*r;return this.int16[ra+0]=u,this.int16[ra+1]=f,this.int16[ra+2]=v,this.int16[ra+3]=S,this.int16[ra+4]=P,this.int16[ra+5]=V,this.int16[ra+6]=te,this.int16[ra+7]=he,this.uint16[ra+8]=_e,this.uint16[ra+9]=Ce,this.uint16[ra+10]=lt,this.uint16[ra+11]=Pt,this.uint16[ra+12]=Ct,this.uint16[ra+13]=Yt,this.uint16[ra+14]=Zt,this.uint16[ra+15]=ir,this.uint16[ra+16]=yr,this.uint16[ra+17]=_r,this.uint16[ra+18]=kr,this.uint16[ra+19]=Dr,this.uint16[ra+20]=pn,this.uint16[ra+21]=fn,this.uint16[ra+22]=Rn,this.uint32[$a+12]=Qn,this.float32[$a+13]=Xn,this.float32[$a+14]=Nn,this.float32[$a+15]=Ea,this.float32[$a+16]=ca,r},t}(Ka);nc.prototype.bytesPerElement=68,In("StructArrayLayout8i15ui1ul4f68",nc);var Zu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}(Ka);Zu.prototype.bytesPerElement=4,In("StructArrayLayout1f4",Zu);var Ps=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=3*r;return this.int16[S+0]=u,this.int16[S+1]=f,this.int16[S+2]=v,r},t}(Ka);Ps.prototype.bytesPerElement=6,In("StructArrayLayout3i6",Ps);var of=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var v=this.length;return this.resize(v+1),this.emplace(v,r,u,f)},t.prototype.emplace=function(r,u,f,v){var S=4*r;return this.uint32[2*r+0]=u,this.uint16[S+2]=f,this.uint16[S+3]=v,r},t}(Ka);of.prototype.bytesPerElement=8,In("StructArrayLayout1ul2ui8",of);var ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var v=2*r;return this.uint16[v+0]=u,this.uint16[v+1]=f,r},t}(Ka);ac.prototype.bytesPerElement=4,In("StructArrayLayout2ui4",ac);var ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}(Ka);ic.prototype.bytesPerElement=2,In("StructArrayLayout1ui2",ic);var oc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,v){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,v)},t.prototype.emplace=function(r,u,f,v,S){var P=4*r;return this.float32[P+0]=u,this.float32[P+1]=f,this.float32[P+2]=v,this.float32[P+3]=S,r},t}(Ka);oc.prototype.bytesPerElement=16,In("StructArrayLayout4f16",oc);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new ee(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(rc);s.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(Sc);In("CollisionBoxArray",a);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(rc);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Wu);In("PlacedSymbolArray",l);var g=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(rc);g.prototype.size=68;var w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new g(this,r)},t}(nc);In("SymbolInstanceArray",w);var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Zu);In("GlyphOffsetArray",L);var F=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Ps);In("SymbolLineVertexArray",F);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(rc);ue.prototype.size=8;var Ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(of);In("FeatureIndexArray",Ee);var $e=no([{name:"a_pos",components:2,type:"Int16"}],4).members,rt=function(t){t===void 0&&(t=[]),this.segments=t};function nt(e,t){return 256*(e=Pe(Math.floor(e),0,255))+Pe(Math.floor(t),0,255)}rt.prototype.prepareSegment=function(e,t,r,u){var f=this.segments[this.segments.length-1];return e>rt.MAX_VERTEX_ARRAY_LENGTH&&we("Max vertices per segment is "+rt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>rt.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},rt.prototype.get=function(){return this.segments},rt.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},rt.simpleSegment=function(e,t,r,u){return new rt([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},rt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,In("SegmentVector",rt);var Ft=no([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Nt=W(function(e){e.exports=function(t,r){var u,f,v,S,P,V,te,he;for(f=t.length-(u=3&t.length),v=r,P=3432918353,V=461845907,he=0;he<f;)te=255&t.charCodeAt(he)|(255&t.charCodeAt(++he))<<8|(255&t.charCodeAt(++he))<<16|(255&t.charCodeAt(++he))<<24,++he,v=27492+(65535&(S=5*(65535&(v=(v^=te=(65535&(te=(te=(65535&te)*P+(((te>>>16)*P&65535)<<16)&4294967295)<<15|te>>>17))*V+(((te>>>16)*V&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(te=0,u){case 3:te^=(255&t.charCodeAt(he+2))<<16;case 2:te^=(255&t.charCodeAt(he+1))<<8;case 1:v^=te=(65535&(te=(te=(65535&(te^=255&t.charCodeAt(he)))*P+(((te>>>16)*P&65535)<<16)&4294967295)<<15|te>>>17))*V+(((te>>>16)*V&65535)<<16)&4294967295}return v^=t.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}}),Kt=W(function(e){e.exports=function(t,r){for(var u,f=t.length,v=r^f,S=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(S)|(255&t.charCodeAt(++S))<<8|(255&t.charCodeAt(++S))<<16|(255&t.charCodeAt(++S))<<24))+((1540483477*(u>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++S;switch(f){case 3:v^=(255&t.charCodeAt(S+2))<<16;case 2:v^=(255&t.charCodeAt(S+1))<<8;case 1:v=1540483477*(65535&(v^=255&t.charCodeAt(S)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}}),jt=Nt,Gt=Kt;jt.murmur3=Nt,jt.murmur2=Gt;var nr=function(){this.ids=[],this.positions=[],this.indexed=!1};nr.prototype.add=function(e,t,r,u){this.ids.push(Lr(e)),this.positions.push(t,r,u)},nr.prototype.getPositions=function(e){for(var t=Lr(e),r=0,u=this.ids.length-1;r<u;){var f=r+u>>1;this.ids[f]>=t?u=f:r=f+1}for(var v=[];this.ids[r]===t;)v.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return v},nr.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(v,S,P,V){for(;P<V;){for(var te=v[P+V>>1],he=P-1,_e=V+1;;){do he++;while(v[he]<te);do _e--;while(v[_e]>te);if(he>=_e)break;vr(v,he,_e),vr(S,3*he,3*_e),vr(S,3*he+1,3*_e+1),vr(S,3*he+2,3*_e+2)}_e-P<V-_e?(f(v,S,P,_e),P=_e+1):(f(v,S,_e+1,V),V=_e)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},nr.deserialize=function(e){var t=new nr;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var rr=Math.pow(2,53)-1;function Lr(e){var t=+e;return!isNaN(t)&&t<=rr?t:jt(String(e))}function vr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}In("FeaturePositionMap",nr);var Sr=function(t,r){this.gl=t.gl,this.location=r},Ar=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Sr),rn=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Sr),Xr=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Sr),mn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Sr),Ln=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Sr),qn=function(e){function t(r,u){e.call(this,r,u),this.current=fa.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Sr),sa=new Float32Array(16),Sa=function(e){function t(r,u){e.call(this,r,u),this.current=sa}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Sr);function Wa(e){return[nt(255*e.r,255*e.g),nt(255*e.b,255*e.a)]}var Sn=function(t,r,u){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=u};Sn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Sn.prototype.getBinding=function(e,t,r){return this.type==="color"?new qn(e,t):new rn(e,t)};var ua=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ua.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ua.prototype.setUniform=function(e,t,r,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},ua.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Ln(e,t):new rn(e,t)};var ba=function(t,r,u,f){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(v){return{name:"a_"+v,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new f};ba.prototype.populatePaintArray=function(e,t,r,u,f){var v=this.paintVertexArray.length,S=this.expression.evaluate(new Pa(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(v,e,S)},ba.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,f)},ba.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=Wa(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var v=e;v<t;v++)this.paintVertexArray.emplace(v,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},ba.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ba.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Wn=function(t,r,u,f,v,S){this.expression=t,this.uniformNames=r.map(function(P){return"u_"+P+"_t"}),this.type=u,this.useIntegerZoom=f,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=r.map(function(P){return{name:"a_"+P,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new S};Wn.prototype.populatePaintArray=function(e,t,r,u,f){var v=this.expression.evaluate(new Pa(this.zoom),t,{},u,[],f),S=this.expression.evaluate(new Pa(this.zoom+1),t,{},u,[],f),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,v,S)},Wn.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:this.zoom},r,u),v=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,f,v)},Wn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var f=Wa(r),v=Wa(u),S=e;S<t;S++)this.paintVertexArray.emplace(S,f[0],f[1],v[0],v[1]);else{for(var P=e;P<t;P++)this.paintVertexArray.emplace(P,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},Wn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Wn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Wn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=Pe(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},Wn.prototype.getBinding=function(e,t,r){return new rn(e,t)};var Aa=function(t,r,u,f,v,S){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=f,this.layerId=S,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v};Aa.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Aa.prototype.updatePaintArray=function(e,t,r,u,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Aa.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var f=u[r.min],v=u[r.mid],S=u[r.max];if(f&&v&&S)for(var P=e;P<t;P++)this.zoomInPaintVertexArray.emplace(P,v.tl[0],v.tl[1],v.br[0],v.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],v.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,v.tl[0],v.tl[1],v.br[0],v.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],v.pixelRatio,S.pixelRatio)}},Aa.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ft.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ft.members,this.expression.isStateDependent))},Aa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var na=function(t,r,u){this.binders={},this._buffers=[];var f=[];for(var v in t.paint._values)if(u(v)){var S=t.paint.get(v);if(S instanceof _s&&Au(S.property.specification)){var P=za(v,t.type),V=S.value,te=S.property.specification.type,he=S.property.useIntegerZoom,_e=S.property.specification["property-type"],Ce=_e==="cross-faded"||_e==="cross-faded-data-driven";if(V.kind==="constant")this.binders[v]=Ce?new ua(V.value,P):new Sn(V.value,P,te),f.push("/u_"+v);else if(V.kind==="source"||Ce){var lt=Gi(v,te,"source");this.binders[v]=Ce?new Aa(V,te,he,r,lt,t.id):new ba(V,P,te,lt),f.push("/a_"+v)}else{var Pt=Gi(v,te,"composite");this.binders[v]=new Wn(V,P,te,he,r,Pt),f.push("/z_"+v)}}}this.cacheKey=f.sort().join("")};na.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof ba||t instanceof Wn?t.maxValue:0},na.prototype.populatePaintArrays=function(e,t,r,u,f){for(var v in this.binders){var S=this.binders[v];(S instanceof ba||S instanceof Wn||S instanceof Aa)&&S.populatePaintArray(e,t,r,u,f)}},na.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ua&&u.setConstantPatternPositions(e,t)}},na.prototype.updatePaintArrays=function(e,t,r,u,f){var v=!1;for(var S in e)for(var P=0,V=t.getPositions(S);P<V.length;P+=1){var te=V[P],he=r.feature(te.index);for(var _e in this.binders){var Ce=this.binders[_e];if((Ce instanceof ba||Ce instanceof Wn||Ce instanceof Aa)&&Ce.expression.isStateDependent===!0){var lt=u.paint.get(_e);Ce.expression=lt.value,Ce.updatePaintArray(te.start,te.end,he,e[S],f),v=!0}}}return v},na.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Sn||r instanceof ua)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},na.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof ba||r instanceof Wn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Aa)for(var f=0;f<Ft.members.length;f++)e.push(Ft.members[f].name)}return e},na.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Sn||r instanceof ua||r instanceof Wn)for(var u=0,f=r.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},na.prototype.getPaintVertexBuffers=function(){return this._buffers},na.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof Sn||f instanceof ua||f instanceof Wn)for(var v=0,S=f.uniformNames;v<S.length;v+=1){var P=S[v];if(t[P]){var V=f.getBinding(e,t[P],P);r.push({name:P,property:u,binding:V})}}}return r},na.prototype.setUniforms=function(e,t,r,u){for(var f=0,v=t;f<v.length;f+=1){var S=v[f],P=S.name,V=S.property;this.binders[V].setUniform(S.binding,u,r.get(V),P)}},na.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Aa){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof ba||r instanceof Wn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},na.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof ba||r instanceof Wn||r instanceof Aa)&&r.upload(e)}this.updatePaintBuffers()},na.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof ba||t instanceof Wn||t instanceof Aa)&&t.destroy()}};var La=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var f=0,v=t;f<v.length;f+=1){var S=v[f];this.programConfigurations[S.id]=new na(S,r,u)}this.needsUpload=!1,this._featureMap=new nr,this._bufferOffset=0};function za(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Gi(e,t,r){var u={color:{source:Bc,composite:oc},number:{source:Zu,composite:Bc}},f=function(v){return{"line-pattern":{source:Vs,composite:Vs},"fill-pattern":{source:Vs,composite:Vs},"fill-extrusion-pattern":{source:Vs,composite:Vs}}[v]}(e);return f&&f[r]||u[t][r]}La.prototype.populatePaintArrays=function(e,t,r,u,f,v){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,t,u,f,v);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},La.prototype.updatePaintArrays=function(e,t,r,u){for(var f=0,v=r;f<v.length;f+=1){var S=v[f];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(e,this._featureMap,t,S,u)||this.needsUpload}},La.prototype.get=function(e){return this.programConfigurations[e]},La.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},La.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},In("ConstantBinder",Sn),In("CrossFadedConstantBinder",ua),In("SourceExpressionBinder",ba),In("CrossFadedCompositeBinder",Aa),In("CompositeExpressionBinder",Wn),In("ProgramConfiguration",na,{omit:["_buffers"]}),In("ProgramConfigurationSet",La);var _i=Math.pow(2,14)-1,Di=-_i-1;function gi(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var f=r[u],v=0;v<f.length;v++){var S=f[v],P=Math.round(S.x*t),V=Math.round(S.y*t);S.x=Pe(P,Di,_i),S.y=Pe(V,Di,_i),(P<S.x||P>S.x+1||V<S.y||V>S.y+1)&&we("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Ui(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?gi(e):[]}}function Qo(e,t,r,u,f){e.emplaceBack(2*t+(u+1)/2,2*r+(f+1)/2)}var qo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new mu,this.indexArray=new Cl,this.segments=new rt,this.programConfigurations=new La(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function vu(e,t){for(var r=0;r<e.length;r++)if(ru(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(ru(e,t[u]))return!0;return!!Pu(e,t)}function Mu(e,t,r){return!!ru(e,t)||!!tu(t,e,r)}function cs(e,t){if(e.length===1)return uc(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],f=0;f<u.length;f++)if(ru(e,u[f]))return!0;for(var v=0;v<e.length;v++)if(uc(t,e[v]))return!0;for(var S=0;S<t.length;S++)if(Pu(e,t[S]))return!0;return!1}function Gs(e,t,r){if(e.length>1){if(Pu(e,t))return!0;for(var u=0;u<t.length;u++)if(tu(t[u],e,r))return!0}for(var f=0;f<e.length;f++)if(tu(e[f],t,r))return!0;return!1}function Pu(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],f=e[r+1],v=0;v<t.length-1;v++)if(sc(u,f,t[v],t[v+1]))return!0;return!1}function sc(e,t,r,u){return pt(e,r,u)!==pt(t,r,u)&&pt(e,t,r)!==pt(e,t,u)}function tu(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(Xu(e,t[f-1],t[f])<u)return!0;return!1}function Xu(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function uc(e,t){for(var r,u,f,v=!1,S=0;S<e.length;S++)for(var P=0,V=(r=e[S]).length-1;P<r.length;V=P++)(u=r[P]).y>t.y!=(f=r[V]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(v=!v);return v}function ru(e,t){for(var r=!1,u=0,f=e.length-1;u<e.length;f=u++){var v=e[u],S=e[f];v.y>t.y!=S.y>t.y&&t.x<(S.x-v.x)*(t.y-v.y)/(S.y-v.y)+v.x&&(r=!r)}return r}function Lu(e,t,r){var u=r[0],f=r[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var v=pt(e,t,r[0]);return v!==pt(e,t,r[1])||v!==pt(e,t,r[2])||v!==pt(e,t,r[3])}function fs(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ao(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Yu(e,t,r,u,f){if(!t[0]&&!t[1])return e;var v=ee.convert(t)._mult(f);r==="viewport"&&v._rotate(-u);for(var S=[],P=0;P<e.length;P++)S.push(e[P].sub(v));return S}qo.prototype.populate=function(e,t,r){var u=this.layers[0],f=[],v=null;u.type==="circle"&&(v=u.layout.get("circle-sort-key"));for(var S=0,P=e;S<P.length;S+=1){var V=P[S],te=V.feature,he=V.id,_e=V.index,Ce=V.sourceLayerIndex,lt=this.layers[0]._featureFilter.needGeometry,Pt=Ui(te,lt);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),Pt,r)){var Ct=v?v.evaluate(Pt,{},r):void 0,Yt={id:he,properties:te.properties,type:te.type,sourceLayerIndex:Ce,index:_e,geometry:lt?Pt.geometry:gi(te),patterns:{},sortKey:Ct};f.push(Yt)}}v&&f.sort(function(fn,Rn){return fn.sortKey-Rn.sortKey});for(var Zt=0,ir=f;Zt<ir.length;Zt+=1){var yr=ir[Zt],_r=yr.geometry,kr=yr.index,Dr=yr.sourceLayerIndex,pn=e[kr].feature;this.addFeature(yr,_r,kr,r),t.featureIndex.insert(pn,_r,kr,Dr,this.index)}},qo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},qo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$e),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qo.prototype.addFeature=function(e,t,r,u){for(var f=0,v=t;f<v.length;f+=1)for(var S=0,P=v[f];S<P.length;S+=1){var V=P[S],te=V.x,he=V.y;if(!(te<0||te>=8192||he<0||he>=8192)){var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Ce=_e.vertexLength;Qo(this.layoutVertexArray,te,he,-1,-1),Qo(this.layoutVertexArray,te,he,1,-1),Qo(this.layoutVertexArray,te,he,1,1),Qo(this.layoutVertexArray,te,he,-1,1),this.indexArray.emplaceBack(Ce,Ce+1,Ce+2),this.indexArray.emplaceBack(Ce,Ce+3,Ce+2),_e.vertexLength+=4,_e.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},In("CircleBucket",qo,{omit:["layers"]});var Gl=new vo({"circle-sort-key":new jn(Xe.layout_circle["circle-sort-key"])}),hs={paint:new vo({"circle-radius":new jn(Xe.paint_circle["circle-radius"]),"circle-color":new jn(Xe.paint_circle["circle-color"]),"circle-blur":new jn(Xe.paint_circle["circle-blur"]),"circle-opacity":new jn(Xe.paint_circle["circle-opacity"]),"circle-translate":new Jn(Xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Jn(Xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jn(Xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jn(Xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jn(Xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jn(Xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jn(Xe.paint_circle["circle-stroke-opacity"])}),layout:Gl},Do=typeof Float32Array!="undefined"?Float32Array:Array;function No(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ho(e,t,r){var u=t[0],f=t[1],v=t[2],S=t[3],P=t[4],V=t[5],te=t[6],he=t[7],_e=t[8],Ce=t[9],lt=t[10],Pt=t[11],Ct=t[12],Yt=t[13],Zt=t[14],ir=t[15],yr=r[0],_r=r[1],kr=r[2],Dr=r[3];return e[0]=yr*u+_r*P+kr*_e+Dr*Ct,e[1]=yr*f+_r*V+kr*Ce+Dr*Yt,e[2]=yr*v+_r*te+kr*lt+Dr*Zt,e[3]=yr*S+_r*he+kr*Pt+Dr*ir,e[4]=(yr=r[4])*u+(_r=r[5])*P+(kr=r[6])*_e+(Dr=r[7])*Ct,e[5]=yr*f+_r*V+kr*Ce+Dr*Yt,e[6]=yr*v+_r*te+kr*lt+Dr*Zt,e[7]=yr*S+_r*he+kr*Pt+Dr*ir,e[8]=(yr=r[8])*u+(_r=r[9])*P+(kr=r[10])*_e+(Dr=r[11])*Ct,e[9]=yr*f+_r*V+kr*Ce+Dr*Yt,e[10]=yr*v+_r*te+kr*lt+Dr*Zt,e[11]=yr*S+_r*he+kr*Pt+Dr*ir,e[12]=(yr=r[12])*u+(_r=r[13])*P+(kr=r[14])*_e+(Dr=r[15])*Ct,e[13]=yr*f+_r*V+kr*Ce+Dr*Yt,e[14]=yr*v+_r*te+kr*lt+Dr*Zt,e[15]=yr*S+_r*he+kr*Pt+Dr*ir,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var _o,uo=Ho;function Ls(e,t,r){var u=t[0],f=t[1],v=t[2],S=t[3];return e[0]=r[0]*u+r[4]*f+r[8]*v+r[12]*S,e[1]=r[1]*u+r[5]*f+r[9]*v+r[13]*S,e[2]=r[2]*u+r[6]*f+r[10]*v+r[14]*S,e[3]=r[3]*u+r[7]*f+r[11]*v+r[15]*S,e}_o=new Do(3),Do!=Float32Array&&(_o[0]=0,_o[1]=0,_o[2]=0),function(){var e=new Do(4);Do!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var nu=(function(){var e=new Do(2);Do!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,hs)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new qo(r)},t.prototype.queryRadius=function(r){var u=r;return fs("circle-radius",this,u)+fs("circle-stroke-width",this,u)+ao(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V,te){for(var he=Yu(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,V),_e=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),Ce=this.paint.get("circle-pitch-alignment")==="map",lt=Ce?he:function(pn,fn){return pn.map(function(Rn){return Hl(Rn,fn)})}(he,te),Pt=Ce?_e*V:_e,Ct=0,Yt=v;Ct<Yt.length;Ct+=1)for(var Zt=0,ir=Yt[Ct];Zt<ir.length;Zt+=1){var yr=ir[Zt],_r=Ce?yr:Hl(yr,te),kr=Pt,Dr=Ls([],[yr.x,yr.y,0,1],te);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?kr*=Dr[3]/P.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(kr*=P.cameraToCenterDistance/Dr[3]),Mu(lt,_r,kr))return!0}return!1},t}(Ss));function Hl(e,t){var r=Ls([],[e.x,e.y,0,1],t);return new ee(r[0]/r[3],r[1]/r[3])}var Gc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(qo);function dl(e,t,r,u){var f=t.width,v=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*v*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*v*r);return e.width=f,e.height=v,e.data=u,e}function lc(e,t,r){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var v=dl({},{width:u,height:f},r);pl(e,v,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},r),e.width=u,e.height=f,e.data=v.data}}function pl(e,t,r,u,f,v){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=e.data,P=t.data,V=0;V<f.height;V++)for(var te=((r.y+V)*e.width+r.x)*v,he=((u.y+V)*t.width+u.x)*v,_e=0;_e<f.width*v;_e++)P[he+_e]=S[te+_e];return t}In("HeatmapBucket",Gc,{omit:["layers"]});var Rs=function(t,r){dl(this,t,1,r)};Rs.prototype.resize=function(e){lc(this,e,1)},Rs.prototype.clone=function(){return new Rs({width:this.width,height:this.height},new Uint8Array(this.data))},Rs.copy=function(e,t,r,u,f){pl(e,t,r,u,f,1)};var go=function(t,r){dl(this,t,4,r)};go.prototype.resize=function(e){lc(this,e,4)},go.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},go.prototype.clone=function(){return new go({width:this.width,height:this.height},new Uint8Array(this.data))},go.copy=function(e,t,r,u,f){pl(e,t,r,u,f,4)},In("AlphaImage",Rs),In("RGBAImage",go);var Ac={paint:new vo({"heatmap-radius":new jn(Xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jn(Xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jn(Xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Io(Xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jn(Xe.paint_heatmap["heatmap-opacity"])})};function ds(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new go({width:r,height:u}),v=function(Ct,Yt,Zt){t[e.evaluationKey]=Zt;var ir=e.expression.evaluate(t);f.data[Ct+Yt+0]=Math.floor(255*ir.r/ir.a),f.data[Ct+Yt+1]=Math.floor(255*ir.g/ir.a),f.data[Ct+Yt+2]=Math.floor(255*ir.b/ir.a),f.data[Ct+Yt+3]=Math.floor(255*ir.a)};if(e.clips)for(var S=0,P=0;S<u;++S,P+=4*r)for(var V=0,te=0;V<r;V++,te+=4){var he=V/(r-1),_e=e.clips[S];v(P,te,_e.start*(1-he)+_e.end*he)}else for(var Ce=0,lt=0;Ce<r;Ce++,lt+=4)v(0,lt,Ce/(r-1));return f}var sf=function(e){function t(r){e.call(this,r,Ac),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Gc(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=ds({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Ss),Cf={paint:new vo({"hillshade-illumination-direction":new Jn(Xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jn(Xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jn(Xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jn(Xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jn(Xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jn(Xe.paint_hillshade["hillshade-accent-color"])})},wf=function(e){function t(r){e.call(this,r,Cf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Ss),Cc=no([{name:"a_pos",components:2,type:"Int16"}],4).members,Ku=uf,Ef=uf;function uf(e,t,r){r=r||2;var u,f,v,S,P,V,te,he=t&&t.length,_e=he?t[0]*r:e.length,Ce=Of(e,0,_e,r,!0),lt=[];if(!Ce||Ce.next===Ce.prev)return lt;if(he&&(Ce=function(Ct,Yt,Zt,ir){var yr,_r,kr,Dr=[];for(yr=0,_r=Yt.length;yr<_r;yr++)(kr=Of(Ct,Yt[yr]*ir,yr<_r-1?Yt[yr+1]*ir:Ct.length,ir,!1))===kr.next&&(kr.steiner=!0),Dr.push(rh(kr));for(Dr.sort(qf),yr=0;yr<Dr.length;yr++)eh(Dr[yr],Zt),Zt=Ru(Zt,Zt.next);return Zt}(e,t,Ce,r)),e.length>80*r){u=v=e[0],f=S=e[1];for(var Pt=r;Pt<_e;Pt+=r)(P=e[Pt])<u&&(u=P),(V=e[Pt+1])<f&&(f=V),P>v&&(v=P),V>S&&(S=V);te=(te=Math.max(v-u,S-f))!==0?1/te:0}return cc(Ce,lt,r,u,f,te),lt}function Of(e,t,r,u,f){var v,S;if(f===Zc(e,t,r,u)>0)for(v=t;v<r;v+=u)S=Nf(v,e[v],e[v+1],S);else for(v=r-u;v>=t;v-=u)S=Nf(v,e[v],e[v+1],S);return S&&fc(S,S.next)&&(Wc(S),S=S.next),S}function Ru(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!fc(u,u.next)&&io(u.prev,u,u.next)!==0)u=u.next;else{if(Wc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function cc(e,t,r,u,f,v,S){if(e){!S&&v&&function(he,_e,Ce,lt){var Pt=he;do Pt.z===null&&(Pt.z=Mf(Pt.x,Pt.y,_e,Ce,lt)),Pt.prevZ=Pt.prev,Pt.nextZ=Pt.next,Pt=Pt.next;while(Pt!==he);Pt.prevZ.nextZ=null,Pt.prevZ=null,function(Ct){var Yt,Zt,ir,yr,_r,kr,Dr,pn,fn=1;do{for(Zt=Ct,Ct=null,_r=null,kr=0;Zt;){for(kr++,ir=Zt,Dr=0,Yt=0;Yt<fn&&(Dr++,ir=ir.nextZ);Yt++);for(pn=fn;Dr>0||pn>0&&ir;)Dr!==0&&(pn===0||!ir||Zt.z<=ir.z)?(yr=Zt,Zt=Zt.nextZ,Dr--):(yr=ir,ir=ir.nextZ,pn--),_r?_r.nextZ=yr:Ct=yr,yr.prevZ=_r,_r=yr;Zt=ir}_r.nextZ=null,fn*=2}while(kr>1)}(Pt)}(e,u,f,v);for(var P,V,te=e;e.prev!==e.next;)if(P=e.prev,V=e.next,v?Hc(e,u,f,v):Df(e))t.push(P.i/r),t.push(e.i/r),t.push(V.i/r),Wc(e),e=V.next,te=V.next;else if((e=V)===te){S?S===1?cc(e=wc(Ru(e),t,r),t,r,u,f,v,2):S===2&&Qf(e,t,r,u,f,v):cc(Ru(e),t,r,u,f,v,1);break}}}function Df(e){var t=e.prev,r=e,u=e.next;if(io(t,r,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(Wl(t.x,t.y,r.x,r.y,u.x,u.y,f.x,f.y)&&io(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Hc(e,t,r,u){var f=e.prev,v=e,S=e.next;if(io(f,v,S)>=0)return!1;for(var P=f.x>v.x?f.x>S.x?f.x:S.x:v.x>S.x?v.x:S.x,V=f.y>v.y?f.y>S.y?f.y:S.y:v.y>S.y?v.y:S.y,te=Mf(f.x<v.x?f.x<S.x?f.x:S.x:v.x<S.x?v.x:S.x,f.y<v.y?f.y<S.y?f.y:S.y:v.y<S.y?v.y:S.y,t,r,u),he=Mf(P,V,t,r,u),_e=e.prevZ,Ce=e.nextZ;_e&&_e.z>=te&&Ce&&Ce.z<=he;){if(_e!==e.prev&&_e!==e.next&&Wl(f.x,f.y,v.x,v.y,S.x,S.y,_e.x,_e.y)&&io(_e.prev,_e,_e.next)>=0)return!1;if(_e=_e.prevZ,Ce!==e.prev&&Ce!==e.next&&Wl(f.x,f.y,v.x,v.y,S.x,S.y,Ce.x,Ce.y)&&io(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}for(;_e&&_e.z>=te;){if(_e!==e.prev&&_e!==e.next&&Wl(f.x,f.y,v.x,v.y,S.x,S.y,_e.x,_e.y)&&io(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Ce&&Ce.z<=he;){if(Ce!==e.prev&&Ce!==e.next&&Wl(f.x,f.y,v.x,v.y,S.x,S.y,Ce.x,Ce.y)&&io(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function wc(e,t,r){var u=e;do{var f=u.prev,v=u.next.next;!fc(f,v)&&Tf(f,u,u.next,v)&&wl(f,v)&&wl(v,f)&&(t.push(f.i/r),t.push(u.i/r),t.push(v.i/r),Wc(u),Wc(u.next),u=e=v),u=u.next}while(u!==e);return Ru(u)}function Qf(e,t,r,u,f,v){var S=e;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&lf(S,P)){var V=_f(S,P);return S=Ru(S,S.next),V=Ru(V,V.next),cc(S,t,r,u,f,v),void cc(V,t,r,u,f,v)}P=P.next}S=S.next}while(S!==e)}function qf(e,t){return e.x-t.x}function eh(e,t){if(t=function(u,f){var v,S=f,P=u.x,V=u.y,te=-1/0;do{if(V<=S.y&&V>=S.next.y&&S.next.y!==S.y){var he=S.x+(V-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(he<=P&&he>te){if(te=he,he===P){if(V===S.y)return S;if(V===S.next.y)return S.next}v=S.x<S.next.x?S:S.next}}S=S.next}while(S!==f);if(!v)return null;if(P===te)return v;var _e,Ce=v,lt=v.x,Pt=v.y,Ct=1/0;S=v;do P>=S.x&&S.x>=lt&&P!==S.x&&Wl(V<Pt?P:te,V,lt,Pt,V<Pt?te:P,V,S.x,S.y)&&(_e=Math.abs(V-S.y)/(P-S.x),wl(S,u)&&(_e<Ct||_e===Ct&&(S.x>v.x||S.x===v.x&&th(v,S)))&&(v=S,Ct=_e)),S=S.next;while(S!==Ce);return v}(e,t)){var r=_f(t,e);Ru(t,t.next),Ru(r,r.next)}}function th(e,t){return io(e.prev,e,t.prev)<0&&io(t.next,e,e.next)<0}function Mf(e,t,r,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function rh(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Wl(e,t,r,u,f,v,S,P){return(f-S)*(t-P)-(e-S)*(v-P)>=0&&(e-S)*(u-P)-(r-S)*(t-P)>=0&&(r-S)*(v-P)-(f-S)*(u-P)>=0}function lf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==u.i&&f.next.i!==u.i&&Tf(f,f.next,r,u))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(wl(e,t)&&wl(t,e)&&function(r,u){var f=r,v=!1,S=(r.x+u.x)/2,P=(r.y+u.y)/2;do f.y>P!=f.next.y>P&&f.next.y!==f.y&&S<(f.next.x-f.x)*(P-f.y)/(f.next.y-f.y)+f.x&&(v=!v),f=f.next;while(f!==r);return v}(e,t)&&(io(e.prev,e,t.prev)||io(e,t.prev,t))||fc(e,t)&&io(e.prev,e,e.next)>0&&io(t.prev,t,t.next)>0)}function io(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function fc(e,t){return e.x===t.x&&e.y===t.y}function Tf(e,t,r,u){var f=au(io(e,t,r)),v=au(io(e,t,u)),S=au(io(r,u,e)),P=au(io(r,u,t));return f!==v&&S!==P||!(f!==0||!Oc(e,r,t))||!(v!==0||!Oc(e,u,t))||!(S!==0||!Oc(r,e,u))||!(P!==0||!Oc(r,t,u))}function Oc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function au(e){return e>0?1:e<0?-1:0}function wl(e,t){return io(e.prev,e,e.next)<0?io(e,t,e.next)>=0&&io(e,e.prev,t)>=0:io(e,t,e.prev)<0||io(e,e.next,t)<0}function _f(e,t){var r=new cf(e.i,e.x,e.y),u=new cf(t.i,t.x,t.y),f=e.next,v=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,u.next=r,r.prev=u,v.next=u,u.prev=v,u}function Nf(e,t,r,u){var f=new cf(e,t,r);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Wc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function cf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Zc(e,t,r,u){for(var f=0,v=t,S=r-u;v<r;v+=u)f+=(e[S]-e[v])*(e[v+1]+e[S+1]),S=v;return f}function ml(e,t,r,u,f){!function v(S,P,V,te,he){for(;te>V;){if(te-V>600){var _e=te-V+1,Ce=P-V+1,lt=Math.log(_e),Pt=.5*Math.exp(2*lt/3),Ct=.5*Math.sqrt(lt*Pt*(_e-Pt)/_e)*(Ce-_e/2<0?-1:1);v(S,P,Math.max(V,Math.floor(P-Ce*Pt/_e+Ct)),Math.min(te,Math.floor(P+(_e-Ce)*Pt/_e+Ct)),he)}var Yt=S[P],Zt=V,ir=te;for(re(S,V,P),he(S[te],Yt)>0&&re(S,V,te);Zt<ir;){for(re(S,Zt,ir),Zt++,ir--;he(S[Zt],Yt)<0;)Zt++;for(;he(S[ir],Yt)>0;)ir--}he(S[V],Yt)===0?re(S,V,ir):re(S,++ir,te),ir<=P&&(V=ir+1),P<=ir&&(te=ir-1)}}(e,t,r||0,u||e.length-1,f||se)}function re(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function se(e,t){return e<t?-1:e>t?1:0}function N(e,t){var r=e.length;if(r<=1)return[e];for(var u,f,v=[],S=0;S<r;S++){var P=Wt(e[S]);P!==0&&(e[S].area=Math.abs(P),f===void 0&&(f=P<0),f===P<0?(u&&v.push(u),u=[e[S]]):u.push(e[S]))}if(u&&v.push(u),t>1)for(var V=0;V<v.length;V++)v[V].length<=t||(ml(v[V],t,1,v[V].length-1,G),v[V]=v[V].slice(0,t));return v}function G(e,t){return t.area-e.area}function Ae(e,t,r){for(var u=r.patternDependencies,f=!1,v=0,S=t;v<S.length;v+=1){var P=S[v].paint.get(e+"-pattern");P.isConstant()||(f=!0);var V=P.constantOr(null);V&&(f=!0,u[V.to]=!0,u[V.from]=!0)}return f}function ft(e,t,r,u,f){for(var v=f.patternDependencies,S=0,P=t;S<P.length;S+=1){var V=P[S],te=V.paint.get(e+"-pattern").value;if(te.kind!=="constant"){var he=te.evaluate({zoom:u-1},r,{},f.availableImages),_e=te.evaluate({zoom:u},r,{},f.availableImages),Ce=te.evaluate({zoom:u+1},r,{},f.availableImages);_e=_e&&_e.name?_e.name:_e,Ce=Ce&&Ce.name?Ce.name:Ce,v[he=he&&he.name?he.name:he]=!0,v[_e]=!0,v[Ce]=!0,r.patterns[V.id]={min:he,mid:_e,max:Ce}}}return r}uf.deviation=function(e,t,r,u){var f=t&&t.length,v=Math.abs(Zc(e,0,f?t[0]*r:e.length,r));if(f)for(var S=0,P=t.length;S<P;S++)v-=Math.abs(Zc(e,t[S]*r,S<P-1?t[S+1]*r:e.length,r));var V=0;for(S=0;S<u.length;S+=3){var te=u[S]*r,he=u[S+1]*r,_e=u[S+2]*r;V+=Math.abs((e[te]-e[_e])*(e[he+1]-e[te+1])-(e[te]-e[he])*(e[_e+1]-e[te+1]))}return v===0&&V===0?0:Math.abs((V-v)/v)},uf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var v=0;v<e[f].length;v++)for(var S=0;S<t;S++)r.vertices.push(e[f][v][S]);f>0&&r.holes.push(u+=e[f-1].length)}return r},Ku.default=Ef;var Xt=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mu,this.indexArray=new Cl,this.indexArray2=new ac,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new rt,this.segments2=new rt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Xt.prototype.populate=function(e,t,r){this.hasPattern=Ae("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],v=0,S=e;v<S.length;v+=1){var P=S[v],V=P.feature,te=P.id,he=P.index,_e=P.sourceLayerIndex,Ce=this.layers[0]._featureFilter.needGeometry,lt=Ui(V,Ce);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),lt,r)){var Pt=u?u.evaluate(lt,{},r,t.availableImages):void 0,Ct={id:te,properties:V.properties,type:V.type,sourceLayerIndex:_e,index:he,geometry:Ce?lt.geometry:gi(V),patterns:{},sortKey:Pt};f.push(Ct)}}u&&f.sort(function(pn,fn){return pn.sortKey-fn.sortKey});for(var Yt=0,Zt=f;Yt<Zt.length;Yt+=1){var ir=Zt[Yt],yr=ir.geometry,_r=ir.index,kr=ir.sourceLayerIndex;if(this.hasPattern){var Dr=ft("fill",this.layers,ir,this.zoom,t);this.patternFeatures.push(Dr)}else this.addFeature(ir,yr,_r,r,{});t.featureIndex.insert(e[_r].feature,yr,_r,kr,this.index)}},Xt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Xt.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var v=f[u];this.addFeature(v,v.geometry,v.index,t,r)}},Xt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Xt.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Xt.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Xt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Xt.prototype.addFeature=function(e,t,r,u,f){for(var v=0,S=N(t,500);v<S.length;v+=1){for(var P=S[v],V=0,te=0,he=P;te<he.length;te+=1)V+=he[te].length;for(var _e=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray),Ce=_e.vertexLength,lt=[],Pt=[],Ct=0,Yt=P;Ct<Yt.length;Ct+=1){var Zt=Yt[Ct];if(Zt.length!==0){Zt!==P[0]&&Pt.push(lt.length/2);var ir=this.segments2.prepareSegment(Zt.length,this.layoutVertexArray,this.indexArray2),yr=ir.vertexLength;this.layoutVertexArray.emplaceBack(Zt[0].x,Zt[0].y),this.indexArray2.emplaceBack(yr+Zt.length-1,yr),lt.push(Zt[0].x),lt.push(Zt[0].y);for(var _r=1;_r<Zt.length;_r++)this.layoutVertexArray.emplaceBack(Zt[_r].x,Zt[_r].y),this.indexArray2.emplaceBack(yr+_r-1,yr+_r),lt.push(Zt[_r].x),lt.push(Zt[_r].y);ir.vertexLength+=Zt.length,ir.primitiveLength+=Zt.length}}for(var kr=Ku(lt,Pt),Dr=0;Dr<kr.length;Dr+=3)this.indexArray.emplaceBack(Ce+kr[Dr],Ce+kr[Dr+1],Ce+kr[Dr+2]);_e.vertexLength+=V,_e.primitiveLength+=kr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},In("FillBucket",Xt,{omit:["layers","patternFeatures"]});var sr=new vo({"fill-sort-key":new jn(Xe.layout_fill["fill-sort-key"])}),or={paint:new vo({"fill-antialias":new Jn(Xe.paint_fill["fill-antialias"]),"fill-opacity":new jn(Xe.paint_fill["fill-opacity"]),"fill-color":new jn(Xe.paint_fill["fill-color"]),"fill-outline-color":new jn(Xe.paint_fill["fill-outline-color"]),"fill-translate":new Jn(Xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Jn(Xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new _c(Xe.paint_fill["fill-pattern"])}),layout:sr},Ir=function(e){function t(r){e.call(this,r,or)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Xt(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V){return cs(Yu(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,V),v)},t.prototype.isTileClipped=function(){return!0},t}(Ss),an=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Gn=ea;function ea(e,t,r,u,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(la,this,t)}function la(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,f){for(var v=u.readVarint()+u.pos;u.pos<v;){var S=f._keys[u.readVarint()],P=f._values[u.readVarint()];f.properties[S]=P}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function qa(e){for(var t,r,u=0,f=0,v=e.length,S=v-1;f<v;S=f++)u+=((r=e[S]).x-(t=e[f]).x)*(t.y+r.y);return u}ea.types=["Unknown","Point","LineString","Polygon"],ea.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,f=0,v=0,S=0,P=[];e.pos<r;){if(f<=0){var V=e.readVarint();u=7&V,f=V>>3}if(f--,u===1||u===2)v+=e.readSVarint(),S+=e.readSVarint(),u===1&&(t&&P.push(t),t=[]),t.push(new ee(v,S));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&P.push(t),P},ea.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,f=0,v=0,S=1/0,P=-1/0,V=1/0,te=-1/0;e.pos<t;){if(u<=0){var he=e.readVarint();r=7&he,u=he>>3}if(u--,r===1||r===2)(f+=e.readSVarint())<S&&(S=f),f>P&&(P=f),(v+=e.readSVarint())<V&&(V=v),v>te&&(te=v);else if(r!==7)throw new Error("unknown command "+r)}return[S,V,P,te]},ea.prototype.toGeoJSON=function(e,t,r){var u,f,v=this.extent*Math.pow(2,r),S=this.extent*e,P=this.extent*t,V=this.loadGeometry(),te=ea.types[this.type];function he(lt){for(var Pt=0;Pt<lt.length;Pt++){var Ct=lt[Pt];lt[Pt]=[360*(Ct.x+S)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ct.y+P)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var _e=[];for(u=0;u<V.length;u++)_e[u]=V[u][0];he(V=_e);break;case 2:for(u=0;u<V.length;u++)he(V[u]);break;case 3:for(V=function(lt){var Pt=lt.length;if(Pt<=1)return[lt];for(var Ct,Yt,Zt=[],ir=0;ir<Pt;ir++){var yr=qa(lt[ir]);yr!==0&&(Yt===void 0&&(Yt=yr<0),Yt===yr<0?(Ct&&Zt.push(Ct),Ct=[lt[ir]]):Ct.push(lt[ir]))}return Ct&&Zt.push(Ct),Zt}(V),u=0;u<V.length;u++)for(f=0;f<V[u].length;f++)he(V[u][f])}V.length===1?V=V[0]:te="Multi"+te;var Ce={type:"Feature",geometry:{type:te,coordinates:V},properties:this.properties};return"id"in this&&(Ce.id=this.id),Ce};var Fa=yi;function yi(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ja,this,t),this.length=this._features.length}function Ja(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var f=null,v=u.readVarint()+u.pos;u.pos<v;){var S=u.readVarint()>>3;f=S===1?u.readString():S===2?u.readFloat():S===3?u.readDouble():S===4?u.readVarint64():S===5?u.readVarint():S===6?u.readSVarint():S===7?u.readBoolean():null}return f}(r))}function Bi(e,t,r){if(e===3){var u=new Fa(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}yi.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Gn(this._pbf,t,this.extent,this._keys,this._values)};var So={VectorTile:function(t,r){this.layers=t.readFields(Bi,{},r)},VectorTileFeature:Gn,VectorTileLayer:Fa},yo=So.VectorTileFeature.types,Hi=Math.pow(2,13);function ko(e,t,r,u,f,v,S,P){e.emplaceBack(t,r,2*Math.floor(u*Hi)+S,f*Hi*2,v*Hi*2,Math.round(P))}var Qa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ou,this.indexArray=new Cl,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new rt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function lo(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Qa.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Ae("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var v=f[u],S=v.feature,P=v.id,V=v.index,te=v.sourceLayerIndex,he=this.layers[0]._featureFilter.needGeometry,_e=Ui(S,he);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),_e,r)){var Ce={id:P,sourceLayerIndex:te,index:V,geometry:he?_e.geometry:gi(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(ft("fill-extrusion",this.layers,Ce,this.zoom,t)):this.addFeature(Ce,Ce.geometry,V,r,{}),t.featureIndex.insert(S,Ce.geometry,V,te,this.index,!0)}}},Qa.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.features;u<f.length;u+=1){var v=f[u];this.addFeature(v,v.geometry,v.index,t,r)}},Qa.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Qa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,an),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qa.prototype.addFeature=function(e,t,r,u,f){for(var v=0,S=N(t,500);v<S.length;v+=1){for(var P=S[v],V=0,te=0,he=P;te<he.length;te+=1)V+=he[te].length;for(var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Ce=0,lt=P;Ce<lt.length;Ce+=1){var Pt=lt[Ce];if(Pt.length!==0&&!(($a=Pt).every(function(Na){return Na.x<0})||$a.every(function(Na){return Na.x>8192})||$a.every(function(Na){return Na.y<0})||$a.every(function(Na){return Na.y>8192})))for(var Ct=0,Yt=0;Yt<Pt.length;Yt++){var Zt=Pt[Yt];if(Yt>=1){var ir=Pt[Yt-1];if(!lo(Zt,ir)){_e.vertexLength+4>rt.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var yr=Zt.sub(ir)._perp()._unit(),_r=ir.dist(Zt);Ct+_r>32768&&(Ct=0),ko(this.layoutVertexArray,Zt.x,Zt.y,yr.x,yr.y,0,0,Ct),ko(this.layoutVertexArray,Zt.x,Zt.y,yr.x,yr.y,0,1,Ct),ko(this.layoutVertexArray,ir.x,ir.y,yr.x,yr.y,0,0,Ct+=_r),ko(this.layoutVertexArray,ir.x,ir.y,yr.x,yr.y,0,1,Ct);var kr=_e.vertexLength;this.indexArray.emplaceBack(kr,kr+2,kr+1),this.indexArray.emplaceBack(kr+1,kr+2,kr+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+V>rt.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray)),yo[e.type]==="Polygon"){for(var Dr=[],pn=[],fn=_e.vertexLength,Rn=0,Qn=P;Rn<Qn.length;Rn+=1){var Xn=Qn[Rn];if(Xn.length!==0){Xn!==P[0]&&pn.push(Dr.length/2);for(var Nn=0;Nn<Xn.length;Nn++){var Ea=Xn[Nn];ko(this.layoutVertexArray,Ea.x,Ea.y,0,0,1,1,0),Dr.push(Ea.x),Dr.push(Ea.y)}}}for(var ca=Ku(Dr,pn),ra=0;ra<ca.length;ra+=3)this.indexArray.emplaceBack(fn+ca[ra],fn+ca[ra+2],fn+ca[ra+1]);_e.primitiveLength+=ca.length/3,_e.vertexLength+=V}}var $a;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},In("FillExtrusionBucket",Qa,{omit:["layers","features"]});var iu={paint:new vo({"fill-extrusion-opacity":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jn(Xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _c(Xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jn(Xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jn(Xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Jn(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},bi=function(e){function t(r){e.call(this,r,iu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Qa(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V,te){var he=Yu(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,V),_e=this.paint.get("fill-extrusion-height").evaluate(u,f),Ce=this.paint.get("fill-extrusion-base").evaluate(u,f),lt=function(Ct,Yt,Zt,ir){for(var yr=[],_r=0,kr=Ct;_r<kr.length;_r+=1){var Dr=kr[_r],pn=[Dr.x,Dr.y,0,1];Ls(pn,pn,Yt),yr.push(new ee(pn[0]/pn[3],pn[1]/pn[3]))}return yr}(he,te),Pt=function(Ct,Yt,Zt,ir){for(var yr=[],_r=[],kr=ir[8]*Yt,Dr=ir[9]*Yt,pn=ir[10]*Yt,fn=ir[11]*Yt,Rn=ir[8]*Zt,Qn=ir[9]*Zt,Xn=ir[10]*Zt,Nn=ir[11]*Zt,Ea=0,ca=Ct;Ea<ca.length;Ea+=1){for(var ra=[],$a=[],Na=0,ki=ca[Ea];Na<ki.length;Na+=1){var ma=ki[Na],ri=ma.x,Fo=ma.y,mi=ir[0]*ri+ir[4]*Fo+ir[12],zo=ir[1]*ri+ir[5]*Fo+ir[13],Uo=ir[2]*ri+ir[6]*Fo+ir[14],ts=ir[3]*ri+ir[7]*Fo+ir[15],bu=Uo+pn,rs=ts+fn,$u=mi+Rn,su=zo+Qn,Ju=Uo+Xn,uu=ts+Nn,Zs=new ee((mi+kr)/rs,(zo+Dr)/rs);Zs.z=bu/rs,ra.push(Zs);var lu=new ee($u/uu,su/uu);lu.z=Ju/uu,$a.push(lu)}yr.push(ra),_r.push($a)}return[yr,_r]}(v,Ce,_e,te);return function(Ct,Yt,Zt){var ir=1/0;cs(Zt,Yt)&&(ir=xa(Zt,Yt[0]));for(var yr=0;yr<Yt.length;yr++)for(var _r=Yt[yr],kr=Ct[yr],Dr=0;Dr<_r.length-1;Dr++){var pn=_r[Dr],fn=[pn,_r[Dr+1],kr[Dr+1],kr[Dr],pn];vu(Zt,fn)&&(ir=Math.min(ir,xa(Zt,fn)))}return ir!==1/0&&ir}(Pt[0],Pt[1],lt)},t}(Ss);function Ni(e,t){return e.x*t.x+e.y*t.y}function xa(e,t){if(e.length===1){for(var r,u=0,f=t[u++];!r||f.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var v=t[u],S=e[0],P=r.sub(f),V=v.sub(f),te=S.sub(f),he=Ni(P,P),_e=Ni(P,V),Ce=Ni(V,V),lt=Ni(te,P),Pt=Ni(te,V),Ct=he*Ce-_e*_e,Yt=(Ce*lt-_e*Pt)/Ct,Zt=(he*Pt-_e*lt)/Ct,ir=f.z*(1-Yt-Zt)+r.z*Yt+v.z*Zt;if(isFinite(ir))return ir}return 1/0}for(var yr=1/0,_r=0,kr=t;_r<kr.length;_r+=1)yr=Math.min(yr,kr[_r].z);return yr}var Ao=no([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,hc=no([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,kf=So.VectorTileFeature.types,uh=Math.cos(Math.PI/180*37.5),jf=Math.pow(2,14)/.5,Iu=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new Ms,this.layoutVertexArray2=new Bc,this.indexArray=new Cl,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new rt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Iu.prototype.populate=function(e,t,r){this.hasPattern=Ae("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],v=0,S=e;v<S.length;v+=1){var P=S[v],V=P.feature,te=P.id,he=P.index,_e=P.sourceLayerIndex,Ce=this.layers[0]._featureFilter.needGeometry,lt=Ui(V,Ce);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),lt,r)){var Pt=u?u.evaluate(lt,{},r):void 0,Ct={id:te,properties:V.properties,type:V.type,sourceLayerIndex:_e,index:he,geometry:Ce?lt.geometry:gi(V),patterns:{},sortKey:Pt};f.push(Ct)}}u&&f.sort(function(pn,fn){return pn.sortKey-fn.sortKey});for(var Yt=0,Zt=f;Yt<Zt.length;Yt+=1){var ir=Zt[Yt],yr=ir.geometry,_r=ir.index,kr=ir.sourceLayerIndex;if(this.hasPattern){var Dr=ft("line",this.layers,ir,this.zoom,t);this.patternFeatures.push(Dr)}else this.addFeature(ir,yr,_r,r,{});t.featureIndex.insert(e[_r].feature,yr,_r,kr,this.index)}},Iu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Iu.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var v=f[u];this.addFeature(v,v.geometry,v.index,t,r)}},Iu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Iu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Iu.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,hc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ao),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Iu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Iu.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Iu.prototype.addFeature=function(e,t,r,u,f){var v=this.layers[0].layout,S=v.get("line-join").evaluate(e,{}),P=v.get("line-cap"),V=v.get("line-miter-limit"),te=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var he=0,_e=t;he<_e.length;he+=1)this.addLine(_e[he],e,S,P,V,te);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Iu.prototype.addLine=function(e,t,r,u,f,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<e.length-1;S++)this.totalDistance+=e[S].dist(e[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P=kf[t.type]==="Polygon",V=e.length;V>=2&&e[V-1].equals(e[V-2]);)V--;for(var te=0;te<V-1&&e[te].equals(e[te+1]);)te++;if(!(V<(P?3:2))){r==="bevel"&&(f=1.05);var he,_e=this.overscaling<=16?122880/(512*this.overscaling):0,Ce=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray),lt=void 0,Pt=void 0,Ct=void 0,Yt=void 0;this.e1=this.e2=-1,P&&(Yt=e[te].sub(he=e[V-2])._unit()._perp());for(var Zt=te;Zt<V;Zt++)if(!(Pt=Zt===V-1?P?e[te+1]:void 0:e[Zt+1])||!e[Zt].equals(Pt)){Yt&&(Ct=Yt),he&&(lt=he),he=e[Zt],Yt=Pt?Pt.sub(he)._unit()._perp():Ct;var ir=(Ct=Ct||Yt).add(Yt);ir.x===0&&ir.y===0||ir._unit();var yr=Ct.x*Yt.x+Ct.y*Yt.y,_r=ir.x*Yt.x+ir.y*Yt.y,kr=_r!==0?1/_r:1/0,Dr=2*Math.sqrt(2-2*_r),pn=_r<uh&&lt&&Pt,fn=Ct.x*Yt.y-Ct.y*Yt.x>0;if(pn&&Zt>te){var Rn=he.dist(lt);if(Rn>2*_e){var Qn=he.sub(he.sub(lt)._mult(_e/Rn)._round());this.updateDistance(lt,Qn),this.addCurrentVertex(Qn,Ct,0,0,Ce),lt=Qn}}var Xn=lt&&Pt,Nn=Xn?r:P?"butt":u;if(Xn&&Nn==="round"&&(kr<v?Nn="miter":kr<=2&&(Nn="fakeround")),Nn==="miter"&&kr>f&&(Nn="bevel"),Nn==="bevel"&&(kr>2&&(Nn="flipbevel"),kr<f&&(Nn="miter")),lt&&this.updateDistance(lt,he),Nn==="miter")ir._mult(kr),this.addCurrentVertex(he,ir,0,0,Ce);else if(Nn==="flipbevel"){if(kr>100)ir=Yt.mult(-1);else{var Ea=kr*Ct.add(Yt).mag()/Ct.sub(Yt).mag();ir._perp()._mult(Ea*(fn?-1:1))}this.addCurrentVertex(he,ir,0,0,Ce),this.addCurrentVertex(he,ir.mult(-1),0,0,Ce)}else if(Nn==="bevel"||Nn==="fakeround"){var ca=-Math.sqrt(kr*kr-1),ra=fn?ca:0,$a=fn?0:ca;if(lt&&this.addCurrentVertex(he,Ct,ra,$a,Ce),Nn==="fakeround")for(var Na=Math.round(180*Dr/Math.PI/20),ki=1;ki<Na;ki++){var ma=ki/Na;if(ma!==.5){var ri=ma-.5;ma+=ma*ri*(ma-1)*((1.0904+yr*(yr*(3.55645-1.43519*yr)-3.2452))*ri*ri+(.848013+yr*(.215638*yr-1.06021)))}var Fo=Yt.sub(Ct)._mult(ma)._add(Ct)._unit()._mult(fn?-1:1);this.addHalfVertex(he,Fo.x,Fo.y,!1,fn,0,Ce)}Pt&&this.addCurrentVertex(he,Yt,-ra,-$a,Ce)}else if(Nn==="butt")this.addCurrentVertex(he,ir,0,0,Ce);else if(Nn==="square"){var mi=lt?1:-1;this.addCurrentVertex(he,ir,mi,mi,Ce)}else Nn==="round"&&(lt&&(this.addCurrentVertex(he,Ct,0,0,Ce),this.addCurrentVertex(he,Ct,1,1,Ce,!0)),Pt&&(this.addCurrentVertex(he,Yt,-1,-1,Ce,!0),this.addCurrentVertex(he,Yt,0,0,Ce)));if(pn&&Zt<V-1){var zo=he.dist(Pt);if(zo>2*_e){var Uo=he.add(Pt.sub(he)._mult(_e/zo)._round());this.updateDistance(he,Uo),this.addCurrentVertex(Uo,Yt,0,0,Ce),he=Uo}}}}},Iu.prototype.addCurrentVertex=function(e,t,r,u,f,v){v===void 0&&(v=!1);var S=t.y*u-t.x,P=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,v,!1,r,f),this.addHalfVertex(e,S,P,v,!0,-u,f),this.distance>jf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,f,v))},Iu.prototype.addHalfVertex=function(e,t,r,u,f,v,S){var P=.5*(this.lineClips?this.scaledDistance*(jf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(v===0?0:v<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var V=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),S.primitiveLength++),f?this.e2=V:this.e1=V},Iu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Iu.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},In("LineBucket",Iu,{omit:["layers","patternFeatures"]});var Ff=new vo({"line-cap":new Jn(Xe.layout_line["line-cap"]),"line-join":new jn(Xe.layout_line["line-join"]),"line-miter-limit":new Jn(Xe.layout_line["line-miter-limit"]),"line-round-limit":new Jn(Xe.layout_line["line-round-limit"]),"line-sort-key":new jn(Xe.layout_line["line-sort-key"])}),ff={paint:new vo({"line-opacity":new jn(Xe.paint_line["line-opacity"]),"line-color":new jn(Xe.paint_line["line-color"]),"line-translate":new Jn(Xe.paint_line["line-translate"]),"line-translate-anchor":new Jn(Xe.paint_line["line-translate-anchor"]),"line-width":new jn(Xe.paint_line["line-width"]),"line-gap-width":new jn(Xe.paint_line["line-gap-width"]),"line-offset":new jn(Xe.paint_line["line-offset"]),"line-blur":new jn(Xe.paint_line["line-blur"]),"line-dasharray":new us(Xe.paint_line["line-dasharray"]),"line-pattern":new _c(Xe.paint_line["line-pattern"]),"line-gradient":new Io(Xe.paint_line["line-gradient"])}),layout:Ff},zf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new Pa(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,f,v){return u=Le({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,f,v)},t}(jn))(ff.paint.properties["line-width"].specification);zf.useIntegerZoom=!0;var Th=function(e){function t(r){e.call(this,r,ff),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ri,this.gradientVersion=(this.gradientVersion+1)%je)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=zf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Iu(r)},t.prototype.queryRadius=function(r){var u=r,f=lh(fs("line-width",this,u),fs("line-gap-width",this,u)),v=fs("line-offset",this,u);return f/2+Math.abs(v)+ao(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,v,S,P,V){var te=Yu(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,V),he=V/2*lh(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),_e=this.paint.get("line-offset").evaluate(u,f);return _e&&(v=function(Ce,lt){for(var Pt=[],Ct=new ee(0,0),Yt=0;Yt<Ce.length;Yt++){for(var Zt=Ce[Yt],ir=[],yr=0;yr<Zt.length;yr++){var _r=Zt[yr],kr=Zt[yr+1],Dr=yr===0?Ct:_r.sub(Zt[yr-1])._unit()._perp(),pn=yr===Zt.length-1?Ct:kr.sub(_r)._unit()._perp(),fn=Dr._add(pn)._unit();fn._mult(1/(fn.x*pn.x+fn.y*pn.y)),ir.push(fn._mult(lt)._add(_r))}Pt.push(ir)}return Pt}(v,_e*V)),function(Ce,lt,Pt){for(var Ct=0;Ct<lt.length;Ct++){var Yt=lt[Ct];if(Ce.length>=3){for(var Zt=0;Zt<Yt.length;Zt++)if(ru(Ce,Yt[Zt]))return!0}if(Gs(Ce,Yt,Pt))return!0}return!1}(te,v,he)},t.prototype.isTileClipped=function(){return!0},t}(Ss);function lh(e,t){return t>0?t+2*e:e}var Sf=no([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Uf=no([{name:"a_projected_pos",components:3,type:"Float32"}],4),Bf=(no([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),no([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ch=(no([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),no([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Vf=no([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Pf(e,t,r){return e.sections.forEach(function(u){u.text=function(f,v,S){var P=v.layout.get("text-transform").evaluate(S,{});return P==="uppercase"?f=f.toLocaleUpperCase():P==="lowercase"&&(f=f.toLocaleLowerCase()),ss.applyArabicShaping&&(f=ss.applyArabicShaping(f)),f}(u.text,t,r)}),e}no([{name:"triangle",components:3,type:"Uint16"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),no([{type:"Float32",name:"offsetX"}]),no([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Zl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Dh=function(t,r,u,f,v){var S,P,V=8*v-f-1,te=(1<<V)-1,he=te>>1,_e=-7,Ce=u?v-1:0,lt=u?-1:1,Pt=t[r+Ce];for(Ce+=lt,S=Pt&(1<<-_e)-1,Pt>>=-_e,_e+=V;_e>0;S=256*S+t[r+Ce],Ce+=lt,_e-=8);for(P=S&(1<<-_e)-1,S>>=-_e,_e+=f;_e>0;P=256*P+t[r+Ce],Ce+=lt,_e-=8);if(S===0)S=1-he;else{if(S===te)return P?NaN:1/0*(Pt?-1:1);P+=Math.pow(2,f),S-=he}return(Pt?-1:1)*P*Math.pow(2,S-f)},ye=function(t,r,u,f,v,S){var P,V,te,he=8*S-v-1,_e=(1<<he)-1,Ce=_e>>1,lt=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,Pt=f?0:S-1,Ct=f?1:-1,Yt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(V=isNaN(r)?1:0,P=_e):(P=Math.floor(Math.log(r)/Math.LN2),r*(te=Math.pow(2,-P))<1&&(P--,te*=2),(r+=P+Ce>=1?lt/te:lt*Math.pow(2,1-Ce))*te>=2&&(P++,te/=2),P+Ce>=_e?(V=0,P=_e):P+Ce>=1?(V=(r*te-1)*Math.pow(2,v),P+=Ce):(V=r*Math.pow(2,Ce-1)*Math.pow(2,v),P=0));v>=8;t[u+Pt]=255&V,Pt+=Ct,V/=256,v-=8);for(P=P<<v|V,he+=v;he>0;t[u+Pt]=255&P,Pt+=Ct,P/=256,he-=8);t[u+Pt-Ct]|=128*Yt},Fe=Ot;function Ot(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Ot.Varint=0,Ot.Fixed64=1,Ot.Bytes=2,Ot.Fixed32=5;var xr=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Pr(e){return e.type===Ot.Bytes?e.readVarint()+e.pos:e.pos+1}function Cr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Er(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var f=r.pos-1;f>=e;f--)r.buf[f+u]=r.buf[f]}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function on(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function en(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Yr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Tn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function dn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Tr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function br(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Zr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function wn(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Rr(e,t,r){e===1&&r.readMessage(ta,t)}function ta(e,t,r){if(e===3){var u=r.readMessage(Jr,{}),f=u.width,v=u.height,S=u.left,P=u.top,V=u.advance;t.push({id:u.id,bitmap:new Rs({width:f+6,height:v+6},u.bitmap),metrics:{width:f,height:v,left:S,top:P,advance:V}})}}function Jr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Br(e){for(var t=0,r=0,u=0,f=e;u<f.length;u+=1){var v=f[u];t+=v.w*v.h,r=Math.max(r,v.w)}e.sort(function(Ct,Yt){return Yt.h-Ct.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],P=0,V=0,te=0,he=e;te<he.length;te+=1)for(var _e=he[te],Ce=S.length-1;Ce>=0;Ce--){var lt=S[Ce];if(!(_e.w>lt.w||_e.h>lt.h)){if(_e.x=lt.x,_e.y=lt.y,V=Math.max(V,_e.y+_e.h),P=Math.max(P,_e.x+_e.w),_e.w===lt.w&&_e.h===lt.h){var Pt=S.pop();Ce<S.length&&(S[Ce]=Pt)}else _e.h===lt.h?(lt.x+=_e.w,lt.w-=_e.w):_e.w===lt.w?(lt.y+=_e.h,lt.h-=_e.h):(S.push({x:lt.x+_e.w,y:lt.y,w:lt.w-_e.w,h:_e.h}),lt.y+=_e.h,lt.h-=_e.h);break}}return{w:P,h:V,fill:t/(P*V)||0}}Ot.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),v=f>>3,S=this.pos;this.type=7&f,t(v,r,this),this.pos===S&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=br(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=wn(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=br(this.buf,this.pos)+4294967296*br(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=br(this.buf,this.pos)+4294967296*wn(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Dh(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Dh(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,f=this.buf;return r=127&(u=f[this.pos++]),u<128?r:(r|=(127&(u=f[this.pos++]))<<7,u<128?r:(r|=(127&(u=f[this.pos++]))<<14,u<128?r:(r|=(127&(u=f[this.pos++]))<<21,u<128?r:function(v,S,P){var V,te,he=P.buf;if(V=(112&(te=he[P.pos++]))>>4,te<128)return Cr(v,V,S);if(V|=(127&(te=he[P.pos++]))<<3,te<128)return Cr(v,V,S);if(V|=(127&(te=he[P.pos++]))<<10,te<128)return Cr(v,V,S);if(V|=(127&(te=he[P.pos++]))<<17,te<128)return Cr(v,V,S);if(V|=(127&(te=he[P.pos++]))<<24,te<128)return Cr(v,V,S);if(V|=(1&(te=he[P.pos++]))<<31,te<128)return Cr(v,V,S);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&xr?function(u,f,v){return xr.decode(u.subarray(f,v))}(this.buf,r,t):function(u,f,v){for(var S="",P=f;P<v;){var V,te,he,_e=u[P],Ce=null,lt=_e>239?4:_e>223?3:_e>191?2:1;if(P+lt>v)break;lt===1?_e<128&&(Ce=_e):lt===2?(192&(V=u[P+1]))==128&&(Ce=(31&_e)<<6|63&V)<=127&&(Ce=null):lt===3?(te=u[P+2],(192&(V=u[P+1]))==128&&(192&te)==128&&((Ce=(15&_e)<<12|(63&V)<<6|63&te)<=2047||Ce>=55296&&Ce<=57343)&&(Ce=null)):lt===4&&(te=u[P+2],he=u[P+3],(192&(V=u[P+1]))==128&&(192&te)==128&&(192&he)==128&&((Ce=(15&_e)<<18|(63&V)<<12|(63&te)<<6|63&he)<=65535||Ce>=1114112)&&(Ce=null)),Ce===null?(Ce=65533,lt=1):Ce>65535&&(Ce-=65536,S+=String.fromCharCode(Ce>>>10&1023|55296),Ce=56320|1023&Ce),S+=String.fromCharCode(Ce),P+=lt}return S}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==Ot.Bytes)return t.push(this.readVarint(r));var u=Pr(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==Ot.Bytes)return t.push(this.readSVarint());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ot.Bytes)return t.push(this.readBoolean());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ot.Bytes)return t.push(this.readFloat());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ot.Bytes)return t.push(this.readDouble());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ot.Bytes)return t.push(this.readFixed32());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ot.Bytes)return t.push(this.readSFixed32());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ot.Bytes)return t.push(this.readFixed64());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ot.Bytes)return t.push(this.readSFixed64());var r=Pr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===Ot.Varint)for(;this.buf[this.pos++]>127;);else if(r===Ot.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Ot.Fixed32)this.pos+=4;else{if(r!==Ot.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Zr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Zr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Zr(this.buf,-1&t,this.pos),Zr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Zr(this.buf,-1&t,this.pos),Zr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var f,v;if(r>=0?(f=r%4294967296|0,v=r/4294967296|0):(v=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,v=v+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(S,P,V){V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,V.buf[V.pos]=127&(S>>>=7)}(f,0,u),function(S,P){var V=(7&S)<<4;P.buf[P.pos++]|=V|((S>>>=3)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S)))))}(v,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,v,S){for(var P,V,te=0;te<v.length;te++){if((P=v.charCodeAt(te))>55295&&P<57344){if(!V){P>56319||te+1===v.length?(f[S++]=239,f[S++]=191,f[S++]=189):V=P;continue}if(P<56320){f[S++]=239,f[S++]=191,f[S++]=189,V=P;continue}P=V-55296<<10|P-56320|65536,V=null}else V&&(f[S++]=239,f[S++]=191,f[S++]=189,V=null);P<128?f[S++]=P:(P<2048?f[S++]=P>>6|192:(P<65536?f[S++]=P>>12|224:(f[S++]=P>>18|240,f[S++]=P>>12&63|128),f[S++]=P>>6&63|128),f[S++]=63&P|128)}return S}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&Er(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),ye(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ye(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var f=this.pos-u;f>=128&&Er(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,u){this.writeTag(t,Ot.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,on,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,en,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,Yr,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Tn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,dn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,nn,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,Tr,r)},writeBytesField:function(t,r){this.writeTag(t,Ot.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,Ot.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,Ot.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,Ot.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,Ot.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,Ot.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,Ot.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,Ot.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,Ot.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,Ot.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Fr=function(t,r){var u=r.pixelRatio,f=r.version,v=r.stretchX,S=r.stretchY,P=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=v,this.stretchY=S,this.content=P,this.version=f},Kr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Kr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Kr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Kr.tlbr.get=function(){return this.tl.concat(this.br)},Kr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Fr.prototype,Kr);var Hn=function(t,r){var u={},f={};this.haveRenderCallbacks=[];var v=[];this.addImages(t,u,v),this.addImages(r,f,v);var S=Br(v),P=new go({width:S.w||1,height:S.h||1});for(var V in t){var te=t[V],he=u[V].paddedRect;go.copy(te.data,P,{x:0,y:0},{x:he.x+1,y:he.y+1},te.data)}for(var _e in r){var Ce=r[_e],lt=f[_e].paddedRect,Pt=lt.x+1,Ct=lt.y+1,Yt=Ce.data.width,Zt=Ce.data.height;go.copy(Ce.data,P,{x:0,y:0},{x:Pt,y:Ct},Ce.data),go.copy(Ce.data,P,{x:0,y:Zt-1},{x:Pt,y:Ct-1},{width:Yt,height:1}),go.copy(Ce.data,P,{x:0,y:0},{x:Pt,y:Ct+Zt},{width:Yt,height:1}),go.copy(Ce.data,P,{x:Yt-1,y:0},{x:Pt-1,y:Ct},{width:1,height:Zt}),go.copy(Ce.data,P,{x:0,y:0},{x:Pt+Yt,y:Ct},{width:1,height:Zt})}this.image=P,this.iconPositions=u,this.patternPositions=f};Hn.prototype.addImages=function(e,t,r){for(var u in e){var f=e[u],v={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(v),t[u]=new Fr(v,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Hn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Hn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},In("ImagePosition",Fr),In("ImageAtlas",Hn);var aa={horizontal:1,vertical:2,horizontalOnly:3},sn=function(){this.scale=1,this.fontStack="",this.imageName=null};sn.forText=function(e,t){var r=new sn;return r.scale=e||1,r.fontStack=t,r},sn.forImage=function(e){var t=new sn;return t.imageName=e,t};var Gr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function jr(e,t,r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct){var Yt,Zt=Gr.fromFeature(e,f);_e===aa.vertical&&Zt.verticalizePunctuation();var ir=ss.processBidirectionalText,yr=ss.processStyledBidirectionalText;if(ir&&Zt.sections.length===1){Yt=[];for(var _r=0,kr=ir(Zt.toString(),fi(Zt,te,v,t,u,lt,Pt));_r<kr.length;_r+=1){var Dr=kr[_r],pn=new Gr;pn.text=Dr,pn.sections=Zt.sections;for(var fn=0;fn<Dr.length;fn++)pn.sectionIndex.push(0);Yt.push(pn)}}else if(yr){Yt=[];for(var Rn=0,Qn=yr(Zt.text,Zt.sectionIndex,fi(Zt,te,v,t,u,lt,Pt));Rn<Qn.length;Rn+=1){var Xn=Qn[Rn],Nn=new Gr;Nn.text=Xn[0],Nn.sectionIndex=Xn[1],Nn.sections=Zt.sections,Yt.push(Nn)}}else Yt=function(ra,$a){for(var Na=[],ki=ra.text,ma=0,ri=0,Fo=$a;ri<Fo.length;ri+=1){var mi=Fo[ri];Na.push(ra.substring(ma,mi)),ma=mi}return ma<ki.length&&Na.push(ra.substring(ma,ki.length)),Na}(Zt,fi(Zt,te,v,t,u,lt,Pt));var Ea=[],ca={positionedLines:Ea,text:Zt.toString(),top:he[1],bottom:he[1],left:he[0],right:he[0],writingMode:_e,iconsInText:!1,verticalizable:!1};return function(ra,$a,Na,ki,ma,ri,Fo,mi,zo,Uo,ts,bu){for(var rs=0,$u=-17,su=0,Ju=0,uu=mi==="right"?1:mi==="left"?0:.5,Zs=0,lu=0,hi=ma;lu<hi.length;lu+=1){var ni=hi[lu];ni.trim();var Ji=ni.getMaxScale(),fo=24*(Ji-1),xu={positionedGlyphs:[],lineOffset:0};ra.positionedLines[Zs]=xu;var bo=xu.positionedGlyphs,Bo=0;if(ni.length()){for(var Nu=0;Nu<ni.length();Nu++){var li=ni.getSection(Nu),Xf=ni.getSectionIndex(Nu),Xc=ni.getCharCode(Nu),hf=0,mc=null,ku=null,Lf=null,Rf=24,Yf=!(zo===aa.horizontal||!ts&&!os(Xc)||ts&&(ha[Xc]||(ph=Xc,qr.Arabic(ph)||qr["Arabic Supplement"](ph)||qr["Arabic Extended-A"](ph)||qr["Arabic Presentation Forms-A"](ph)||qr["Arabic Presentation Forms-B"](ph))));if(li.imageName){var Sh=ki[li.imageName];if(!Sh)continue;Lf=li.imageName,ra.iconsInText=ra.iconsInText||!0,ku=Sh.paddedRect;var Af=Sh.displaySize;li.scale=24*li.scale/bu,hf=fo+(24-Af[1]*li.scale),Rf=(mc={width:Af[0],height:Af[1],left:1,top:-3,advance:Yf?Af[1]:Af[0]}).advance;var Ah=Yf?Af[0]*li.scale-24*Ji:Af[1]*li.scale-24*Ji;Ah>0&&Ah>Bo&&(Bo=Ah)}else{var Kf=Na[li.fontStack],dh=Kf&&Kf[Xc];if(dh&&dh.rect)ku=dh.rect,mc=dh.metrics;else{var Wh=$a[li.fontStack],jh=Wh&&Wh[Xc];if(!jh)continue;mc=jh.metrics}hf=24*(Ji-li.scale)}Yf?(ra.verticalizable=!0,bo.push({glyph:Xc,imageName:Lf,x:rs,y:$u+hf,vertical:Yf,scale:li.scale,fontStack:li.fontStack,sectionIndex:Xf,metrics:mc,rect:ku}),rs+=Rf*li.scale+Uo):(bo.push({glyph:Xc,imageName:Lf,x:rs,y:$u+hf,vertical:Yf,scale:li.scale,fontStack:li.fontStack,sectionIndex:Xf,metrics:mc,rect:ku}),rs+=mc.advance*li.scale+Uo)}bo.length!==0&&(su=Math.max(rs-Uo,su),ps(bo,0,bo.length-1,uu,Bo)),rs=0;var Zh=ri*Ji+Bo;xu.lineOffset=Math.max(Bo,fo),$u+=Zh,Ju=Math.max(Zh,Ju),++Zs}else $u+=ri,++Zs}var ph,Ch=$u- -17,Xh=jo(Fo),mh=Xh.horizontalAlign,$f=Xh.verticalAlign;(function(ih,Yh,Fh,vh,zh,wh,gh,Uh,Bh){var Oh,Mh=(Yh-Fh)*zh;Oh=wh!==gh?-Uh*vh- -17:(-vh*Bh+.5)*gh;for(var yh=0,Ph=ih;yh<Ph.length;yh+=1)for(var bh=0,If=Ph[yh].positionedGlyphs;bh<If.length;bh+=1){var Lh=If[bh];Lh.x+=Mh,Lh.y+=Oh}})(ra.positionedLines,uu,mh,$f,su,Ju,ri,Ch,ma.length),ra.top+=-$f*Ch,ra.bottom=ra.top+Ch,ra.left+=-mh*su,ra.right=ra.left+su}(ca,t,r,u,Yt,S,P,V,_e,te,Ce,Ct),!function(ra){for(var $a=0,Na=ra;$a<Na.length;$a+=1)if(Na[$a].positionedGlyphs.length!==0)return!1;return!0}(Ea)&&ca}Gr.fromFeature=function(e,t){for(var r=new Gr,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},Gr.prototype.length=function(){return this.text.length},Gr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Gr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Gr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Gr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=u&&ro(u)&&!Zl[e[r+1]]||f&&ro(f)&&!Zl[e[r-1]]||!Zl[e[r]]?e[r]:Zl[e[r]]}return t}(this.text)},Gr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&ha[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&ha[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Gr.prototype.substring=function(e,t){var r=new Gr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Gr.prototype.toString=function(){return this.text},Gr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Gr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(sn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},Gr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(sn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):we("Reached maximum number of images 6401")}else we("Can't add FormattedSection with an empty image.")},Gr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ha={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pa={};function Un(e,t,r,u,f,v){if(t.imageName){var S=u[t.imageName];return S?S.displaySize[0]*t.scale*24/v+f:0}var P=r[t.fontStack],V=P&&P[e];return V?V.metrics.advance*t.scale+f:0}function Ua(e,t,r,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(r)*r}function Oa(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Da(e,t,r,u,f,v){for(var S=null,P=Ua(t,r,f,v),V=0,te=u;V<te.length;V+=1){var he=te[V],_e=Ua(t-he.x,r,f,v)+he.badness;_e<=P&&(S=he,P=_e)}return{index:e,x:t,priorBreak:S,badness:P}}function fi(e,t,r,u,f,v,S){if(v!=="point")return[];if(!e)return[];for(var P,V=[],te=function(Yt,Zt,ir,yr,_r,kr){for(var Dr=0,pn=0;pn<Yt.length();pn++){var fn=Yt.getSection(pn);Dr+=Un(Yt.getCharCode(pn),fn,yr,_r,Zt,kr)}return Dr/Math.max(1,Math.ceil(Dr/ir))}(e,t,r,u,f,S),he=e.text.indexOf("\u200B")>=0,_e=0,Ce=0;Ce<e.length();Ce++){var lt=e.getSection(Ce),Pt=e.getCharCode(Ce);if(ha[Pt]||(_e+=Un(Pt,lt,u,f,t,S)),Ce<e.length()-1){var Ct=!((P=Pt)<11904||!(qr["Bopomofo Extended"](P)||qr.Bopomofo(P)||qr["CJK Compatibility Forms"](P)||qr["CJK Compatibility Ideographs"](P)||qr["CJK Compatibility"](P)||qr["CJK Radicals Supplement"](P)||qr["CJK Strokes"](P)||qr["CJK Symbols and Punctuation"](P)||qr["CJK Unified Ideographs Extension A"](P)||qr["CJK Unified Ideographs"](P)||qr["Enclosed CJK Letters and Months"](P)||qr["Halfwidth and Fullwidth Forms"](P)||qr.Hiragana(P)||qr["Ideographic Description Characters"](P)||qr["Kangxi Radicals"](P)||qr["Katakana Phonetic Extensions"](P)||qr.Katakana(P)||qr["Vertical Forms"](P)||qr["Yi Radicals"](P)||qr["Yi Syllables"](P)));(pa[Pt]||Ct||lt.imageName)&&V.push(Da(Ce+1,_e,te,V,Oa(Pt,e.getCharCode(Ce+1),Ct&&he),!1))}}return function Yt(Zt){return Zt?Yt(Zt.priorBreak).concat(Zt.index):[]}(Da(e.length(),_e,te,V,0,!0))}function jo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function ps(e,t,r,u,f){if(u||f)for(var v=e[r],S=(e[r].x+v.metrics.advance*v.scale)*u,P=t;P<=r;P++)e[P].x-=S,e[P].y+=f}function ei(e,t,r,u,f,v){var S,P=e.image;if(P.content){var V=P.content,te=P.pixelRatio||1;S=[V[0]/te,V[1]/te,P.displaySize[0]-V[2]/te,P.displaySize[1]-V[3]/te]}var he,_e,Ce,lt,Pt=t.left*v,Ct=t.right*v;r==="width"||r==="both"?(lt=f[0]+Pt-u[3],_e=f[0]+Ct+u[1]):_e=(lt=f[0]+(Pt+Ct-P.displaySize[0])/2)+P.displaySize[0];var Yt=t.top*v,Zt=t.bottom*v;return r==="height"||r==="both"?(he=f[1]+Yt-u[0],Ce=f[1]+Zt+u[2]):Ce=(he=f[1]+(Yt+Zt-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:he,right:_e,bottom:Ce,left:lt,collisionPadding:S}}pa[10]=!0,pa[32]=!0,pa[38]=!0,pa[40]=!0,pa[41]=!0,pa[43]=!0,pa[45]=!0,pa[47]=!0,pa[173]=!0,pa[183]=!0,pa[8203]=!0,pa[8208]=!0,pa[8211]=!0,pa[8231]=!0;var co=function(e){function t(r,u,f,v){e.call(this,r,u),this.angle=f,v!==void 0&&(this.segment=v)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(ee);function Mi(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Pa(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,f=r.interpolationType,v=0;v<u.length&&u[v]<=e;)v++;for(var S=v=Math.max(0,v-1);S<u.length&&u[S]<e+1;)S++;S=Math.min(u.length-1,S);var P=u[v],V=u[S];return r.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:V,interpolationType:f}:{kind:"camera",minZoom:P,maxZoom:V,minSize:r.evaluate(new Pa(P)),maxSize:r.evaluate(new Pa(V)),interpolationType:f}}function ms(e,t,r){var u=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Vi(f/128,r.upperSize/128,t.uSizeT):u}function Wo(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,v=f?Pe(pi.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=Vi(e.minSize,e.maxSize,v):r=v}return{uSizeT:r,uSize:u}}In("Anchor",co);var Zo=Object.freeze({__proto__:null,getSizeData:Mi,evaluateSizeForFeature:ms,evaluateSizeForZoom:Wo,SIZE_PACK_FACTOR:128});function es(e,t,r,u,f){if(t.segment===void 0)return!0;for(var v=t,S=t.segment+1,P=0;P>-r/2;){if(--S<0)return!1;P-=e[S].dist(v),v=e[S]}P+=e[S].dist(e[S+1]),S++;for(var V=[],te=0;P<r/2;){var he=e[S],_e=e[S+1];if(!_e)return!1;var Ce=e[S-1].angleTo(he)-he.angleTo(_e);for(Ce=Math.abs((Ce+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:P,angleDelta:Ce}),te+=Ce;P-V[0].distance>u;)te-=V.shift().angleDelta;if(te>f)return!1;S++,P+=he.dist(_e)}return!0}function Is(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Wi(e,t,r){return e?.6*t*r:0}function ia(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Hs(e,t,r,u,f,v){for(var S=Wi(r,f,v),P=ia(r,u)*v,V=0,te=Is(e)/2,he=0;he<e.length-1;he++){var _e=e[he],Ce=e[he+1],lt=_e.dist(Ce);if(V+lt>te){var Pt=(te-V)/lt,Ct=Vi(_e.x,Ce.x,Pt),Yt=Vi(_e.y,Ce.y,Pt),Zt=new co(Ct,Yt,Ce.angleTo(_e),he);return Zt._round(),!S||es(e,Zt,P,S,t)?Zt:void 0}V+=lt}}function xi(e,t,r,u,f,v,S,P,V){var te=Wi(u,v,S),he=ia(u,f),_e=he*S,Ce=e[0].x===0||e[0].x===V||e[0].y===0||e[0].y===V;return t-_e<t/4&&(t=_e+t/4),function lt(Pt,Ct,Yt,Zt,ir,yr,_r,kr,Dr){for(var pn=yr/2,fn=Is(Pt),Rn=0,Qn=Ct-Yt,Xn=[],Nn=0;Nn<Pt.length-1;Nn++){for(var Ea=Pt[Nn],ca=Pt[Nn+1],ra=Ea.dist(ca),$a=ca.angleTo(Ea);Qn+Yt<Rn+ra;){var Na=((Qn+=Yt)-Rn)/ra,ki=Vi(Ea.x,ca.x,Na),ma=Vi(Ea.y,ca.y,Na);if(ki>=0&&ki<Dr&&ma>=0&&ma<Dr&&Qn-pn>=0&&Qn+pn<=fn){var ri=new co(ki,ma,$a,Nn);ri._round(),Zt&&!es(Pt,ri,yr,Zt,ir)||Xn.push(ri)}}Rn+=ra}return kr||Xn.length||_r||(Xn=lt(Pt,Rn/2,Yt,Zt,ir,yr,_r,!0,Dr)),Xn}(e,Ce?t/2*P%t:(he/2+2*v)*S*P%t,t,te,r,_e,Ce,!1,V)}function An(e,t,r,u,f){for(var v=[],S=0;S<e.length;S++)for(var P=e[S],V=void 0,te=0;te<P.length-1;te++){var he=P[te],_e=P[te+1];he.x<t&&_e.x<t||(he.x<t?he=new ee(t,he.y+(t-he.x)/(_e.x-he.x)*(_e.y-he.y))._round():_e.x<t&&(_e=new ee(t,he.y+(t-he.x)/(_e.x-he.x)*(_e.y-he.y))._round()),he.y<r&&_e.y<r||(he.y<r?he=new ee(he.x+(r-he.y)/(_e.y-he.y)*(_e.x-he.x),r)._round():_e.y<r&&(_e=new ee(he.x+(r-he.y)/(_e.y-he.y)*(_e.x-he.x),r)._round()),he.x>=u&&_e.x>=u||(he.x>=u?he=new ee(u,he.y+(u-he.x)/(_e.x-he.x)*(_e.y-he.y))._round():_e.x>=u&&(_e=new ee(u,he.y+(u-he.x)/(_e.x-he.x)*(_e.y-he.y))._round()),he.y>=f&&_e.y>=f||(he.y>=f?he=new ee(he.x+(f-he.y)/(_e.y-he.y)*(_e.x-he.x),f)._round():_e.y>=f&&(_e=new ee(he.x+(f-he.y)/(_e.y-he.y)*(_e.x-he.x),f)._round()),V&&he.equals(V[V.length-1])||v.push(V=[he]),V.push(_e)))))}return v}function Ra(e,t,r,u){var f=[],v=e.image,S=v.pixelRatio,P=v.paddedRect.w-2,V=v.paddedRect.h-2,te=e.right-e.left,he=e.bottom-e.top,_e=v.stretchX||[[0,P]],Ce=v.stretchY||[[0,V]],lt=function(ma,ri){return ma+ri[1]-ri[0]},Pt=_e.reduce(lt,0),Ct=Ce.reduce(lt,0),Yt=P-Pt,Zt=V-Ct,ir=0,yr=Pt,_r=0,kr=Ct,Dr=0,pn=Yt,fn=0,Rn=Zt;if(v.content&&u){var Qn=v.content;ir=Ba(_e,0,Qn[0]),_r=Ba(Ce,0,Qn[1]),yr=Ba(_e,Qn[0],Qn[2]),kr=Ba(Ce,Qn[1],Qn[3]),Dr=Qn[0]-ir,fn=Qn[1]-_r,pn=Qn[2]-Qn[0]-yr,Rn=Qn[3]-Qn[1]-kr}var Xn=function(ma,ri,Fo,mi){var zo=gu(ma.stretch-ir,yr,te,e.left),Uo=O(ma.fixed-Dr,pn,ma.stretch,Pt),ts=gu(ri.stretch-_r,kr,he,e.top),bu=O(ri.fixed-fn,Rn,ri.stretch,Ct),rs=gu(Fo.stretch-ir,yr,te,e.left),$u=O(Fo.fixed-Dr,pn,Fo.stretch,Pt),su=gu(mi.stretch-_r,kr,he,e.top),Ju=O(mi.fixed-fn,Rn,mi.stretch,Ct),uu=new ee(zo,ts),Zs=new ee(rs,ts),lu=new ee(rs,su),hi=new ee(zo,su),ni=new ee(Uo/S,bu/S),Ji=new ee($u/S,Ju/S),fo=t*Math.PI/180;if(fo){var xu=Math.sin(fo),bo=Math.cos(fo),Bo=[bo,-xu,xu,bo];uu._matMult(Bo),Zs._matMult(Bo),hi._matMult(Bo),lu._matMult(Bo)}var Nu=ma.stretch+ma.fixed,li=ri.stretch+ri.fixed;return{tl:uu,tr:Zs,bl:hi,br:lu,tex:{x:v.paddedRect.x+1+Nu,y:v.paddedRect.y+1+li,w:Fo.stretch+Fo.fixed-Nu,h:mi.stretch+mi.fixed-li},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ni,pixelOffsetBR:Ji,minFontScaleX:pn/S/te,minFontScaleY:Rn/S/he,isSDF:r}};if(u&&(v.stretchX||v.stretchY))for(var Nn=Xo(_e,Yt,Pt),Ea=Xo(Ce,Zt,Ct),ca=0;ca<Nn.length-1;ca++)for(var ra=Nn[ca],$a=Nn[ca+1],Na=0;Na<Ea.length-1;Na++)f.push(Xn(ra,Ea[Na],$a,Ea[Na+1]));else f.push(Xn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:V+1}));return f}function Ba(e,t,r){for(var u=0,f=0,v=e;f<v.length;f+=1){var S=v[f];u+=Math.max(t,Math.min(r,S[1]))-Math.max(t,Math.min(r,S[0]))}return u}function Xo(e,t,r){for(var u=[{fixed:-1,stretch:0}],f=0,v=e;f<v.length;f+=1){var S=v[f],P=S[0],V=S[1],te=u[u.length-1];u.push({fixed:P-te.stretch,stretch:te.stretch}),u.push({fixed:P-te.stretch,stretch:te.stretch+(V-P)})}return u.push({fixed:t+1,stretch:r}),u}function gu(e,t,r,u){return e/t*r+u}function O(e,t,r,u){return e-t*r/u}var d=function(t,r,u,f,v,S,P,V,te,he){if(this.boxStartIndex=t.length,te){var _e=S.top,Ce=S.bottom,lt=S.collisionPadding;lt&&(_e-=lt[1],Ce+=lt[3]);var Pt=Ce-_e;Pt>0&&(Pt=Math.max(10,Pt),this.circleDiameter=Pt)}else{var Ct=S.top*P-V,Yt=S.bottom*P+V,Zt=S.left*P-V,ir=S.right*P+V,yr=S.collisionPadding;if(yr&&(Zt-=yr[0]*P,Ct-=yr[1]*P,ir+=yr[2]*P,Yt+=yr[3]*P),he){var _r=new ee(Zt,Ct),kr=new ee(ir,Ct),Dr=new ee(Zt,Yt),pn=new ee(ir,Yt),fn=he*Math.PI/180;_r._rotate(fn),kr._rotate(fn),Dr._rotate(fn),pn._rotate(fn),Zt=Math.min(_r.x,kr.x,Dr.x,pn.x),ir=Math.max(_r.x,kr.x,Dr.x,pn.x),Ct=Math.min(_r.y,kr.y,Dr.y,pn.y),Yt=Math.max(_r.y,kr.y,Dr.y,pn.y)}t.emplaceBack(r.x,r.y,Zt,Ct,ir,Yt,u,f,v)}this.boxEndIndex=t.length},c=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=p),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function p(e,t){return e<t?-1:e>t?1:0}function T(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,f=1/0,v=-1/0,S=-1/0,P=e[0],V=0;V<P.length;V++){var te=P[V];(!V||te.x<u)&&(u=te.x),(!V||te.y<f)&&(f=te.y),(!V||te.x>v)&&(v=te.x),(!V||te.y>S)&&(S=te.y)}var he=Math.min(v-u,S-f),_e=he/2,Ce=new c([],j);if(he===0)return new ee(u,f);for(var lt=u;lt<v;lt+=he)for(var Pt=f;Pt<S;Pt+=he)Ce.push(new I(lt+_e,Pt+_e,_e,e));for(var Ct=function(ir){for(var yr=0,_r=0,kr=0,Dr=ir[0],pn=0,fn=Dr.length,Rn=fn-1;pn<fn;Rn=pn++){var Qn=Dr[pn],Xn=Dr[Rn],Nn=Qn.x*Xn.y-Xn.x*Qn.y;_r+=(Qn.x+Xn.x)*Nn,kr+=(Qn.y+Xn.y)*Nn,yr+=3*Nn}return new I(_r/yr,kr/yr,0,ir)}(e),Yt=Ce.length;Ce.length;){var Zt=Ce.pop();(Zt.d>Ct.d||!Ct.d)&&(Ct=Zt,r&&console.log("found best %d after %d probes",Math.round(1e4*Zt.d)/1e4,Yt)),Zt.max-Ct.d<=t||(Ce.push(new I(Zt.p.x-(_e=Zt.h/2),Zt.p.y-_e,_e,e)),Ce.push(new I(Zt.p.x+_e,Zt.p.y-_e,_e,e)),Ce.push(new I(Zt.p.x-_e,Zt.p.y+_e,_e,e)),Ce.push(new I(Zt.p.x+_e,Zt.p.y+_e,_e,e)),Yt+=4)}return r&&(console.log("num probes: "+Yt),console.log("best distance: "+Ct.d)),Ct.p}function j(e,t){return t.max-e.max}function I(e,t,r,u){this.p=new ee(e,t),this.h=r,this.d=function(f,v){for(var S=!1,P=1/0,V=0;V<v.length;V++)for(var te=v[V],he=0,_e=te.length,Ce=_e-1;he<_e;Ce=he++){var lt=te[he],Pt=te[Ce];lt.y>f.y!=Pt.y>f.y&&f.x<(Pt.x-lt.x)*(f.y-lt.y)/(Pt.y-lt.y)+lt.x&&(S=!S),P=Math.min(P,Xu(f,lt,Pt))}return(S?1:-1)*Math.sqrt(P)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}c.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},c.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},c.prototype.peek=function(){return this.data[0]},c.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var f=e-1>>1,v=t[f];if(r(u,v)>=0)break;t[e]=v,e=f}t[e]=u},c.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,f=t[e];e<u;){var v=1+(e<<1),S=t[v],P=v+1;if(P<this.length&&r(t[P],S)<0&&(v=P,S=t[P]),r(S,f)>=0)break;t[e]=S,e=v}t[e]=f};var k=Number.POSITIVE_INFINITY;function X(e,t){return t[1]!==k?function(r,u,f){var v=0,S=0;switch(u=Math.abs(u),f=Math.abs(f),r){case"top-right":case"top-left":case"top":S=f-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-f}switch(r){case"top-right":case"bottom-right":case"right":v=-u;break;case"top-left":case"bottom-left":case"left":v=u}return[v,S]}(e,t[0],t[1]):function(r,u){var f=0,v=0;u<0&&(u=0);var S=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":v=S-7;break;case"bottom-right":case"bottom-left":v=7-S;break;case"bottom":v=7-u;break;case"top":v=u-7}switch(r){case"top-right":case"bottom-right":f=-S;break;case"top-left":case"bottom-left":f=S;break;case"left":f=u;break;case"right":f=-u}return[f,v]}(e,t[0])}function ae(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Je(e,t,r,u,f,v,S,P,V,te,he,_e,Ce,lt,Pt){var Ct=function(_r,kr,Dr,pn,fn,Rn,Qn,Xn){for(var Nn=pn.layout.get("text-rotate").evaluate(Rn,{})*Math.PI/180,Ea=[],ca=0,ra=kr.positionedLines;ca<ra.length;ca+=1)for(var $a=ra[ca],Na=0,ki=$a.positionedGlyphs;Na<ki.length;Na+=1){var ma=ki[Na];if(ma.rect){var ri=ma.rect||{},Fo=4,mi=!0,zo=1,Uo=0,ts=(fn||Xn)&&ma.vertical,bu=ma.metrics.advance*ma.scale/2;if(Xn&&kr.verticalizable&&(Uo=$a.lineOffset/2-(ma.imageName?-(24-ma.metrics.width*ma.scale)/2:24*(ma.scale-1))),ma.imageName){var rs=Qn[ma.imageName];mi=rs.sdf,Fo=1/(zo=rs.pixelRatio)}var $u=fn?[ma.x+bu,ma.y]:[0,0],su=fn?[0,0]:[ma.x+bu+Dr[0],ma.y+Dr[1]-Uo],Ju=[0,0];ts&&(Ju=su,su=[0,0]);var uu=(ma.metrics.left-Fo)*ma.scale-bu+su[0],Zs=(-ma.metrics.top-Fo)*ma.scale+su[1],lu=uu+ri.w*ma.scale/zo,hi=Zs+ri.h*ma.scale/zo,ni=new ee(uu,Zs),Ji=new ee(lu,Zs),fo=new ee(uu,hi),xu=new ee(lu,hi);if(ts){var bo=new ee(-bu,bu- -17),Bo=-Math.PI/2,Nu=12-bu,li=new ee(22-Nu,-(ma.imageName?Nu:0)),Xf=new(Function.prototype.bind.apply(ee,[null].concat(Ju)));ni._rotateAround(Bo,bo)._add(li)._add(Xf),Ji._rotateAround(Bo,bo)._add(li)._add(Xf),fo._rotateAround(Bo,bo)._add(li)._add(Xf),xu._rotateAround(Bo,bo)._add(li)._add(Xf)}if(Nn){var Xc=Math.sin(Nn),hf=Math.cos(Nn),mc=[hf,-Xc,Xc,hf];ni._matMult(mc),Ji._matMult(mc),fo._matMult(mc),xu._matMult(mc)}var ku=new ee(0,0),Lf=new ee(0,0);Ea.push({tl:ni,tr:Ji,bl:fo,br:xu,tex:ri,writingMode:kr.writingMode,glyphOffset:$u,sectionIndex:ma.sectionIndex,isSDF:mi,pixelOffsetTL:ku,pixelOffsetBR:Lf,minFontScaleX:0,minFontScaleY:0})}}return Ea}(0,r,P,f,v,S,u,e.allowVerticalPlacement),Yt=e.textSizeData,Zt=null;Yt.kind==="source"?(Zt=[128*f.layout.get("text-size").evaluate(S,{})])[0]>32640&&we(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Yt.kind==="composite"&&((Zt=[128*lt.compositeTextSizes[0].evaluate(S,{},Pt),128*lt.compositeTextSizes[1].evaluate(S,{},Pt)])[0]>32640||Zt[1]>32640)&&we(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Ct,Zt,P,v,S,te,t,V.lineStartIndex,V.lineLength,Ce,Pt);for(var ir=0,yr=he;ir<yr.length;ir+=1)_e[yr[ir]]=e.text.placedSymbolArray.length-1;return 4*Ct.length}function Ne(e){for(var t in e)return e[t];return null}function Me(e,t,r,u){var f=e.compareText;if(t in f){for(var v=f[t],S=v.length-1;S>=0;S--)if(u.dist(v[S])<r)return!0}else f[t]=[];return f[t].push(u),!1}var mt=So.VectorTileFeature.types,ke=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ct(e,t,r,u,f,v,S,P,V,te,he,_e,Ce){var lt=P?Math.min(32640,Math.round(P[0])):0,Pt=P?Math.min(32640,Math.round(P[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*f),v,S,(lt<<1)+(V?1:0),Pt,16*te,16*he,256*_e,256*Ce)}function Be(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function It(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Fl(r[t].text))return!0;return!1}var $t=function(t){this.layoutVertexArray=new xf,this.indexArray=new Cl,this.programConfigurations=t,this.segments=new rt,this.dynamicLayoutVertexArray=new Bl,this.opacityVertexArray=new Vl,this.placedSymbolArray=new l};$t.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},$t.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Sf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Uf.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ke,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},$t.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},In("SymbolBuffers",$t);var ar=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new rt,this.collisionVertexArray=new Vc};ar.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Bf.members,!0)},ar.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},In("CollisionBuffers",ar);var tr=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(S){return S.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=No([]),this.placementViewportMatrix=No([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mi(this.zoom,r["text-size"]),this.iconSizeData=Mi(this.zoom,r["icon-size"]);var u=this.layers[0].layout,f=u.get("symbol-sort-key"),v=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(S){return aa[S]})),this.stateDependentLayerIds=this.layers.filter(function(S){return S.isStateDependent()}).map(function(S){return S.id}),this.sourceID=t.sourceID};tr.prototype.createArrays=function(){this.text=new $t(new La(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new $t(new La(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new L,this.lineVertexArray=new F,this.symbolInstances=new w},tr.prototype.calculateGlyphDependencies=function(e,t,r,u,f){for(var v=0;v<e.length;v++)if(t[e.charCodeAt(v)]=!0,(r||u)&&f){var S=Zl[e.charAt(v)];S&&(t[S.charCodeAt(0)]=!0)}},tr.prototype.populate=function(e,t,r){var u=this.layers[0],f=u.layout,v=f.get("text-font"),S=f.get("text-field"),P=f.get("icon-image"),V=(S.value.kind!=="constant"||S.value.value instanceof Xi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),te=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,he=f.get("symbol-sort-key");if(this.features=[],V||te){for(var _e=t.iconDependencies,Ce=t.glyphDependencies,lt=t.availableImages,Pt=new Pa(this.zoom),Ct=0,Yt=e;Ct<Yt.length;Ct+=1){var Zt=Yt[Ct],ir=Zt.feature,yr=Zt.id,_r=Zt.index,kr=Zt.sourceLayerIndex,Dr=u._featureFilter.needGeometry,pn=Ui(ir,Dr);if(u._featureFilter.filter(Pt,pn,r)){Dr||(pn.geometry=gi(ir));var fn=void 0;if(V){var Rn=u.getValueAndResolveTokens("text-field",pn,r,lt),Qn=Xi.factory(Rn);It(Qn)&&(this.hasRTLText=!0),(!this.hasRTLText||Uc()==="unavailable"||this.hasRTLText&&ss.isParsed())&&(fn=Pf(Qn,u,pn))}var Xn=void 0;if(te){var Nn=u.getValueAndResolveTokens("icon-image",pn,r,lt);Xn=Nn instanceof Vo?Nn:Vo.fromString(Nn)}if(fn||Xn){var Ea=this.sortFeaturesByKey?he.evaluate(pn,{},r):void 0;if(this.features.push({id:yr,text:fn,icon:Xn,index:_r,sourceLayerIndex:kr,geometry:pn.geometry,properties:ir.properties,type:mt[ir.type],sortKey:Ea}),Xn&&(_e[Xn.name]=!0),fn){var ca=v.evaluate(pn,{},r).join(","),ra=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(aa.vertical)>=0;for(var $a=0,Na=fn.sections;$a<Na.length;$a+=1){var ki=Na[$a];if(ki.image)_e[ki.image.name]=!0;else{var ma=Ec(fn.toString()),ri=ki.fontStack||ca,Fo=Ce[ri]=Ce[ri]||{};this.calculateGlyphDependencies(ki.text,Fo,ra,this.allowVerticalPlacement,ma)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(mi){var zo={},Uo={},ts=[],bu=0;function rs(bo){ts.push(mi[bo]),bu++}function $u(bo,Bo,Nu){var li=Uo[bo];return delete Uo[bo],Uo[Bo]=li,ts[li].geometry[0].pop(),ts[li].geometry[0]=ts[li].geometry[0].concat(Nu[0]),li}function su(bo,Bo,Nu){var li=zo[Bo];return delete zo[Bo],zo[bo]=li,ts[li].geometry[0].shift(),ts[li].geometry[0]=Nu[0].concat(ts[li].geometry[0]),li}function Ju(bo,Bo,Nu){var li=Nu?Bo[0][Bo[0].length-1]:Bo[0][0];return bo+":"+li.x+":"+li.y}for(var uu=0;uu<mi.length;uu++){var Zs=mi[uu],lu=Zs.geometry,hi=Zs.text?Zs.text.toString():null;if(hi){var ni=Ju(hi,lu),Ji=Ju(hi,lu,!0);if(ni in Uo&&Ji in zo&&Uo[ni]!==zo[Ji]){var fo=su(ni,Ji,lu),xu=$u(ni,Ji,ts[fo].geometry);delete zo[ni],delete Uo[Ji],Uo[Ju(hi,ts[xu].geometry,!0)]=xu,ts[fo].geometry=null}else ni in Uo?$u(ni,Ji,lu):Ji in zo?su(ni,Ji,lu):(rs(uu),zo[ni]=bu-1,Uo[Ji]=bu-1)}else rs(uu)}return ts.filter(function(bo){return bo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(mi,zo){return mi.sortKey-zo.sortKey})}},tr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},tr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},tr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},tr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},tr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},tr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},tr.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),v={},S=e.segment+1;S<t.length;S++)v[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:u},S<t.length-1&&(u+=t[S+1].dist(t[S]));for(var P=e.segment||0;P>=0;P--)v[P]={x:t[P].x,y:t[P].y,tileUnitDistanceFromAnchor:f},P>0&&(f+=t[P-1].dist(t[P]));for(var V=0;V<t.length;V++){var te=v[V];this.lineVertexArray.emplaceBack(te.x,te.y,te.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},tr.prototype.addSymbols=function(e,t,r,u,f,v,S,P,V,te,he,_e){for(var Ce=e.indexArray,lt=e.layoutVertexArray,Pt=e.segments.prepareSegment(4*t.length,lt,Ce,this.canOverlap?v.sortKey:void 0),Ct=this.glyphOffsetArray.length,Yt=Pt.vertexLength,Zt=this.allowVerticalPlacement&&S===aa.vertical?Math.PI/2:0,ir=v.text&&v.text.sections,yr=0;yr<t.length;yr++){var _r=t[yr],kr=_r.tl,Dr=_r.tr,pn=_r.bl,fn=_r.br,Rn=_r.tex,Qn=_r.pixelOffsetTL,Xn=_r.pixelOffsetBR,Nn=_r.minFontScaleX,Ea=_r.minFontScaleY,ca=_r.glyphOffset,ra=_r.isSDF,$a=_r.sectionIndex,Na=Pt.vertexLength,ki=ca[1];ct(lt,P.x,P.y,kr.x,ki+kr.y,Rn.x,Rn.y,r,ra,Qn.x,Qn.y,Nn,Ea),ct(lt,P.x,P.y,Dr.x,ki+Dr.y,Rn.x+Rn.w,Rn.y,r,ra,Xn.x,Qn.y,Nn,Ea),ct(lt,P.x,P.y,pn.x,ki+pn.y,Rn.x,Rn.y+Rn.h,r,ra,Qn.x,Xn.y,Nn,Ea),ct(lt,P.x,P.y,fn.x,ki+fn.y,Rn.x+Rn.w,Rn.y+Rn.h,r,ra,Xn.x,Xn.y,Nn,Ea),Be(e.dynamicLayoutVertexArray,P,Zt),Ce.emplaceBack(Na,Na+1,Na+2),Ce.emplaceBack(Na+1,Na+2,Na+3),Pt.vertexLength+=4,Pt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ca[0]),yr!==t.length-1&&$a===t[yr+1].sectionIndex||e.programConfigurations.populatePaintArrays(lt.length,v,v.index,{},_e,ir&&ir[$a])}e.placedSymbolArray.emplaceBack(P.x,P.y,Ct,this.glyphOffsetArray.length-Ct,Yt,V,te,P.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],S,0,!1,0,he)},tr.prototype._addCollisionDebugVertex=function(e,t,r,u,f,v){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,f,Math.round(v.x),Math.round(v.y))},tr.prototype.addCollisionDebugVertices=function(e,t,r,u,f,v,S){var P=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),V=P.vertexLength,te=f.layoutVertexArray,he=f.collisionVertexArray,_e=S.anchorX,Ce=S.anchorY;this._addCollisionDebugVertex(te,he,v,_e,Ce,new ee(e,t)),this._addCollisionDebugVertex(te,he,v,_e,Ce,new ee(r,t)),this._addCollisionDebugVertex(te,he,v,_e,Ce,new ee(r,u)),this._addCollisionDebugVertex(te,he,v,_e,Ce,new ee(e,u)),P.vertexLength+=4;var lt=f.indexArray;lt.emplaceBack(V,V+1),lt.emplaceBack(V+1,V+2),lt.emplaceBack(V+2,V+3),lt.emplaceBack(V+3,V),P.primitiveLength+=4},tr.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var f=e;f<t;f++){var v=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,u?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,r)}},tr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ar(ls,ch.members,ac),this.iconCollisionBox=new ar(ls,ch.members,ac);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},tr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,f,v,S,P,V){for(var te={},he=t;he<r;he++){var _e=e.get(he);te.textBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},te.textFeatureIndex=_e.featureIndex;break}for(var Ce=u;Ce<f;Ce++){var lt=e.get(Ce);te.verticalTextBox={x1:lt.x1,y1:lt.y1,x2:lt.x2,y2:lt.y2,anchorPointX:lt.anchorPointX,anchorPointY:lt.anchorPointY},te.verticalTextFeatureIndex=lt.featureIndex;break}for(var Pt=v;Pt<S;Pt++){var Ct=e.get(Pt);te.iconBox={x1:Ct.x1,y1:Ct.y1,x2:Ct.x2,y2:Ct.y2,anchorPointX:Ct.anchorPointX,anchorPointY:Ct.anchorPointY},te.iconFeatureIndex=Ct.featureIndex;break}for(var Yt=P;Yt<V;Yt++){var Zt=e.get(Yt);te.verticalIconBox={x1:Zt.x1,y1:Zt.y1,x2:Zt.x2,y2:Zt.y2,anchorPointX:Zt.anchorPointX,anchorPointY:Zt.anchorPointY},te.verticalIconFeatureIndex=Zt.featureIndex;break}return te},tr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},tr.prototype.hasTextData=function(){return this.text.segments.get().length>0},tr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},tr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},tr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},tr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},tr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},tr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],f=[],v=[],S=0;S<this.symbolInstances.length;++S){v.push(S);var P=this.symbolInstances.get(S);u.push(0|Math.round(t*P.anchorX+r*P.anchorY)),f.push(P.featureIndex)}return v.sort(function(V,te){return u[V]-u[te]||f[te]-f[V]}),v},tr.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},tr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var f=this.symbolInstances.get(u[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(v,S,P){v>=0&&P.indexOf(v)===S&&t.addIndicesForPlacedSymbol(t.text,v)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},In("SymbolBucket",tr,{omit:["layers","collisionBoxArray","features","compareText"]}),tr.MAX_GLYPHS=65535,tr.addDynamicAttributes=Be;var pr=new vo({"symbol-placement":new Jn(Xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Jn(Xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jn(Xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jn(Xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jn(Xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Jn(Xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jn(Xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jn(Xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jn(Xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new jn(Xe.layout_symbol["icon-size"]),"icon-text-fit":new Jn(Xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jn(Xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new jn(Xe.layout_symbol["icon-image"]),"icon-rotate":new jn(Xe.layout_symbol["icon-rotate"]),"icon-padding":new Jn(Xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Jn(Xe.layout_symbol["icon-keep-upright"]),"icon-offset":new jn(Xe.layout_symbol["icon-offset"]),"icon-anchor":new jn(Xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jn(Xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jn(Xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jn(Xe.layout_symbol["text-rotation-alignment"]),"text-field":new jn(Xe.layout_symbol["text-field"]),"text-font":new jn(Xe.layout_symbol["text-font"]),"text-size":new jn(Xe.layout_symbol["text-size"]),"text-max-width":new jn(Xe.layout_symbol["text-max-width"]),"text-line-height":new Jn(Xe.layout_symbol["text-line-height"]),"text-letter-spacing":new jn(Xe.layout_symbol["text-letter-spacing"]),"text-justify":new jn(Xe.layout_symbol["text-justify"]),"text-radial-offset":new jn(Xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jn(Xe.layout_symbol["text-variable-anchor"]),"text-anchor":new jn(Xe.layout_symbol["text-anchor"]),"text-max-angle":new Jn(Xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Jn(Xe.layout_symbol["text-writing-mode"]),"text-rotate":new jn(Xe.layout_symbol["text-rotate"]),"text-padding":new Jn(Xe.layout_symbol["text-padding"]),"text-keep-upright":new Jn(Xe.layout_symbol["text-keep-upright"]),"text-transform":new jn(Xe.layout_symbol["text-transform"]),"text-offset":new jn(Xe.layout_symbol["text-offset"]),"text-allow-overlap":new Jn(Xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jn(Xe.layout_symbol["text-ignore-placement"]),"text-optional":new Jn(Xe.layout_symbol["text-optional"])}),wr={paint:new vo({"icon-opacity":new jn(Xe.paint_symbol["icon-opacity"]),"icon-color":new jn(Xe.paint_symbol["icon-color"]),"icon-halo-color":new jn(Xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new jn(Xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jn(Xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Jn(Xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jn(Xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new jn(Xe.paint_symbol["text-opacity"]),"text-color":new jn(Xe.paint_symbol["text-color"],{runtimeType:xn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new jn(Xe.paint_symbol["text-halo-color"]),"text-halo-width":new jn(Xe.paint_symbol["text-halo-width"]),"text-halo-blur":new jn(Xe.paint_symbol["text-halo-blur"]),"text-translate":new Jn(Xe.paint_symbol["text-translate"]),"text-translate-anchor":new Jn(Xe.paint_symbol["text-translate-anchor"])}),layout:pr},$r=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ln,this.defaultValue=t};$r.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},$r.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},$r.prototype.outputDefined=function(){return!1},$r.prototype.serialize=function(){return null},In("FormatSectionOverride",$r,{omit:["defaultValue"]});var Cn=function(e){function t(r){e.call(this,r,wr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var v=[],S=0,P=f;S<P.length;S+=1){var V=P[S];v.indexOf(V)<0&&v.push(V)}this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,f,v){var S=this.layout.get(r).evaluate(u,{},f,v),P=this._unevaluatedLayout._values[r];return P.isDataDriven()||Po(P.value)||!S?S:function(V,te){return te.replace(/{([^{}]+)}/g,function(he,_e){return _e in V?String(V[_e]):""})}(u.properties,S)},t.prototype.createBucket=function(r){return new tr(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=wr.paint.overridableProperties;r<u.length;r+=1){var f=u[r];if(t.hasPaintOverride(this.layout,f)){var v,S=this.paint.get(f),P=new $r(S),V=new xl(P,S.property.specification);v=S.value.kind==="constant"||S.value.kind==="source"?new Rl("source",V):new Il("composite",V,S.value.zoomStops,S.value._interpolationType),this.paint._values[f]=new _s(S.property,v,S.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var f=r.get("text-field"),v=wr.paint.properties[u],S=!1,P=function(_e){for(var Ce=0,lt=_e;Ce<lt.length;Ce+=1)if(v.overrides&&v.overrides.hasOverride(lt[Ce]))return void(S=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Xi)P(f.value.value.sections);else if(f.value.kind==="source"){var V=function he(_e){S||(_e instanceof oi&&Ai(_e.value)===Va?P(_e.value.sections):_e instanceof oo?P(_e.sections):_e.eachChild(he))},te=f.value;te._styleExpression&&V(te._styleExpression.expression)}return S},t}(Ss),un={paint:new vo({"background-color":new Jn(Xe.paint_background["background-color"]),"background-pattern":new us(Xe.paint_background["background-pattern"]),"background-opacity":new Jn(Xe.paint_background["background-opacity"])})},_n=function(e){function t(r){e.call(this,r,un)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ss),Kn={paint:new vo({"raster-opacity":new Jn(Xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Jn(Xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jn(Xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jn(Xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Jn(Xe.paint_raster["raster-saturation"]),"raster-contrast":new Jn(Xe.paint_raster["raster-contrast"]),"raster-resampling":new Jn(Xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Jn(Xe.paint_raster["raster-fade-duration"])})},ka=function(e){function t(r){e.call(this,r,Kn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ss),Ei=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(Ss),Pi={circle:nu,heatmap:sf,hillshade:wf,fill:Ir,"fill-extrusion":bi,line:Th,symbol:Cn,background:_n,raster:ka},Du=K.HTMLImageElement,ou=K.HTMLCanvasElement,Xl=K.HTMLVideoElement,Ds=K.ImageData,Ns=K.ImageBitmap,Yl=function(t,r,u,f){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,f)};Yl.prototype.update=function(e,t,r){var u=e.width,f=e.height,v=!(this.size&&this.size[0]===u&&this.size[1]===f||r),S=this.context,P=S.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!t||t.premultiply!==!1)),v)this.size=[u,f],e instanceof Du||e instanceof ou||e instanceof Xl||e instanceof Ds||Ns&&e instanceof Ns?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,u,f,0,this.format,P.UNSIGNED_BYTE,e.data);else{var V=r||{x:0,y:0},te=V.x,he=V.y;e instanceof Du||e instanceof ou||e instanceof Xl||e instanceof Ds||Ns&&e instanceof Ns?P.texSubImage2D(P.TEXTURE_2D,0,te,he,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,te,he,u,f,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},Yl.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},Yl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Yl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var dc=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};dc.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},dc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var yu=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},At(["receive","process"],this),this.invoker=new dc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qt()?t:K};function Mc(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}yu.prototype.send=function(e,t,r,u,f){var v=this;f===void 0&&(f=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[S]=r);var P=J(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:e,hasCallback:!!r,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:du(t,P)},P),{cancel:function(){r&&delete v.callbacks[S],v.target.postMessage({id:S,type:"<cancel>",targetMapId:u,sourceMapId:v.mapId})}}},yu.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else Qt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},yu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},yu.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Us(t.error)):u(null,Us(t.data)))}else{var f=!1,v=J(this.globalScope)?void 0:[],S=t.hasCallback?function(he,_e){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:he?du(he):null,data:du(_e,v)},v)}:function(he){f=!0},P=null,V=Us(t.data);if(this.parent[t.type])P=this.parent[t.type](t.sourceMapId,V,S);else if(this.parent.getWorkerSource){var te=t.type.split(".");P=this.parent.getWorkerSource(t.sourceMapId,te[0],V.source)[te[1]](V,S)}else S(new Error("Could not find function "+t.type));!f&&P&&P.cancel&&(this.cancelCallbacks[e]=P.cancel)}},yu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Co=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Co.prototype.setNorthEast=function(e){return this._ne=e instanceof _a?new _a(e.lng,e.lat):_a.convert(e),this},Co.prototype.setSouthWest=function(e){return this._sw=e instanceof _a?new _a(e.lng,e.lat):_a.convert(e),this},Co.prototype.extend=function(e){var t,r,u=this._sw,f=this._ne;if(e instanceof _a)t=e,r=e;else{if(!(e instanceof Co))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Co.convert(e)):this.extend(_a.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new _a(t.lng,t.lat),this._ne=new _a(r.lng,r.lat)),this},Co.prototype.getCenter=function(){return new _a((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Co.prototype.getSouthWest=function(){return this._sw},Co.prototype.getNorthEast=function(){return this._ne},Co.prototype.getNorthWest=function(){return new _a(this.getWest(),this.getNorth())},Co.prototype.getSouthEast=function(){return new _a(this.getEast(),this.getSouth())},Co.prototype.getWest=function(){return this._sw.lng},Co.prototype.getSouth=function(){return this._sw.lat},Co.prototype.getEast=function(){return this._ne.lng},Co.prototype.getNorth=function(){return this._ne.lat},Co.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Co.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Co.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Co.prototype.contains=function(e){var t=_a.convert(e),r=t.lng,u=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},Co.convert=function(e){return!e||e instanceof Co?e:new Co(e)};var _a=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};_a.prototype.wrap=function(){return new _a(ht(this.lng,-180,180),this.lat)},_a.prototype.toArray=function(){return[this.lng,this.lat]},_a.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},_a.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,f=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},_a.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Co(new _a(this.lng-r,this.lat-t),new _a(this.lng+r,this.lat+t))},_a.convert=function(e){if(e instanceof _a)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new _a(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new _a(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ol=2*Math.PI*63710088e-1;function nh(e){return Ol*Math.cos(e*Math.PI/180)}function fh(e){return(180+e)/360}function Nh(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function pc(e,t){return e/nh(t)}function Gf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ah=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};ah.fromLngLat=function(e,t){t===void 0&&(t=0);var r=_a.convert(e);return new ah(fh(r.lng),Nh(r.lat),pc(t,r.lat))},ah.prototype.toLngLat=function(){return new _a(360*this.x-180,Gf(this.y))},ah.prototype.toAltitude=function(){return this.z*nh(Gf(this.y))},ah.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ol*(e=Gf(this.y),1/Math.cos(e*Math.PI/180));var e};var hh=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=kh(0,t,t,r,u)};hh.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},hh.prototype.url=function(e,t){var r,u,f,v,S,P=(u=this.y,f=this.z,v=Mc(256*(r=this.x),256*(u=Math.pow(2,f)-u-1),f),S=Mc(256*(r+1),256*(u+1),f),v[0]+","+v[1]+","+S[0]+","+S[1]),V=function(te,he,_e){for(var Ce,lt="",Pt=te;Pt>0;Pt--)lt+=(he&(Ce=1<<Pt-1)?1:0)+(_e&Ce?2:0);return lt}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",V).replace("{bbox-epsg-3857}",P)},hh.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new ee(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},hh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qh=function(t,r){this.wrap=t,this.canonical=r,this.key=kh(t,r.z,r.z,r.x,r.y)},Ws=function(t,r,u,f,v){this.overscaledZ=t,this.wrap=r,this.canonical=new hh(u,+f,+v),this.key=kh(r,t,u,f,v)};function kh(e,t,r,u,f){(e*=2)<0&&(e=-1*e-1);var v=1<<r;return(v*v*e+v*f+u).toString(36)+r.toString(36)+t.toString(36)}Ws.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Ws.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Ws(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ws(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Ws.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?kh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):kh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Ws.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Ws.prototype.children=function(e){if(this.overscaledZ>=e)return[new Ws(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new Ws(t,this.wrap,t,r,u),new Ws(t,this.wrap,t,r+1,u),new Ws(t,this.wrap,t,r,u+1),new Ws(t,this.wrap,t,r+1,u+1)]},Ws.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Ws.prototype.wrapped=function(){return new Ws(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ws.prototype.unwrapTo=function(e){return new Ws(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Ws.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ws.prototype.toUnwrapped=function(){return new qh(this.wrap,this.canonical)},Ws.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ws.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ah(e.x-this.wrap,e.y))},In("CanonicalTileID",hh),In("OverscaledTileID",Ws,{omit:["posMatrix"]});var Hf=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return we('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var v=0;v<f;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(f,v)]=this.data[this._idx(f-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,f)]=this.data[this._idx(v,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};Hf.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},Hf.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hf.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Hf.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Hf.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Hf.prototype.getPixels=function(){return new go({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hf.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,v=r*this.dim,S=r*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(r){case-1:v=S-1;break;case 1:S=v+1}for(var P=-t*this.dim,V=-r*this.dim,te=v;te<S;te++)for(var he=u;he<f;he++)this.data[this._idx(he,te)]=e.data[this._idx(he+P,te+V)]},In("DEMData",Hf);var Gh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};Gh.prototype.encode=function(e){return this._stringToNumber[e]},Gh.prototype.decode=function(e){return this._numberToString[e]};var Hh=function(t,r,u,f,v){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=f,this.properties=t.properties,this.id=v},ed={geometry:{configurable:!0}};ed.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ed.geometry.set=function(e){this._geometry=e},Hh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Hh.prototype,ed);var _h=function(){this.state={},this.stateChanges={},this.deletedStates={}};_h.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Le(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var v in this.deletedStates[e][u]={},this.state[e][u])r[v]||(this.deletedStates[e][u][v]=null);else for(var S in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][S]===null&&delete this.deletedStates[e][u][S]},_h.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},_h.prototype.getState=function(e,t){var r=String(t),u=Le({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var v in f)delete u[v]}return u},_h.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},_h.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var v in this.stateChanges[u])this.state[u][v]||(this.state[u][v]={}),Le(this.state[u][v],this.stateChanges[u][v]),f[v]=this.state[u][v];r[u]=f}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var P={};if(this.deletedStates[S]===null)for(var V in this.state[S])P[V]={},this.state[S][V]={};else for(var te in this.deletedStates[S]){if(this.deletedStates[S][te]===null)this.state[S][te]={};else for(var he=0,_e=Object.keys(this.deletedStates[S][te]);he<_e.length;he+=1)delete this.state[S][te][_e[he]];P[te]=this.state[S][te]}r[S]=r[S]||{},Le(r[S],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Ce in e)e[Ce].setFeatureState(r,t)};var Wf=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ul(8192,16,0),this.grid3D=new ul(8192,16,0),this.featureIndexArray=new Ee,this.promoteId=r};function td(e,t,r,u,f){return De(e,function(v,S){var P=t instanceof Tc?t.get(S):null;return P&&P.evaluate?P.evaluate(r,u,f):P})}function rd(e){for(var t=1/0,r=1/0,u=-1/0,f=-1/0,v=0,S=e;v<S.length;v+=1){var P=S[v];t=Math.min(t,P.x),r=Math.min(r,P.y),u=Math.max(u,P.x),f=Math.max(f,P.y)}return{minX:t,minY:r,maxX:u,maxY:f}}function ld(e,t){return t-e}Wf.prototype.insert=function(e,t,r,u,f,v){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,f);for(var P=v?this.grid3D:this.grid,V=0;V<t.length;V++){for(var te=t[V],he=[1/0,1/0,-1/0,-1/0],_e=0;_e<te.length;_e++){var Ce=te[_e];he[0]=Math.min(he[0],Ce.x),he[1]=Math.min(he[1],Ce.y),he[2]=Math.max(he[2],Ce.x),he[3]=Math.max(he[3],Ce.y)}he[0]<8192&&he[1]<8192&&he[2]>=0&&he[3]>=0&&P.insert(S,he[0],he[1],he[2],he[3])}},Wf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new So.VectorTile(new Fe(this.rawTileData)).layers,this.sourceLayerCoder=new Gh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Wf.prototype.query=function(e,t,r,u){var f=this;this.loadVTLayers();for(var v=e.params||{},S=8192/e.tileSize/e.scale,P=bc(v.filter),V=e.queryGeometry,te=e.queryPadding*S,he=rd(V),_e=this.grid.query(he.minX-te,he.minY-te,he.maxX+te,he.maxY+te),Ce=rd(e.cameraQueryGeometry),lt=this.grid3D.query(Ce.minX-te,Ce.minY-te,Ce.maxX+te,Ce.maxY+te,function(_r,kr,Dr,pn){return function(fn,Rn,Qn,Xn,Nn){for(var Ea=0,ca=fn;Ea<ca.length;Ea+=1){var ra=ca[Ea];if(Rn<=ra.x&&Qn<=ra.y&&Xn>=ra.x&&Nn>=ra.y)return!0}var $a=[new ee(Rn,Qn),new ee(Rn,Nn),new ee(Xn,Nn),new ee(Xn,Qn)];if(fn.length>2){for(var Na=0,ki=$a;Na<ki.length;Na+=1)if(ru(fn,ki[Na]))return!0}for(var ma=0;ma<fn.length-1;ma++)if(Lu(fn[ma],fn[ma+1],$a))return!0;return!1}(e.cameraQueryGeometry,_r-te,kr-te,Dr+te,pn+te)}),Pt=0,Ct=lt;Pt<Ct.length;Pt+=1)_e.push(Ct[Pt]);_e.sort(ld);for(var Yt,Zt={},ir=function(kr){var Dr=_e[kr];if(Dr!==Yt){Yt=Dr;var pn=f.featureIndexArray.get(Dr),fn=null;f.loadMatchingFeature(Zt,pn.bucketIndex,pn.sourceLayerIndex,pn.featureIndex,P,v.layers,v.availableImages,t,r,u,function(Rn,Qn,Xn){return fn||(fn=gi(Rn)),Qn.queryIntersectsFeature(V,Rn,Xn,fn,f.z,e.transform,S,e.pixelPosMatrix)})}},yr=0;yr<_e.length;yr++)ir(yr);return Zt},Wf.prototype.loadMatchingFeature=function(e,t,r,u,f,v,S,P,V,te,he){var _e=this.bucketLayerIDs[t];if(!v||function(fn,Rn){for(var Qn=0;Qn<fn.length;Qn++)if(Rn.indexOf(fn[Qn])>=0)return!0;return!1}(v,_e)){var Ce=this.sourceLayerCoder.decode(r),lt=this.vtLayers[Ce].feature(u);if(f.needGeometry){var Pt=Ui(lt,!0);if(!f.filter(new Pa(this.tileID.overscaledZ),Pt,this.tileID.canonical))return}else if(!f.filter(new Pa(this.tileID.overscaledZ),lt))return;for(var Ct=this.getId(lt,Ce),Yt=0;Yt<_e.length;Yt++){var Zt=_e[Yt];if(!(v&&v.indexOf(Zt)<0)){var ir=P[Zt];if(ir){var yr={};Ct!==void 0&&te&&(yr=te.getState(ir.sourceLayer||"_geojsonTileLayer",Ct));var _r=Le({},V[Zt]);_r.paint=td(_r.paint,ir.paint,lt,yr,S),_r.layout=td(_r.layout,ir.layout,lt,yr,S);var kr=!he||he(lt,ir,yr);if(kr){var Dr=new Hh(lt,this.z,this.x,this.y,Ct);Dr.layer=_r;var pn=e[Zt];pn===void 0&&(pn=e[Zt]=[]),pn.push({featureIndex:u,feature:Dr,intersectionZ:kr})}}}}}},Wf.prototype.lookupSymbolFeatures=function(e,t,r,u,f,v,S,P){var V={};this.loadVTLayers();for(var te=bc(f),he=0,_e=e;he<_e.length;he+=1)this.loadMatchingFeature(V,r,u,_e[he],te,v,S,P,t);return V},Wf.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,f=r[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},Wf.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},In("FeatureIndex",Wf,{omit:["rawTileData","sourceLayerCoder"]});var vs=function(t,r){this.tileID=t,this.uid=ot(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};vs.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ve.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},vs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},vs.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(te,he){var _e={};if(!he)return _e;for(var Ce=function(){var Yt=Pt[lt],Zt=Yt.layerIds.map(function(_r){return he.getLayer(_r)}).filter(Boolean);if(Zt.length!==0){Yt.layers=Zt,Yt.stateDependentLayerIds&&(Yt.stateDependentLayers=Yt.stateDependentLayerIds.map(function(_r){return Zt.filter(function(kr){return kr.id===_r})[0]}));for(var ir=0,yr=Zt;ir<yr.length;ir+=1)_e[yr[ir].id]=Yt}},lt=0,Pt=te;lt<Pt.length;lt+=1)Ce();return _e}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof tr){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var v in this.buckets){var S=this.buckets[v];if(S instanceof tr&&S.hasRTLText){this.hasRTLText=!0,ss.isLoading()||ss.isLoaded()||Uc()!=="deferred"||Lo();break}}for(var P in this.queryPadding=0,this.buckets){var V=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(P).queryRadius(V))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},vs.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},vs.prototype.getBucket=function(e){return this.buckets[e.id]},vs.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Yl(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Yl(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},vs.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},vs.prototype.queryRenderedFeatures=function(e,t,r,u,f,v,S,P,V,te){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:v,tileSize:this.tileSize,pixelPosMatrix:te,transform:P,params:S,queryPadding:this.queryPadding*V},e,t,r):{}},vs.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),f=t?t.sourceLayer:"",v=u._geojsonTileLayer||u[f];if(v)for(var S=bc(t&&t.filter),P=this.tileID.canonical,V=P.z,te=P.x,he=P.y,_e={z:V,x:te,y:he},Ce=0;Ce<v.length;Ce++){var lt=v.feature(Ce);if(S.needGeometry){var Pt=Ui(lt,!0);if(!S.filter(new Pa(this.tileID.overscaledZ),Pt,this.tileID.canonical))continue}else if(!S.filter(new Pa(this.tileID.overscaledZ),lt))continue;var Ct=r.getId(lt,f),Yt=new Hh(lt,V,te,he,Ct);Yt.tile=_e,e.push(Yt)}}},vs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},vs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},vs.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ur(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var v=this.expirationTime-t;v?this.expirationTime=u+Math.max(v,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},vs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},vs.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],v=f.layers[0].sourceLayer||"_geojsonTileLayer",S=r[v],P=e[v];if(S&&P&&Object.keys(P).length!==0){f.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var V=t&&t.style&&t.style.getLayer(u);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(f)))}}}},vs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},vs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ve.now()},vs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},vs.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ve.now()+e},vs.prototype.setDependencies=function(e,t){for(var r={},u=0,f=t;u<f.length;u+=1)r[f[u]]=!0;this.dependencies[e]=r},vs.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var f=this.dependencies[u[r]];if(f){for(var v=0,S=t;v<S.length;v+=1)if(f[S[v]])return!0}}return!1};var Zf=K.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Zf.mark(this._marks.start)};cd.prototype.finish=function(){Zf.mark(this._marks.end);var e=Zf.getEntriesByName(this._marks.measure);return e.length===0&&(Zf.measure(this._marks.measure,this._marks.start,this._marks.end),e=Zf.getEntriesByName(this._marks.measure),Zf.clearMarks(this._marks.start),Zf.clearMarks(this._marks.end),Zf.clearMeasures(this._marks.measure)),e},i.Actor=yu,i.AlphaImage=Rs,i.CanonicalTileID=hh,i.CollisionBoxArray=a,i.Color=fa,i.DEMData=Hf,i.DataConstantProperty=Jn,i.DictionaryCoder=Gh,i.EXTENT=8192,i.ErrorEvent=wt,i.EvaluationParameters=Pa,i.Event=ut,i.Evented=Bt,i.FeatureIndex=Wf,i.FillBucket=Xt,i.FillExtrusionBucket=Qa,i.ImageAtlas=Hn,i.ImagePosition=Fr,i.LineBucket=Iu,i.LngLat=_a,i.LngLatBounds=Co,i.MercatorCoordinate=ah,i.ONE_EM=24,i.OverscaledTileID=Ws,i.Point=ee,i.Point$1=ee,i.Properties=vo,i.Protobuf=Fe,i.RGBAImage=go,i.RequestManager=R,i.RequestPerformance=cd,i.ResourceType=Hr,i.SegmentVector=rt,i.SourceFeatureState=_h,i.StructArrayLayout1ui2=ic,i.StructArrayLayout2f1f2i16=Hu,i.StructArrayLayout2i4=mu,i.StructArrayLayout3ui6=Cl,i.StructArrayLayout4i8=hl,i.SymbolBucket=tr,i.Texture=Yl,i.Tile=vs,i.Transitionable=To,i.Uniform1f=rn,i.Uniform1i=Ar,i.Uniform2f=Xr,i.Uniform3f=mn,i.Uniform4f=Ln,i.UniformColor=qn,i.UniformMatrix4f=Sa,i.UnwrappedTileID=qh,i.ValidationError=Lt,i.WritingMode=aa,i.ZoomHistory=ll,i.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},i.addDynamicAttributes=Be,i.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,f=new Array(e.length),v=null;e.forEach(function(S,P){t(S,function(V,te){V&&(v=V),f[P]=te,--u==0&&r(v,f)})})},i.bezier=pe,i.bindAll=At,i.browser=ve,i.cacheEntryPossiblyAdded=function(e){++Ht>Et&&(e.getActor().send("enforceCacheSizeLimit",bt),Ht=0)},i.clamp=Pe,i.clearTileCache=function(e){var t=K.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},i.clipLine=An,i.clone=function(e){var t=new Do(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.clone$1=Ge,i.clone$2=function(e){var t=new Do(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.collisionCircleLayout=Vf,i.config=ge,i.create=function(){var e=new Do(16);return Do!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},i.create$1=function(){var e=new Do(9);return Do!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},i.create$2=function(){var e=new Do(4);return Do!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},i.createCommonjsModule=W,i.createExpression=ql,i.createLayout=no,i.createStyleLayer=function(e){return e.type==="custom"?new Ei(e):new Pi[e.type](e)},i.cross=function(e,t,r){var u=t[0],f=t[1],v=t[2],S=r[0],P=r[1],V=r[2];return e[0]=f*V-v*P,e[1]=v*S-u*V,e[2]=u*P-f*S,e},i.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object")return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},i.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.ease=Ke,i.emitValidationErrors=sl,i.endsWith=St,i.enforceCacheSizeLimit=function(e){ze(),Qe&&Qe.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},i.evaluateSizeForFeature=ms,i.evaluateSizeForZoom=Wo,i.evaluateVariableOffset=X,i.evented=af,i.extend=Le,i.featureFilter=bc,i.filterObject=Ie,i.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.getAnchorAlignment=jo,i.getAnchorJustification=ae,i.getArrayBuffer=Yn,i.getImage=Z,i.getJSON=function(e,t){return $n(Le(e,{type:"json"}),t)},i.getRTLTextPluginStatus=Uc,i.getReferrer=Bn,i.getVideo=function(e,t){var r,u,f=K.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var v=0;v<e.length;v++){var S=K.document.createElement("source");r=e[v],u=void 0,(u=K.document.createElement("a")).href=r,(u.protocol!==K.document.location.protocol||u.host!==K.document.location.host)&&(f.crossOrigin="Anonymous"),S.src=e[v],f.appendChild(S)}return{cancel:function(){}}},i.identity=No,i.invert=function(e,t){var r=t[0],u=t[1],f=t[2],v=t[3],S=t[4],P=t[5],V=t[6],te=t[7],he=t[8],_e=t[9],Ce=t[10],lt=t[11],Pt=t[12],Ct=t[13],Yt=t[14],Zt=t[15],ir=r*P-u*S,yr=r*V-f*S,_r=r*te-v*S,kr=u*V-f*P,Dr=u*te-v*P,pn=f*te-v*V,fn=he*Ct-_e*Pt,Rn=he*Yt-Ce*Pt,Qn=he*Zt-lt*Pt,Xn=_e*Yt-Ce*Ct,Nn=_e*Zt-lt*Ct,Ea=Ce*Zt-lt*Yt,ca=ir*Ea-yr*Nn+_r*Xn+kr*Qn-Dr*Rn+pn*fn;return ca?(e[0]=(P*Ea-V*Nn+te*Xn)*(ca=1/ca),e[1]=(f*Nn-u*Ea-v*Xn)*ca,e[2]=(Ct*pn-Yt*Dr+Zt*kr)*ca,e[3]=(Ce*Dr-_e*pn-lt*kr)*ca,e[4]=(V*Qn-S*Ea-te*Rn)*ca,e[5]=(r*Ea-f*Qn+v*Rn)*ca,e[6]=(Yt*_r-Pt*pn-Zt*yr)*ca,e[7]=(he*pn-Ce*_r+lt*yr)*ca,e[8]=(S*Nn-P*Qn+te*fn)*ca,e[9]=(u*Qn-r*Nn-v*fn)*ca,e[10]=(Pt*Dr-Ct*_r+Zt*ir)*ca,e[11]=(_e*_r-he*Dr-lt*ir)*ca,e[12]=(P*Rn-S*Xn-V*fn)*ca,e[13]=(r*Xn-u*Rn+f*fn)*ca,e[14]=(Ct*yr-Pt*kr-Yt*ir)*ca,e[15]=(he*kr-_e*yr+Ce*ir)*ca,e):null},i.isChar=qr,i.isMapboxURL=q,i.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},i.makeRequest=$n,i.mapObject=De,i.mercatorXfromLng=fh,i.mercatorYfromLat=Nh,i.mercatorZfromAltitude=pc,i.mul=uo,i.multiply=Ho,i.mvt=So,i.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},i.normalize=function(e,t){var r=t[0],u=t[1],f=t[2],v=r*r+u*u+f*f;return v>0&&(v=1/Math.sqrt(v)),e[0]=t[0]*v,e[1]=t[1]*v,e[2]=t[2]*v,e},i.number=Vi,i.offscreenCanvasSupported=hr,i.ortho=function(e,t,r,u,f,v,S){var P=1/(t-r),V=1/(u-f),te=1/(v-S);return e[0]=-2*P,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*V,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*te,e[11]=0,e[12]=(t+r)*P,e[13]=(f+u)*V,e[14]=(S+v)*te,e[15]=1,e},i.parseGlyphPBF=function(e){return new Fe(e).readFields(Rr,[])},i.pbf=Fe,i.performSymbolLayout=function(e,t,r,u,f,v,S){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var P=e.layers[0].layout,V=e.layers[0]._unevaluatedLayout._values,te={};if(e.textSizeData.kind==="composite"){var he=e.textSizeData,_e=he.maxZoom;te.compositeTextSizes=[V["text-size"].possiblyEvaluate(new Pa(he.minZoom),S),V["text-size"].possiblyEvaluate(new Pa(_e),S)]}if(e.iconSizeData.kind==="composite"){var Ce=e.iconSizeData,lt=Ce.maxZoom;te.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new Pa(Ce.minZoom),S),V["icon-size"].possiblyEvaluate(new Pa(lt),S)]}te.layoutTextSize=V["text-size"].possiblyEvaluate(new Pa(e.zoom+1),S),te.layoutIconSize=V["icon-size"].possiblyEvaluate(new Pa(e.zoom+1),S),te.textMaxSize=V["text-size"].possiblyEvaluate(new Pa(18));for(var Pt=24*P.get("text-line-height"),Ct=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",Yt=P.get("text-keep-upright"),Zt=P.get("text-size"),ir=function(){var Dr=_r[yr],pn=P.get("text-font").evaluate(Dr,{},S).join(","),fn=Zt.evaluate(Dr,{},S),Rn=te.layoutTextSize.evaluate(Dr,{},S),Qn=te.layoutIconSize.evaluate(Dr,{},S),Xn={horizontal:{},vertical:void 0},Nn=Dr.text,Ea=[0,0];if(Nn){var ca=Nn.toString(),ra=24*P.get("text-letter-spacing").evaluate(Dr,{},S),$a=function(hi){for(var ni=0,Ji=hi;ni<Ji.length;ni+=1)if(fo=Ji[ni].charCodeAt(0),qr.Arabic(fo)||qr["Arabic Supplement"](fo)||qr["Arabic Extended-A"](fo)||qr["Arabic Presentation Forms-A"](fo)||qr["Arabic Presentation Forms-B"](fo))return!1;var fo;return!0}(ca)?ra:0,Na=P.get("text-anchor").evaluate(Dr,{},S),ki=P.get("text-variable-anchor");if(!ki){var ma=P.get("text-radial-offset").evaluate(Dr,{},S);Ea=ma?X(Na,[24*ma,k]):P.get("text-offset").evaluate(Dr,{},S).map(function(hi){return 24*hi})}var ri=Ct?"center":P.get("text-justify").evaluate(Dr,{},S),Fo=P.get("symbol-placement"),mi=Fo==="point"?24*P.get("text-max-width").evaluate(Dr,{},S):0,zo=function(){e.allowVerticalPlacement&&Ec(ca)&&(Xn.vertical=jr(Nn,t,r,f,pn,mi,Pt,Na,"left",$a,Ea,aa.vertical,!0,Fo,Rn,fn))};if(!Ct&&ki){for(var Uo=ri==="auto"?ki.map(function(hi){return ae(hi)}):[ri],ts=!1,bu=0;bu<Uo.length;bu++){var rs=Uo[bu];if(!Xn.horizontal[rs])if(ts)Xn.horizontal[rs]=Xn.horizontal[0];else{var $u=jr(Nn,t,r,f,pn,mi,Pt,"center",rs,$a,Ea,aa.horizontal,!1,Fo,Rn,fn);$u&&(Xn.horizontal[rs]=$u,ts=$u.positionedLines.length===1)}}zo()}else{ri==="auto"&&(ri=ae(Na));var su=jr(Nn,t,r,f,pn,mi,Pt,Na,ri,$a,Ea,aa.horizontal,!1,Fo,Rn,fn);su&&(Xn.horizontal[ri]=su),zo(),Ec(ca)&&Ct&&Yt&&(Xn.vertical=jr(Nn,t,r,f,pn,mi,Pt,Na,ri,$a,Ea,aa.vertical,!1,Fo,Rn,fn))}}var Ju=void 0,uu=!1;if(Dr.icon&&Dr.icon.name){var Zs=u[Dr.icon.name];Zs&&(Ju=function(hi,ni,Ji){var fo=jo(Ji),xu=ni[0]-hi.displaySize[0]*fo.horizontalAlign,bo=ni[1]-hi.displaySize[1]*fo.verticalAlign;return{image:hi,top:bo,bottom:bo+hi.displaySize[1],left:xu,right:xu+hi.displaySize[0]}}(f[Dr.icon.name],P.get("icon-offset").evaluate(Dr,{},S),P.get("icon-anchor").evaluate(Dr,{},S)),uu=Zs.sdf,e.sdfIcons===void 0?e.sdfIcons=Zs.sdf:e.sdfIcons!==Zs.sdf&&we("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Zs.pixelRatio!==e.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var lu=Ne(Xn.horizontal)||Xn.vertical;e.iconsInText=!!lu&&lu.iconsInText,(lu||Ju)&&function(hi,ni,Ji,fo,xu,bo,Bo,Nu,li,Xf,Xc){var hf=bo.textMaxSize.evaluate(ni,{});hf===void 0&&(hf=Bo);var mc,ku=hi.layers[0].layout,Lf=ku.get("icon-offset").evaluate(ni,{},Xc),Rf=Ne(Ji.horizontal),Yf=Bo/24,Sh=hi.tilePixelRatio*Yf,Af=hi.tilePixelRatio*hf/24,Ah=hi.tilePixelRatio*Nu,Kf=hi.tilePixelRatio*ku.get("symbol-spacing"),dh=ku.get("text-padding")*hi.tilePixelRatio,Wh=ku.get("icon-padding")*hi.tilePixelRatio,jh=ku.get("text-max-angle")/180*Math.PI,Zh=ku.get("text-rotation-alignment")==="map"&&ku.get("symbol-placement")!=="point",ph=ku.get("icon-rotation-alignment")==="map"&&ku.get("symbol-placement")!=="point",Ch=ku.get("symbol-placement"),Xh=Kf/2,mh=ku.get("icon-text-fit");fo&&mh!=="none"&&(hi.allowVerticalPlacement&&Ji.vertical&&(mc=ei(fo,Ji.vertical,mh,ku.get("icon-text-fit-padding"),Lf,Yf)),Rf&&(fo=ei(fo,Rf,mh,ku.get("icon-text-fit-padding"),Lf,Yf)));var $f=function(fd,Rh){Rh.x<0||Rh.x>=8192||Rh.y<0||Rh.y>=8192||function(gs,Yc,hd,Jf,od,h,_,E,b,A,M,B,ie,de,Ve,zt,qt,Or,Nr,bn,gn,Fn,Ta,Ca,Li){var ai,ii,Qi,wa,qi,xo=gs.addToLineVertexArray(Yc,hd),Xs=0,Za=0,As=0,Yo=0,df=-1,Ih=-1,Pc={},xh=jt(""),oh=0,Kc=0;if(E._unevaluatedLayout.getValue("text-radial-offset")===void 0?(oh=(ai=E.layout.get("text-offset").evaluate(gn,{},Ca).map(function(_d){return 24*_d}))[0],Kc=ai[1]):(oh=24*E.layout.get("text-radial-offset").evaluate(gn,{},Ca),Kc=k),gs.allowVerticalPlacement&&Jf.vertical){var dd=E.layout.get("text-rotate").evaluate(gn,{},Ca)+90;wa=new d(b,Yc,A,M,B,Jf.vertical,ie,de,Ve,dd),_&&(qi=new d(b,Yc,A,M,B,_,qt,Or,Ve,dd))}if(od){var sd=E.layout.get("icon-rotate").evaluate(gn,{}),pd=E.layout.get("icon-text-fit")!=="none",md=Ra(od,sd,Ta,pd),ud=_?Ra(_,sd,Ta,pd):void 0;Qi=new d(b,Yc,A,M,B,od,qt,Or,!1,sd),Xs=4*md.length;var vd=gs.iconSizeData,Vh=null;vd.kind==="source"?(Vh=[128*E.layout.get("icon-size").evaluate(gn,{})])[0]>32640&&we(gs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):vd.kind==="composite"&&((Vh=[128*Fn.compositeIconSizes[0].evaluate(gn,{},Ca),128*Fn.compositeIconSizes[1].evaluate(gn,{},Ca)])[0]>32640||Vh[1]>32640)&&we(gs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),gs.addSymbols(gs.icon,md,Vh,bn,Nr,gn,!1,Yc,xo.lineStartIndex,xo.lineLength,-1,Ca),df=gs.icon.placedSymbolArray.length-1,ud&&(Za=4*ud.length,gs.addSymbols(gs.icon,ud,Vh,bn,Nr,gn,aa.vertical,Yc,xo.lineStartIndex,xo.lineLength,-1,Ca),Ih=gs.icon.placedSymbolArray.length-1)}for(var gd in Jf.horizontal){var Qh=Jf.horizontal[gd];if(!ii){xh=jt(Qh.text);var ja=E.layout.get("text-rotate").evaluate(gn,{},Ca);ii=new d(b,Yc,A,M,B,Qh,ie,de,Ve,ja)}var ji=Qh.positionedLines.length===1;if(As+=Je(gs,Yc,Qh,h,E,Ve,gn,zt,xo,Jf.vertical?aa.horizontal:aa.horizontalOnly,ji?Object.keys(Jf.horizontal):[gd],Pc,df,Fn,Ca),ji)break}Jf.vertical&&(Yo+=Je(gs,Yc,Jf.vertical,h,E,Ve,gn,zt,xo,aa.vertical,["vertical"],Pc,Ih,Fn,Ca));var si=ii?ii.boxStartIndex:gs.collisionBoxArray.length,Dn=ii?ii.boxEndIndex:gs.collisionBoxArray.length,Lc=wa?wa.boxStartIndex:gs.collisionBoxArray.length,ys=wa?wa.boxEndIndex:gs.collisionBoxArray.length,$c=Qi?Qi.boxStartIndex:gs.collisionBoxArray.length,Jc=Qi?Qi.boxEndIndex:gs.collisionBoxArray.length,Eh=qi?qi.boxStartIndex:gs.collisionBoxArray.length,yd=qi?qi.boxEndIndex:gs.collisionBoxArray.length,sh=-1,bd=function(xd,Sd){return xd&&xd.circleDiameter?Math.max(xd.circleDiameter,Sd):Sd};sh=bd(ii,sh),sh=bd(wa,sh),sh=bd(Qi,sh);var Td=(sh=bd(qi,sh))>-1?1:0;Td&&(sh*=Li/24),gs.glyphOffsetArray.length>=tr.MAX_GLYPHS&&we("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),gn.sortKey!==void 0&&gs.addToSortKeyRanges(gs.symbolInstances.length,gn.sortKey),gs.symbolInstances.emplaceBack(Yc.x,Yc.y,Pc.right>=0?Pc.right:-1,Pc.center>=0?Pc.center:-1,Pc.left>=0?Pc.left:-1,Pc.vertical||-1,df,Ih,xh,si,Dn,Lc,ys,$c,Jc,Eh,yd,A,As,Yo,Xs,Za,Td,0,ie,oh,Kc,sh)}(hi,Rh,fd,Ji,fo,xu,mc,hi.layers[0],hi.collisionBoxArray,ni.index,ni.sourceLayerIndex,hi.index,Sh,dh,Zh,li,Ah,Wh,ph,Lf,ni,bo,Xf,Xc,Bo)};if(Ch==="line")for(var ih=0,Yh=An(ni.geometry,0,0,8192,8192);ih<Yh.length;ih+=1)for(var Fh=Yh[ih],vh=0,zh=xi(Fh,Kf,jh,Ji.vertical||Rf,fo,24,Af,hi.overscaling,8192);vh<zh.length;vh+=1){var wh=zh[vh];Rf&&Me(hi,Rf.text,Xh,wh)||$f(Fh,wh)}else if(Ch==="line-center")for(var gh=0,Uh=ni.geometry;gh<Uh.length;gh+=1){var Bh=Uh[gh];if(Bh.length>1){var Oh=Hs(Bh,jh,Ji.vertical||Rf,fo,24,Af);Oh&&$f(Bh,Oh)}}else if(ni.type==="Polygon")for(var Mh=0,yh=N(ni.geometry,0);Mh<yh.length;Mh+=1){var Ph=yh[Mh],bh=T(Ph,16);$f(Ph[0],new co(bh.x,bh.y,0))}else if(ni.type==="LineString")for(var If=0,Lh=ni.geometry;If<Lh.length;If+=1){var Kh=Lh[If];$f(Kh,new co(Kh[0].x,Kh[0].y,0))}else if(ni.type==="Point")for(var $h=0,nd=ni.geometry;$h<nd.length;$h+=1)for(var ad=0,id=nd[$h];ad<id.length;ad+=1){var Jh=id[ad];$f([Jh],new co(Jh.x,Jh.y,0))}}(e,Dr,Xn,Ju,u,te,Rn,Qn,Ea,uu,S)},yr=0,_r=e.features;yr<_r.length;yr+=1)ir();v&&e.generateCollisionDebugBuffers()},i.perspective=function(e,t,r,u,f){var v,S=1/Math.tan(t/2);return e[0]=S/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=S,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(v=1/(u-f)),e[14]=2*f*u*v):(e[10]=-1,e[14]=-2*u),e},i.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var f=t[u];f in e&&(r[f]=e[f])}return r},i.plugin=ss,i.polygonIntersectsPolygon=vu,i.postMapLoadEvent=xt,i.postTurnstileEvent=dr,i.potpack=Br,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.register=In,i.registerForPluginStateChange=function(e){return e({pluginStatus:Bs,pluginURL:Cu}),af.on("pluginStateChange",e),e},i.renderColorRamp=ds,i.rotate=function(e,t,r){var u=t[0],f=t[1],v=t[2],S=t[3],P=Math.sin(r),V=Math.cos(r);return e[0]=u*V+v*P,e[1]=f*V+S*P,e[2]=u*-P+v*V,e[3]=f*-P+S*V,e},i.rotateX=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),v=t[4],S=t[5],P=t[6],V=t[7],te=t[8],he=t[9],_e=t[10],Ce=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=v*f+te*u,e[5]=S*f+he*u,e[6]=P*f+_e*u,e[7]=V*f+Ce*u,e[8]=te*f-v*u,e[9]=he*f-S*u,e[10]=_e*f-P*u,e[11]=Ce*f-V*u,e},i.rotateZ=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),v=t[0],S=t[1],P=t[2],V=t[3],te=t[4],he=t[5],_e=t[6],Ce=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=v*f+te*u,e[1]=S*f+he*u,e[2]=P*f+_e*u,e[3]=V*f+Ce*u,e[4]=te*f-v*u,e[5]=he*f-S*u,e[6]=_e*f-P*u,e[7]=Ce*f-V*u,e},i.scale=function(e,t,r){var u=r[0],f=r[1],v=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*v,e[9]=t[9]*v,e[10]=t[10]*v,e[11]=t[11]*v,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},i.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},i.setCacheLimits=function(e,t){bt=e,Et=t},i.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Bs==="deferred"||Bs==="loading"||Bs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Cu=ve.resolveURL(e),Bs="deferred",zc=t,Ul(),r||Lo()},i.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},i.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},i.styleSpec=Xe,i.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},i.symbolSize=Zo,i.transformMat3=function(e,t,r){var u=t[0],f=t[1],v=t[2];return e[0]=u*r[0]+f*r[3]+v*r[6],e[1]=u*r[1]+f*r[4]+v*r[7],e[2]=u*r[2]+f*r[5]+v*r[8],e},i.transformMat4=Ls,i.translate=function(e,t,r){var u,f,v,S,P,V,te,he,_e,Ce,lt,Pt,Ct=r[0],Yt=r[1],Zt=r[2];return t===e?(e[12]=t[0]*Ct+t[4]*Yt+t[8]*Zt+t[12],e[13]=t[1]*Ct+t[5]*Yt+t[9]*Zt+t[13],e[14]=t[2]*Ct+t[6]*Yt+t[10]*Zt+t[14],e[15]=t[3]*Ct+t[7]*Yt+t[11]*Zt+t[15]):(f=t[1],v=t[2],S=t[3],P=t[4],V=t[5],te=t[6],he=t[7],_e=t[8],Ce=t[9],lt=t[10],Pt=t[11],e[0]=u=t[0],e[1]=f,e[2]=v,e[3]=S,e[4]=P,e[5]=V,e[6]=te,e[7]=he,e[8]=_e,e[9]=Ce,e[10]=lt,e[11]=Pt,e[12]=u*Ct+P*Yt+_e*Zt+t[12],e[13]=f*Ct+V*Yt+Ce*Zt+t[13],e[14]=v*Ct+te*Yt+lt*Zt+t[14],e[15]=S*Ct+he*Yt+Pt*Zt+t[15]),e},i.triggerPluginCompletionEvent=zl,i.uniqueId=ot,i.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},i.validateLight=bf,i.validateStyle=ol,i.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},i.vectorTile=So,i.version="1.13.0",i.warnOnce=we,i.webpSupported=He,i.window=K,i.wrap=ht}),z(["./shared"],function(i){"use strict";function W(U){var Z=typeof U;if(Z==="number"||Z==="boolean"||Z==="string"||U==null)return JSON.stringify(U);if(Array.isArray(U)){for(var le="[",xe=0,ut=U;xe<ut.length;xe+=1)le+=W(ut[xe])+",";return le+"]"}for(var wt=Object.keys(U).sort(),Bt="{",Xe=0;Xe<wt.length;Xe++)Bt+=JSON.stringify(wt[Xe])+":"+W(U[wt[Xe]])+",";return Bt+"}"}function D(U){for(var Z="",le=0,xe=i.refProperties;le<xe.length;le+=1)Z+="/"+W(U[xe[le]]);return Z}var Q=function(Z){this.keyCache={},Z&&this.replace(Z)};Q.prototype.replace=function(U){this._layerConfigs={},this._layers={},this.update(U,[])},Q.prototype.update=function(U,Z){for(var le=this,xe=0,ut=U;xe<ut.length;xe+=1){var wt=ut[xe];this._layerConfigs[wt.id]=wt;var Bt=this._layers[wt.id]=i.createStyleLayer(wt);Bt._featureFilter=i.featureFilter(Bt.filter),this.keyCache[wt.id]&&delete this.keyCache[wt.id]}for(var Xe=0,Lt=Z;Xe<Lt.length;Xe+=1){var lr=Lt[Xe];delete this.keyCache[lr],delete this._layerConfigs[lr],delete this._layers[lr]}this.familiesBySource={};for(var zr=0,Vr=function(hn,xn){for(var yn={},vn=0;vn<hn.length;vn++){var Pn=xn&&xn[hn[vn].id]||D(hn[vn]);xn&&(xn[hn[vn].id]=Pn);var Va=yn[Pn];Va||(Va=yn[Pn]=[]),Va.push(hn[vn])}var va=[];for(var Ma in yn)va.push(yn[Ma]);return va}(i.values(this._layerConfigs),this.keyCache);zr<Vr.length;zr+=1){var cr=Vr[zr].map(function(hn){return le._layers[hn.id]}),Ur=cr[0];if(Ur.visibility!=="none"){var Mn=Ur.source||"",ln=this.familiesBySource[Mn];ln||(ln=this.familiesBySource[Mn]={});var er=Ur.sourceLayer||"_geojsonTileLayer",tn=ln[er];tn||(tn=ln[er]=[]),tn.push(cr)}}};var ee=function(Z){var le={},xe=[];for(var ut in Z){var wt=Z[ut],Bt=le[ut]={};for(var Xe in wt){var Lt=wt[+Xe];if(Lt&&Lt.bitmap.width!==0&&Lt.bitmap.height!==0){var lr={x:0,y:0,w:Lt.bitmap.width+2,h:Lt.bitmap.height+2};xe.push(lr),Bt[Xe]={rect:lr,metrics:Lt.metrics}}}}var zr=i.potpack(xe),Vr=new i.AlphaImage({width:zr.w||1,height:zr.h||1});for(var cr in Z){var Ur=Z[cr];for(var Mn in Ur){var ln=Ur[+Mn];if(ln&&ln.bitmap.width!==0&&ln.bitmap.height!==0){var er=le[cr][Mn].rect;i.AlphaImage.copy(ln.bitmap,Vr,{x:0,y:0},{x:er.x+1,y:er.y+1},ln.bitmap)}}}this.image=Vr,this.positions=le};i.register("GlyphAtlas",ee);var ce=function(Z){this.tileID=new i.OverscaledTileID(Z.tileID.overscaledZ,Z.tileID.wrap,Z.tileID.canonical.z,Z.tileID.canonical.x,Z.tileID.canonical.y),this.uid=Z.uid,this.zoom=Z.zoom,this.pixelRatio=Z.pixelRatio,this.tileSize=Z.tileSize,this.source=Z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Z.showCollisionBoxes,this.collectResourceTiming=!!Z.collectResourceTiming,this.returnDependencies=!!Z.returnDependencies,this.promoteId=Z.promoteId};function K(U,Z,le){for(var xe=new i.EvaluationParameters(Z),ut=0,wt=U;ut<wt.length;ut+=1)wt[ut].recalculate(xe,le)}function je(U,Z){var le=i.getArrayBuffer(U.request,function(xe,ut,wt,Bt){xe?Z(xe):ut&&Z(null,{vectorTile:new i.vectorTile.VectorTile(new i.pbf(ut)),rawData:ut,cacheControl:wt,expires:Bt})});return function(){le.cancel(),Z()}}ce.prototype.parse=function(U,Z,le,xe,ut){var wt=this;this.status="parsing",this.data=U,this.collisionBoxArray=new i.CollisionBoxArray;var Bt=new i.DictionaryCoder(Object.keys(U.layers).sort()),Xe=new i.FeatureIndex(this.tileID,this.promoteId);Xe.bucketLayerIDs=[];var Lt,lr,zr,Vr,cr={},Ur={featureIndex:Xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},Mn=Z.familiesBySource[this.source];for(var ln in Mn){var er=U.layers[ln];if(er){er.version===1&&i.warnOnce('Vector tile source "'+this.source+'" layer "'+ln+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var tn=Bt.encode(ln),hn=[],xn=0;xn<er.length;xn++){var yn=er.feature(xn),vn=Xe.getId(yn,ln);hn.push({feature:yn,id:vn,index:xn,sourceLayerIndex:tn})}for(var Pn=0,Va=Mn[ln];Pn<Va.length;Pn+=1){var va=Va[Pn],Ma=va[0];Ma.minzoom&&this.zoom<Math.floor(Ma.minzoom)||Ma.maxzoom&&this.zoom>=Ma.maxzoom||Ma.visibility!=="none"&&(K(va,this.zoom,le),(cr[Ma.id]=Ma.createBucket({index:Xe.bucketLayerIDs.length,layers:va,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tn,sourceID:this.source})).populate(hn,Ur,this.tileID.canonical),Xe.bucketLayerIDs.push(va.map(function(ga){return ga.id})))}}}var Ia=i.mapObject(Ur.glyphDependencies,function(ga){return Object.keys(ga).map(Number)});Object.keys(Ia).length?xe.send("getGlyphs",{uid:this.uid,stacks:Ia},function(ga,ya){Lt||(Lt=ga,lr=ya,di.call(wt))}):lr={};var Zi=Object.keys(Ur.iconDependencies);Zi.length?xe.send("getImages",{icons:Zi,source:this.source,tileID:this.tileID,type:"icons"},function(ga,ya){Lt||(Lt=ga,zr=ya,di.call(wt))}):zr={};var da=Object.keys(Ur.patternDependencies);function di(){if(Lt)return ut(Lt);if(lr&&zr&&Vr){var ga=new ee(lr),ya=new i.ImageAtlas(zr,Vr);for(var fa in cr){var Si=cr[fa];Si instanceof i.SymbolBucket?(K(Si.layers,this.zoom,le),i.performSymbolLayout(Si,lr,ga.positions,zr,ya.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Si.hasPattern&&(Si instanceof i.LineBucket||Si instanceof i.FillBucket||Si instanceof i.FillExtrusionBucket)&&(K(Si.layers,this.zoom,le),Si.addFeatures(Ur,this.tileID.canonical,ya.patternPositions))}this.status="done",ut(null,{buckets:i.values(cr).filter(function(ns){return!ns.isEmpty()}),featureIndex:Xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ga.image,imageAtlas:ya,glyphMap:this.returnDependencies?lr:null,iconMap:this.returnDependencies?zr:null,glyphPositions:this.returnDependencies?ga.positions:null})}}da.length?xe.send("getImages",{icons:da,source:this.source,tileID:this.tileID,type:"patterns"},function(ga,ya){Lt||(Lt=ga,Vr=ya,di.call(wt))}):Vr={},di.call(this)};var pe=function(Z,le,xe,ut){this.actor=Z,this.layerIndex=le,this.availableImages=xe,this.loadVectorData=ut||je,this.loading={},this.loaded={}};pe.prototype.loadTile=function(U,Z){var le=this,xe=U.uid;this.loading||(this.loading={});var ut=!!(U&&U.request&&U.request.collectResourceTiming)&&new i.RequestPerformance(U.request),wt=this.loading[xe]=new ce(U);wt.abort=this.loadVectorData(U,function(Bt,Xe){if(delete le.loading[xe],Bt||!Xe)return wt.status="done",le.loaded[xe]=wt,Z(Bt);var Lt=Xe.rawData,lr={};Xe.expires&&(lr.expires=Xe.expires),Xe.cacheControl&&(lr.cacheControl=Xe.cacheControl);var zr={};if(ut){var Vr=ut.finish();Vr&&(zr.resourceTiming=JSON.parse(JSON.stringify(Vr)))}wt.vectorTile=Xe.vectorTile,wt.parse(Xe.vectorTile,le.layerIndex,le.availableImages,le.actor,function(cr,Ur){if(cr||!Ur)return Z(cr);Z(null,i.extend({rawTileData:Lt.slice(0)},Ur,lr,zr))}),le.loaded=le.loaded||{},le.loaded[xe]=wt})},pe.prototype.reloadTile=function(U,Z){var le=this,xe=this.loaded,ut=U.uid,wt=this;if(xe&&xe[ut]){var Bt=xe[ut];Bt.showCollisionBoxes=U.showCollisionBoxes;var Xe=function(lr,zr){var Vr=Bt.reloadCallback;Vr&&(delete Bt.reloadCallback,Bt.parse(Bt.vectorTile,wt.layerIndex,le.availableImages,wt.actor,Vr)),Z(lr,zr)};Bt.status==="parsing"?Bt.reloadCallback=Xe:Bt.status==="done"&&(Bt.vectorTile?Bt.parse(Bt.vectorTile,this.layerIndex,this.availableImages,this.actor,Xe):Xe())}},pe.prototype.abortTile=function(U,Z){var le=this.loading,xe=U.uid;le&&le[xe]&&le[xe].abort&&(le[xe].abort(),delete le[xe]),Z()},pe.prototype.removeTile=function(U,Z){var le=this.loaded,xe=U.uid;le&&le[xe]&&delete le[xe],Z()};var Ke=i.window.ImageBitmap,Pe=function(){this.loaded={}};function ht(U,Z){if(U.length!==0){Le(U[0],Z);for(var le=1;le<U.length;le++)Le(U[le],!Z)}}function Le(U,Z){for(var le=0,xe=0,ut=U.length,wt=ut-1;xe<ut;wt=xe++)le+=(U[xe][0]-U[wt][0])*(U[wt][1]+U[xe][1]);le>=0!=!!Z&&U.reverse()}Pe.prototype.loadTile=function(U,Z){var le=U.uid,xe=U.encoding,ut=U.rawImageData,wt=Ke&&ut instanceof Ke?this.getImageData(ut):ut,Bt=new i.DEMData(le,wt,xe);this.loaded=this.loaded||{},this.loaded[le]=Bt,Z(null,Bt)},Pe.prototype.getImageData=function(U){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(U.width,U.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=U.width,this.offscreenCanvas.height=U.height,this.offscreenCanvasContext.drawImage(U,0,0,U.width,U.height);var Z=this.offscreenCanvasContext.getImageData(-1,-1,U.width+2,U.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new i.RGBAImage({width:Z.width,height:Z.height},Z.data)},Pe.prototype.removeTile=function(U){var Z=this.loaded,le=U.uid;Z&&Z[le]&&delete Z[le]};var _t=i.vectorTile.VectorTileFeature.prototype.toGeoJSON,ot=function(Z){this._feature=Z,this.extent=i.EXTENT,this.type=Z.type,this.properties=Z.tags,"id"in Z&&!isNaN(Z.id)&&(this.id=parseInt(Z.id,10))};ot.prototype.loadGeometry=function(){if(this._feature.type===1){for(var U=[],Z=0,le=this._feature.geometry;Z<le.length;Z+=1){var xe=le[Z];U.push([new i.Point$1(xe[0],xe[1])])}return U}for(var ut=[],wt=0,Bt=this._feature.geometry;wt<Bt.length;wt+=1){for(var Xe=[],Lt=0,lr=Bt[wt];Lt<lr.length;Lt+=1){var zr=lr[Lt];Xe.push(new i.Point$1(zr[0],zr[1]))}ut.push(Xe)}return ut},ot.prototype.toGeoJSON=function(U,Z,le){return _t.call(this,U,Z,le)};var et=function(Z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=Z.length,this._features=Z};et.prototype.feature=function(U){return new ot(this._features[U])};var Ze=i.vectorTile.VectorTileFeature,At=St;function St(U,Z){this.options=Z||{},this.features=U,this.length=U.length}function De(U,Z){this.id=typeof U.id=="number"?U.id:void 0,this.type=U.type,this.rawGeometry=U.type===1?[U.geometry]:U.geometry,this.properties=U.tags,this.extent=Z||4096}St.prototype.feature=function(U){return new De(this.features[U],this.options.extent)},De.prototype.loadGeometry=function(){var U=this.rawGeometry;this.geometry=[];for(var Z=0;Z<U.length;Z++){for(var le=U[Z],xe=[],ut=0;ut<le.length;ut++)xe.push(new i.Point$1(le[ut][0],le[ut][1]));this.geometry.push(xe)}return this.geometry},De.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var U=this.geometry,Z=1/0,le=-1/0,xe=1/0,ut=-1/0,wt=0;wt<U.length;wt++)for(var Bt=U[wt],Xe=0;Xe<Bt.length;Xe++){var Lt=Bt[Xe];Z=Math.min(Z,Lt.x),le=Math.max(le,Lt.x),xe=Math.min(xe,Lt.y),ut=Math.max(ut,Lt.y)}return[Z,xe,le,ut]},De.prototype.toGeoJSON=Ze.prototype.toGeoJSON;var Ie=dt,Ge=At;function dt(U){var Z=new i.pbf;return function(le,xe){for(var ut in le.layers)xe.writeMessage(3,we,le.layers[ut])}(U,Z),Z.finish()}function we(U,Z){var le;Z.writeVarintField(15,U.version||1),Z.writeStringField(1,U.name||""),Z.writeVarintField(5,U.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<U.length;le++)xe.feature=U.feature(le),Z.writeMessage(2,pt,xe);var ut=xe.keys;for(le=0;le<ut.length;le++)Z.writeStringField(3,ut[le]);var wt=xe.values;for(le=0;le<wt.length;le++)Z.writeMessage(4,J,wt[le])}function pt(U,Z){var le=U.feature;le.id!==void 0&&Z.writeVarintField(1,le.id),Z.writeMessage(2,Wt,U),Z.writeVarintField(3,le.type),Z.writeMessage(4,oe,le)}function Wt(U,Z){var le=U.feature,xe=U.keys,ut=U.values,wt=U.keycache,Bt=U.valuecache;for(var Xe in le.properties){var Lt=wt[Xe];Lt===void 0&&(xe.push(Xe),wt[Xe]=Lt=xe.length-1),Z.writeVarint(Lt);var lr=le.properties[Xe],zr=typeof lr;zr!=="string"&&zr!=="boolean"&&zr!=="number"&&(lr=JSON.stringify(lr));var Vr=zr+":"+lr,cr=Bt[Vr];cr===void 0&&(ut.push(lr),Bt[Vr]=cr=ut.length-1),Z.writeVarint(cr)}}function Qt(U,Z){return(Z<<3)+(7&U)}function ur(U){return U<<1^U>>31}function oe(U,Z){for(var le=U.loadGeometry(),xe=U.type,ut=0,wt=0,Bt=le.length,Xe=0;Xe<Bt;Xe++){var Lt=le[Xe],lr=1;xe===1&&(lr=Lt.length),Z.writeVarint(Qt(1,lr));for(var zr=xe===3?Lt.length-1:Lt.length,Vr=0;Vr<zr;Vr++){Vr===1&&xe!==1&&Z.writeVarint(Qt(2,zr-1));var cr=Lt[Vr].x-ut,Ur=Lt[Vr].y-wt;Z.writeVarint(ur(cr)),Z.writeVarint(ur(Ur)),ut+=cr,wt+=Ur}xe===3&&Z.writeVarint(Qt(7,1))}}function J(U,Z){var le=typeof U;le==="string"?Z.writeStringField(1,U):le==="boolean"?Z.writeBooleanField(7,U):le==="number"&&(U%1!=0?Z.writeDoubleField(3,U):U<0?Z.writeSVarintField(6,U):Z.writeVarintField(5,U))}function H(U,Z,le,xe){Se(U,le,xe),Se(Z,2*le,2*xe),Se(Z,2*le+1,2*xe+1)}function Se(U,Z,le){var xe=U[Z];U[Z]=U[le],U[le]=xe}function be(U,Z,le,xe){var ut=U-le,wt=Z-xe;return ut*ut+wt*wt}Ie.fromVectorTileJs=dt,Ie.fromGeojsonVt=function(U,Z){Z=Z||{};var le={};for(var xe in U)le[xe]=new At(U[xe].features,Z),le[xe].name=xe,le[xe].version=Z.version,le[xe].extent=Z.extent;return dt({layers:le})},Ie.GeoJSONWrapper=Ge;var Te=function(Z){return Z[0]},me=function(Z){return Z[1]},at=function(Z,le,xe,ut,wt){le===void 0&&(le=Te),xe===void 0&&(xe=me),ut===void 0&&(ut=64),wt===void 0&&(wt=Float64Array),this.nodeSize=ut,this.points=Z;for(var Bt=Z.length<65536?Uint16Array:Uint32Array,Xe=this.ids=new Bt(Z.length),Lt=this.coords=new wt(2*Z.length),lr=0;lr<Z.length;lr++)Xe[lr]=lr,Lt[2*lr]=le(Z[lr]),Lt[2*lr+1]=xe(Z[lr]);!function zr(Vr,cr,Ur,Mn,ln,er){if(!(ln-Mn<=Ur)){var tn=Mn+ln>>1;!function hn(xn,yn,vn,Pn,Va,va){for(;Va>Pn;){if(Va-Pn>600){var Ma=Va-Pn+1,Ia=vn-Pn+1,Zi=Math.log(Ma),da=.5*Math.exp(2*Zi/3),di=.5*Math.sqrt(Zi*da*(Ma-da)/Ma)*(Ia-Ma/2<0?-1:1);hn(xn,yn,vn,Math.max(Pn,Math.floor(vn-Ia*da/Ma+di)),Math.min(Va,Math.floor(vn+(Ma-Ia)*da/Ma+di)),va)}var ga=yn[2*vn+va],ya=Pn,fa=Va;for(H(xn,yn,Pn,vn),yn[2*Va+va]>ga&&H(xn,yn,Pn,Va);ya<fa;){for(H(xn,yn,ya,fa),ya++,fa--;yn[2*ya+va]<ga;)ya++;for(;yn[2*fa+va]>ga;)fa--}yn[2*Pn+va]===ga?H(xn,yn,Pn,fa):H(xn,yn,++fa,Va),fa<=vn&&(Pn=fa+1),vn<=fa&&(Va=fa-1)}}(Vr,cr,tn,Mn,ln,er%2),zr(Vr,cr,Ur,Mn,tn-1,er+1),zr(Vr,cr,Ur,tn+1,ln,er+1)}}(Xe,Lt,ut,0,Xe.length-1,0)};at.prototype.range=function(U,Z,le,xe){return function(ut,wt,Bt,Xe,Lt,lr,zr){for(var Vr,cr,Ur=[0,ut.length-1,0],Mn=[];Ur.length;){var ln=Ur.pop(),er=Ur.pop(),tn=Ur.pop();if(er-tn<=zr)for(var hn=tn;hn<=er;hn++)cr=wt[2*hn+1],(Vr=wt[2*hn])>=Bt&&Vr<=Lt&&cr>=Xe&&cr<=lr&&Mn.push(ut[hn]);else{var xn=Math.floor((tn+er)/2);cr=wt[2*xn+1],(Vr=wt[2*xn])>=Bt&&Vr<=Lt&&cr>=Xe&&cr<=lr&&Mn.push(ut[xn]);var yn=(ln+1)%2;(ln===0?Bt<=Vr:Xe<=cr)&&(Ur.push(tn),Ur.push(xn-1),Ur.push(yn)),(ln===0?Lt>=Vr:lr>=cr)&&(Ur.push(xn+1),Ur.push(er),Ur.push(yn))}}return Mn}(this.ids,this.coords,U,Z,le,xe,this.nodeSize)},at.prototype.within=function(U,Z,le){return function(xe,ut,wt,Bt,Xe,Lt){for(var lr=[0,xe.length-1,0],zr=[],Vr=Xe*Xe;lr.length;){var cr=lr.pop(),Ur=lr.pop(),Mn=lr.pop();if(Ur-Mn<=Lt)for(var ln=Mn;ln<=Ur;ln++)be(ut[2*ln],ut[2*ln+1],wt,Bt)<=Vr&&zr.push(xe[ln]);else{var er=Math.floor((Mn+Ur)/2),tn=ut[2*er],hn=ut[2*er+1];be(tn,hn,wt,Bt)<=Vr&&zr.push(xe[er]);var xn=(cr+1)%2;(cr===0?wt-Xe<=tn:Bt-Xe<=hn)&&(lr.push(Mn),lr.push(er-1),lr.push(xn)),(cr===0?wt+Xe>=tn:Bt+Xe>=hn)&&(lr.push(er+1),lr.push(Ur),lr.push(xn))}}return zr}(this.ids,this.coords,U,Z,le,this.nodeSize)};var Jt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Z){return Z}},Mt=function(Z){this.options=C(Object.create(Jt),Z),this.trees=new Array(this.options.maxZoom+1)};function ve(U,Z,le,xe,ut){return{x:U,y:Z,zoom:1/0,id:le,parentId:-1,numPoints:xe,properties:ut}}function ge(U,Z){var le=U.geometry.coordinates,xe=le[1];return{x:Oe(le[0]),y:gt(xe),zoom:1/0,index:Z,parentId:-1}}function He(U){return{type:"Feature",id:U.id,properties:st(U),geometry:{type:"Point",coordinates:[(xe=U.x,360*(xe-.5)),(Z=U.y,le=(180-360*Z)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var Z,le,xe}function st(U){var Z=U.numPoints,le=Z>=1e4?Math.round(Z/1e3)+"k":Z>=1e3?Math.round(Z/100)/10+"k":Z;return C(C({},U.properties),{cluster:!0,cluster_id:U.id,point_count:Z,point_count_abbreviated:le})}function Oe(U){return U/360+.5}function gt(U){var Z=Math.sin(U*Math.PI/180),le=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return le<0?0:le>1?1:le}function C(U,Z){for(var le in Z)U[le]=Z[le];return U}function R(U){return U.x}function q(U){return U.y}function fe(U,Z,le,xe,ut,wt){var Bt=ut-le,Xe=wt-xe;if(Bt!==0||Xe!==0){var Lt=((U-le)*Bt+(Z-xe)*Xe)/(Bt*Bt+Xe*Xe);Lt>1?(le=ut,xe=wt):Lt>0&&(le+=Bt*Lt,xe+=Xe*Lt)}return(Bt=U-le)*Bt+(Xe=Z-xe)*Xe}function We(U,Z,le,xe){var ut={id:U===void 0?null:U,type:Z,geometry:le,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(wt){var Bt=wt.geometry,Xe=wt.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")qe(wt,Bt);else if(Xe==="Polygon"||Xe==="MultiLineString")for(var Lt=0;Lt<Bt.length;Lt++)qe(wt,Bt[Lt]);else if(Xe==="MultiPolygon")for(Lt=0;Lt<Bt.length;Lt++)for(var lr=0;lr<Bt[Lt].length;lr++)qe(wt,Bt[Lt][lr])}(ut),ut}function qe(U,Z){for(var le=0;le<Z.length;le+=3)U.minX=Math.min(U.minX,Z[le]),U.minY=Math.min(U.minY,Z[le+1]),U.maxX=Math.max(U.maxX,Z[le]),U.maxY=Math.max(U.maxY,Z[le+1])}function Tt(U,Z,le,xe){if(Z.geometry){var ut=Z.geometry.coordinates,wt=Z.geometry.type,Bt=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Xe=[],Lt=Z.id;if(le.promoteId?Lt=Z.properties[le.promoteId]:le.generateId&&(Lt=xe||0),wt==="Point")it(ut,Xe);else if(wt==="MultiPoint")for(var lr=0;lr<ut.length;lr++)it(ut[lr],Xe);else if(wt==="LineString")Ut(ut,Xe,Bt,!1);else if(wt==="MultiLineString"){if(le.lineMetrics){for(lr=0;lr<ut.length;lr++)Ut(ut[lr],Xe=[],Bt,!1),U.push(We(Lt,"LineString",Xe,Z.properties));return}$(ut,Xe,Bt,!1)}else if(wt==="Polygon")$(ut,Xe,Bt,!0);else{if(wt!=="MultiPolygon"){if(wt==="GeometryCollection"){for(lr=0;lr<Z.geometry.geometries.length;lr++)Tt(U,{id:Lt,geometry:Z.geometry.geometries[lr],properties:Z.properties},le,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(lr=0;lr<ut.length;lr++){var zr=[];$(ut[lr],zr,Bt,!0),Xe.push(zr)}}U.push(We(Lt,wt,Xe,Z.properties))}}function it(U,Z){Z.push(Qe(U[0])),Z.push(ne(U[1])),Z.push(0)}function Ut(U,Z,le,xe){for(var ut,wt,Bt=0,Xe=0;Xe<U.length;Xe++){var Lt=Qe(U[Xe][0]),lr=ne(U[Xe][1]);Z.push(Lt),Z.push(lr),Z.push(0),Xe>0&&(Bt+=xe?(ut*lr-Lt*wt)/2:Math.sqrt(Math.pow(Lt-ut,2)+Math.pow(lr-wt,2))),ut=Lt,wt=lr}var zr=Z.length-3;Z[2]=1,function Vr(cr,Ur,Mn,ln){for(var er,tn=ln,hn=Mn-Ur>>1,xn=Mn-Ur,yn=cr[Ur],vn=cr[Ur+1],Pn=cr[Mn],Va=cr[Mn+1],va=Ur+3;va<Mn;va+=3){var Ma=fe(cr[va],cr[va+1],yn,vn,Pn,Va);if(Ma>tn)er=va,tn=Ma;else if(Ma===tn){var Ia=Math.abs(va-hn);Ia<xn&&(er=va,xn=Ia)}}tn>ln&&(er-Ur>3&&Vr(cr,Ur,er,ln),cr[er+2]=tn,Mn-er>3&&Vr(cr,er,Mn,ln))}(Z,0,zr,le),Z[zr+2]=1,Z.size=Math.abs(Bt),Z.start=0,Z.end=Z.size}function $(U,Z,le,xe){for(var ut=0;ut<U.length;ut++){var wt=[];Ut(U[ut],wt,le,xe),Z.push(wt)}}function Qe(U){return U/360+.5}function ne(U){var Z=Math.sin(U*Math.PI/180),le=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return le<0?0:le>1?1:le}function tt(U,Z,le,xe,ut,wt,Bt,Xe){if(xe/=Z,wt>=(le/=Z)&&Bt<xe)return U;if(Bt<le||wt>=xe)return null;for(var Lt=[],lr=0;lr<U.length;lr++){var zr=U[lr],Vr=zr.geometry,cr=zr.type,Ur=ut===0?zr.minX:zr.minY,Mn=ut===0?zr.maxX:zr.maxY;if(Ur>=le&&Mn<xe)Lt.push(zr);else if(!(Mn<le||Ur>=xe)){var ln=[];if(cr==="Point"||cr==="MultiPoint")kt(Vr,ln,le,xe,ut);else if(cr==="LineString")dr(Vr,ln,le,xe,ut,!1,Xe.lineMetrics);else if(cr==="MultiLineString")xt(Vr,ln,le,xe,ut,!1);else if(cr==="Polygon")xt(Vr,ln,le,xe,ut,!0);else if(cr==="MultiPolygon")for(var er=0;er<Vr.length;er++){var tn=[];xt(Vr[er],tn,le,xe,ut,!0),tn.length&&ln.push(tn)}if(ln.length){if(Xe.lineMetrics&&cr==="LineString"){for(er=0;er<ln.length;er++)Lt.push(We(zr.id,cr,ln[er],zr.tags));continue}cr!=="LineString"&&cr!=="MultiLineString"||(ln.length===1?(cr="LineString",ln=ln[0]):cr="MultiLineString"),cr!=="Point"&&cr!=="MultiPoint"||(cr=ln.length===3?"Point":"MultiPoint"),Lt.push(We(zr.id,cr,ln,zr.tags))}}}return Lt.length?Lt:null}function kt(U,Z,le,xe,ut){for(var wt=0;wt<U.length;wt+=3){var Bt=U[wt+ut];Bt>=le&&Bt<=xe&&(Z.push(U[wt]),Z.push(U[wt+1]),Z.push(U[wt+2]))}}function dr(U,Z,le,xe,ut,wt,Bt){for(var Xe,Lt,lr=Ye(U),zr=ut===0?Et:ze,Vr=U.start,cr=0;cr<U.length-3;cr+=3){var Ur=U[cr],Mn=U[cr+1],ln=U[cr+2],er=U[cr+3],tn=U[cr+4],hn=ut===0?Ur:Mn,xn=ut===0?er:tn,yn=!1;Bt&&(Xe=Math.sqrt(Math.pow(Ur-er,2)+Math.pow(Mn-tn,2))),hn<le?xn>le&&(Lt=zr(lr,Ur,Mn,er,tn,le),Bt&&(lr.start=Vr+Xe*Lt)):hn>xe?xn<xe&&(Lt=zr(lr,Ur,Mn,er,tn,xe),Bt&&(lr.start=Vr+Xe*Lt)):bt(lr,Ur,Mn,ln),xn<le&&hn>=le&&(Lt=zr(lr,Ur,Mn,er,tn,le),yn=!0),xn>xe&&hn<=xe&&(Lt=zr(lr,Ur,Mn,er,tn,xe),yn=!0),!wt&&yn&&(Bt&&(lr.end=Vr+Xe*Lt),Z.push(lr),lr=Ye(U)),Bt&&(Vr+=Xe)}var vn=U.length-3;Ur=U[vn],Mn=U[vn+1],ln=U[vn+2],(hn=ut===0?Ur:Mn)>=le&&hn<=xe&&bt(lr,Ur,Mn,ln),vn=lr.length-3,wt&&vn>=3&&(lr[vn]!==lr[0]||lr[vn+1]!==lr[1])&&bt(lr,lr[0],lr[1],lr[2]),lr.length&&Z.push(lr)}function Ye(U){var Z=[];return Z.size=U.size,Z.start=U.start,Z.end=U.end,Z}function xt(U,Z,le,xe,ut,wt){for(var Bt=0;Bt<U.length;Bt++)dr(U[Bt],Z,le,xe,ut,wt,!1)}function bt(U,Z,le,xe){U.push(Z),U.push(le),U.push(xe)}function Et(U,Z,le,xe,ut,wt){var Bt=(wt-Z)/(xe-Z);return U.push(wt),U.push(le+(ut-le)*Bt),U.push(1),Bt}function ze(U,Z,le,xe,ut,wt){var Bt=(wt-le)/(ut-le);return U.push(Z+(xe-Z)*Bt),U.push(wt),U.push(1),Bt}function vt(U,Z){for(var le=[],xe=0;xe<U.length;xe++){var ut,wt=U[xe],Bt=wt.type;if(Bt==="Point"||Bt==="MultiPoint"||Bt==="LineString")ut=yt(wt.geometry,Z);else if(Bt==="MultiLineString"||Bt==="Polygon"){ut=[];for(var Xe=0;Xe<wt.geometry.length;Xe++)ut.push(yt(wt.geometry[Xe],Z))}else if(Bt==="MultiPolygon")for(ut=[],Xe=0;Xe<wt.geometry.length;Xe++){for(var Lt=[],lr=0;lr<wt.geometry[Xe].length;lr++)Lt.push(yt(wt.geometry[Xe][lr],Z));ut.push(Lt)}le.push(We(wt.id,Bt,ut,wt.tags))}return le}function yt(U,Z){var le=[];le.size=U.size,U.start!==void 0&&(le.start=U.start,le.end=U.end);for(var xe=0;xe<U.length;xe+=3)le.push(U[xe]+Z,U[xe+1],U[xe+2]);return le}function Ht(U,Z){if(U.transformed)return U;var le,xe,ut,wt=1<<U.z,Bt=U.x,Xe=U.y;for(le=0;le<U.features.length;le++){var Lt=U.features[le],lr=Lt.geometry,zr=Lt.type;if(Lt.geometry=[],zr===1)for(xe=0;xe<lr.length;xe+=2)Lt.geometry.push(hr(lr[xe],lr[xe+1],Z,wt,Bt,Xe));else for(xe=0;xe<lr.length;xe++){var Vr=[];for(ut=0;ut<lr[xe].length;ut+=2)Vr.push(hr(lr[xe][ut],lr[xe][ut+1],Z,wt,Bt,Xe));Lt.geometry.push(Vr)}}return U.transformed=!0,U}function hr(U,Z,le,xe,ut,wt){return[Math.round(le*(U*xe-ut)),Math.round(le*(Z*xe-wt))]}function Hr(U,Z,le,xe,ut){for(var wt=Z===ut.maxZoom?0:ut.tolerance/((1<<Z)*ut.extent),Bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:xe,z:Z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Xe=0;Xe<U.length;Xe++){Bt.numFeatures++,gr(Bt,U[Xe],wt,ut);var Lt=U[Xe].minX,lr=U[Xe].minY,zr=U[Xe].maxX,Vr=U[Xe].maxY;Lt<Bt.minX&&(Bt.minX=Lt),lr<Bt.minY&&(Bt.minY=lr),zr>Bt.maxX&&(Bt.maxX=zr),Vr>Bt.maxY&&(Bt.maxY=Vr)}return Bt}function gr(U,Z,le,xe){var ut=Z.geometry,wt=Z.type,Bt=[];if(wt==="Point"||wt==="MultiPoint")for(var Xe=0;Xe<ut.length;Xe+=3)Bt.push(ut[Xe]),Bt.push(ut[Xe+1]),U.numPoints++,U.numSimplified++;else if(wt==="LineString")Bn(Bt,ut,U,le,!1,!1);else if(wt==="MultiLineString"||wt==="Polygon")for(Xe=0;Xe<ut.length;Xe++)Bn(Bt,ut[Xe],U,le,wt==="Polygon",Xe===0);else if(wt==="MultiPolygon")for(var Lt=0;Lt<ut.length;Lt++){var lr=ut[Lt];for(Xe=0;Xe<lr.length;Xe++)Bn(Bt,lr[Xe],U,le,!0,Xe===0)}if(Bt.length){var zr=Z.tags||null;if(wt==="LineString"&&xe.lineMetrics){for(var Vr in zr={},Z.tags)zr[Vr]=Z.tags[Vr];zr.mapbox_clip_start=ut.start/ut.size,zr.mapbox_clip_end=ut.end/ut.size}var cr={geometry:Bt,type:wt==="Polygon"||wt==="MultiPolygon"?3:wt==="LineString"||wt==="MultiLineString"?2:1,tags:zr};Z.id!==null&&(cr.id=Z.id),U.features.push(cr)}}function Bn(U,Z,le,xe,ut,wt){var Bt=xe*xe;if(xe>0&&Z.size<(ut?Bt:xe))le.numPoints+=Z.length/3;else{for(var Xe=[],Lt=0;Lt<Z.length;Lt+=3)(xe===0||Z[Lt+2]>Bt)&&(le.numSimplified++,Xe.push(Z[Lt]),Xe.push(Z[Lt+1])),le.numPoints++;ut&&function(lr,zr){for(var Vr=0,cr=0,Ur=lr.length,Mn=Ur-2;cr<Ur;Mn=cr,cr+=2)Vr+=(lr[cr]-lr[Mn])*(lr[cr+1]+lr[Mn+1]);if(Vr>0===zr)for(cr=0,Ur=lr.length;cr<Ur/2;cr+=2){var ln=lr[cr],er=lr[cr+1];lr[cr]=lr[Ur-2-cr],lr[cr+1]=lr[Ur-1-cr],lr[Ur-2-cr]=ln,lr[Ur-1-cr]=er}}(Xe,wt),U.push(Xe)}}function zn(U,Z){var le=(Z=this.options=function(ut,wt){for(var Bt in wt)ut[Bt]=wt[Bt];return ut}(Object.create(this.options),Z)).debug;if(le&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");var xe=function(ut,wt){var Bt=[];if(ut.type==="FeatureCollection")for(var Xe=0;Xe<ut.features.length;Xe++)Tt(Bt,ut.features[Xe],wt,Xe);else Tt(Bt,ut.type==="Feature"?ut:{geometry:ut},wt);return Bt}(U,Z);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(xe=function(ut,wt){var Bt=wt.buffer/wt.extent,Xe=ut,Lt=tt(ut,1,-1-Bt,Bt,0,-1,2,wt),lr=tt(ut,1,1-Bt,2+Bt,0,-1,2,wt);return(Lt||lr)&&(Xe=tt(ut,1,-Bt,1+Bt,0,-1,2,wt)||[],Lt&&(Xe=vt(Lt,1).concat(Xe)),lr&&(Xe=Xe.concat(vt(lr,-1)))),Xe}(xe,Z)).length&&this.splitTile(xe,0,0,0),le&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function oa(U,Z,le){return 32*((1<<U)*le+Z)+U}function $n(U,Z){var le=U.tileID.canonical;if(!this._geoJSONIndex)return Z(null,null);var xe=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!xe)return Z(null,null);var ut=new et(xe.features),wt=Ie(ut);wt.byteOffset===0&&wt.byteLength===wt.buffer.byteLength||(wt=new Uint8Array(wt)),Z(null,{vectorTile:ut,rawData:wt.buffer})}Mt.prototype.load=function(U){var Z=this.options,le=Z.log,xe=Z.minZoom,ut=Z.maxZoom,wt=Z.nodeSize;le&&console.time("total time");var Bt="prepare "+U.length+" points";le&&console.time(Bt),this.points=U;for(var Xe=[],Lt=0;Lt<U.length;Lt++)U[Lt].geometry&&Xe.push(ge(U[Lt],Lt));this.trees[ut+1]=new at(Xe,R,q,wt,Float32Array),le&&console.timeEnd(Bt);for(var lr=ut;lr>=xe;lr--){var zr=+Date.now();Xe=this._cluster(Xe,lr),this.trees[lr]=new at(Xe,R,q,wt,Float32Array),le&&console.log("z%d: %d clusters in %dms",lr,Xe.length,+Date.now()-zr)}return le&&console.timeEnd("total time"),this},Mt.prototype.getClusters=function(U,Z){var le=((U[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,U[1])),ut=U[2]===180?180:((U[2]+180)%360+360)%360-180,wt=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)le=-180,ut=180;else if(le>ut){var Bt=this.getClusters([le,xe,180,wt],Z),Xe=this.getClusters([-180,xe,ut,wt],Z);return Bt.concat(Xe)}for(var Lt=this.trees[this._limitZoom(Z)],lr=[],zr=0,Vr=Lt.range(Oe(le),gt(wt),Oe(ut),gt(xe));zr<Vr.length;zr+=1){var cr=Lt.points[Vr[zr]];lr.push(cr.numPoints?He(cr):this.points[cr.index])}return lr},Mt.prototype.getChildren=function(U){var Z=this._getOriginId(U),le=this._getOriginZoom(U),xe="No cluster with the specified id.",ut=this.trees[le];if(!ut)throw new Error(xe);var wt=ut.points[Z];if(!wt)throw new Error(xe);for(var Bt=this.options.radius/(this.options.extent*Math.pow(2,le-1)),Xe=[],Lt=0,lr=ut.within(wt.x,wt.y,Bt);Lt<lr.length;Lt+=1){var zr=ut.points[lr[Lt]];zr.parentId===U&&Xe.push(zr.numPoints?He(zr):this.points[zr.index])}if(Xe.length===0)throw new Error(xe);return Xe},Mt.prototype.getLeaves=function(U,Z,le){var xe=[];return this._appendLeaves(xe,U,Z=Z||10,le=le||0,0),xe},Mt.prototype.getTile=function(U,Z,le){var xe=this.trees[this._limitZoom(U)],ut=Math.pow(2,U),wt=this.options,Bt=wt.radius/wt.extent,Xe=(le-Bt)/ut,Lt=(le+1+Bt)/ut,lr={features:[]};return this._addTileFeatures(xe.range((Z-Bt)/ut,Xe,(Z+1+Bt)/ut,Lt),xe.points,Z,le,ut,lr),Z===0&&this._addTileFeatures(xe.range(1-Bt/ut,Xe,1,Lt),xe.points,ut,le,ut,lr),Z===ut-1&&this._addTileFeatures(xe.range(0,Xe,Bt/ut,Lt),xe.points,-1,le,ut,lr),lr.features.length?lr:null},Mt.prototype.getClusterExpansionZoom=function(U){for(var Z=this._getOriginZoom(U)-1;Z<=this.options.maxZoom;){var le=this.getChildren(U);if(Z++,le.length!==1)break;U=le[0].properties.cluster_id}return Z},Mt.prototype._appendLeaves=function(U,Z,le,xe,ut){for(var wt=0,Bt=this.getChildren(Z);wt<Bt.length;wt+=1){var Xe=Bt[wt],Lt=Xe.properties;if(Lt&&Lt.cluster?ut+Lt.point_count<=xe?ut+=Lt.point_count:ut=this._appendLeaves(U,Lt.cluster_id,le,xe,ut):ut<xe?ut++:U.push(Xe),U.length===le)break}return ut},Mt.prototype._addTileFeatures=function(U,Z,le,xe,ut,wt){for(var Bt=0,Xe=U;Bt<Xe.length;Bt+=1){var Lt=Z[Xe[Bt]],lr=Lt.numPoints,zr={type:1,geometry:[[Math.round(this.options.extent*(Lt.x*ut-le)),Math.round(this.options.extent*(Lt.y*ut-xe))]],tags:lr?st(Lt):this.points[Lt.index].properties},Vr=void 0;lr?Vr=Lt.id:this.options.generateId?Vr=Lt.index:this.points[Lt.index].id&&(Vr=this.points[Lt.index].id),Vr!==void 0&&(zr.id=Vr),wt.features.push(zr)}},Mt.prototype._limitZoom=function(U){return Math.max(this.options.minZoom,Math.min(+U,this.options.maxZoom+1))},Mt.prototype._cluster=function(U,Z){for(var le=[],xe=this.options,ut=xe.reduce,wt=xe.minPoints,Bt=xe.radius/(xe.extent*Math.pow(2,Z)),Xe=0;Xe<U.length;Xe++){var Lt=U[Xe];if(!(Lt.zoom<=Z)){Lt.zoom=Z;for(var lr=this.trees[Z+1],zr=lr.within(Lt.x,Lt.y,Bt),Vr=Lt.numPoints||1,cr=Vr,Ur=0,Mn=zr;Ur<Mn.length;Ur+=1){var ln=lr.points[Mn[Ur]];ln.zoom>Z&&(cr+=ln.numPoints||1)}if(cr>=wt){for(var er=Lt.x*Vr,tn=Lt.y*Vr,hn=ut&&Vr>1?this._map(Lt,!0):null,xn=(Xe<<5)+(Z+1)+this.points.length,yn=0,vn=zr;yn<vn.length;yn+=1){var Pn=lr.points[vn[yn]];if(!(Pn.zoom<=Z)){Pn.zoom=Z;var Va=Pn.numPoints||1;er+=Pn.x*Va,tn+=Pn.y*Va,Pn.parentId=xn,ut&&(hn||(hn=this._map(Lt,!0)),ut(hn,this._map(Pn)))}}Lt.parentId=xn,le.push(ve(er/cr,tn/cr,xn,cr,hn))}else if(le.push(Lt),cr>1)for(var va=0,Ma=zr;va<Ma.length;va+=1){var Ia=lr.points[Ma[va]];Ia.zoom<=Z||(Ia.zoom=Z,le.push(Ia))}}}return le},Mt.prototype._getOriginId=function(U){return U-this.points.length>>5},Mt.prototype._getOriginZoom=function(U){return(U-this.points.length)%32},Mt.prototype._map=function(U,Z){if(U.numPoints)return Z?C({},U.properties):U.properties;var le=this.points[U.index].properties,xe=this.options.map(le);return Z&&xe===le?C({},xe):xe},zn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},zn.prototype.splitTile=function(U,Z,le,xe,ut,wt,Bt){for(var Xe=[U,Z,le,xe],Lt=this.options,lr=Lt.debug;Xe.length;){xe=Xe.pop(),le=Xe.pop(),Z=Xe.pop(),U=Xe.pop();var zr=1<<Z,Vr=oa(Z,le,xe),cr=this.tiles[Vr];if(!cr&&(lr>1&&console.time("creation"),cr=this.tiles[Vr]=Hr(U,Z,le,xe,Lt),this.tileCoords.push({z:Z,x:le,y:xe}),lr)){lr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,le,xe,cr.numFeatures,cr.numPoints,cr.numSimplified),console.timeEnd("creation"));var Ur="z"+Z;this.stats[Ur]=(this.stats[Ur]||0)+1,this.total++}if(cr.source=U,ut){if(Z===Lt.maxZoom||Z===ut)continue;var Mn=1<<ut-Z;if(le!==Math.floor(wt/Mn)||xe!==Math.floor(Bt/Mn))continue}else if(Z===Lt.indexMaxZoom||cr.numPoints<=Lt.indexMaxPoints)continue;if(cr.source=null,U.length!==0){lr>1&&console.time("clipping");var ln,er,tn,hn,xn,yn,vn=.5*Lt.buffer/Lt.extent,Pn=.5-vn,Va=.5+vn,va=1+vn;ln=er=tn=hn=null,xn=tt(U,zr,le-vn,le+Va,0,cr.minX,cr.maxX,Lt),yn=tt(U,zr,le+Pn,le+va,0,cr.minX,cr.maxX,Lt),U=null,xn&&(ln=tt(xn,zr,xe-vn,xe+Va,1,cr.minY,cr.maxY,Lt),er=tt(xn,zr,xe+Pn,xe+va,1,cr.minY,cr.maxY,Lt),xn=null),yn&&(tn=tt(yn,zr,xe-vn,xe+Va,1,cr.minY,cr.maxY,Lt),hn=tt(yn,zr,xe+Pn,xe+va,1,cr.minY,cr.maxY,Lt),yn=null),lr>1&&console.timeEnd("clipping"),Xe.push(ln||[],Z+1,2*le,2*xe),Xe.push(er||[],Z+1,2*le,2*xe+1),Xe.push(tn||[],Z+1,2*le+1,2*xe),Xe.push(hn||[],Z+1,2*le+1,2*xe+1)}}},zn.prototype.getTile=function(U,Z,le){var xe=this.options,ut=xe.extent,wt=xe.debug;if(U<0||U>24)return null;var Bt=1<<U,Xe=oa(U,Z=(Z%Bt+Bt)%Bt,le);if(this.tiles[Xe])return Ht(this.tiles[Xe],ut);wt>1&&console.log("drilling down to z%d-%d-%d",U,Z,le);for(var Lt,lr=U,zr=Z,Vr=le;!Lt&&lr>0;)lr--,zr=Math.floor(zr/2),Vr=Math.floor(Vr/2),Lt=this.tiles[oa(lr,zr,Vr)];return Lt&&Lt.source?(wt>1&&console.log("found parent tile z%d-%d-%d",lr,zr,Vr),wt>1&&console.time("drilling down"),this.splitTile(Lt.source,lr,zr,Vr,U,Z,le),wt>1&&console.timeEnd("drilling down"),this.tiles[Xe]?Ht(this.tiles[Xe],ut):null):null};var Yn=function(U){function Z(le,xe,ut,wt){U.call(this,le,xe,ut,$n),wt&&(this.loadGeoJSON=wt)}return U&&(Z.__proto__=U),(Z.prototype=Object.create(U&&U.prototype)).constructor=Z,Z.prototype.loadData=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=xe,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Z.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var xe=this._pendingCallback,ut=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var wt=!!(ut&&ut.request&&ut.request.collectResourceTiming)&&new i.RequestPerformance(ut.request);this.loadGeoJSON(ut,function(Bt,Xe){if(Bt||!Xe)return xe(Bt);if(typeof Xe!="object")return xe(new Error("Input data given to '"+ut.source+"' is not a valid GeoJSON object."));!function cr(Ur,Mn){var ln,er=Ur&&Ur.type;if(er==="FeatureCollection")for(ln=0;ln<Ur.features.length;ln++)cr(Ur.features[ln],Mn);else if(er==="GeometryCollection")for(ln=0;ln<Ur.geometries.length;ln++)cr(Ur.geometries[ln],Mn);else if(er==="Feature")cr(Ur.geometry,Mn);else if(er==="Polygon")ht(Ur.coordinates,Mn);else if(er==="MultiPolygon")for(ln=0;ln<Ur.coordinates.length;ln++)ht(Ur.coordinates[ln],Mn);return Ur}(Xe,!0);try{if(ut.filter){var Lt=i.createExpression(ut.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Lt.result==="error")throw new Error(Lt.value.map(function(cr){return cr.key+": "+cr.message}).join(", "));var lr=Xe.features.filter(function(cr){return Lt.value.evaluate({zoom:0},cr)});Xe={type:"FeatureCollection",features:lr}}le._geoJSONIndex=ut.cluster?new Mt(function(cr){var Ur=cr.superclusterOptions,Mn=cr.clusterProperties;if(!Mn||!Ur)return Ur;for(var ln={},er={},tn={accumulated:null,zoom:0},hn={properties:null},xn=Object.keys(Mn),yn=0,vn=xn;yn<vn.length;yn+=1){var Pn=vn[yn],Va=Mn[Pn],va=Va[0],Ma=i.createExpression(Va[1]),Ia=i.createExpression(typeof va=="string"?[va,["accumulated"],["get",Pn]]:va);ln[Pn]=Ma.value,er[Pn]=Ia.value}return Ur.map=function(Zi){hn.properties=Zi;for(var da={},di=0,ga=xn;di<ga.length;di+=1){var ya=ga[di];da[ya]=ln[ya].evaluate(tn,hn)}return da},Ur.reduce=function(Zi,da){hn.properties=da;for(var di=0,ga=xn;di<ga.length;di+=1){var ya=ga[di];tn.accumulated=Zi[ya],Zi[ya]=er[ya].evaluate(tn,hn)}},Ur}(ut)).load(Xe.features):function(cr,Ur){return new zn(cr,Ur)}(Xe,ut.geojsonVtOptions)}catch(cr){return xe(cr)}le.loaded={};var zr={};if(wt){var Vr=wt.finish();Vr&&(zr.resourceTiming={},zr.resourceTiming[ut.source]=JSON.parse(JSON.stringify(Vr)))}xe(null,zr)})}},Z.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Z.prototype.reloadTile=function(le,xe){var ut=this.loaded;return ut&&ut[le.uid]?U.prototype.reloadTile.call(this,le,xe):this.loadTile(le,xe)},Z.prototype.loadGeoJSON=function(le,xe){if(le.request)i.getJSON(le.request,xe);else{if(typeof le.data!="string")return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return xe(null,JSON.parse(le.data))}catch(ut){return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},Z.prototype.removeSource=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),xe()},Z.prototype.getClusterExpansionZoom=function(le,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(ut){xe(ut)}},Z.prototype.getClusterChildren=function(le,xe){try{xe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(ut){xe(ut)}},Z.prototype.getClusterLeaves=function(le,xe){try{xe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(ut){xe(ut)}},Z}(pe),On=function(Z){var le=this;this.self=Z,this.actor=new i.Actor(Z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:pe,geojson:Yn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(xe,ut){if(le.workerSourceTypes[xe])throw new Error('Worker source with name "'+xe+'" already registered.');le.workerSourceTypes[xe]=ut},this.self.registerRTLTextPlugin=function(xe){if(i.plugin.isParsed())throw new Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=xe.applyArabicShaping,i.plugin.processBidirectionalText=xe.processBidirectionalText,i.plugin.processStyledBidirectionalText=xe.processStyledBidirectionalText}};return On.prototype.setReferrer=function(U,Z){this.referrer=Z},On.prototype.setImages=function(U,Z,le){for(var xe in this.availableImages[U]=Z,this.workerSources[U]){var ut=this.workerSources[U][xe];for(var wt in ut)ut[wt].availableImages=Z}le()},On.prototype.setLayers=function(U,Z,le){this.getLayerIndex(U).replace(Z),le()},On.prototype.updateLayers=function(U,Z,le){this.getLayerIndex(U).update(Z.layers,Z.removedIds),le()},On.prototype.loadTile=function(U,Z,le){this.getWorkerSource(U,Z.type,Z.source).loadTile(Z,le)},On.prototype.loadDEMTile=function(U,Z,le){this.getDEMWorkerSource(U,Z.source).loadTile(Z,le)},On.prototype.reloadTile=function(U,Z,le){this.getWorkerSource(U,Z.type,Z.source).reloadTile(Z,le)},On.prototype.abortTile=function(U,Z,le){this.getWorkerSource(U,Z.type,Z.source).abortTile(Z,le)},On.prototype.removeTile=function(U,Z,le){this.getWorkerSource(U,Z.type,Z.source).removeTile(Z,le)},On.prototype.removeDEMTile=function(U,Z){this.getDEMWorkerSource(U,Z.source).removeTile(Z)},On.prototype.removeSource=function(U,Z,le){if(this.workerSources[U]&&this.workerSources[U][Z.type]&&this.workerSources[U][Z.type][Z.source]){var xe=this.workerSources[U][Z.type][Z.source];delete this.workerSources[U][Z.type][Z.source],xe.removeSource!==void 0?xe.removeSource(Z,le):le()}},On.prototype.loadWorkerSource=function(U,Z,le){try{this.self.importScripts(Z.url),le()}catch(xe){le(xe.toString())}},On.prototype.syncRTLPluginState=function(U,Z,le){try{i.plugin.setState(Z);var xe=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&xe!=null){this.self.importScripts(xe);var ut=i.plugin.isParsed();le(ut?void 0:new Error("RTL Text Plugin failed to import scripts from "+xe),ut)}}catch(wt){le(wt.toString())}},On.prototype.getAvailableImages=function(U){var Z=this.availableImages[U];return Z||(Z=[]),Z},On.prototype.getLayerIndex=function(U){var Z=this.layerIndexes[U];return Z||(Z=this.layerIndexes[U]=new Q),Z},On.prototype.getWorkerSource=function(U,Z,le){var xe=this;return this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][Z]||(this.workerSources[U][Z]={}),this.workerSources[U][Z][le]||(this.workerSources[U][Z][le]=new this.workerSourceTypes[Z]({send:function(wt,Bt,Xe){xe.actor.send(wt,Bt,Xe,U)}},this.getLayerIndex(U),this.getAvailableImages(U))),this.workerSources[U][Z][le]},On.prototype.getDEMWorkerSource=function(U,Z){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][Z]||(this.demWorkerSources[U][Z]=new Pe),this.demWorkerSources[U][Z]},On.prototype.enforceCacheSizeLimit=function(U,Z){i.enforceCacheSizeLimit(Z)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new On(self)),On}),z(["./shared"],function(i){"use strict";var W=i.createCommonjsModule(function(s){function a(g){return!n(g)}function n(g){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,F,ue=new Blob([""],{type:"text/javascript"}),Ee=URL.createObjectURL(ue);try{F=new Worker(Ee),L=!0}catch($e){L=!1}return F&&F.terminate(),URL.revokeObjectURL(Ee),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var F=L.getContext("2d");if(!F)return!1;var ue=F.getImageData(0,0,1,1);return ue&&ue.width===L.width}()?(l[w=g&&g.failIfMajorPerformanceCaveat]===void 0&&(l[w]=function(L){var F=function(Ee){var $e=document.createElement("canvas"),rt=Object.create(a.webGLContextAttributes);return rt.failIfMajorPerformanceCaveat=Ee,$e.probablySupportsContext?$e.probablySupportsContext("webgl",rt)||$e.probablySupportsContext("experimental-webgl",rt):$e.supportsContext?$e.supportsContext("webgl",rt)||$e.supportsContext("experimental-webgl",rt):$e.getContext("webgl",rt)||$e.getContext("experimental-webgl",rt)}(L);if(!F)return!1;var ue=F.createShader(F.VERTEX_SHADER);return!(!ue||F.isContextLost())&&(F.shaderSource(ue,"void main() {}"),F.compileShader(ue),F.getShaderParameter(ue,F.COMPILE_STATUS)===!0)}(w)),l[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}s.exports?s.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(a,n,l){var g=i.window.document.createElement(a);return n!==void 0&&(g.className=n),l&&l.appendChild(g),g},createNS:function(a,n){return i.window.document.createElementNS(a,n)}},Q=i.window.document&&i.window.document.documentElement.style;function ee(s){if(!Q)return s[0];for(var a=0;a<s.length;a++)if(s[a]in Q)return s[a];return s[0]}var ce,K=ee(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){Q&&K&&(ce=Q[K],Q[K]="none")},D.enableDrag=function(){Q&&K&&(Q[K]=ce)};var je=ee(["transform","WebkitTransform"]);D.setTransform=function(s,a){s.style[je]=a};var pe=!1;try{var Ke=Object.defineProperty({},"passive",{get:function(){pe=!0}});i.window.addEventListener("test",Ke,Ke),i.window.removeEventListener("test",Ke,Ke)}catch(s){pe=!1}D.addEventListener=function(s,a,n,l){l===void 0&&(l={}),s.addEventListener(a,n,"passive"in l&&pe?l:l.capture)},D.removeEventListener=function(s,a,n,l){l===void 0&&(l={}),s.removeEventListener(a,n,"passive"in l&&pe?l:l.capture)};var Pe=function s(a){a.preventDefault(),a.stopPropagation(),i.window.removeEventListener("click",s,!0)};function ht(s){var a=s.userImage;return!!(a&&a.render&&a.render())&&(s.data.replace(new Uint8Array(a.data.buffer)),!0)}D.suppressClick=function(){i.window.addEventListener("click",Pe,!0),i.window.setTimeout(function(){i.window.removeEventListener("click",Pe,!0)},0)},D.mousePos=function(s,a){var n=s.getBoundingClientRect();return new i.Point(a.clientX-n.left-s.clientLeft,a.clientY-n.top-s.clientTop)},D.touchPos=function(s,a){for(var n=s.getBoundingClientRect(),l=[],g=0;g<a.length;g++)l.push(new i.Point(a[g].clientX-n.left-s.clientLeft,a[g].clientY-n.top-s.clientTop));return l},D.mouseButton=function(s){return i.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&i.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},D.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var Le=function(s){function a(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,g=this.requestors;l<g.length;l+=1){var w=g[l];this._notify(w.ids,w.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},a.prototype._validate=function(n,l){var g=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),g=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),g=!1),this._validateContent(l.content,l)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),g=!1),g},a.prototype._validateStretch=function(n,l){if(!n)return!0;for(var g=0,w=0,L=n;w<L.length;w+=1){var F=L[w];if(F[0]<g||F[1]<F[0]||l<F[1])return!1;g=F[1]}return!0},a.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,l){var g=!0;if(!this.isLoaded())for(var w=0,L=n;w<L.length;w+=1)this.images[L[w]]||(g=!1);this.isLoaded()||g?this._notify(n,l):this.requestors.push({ids:n,callback:l})},a.prototype._notify=function(n,l){for(var g={},w=0,L=n;w<L.length;w+=1){var F=L[w];this.images[F]||this.fire(new i.Event("styleimagemissing",{id:F}));var ue=this.images[F];ue?g[F]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:i.warnOnce('Image "'+F+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,g)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var l=this.patterns[n],g=this.getImage(n);if(!g)return null;if(l&&l.position.version===g.version)return l.position;if(l)l.position.version=g.version;else{var w={w:g.data.width+2,h:g.data.height+2,x:0,y:0},L=new i.ImagePosition(w,g);this.patterns[n]={bin:w,position:L}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var g=i.potpack(n),w=g.w,L=g.h,F=this.atlasImage;for(var ue in F.resize({width:w||1,height:L||1}),this.patterns){var Ee=this.patterns[ue].bin,$e=Ee.x+1,rt=Ee.y+1,nt=this.images[ue].data,Ft=nt.width,Nt=nt.height;i.RGBAImage.copy(nt,F,{x:0,y:0},{x:$e,y:rt},{width:Ft,height:Nt}),i.RGBAImage.copy(nt,F,{x:0,y:Nt-1},{x:$e,y:rt-1},{width:Ft,height:1}),i.RGBAImage.copy(nt,F,{x:0,y:0},{x:$e,y:rt+Nt},{width:Ft,height:1}),i.RGBAImage.copy(nt,F,{x:Ft-1,y:0},{x:$e-1,y:rt},{width:1,height:Nt}),i.RGBAImage.copy(nt,F,{x:0,y:0},{x:$e+Ft,y:rt},{width:1,height:Nt})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var l=0,g=n;l<g.length;l+=1){var w=g[l];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var L=this.images[w];ht(L)&&this.updateImage(w,L)}}},a}(i.Evented),_t=Ze,ot=Ze,et=1e20;function Ze(s,a,n,l,g,w){this.fontSize=s||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=g||"sans-serif",this.fontWeight=w||"normal",this.radius=n||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function At(s,a,n,l,g,w,L){for(var F=0;F<a;F++){for(var ue=0;ue<n;ue++)l[ue]=s[ue*a+F];for(St(l,g,w,L,n),ue=0;ue<n;ue++)s[ue*a+F]=g[ue]}for(ue=0;ue<n;ue++){for(F=0;F<a;F++)l[F]=s[ue*a+F];for(St(l,g,w,L,a),F=0;F<a;F++)s[ue*a+F]=Math.sqrt(g[F])}}function St(s,a,n,l,g){n[0]=0,l[0]=-et,l[1]=+et;for(var w=1,L=0;w<g;w++){for(var F=(s[w]+w*w-(s[n[L]]+n[L]*n[L]))/(2*w-2*n[L]);F<=l[L];)L--,F=(s[w]+w*w-(s[n[L]]+n[L]*n[L]))/(2*w-2*n[L]);n[++L]=w,l[L]=F,l[L+1]=+et}for(w=0,L=0;w<g;w++){for(;l[L+1]<w;)L++;a[w]=(w-n[L])*(w-n[L])+s[n[L]]}}Ze.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var g=a.data[4*l+3]/255;this.gridOuter[l]=g===1?0:g===0?et:Math.pow(Math.max(0,.5-g),2),this.gridInner[l]=g===1?et:g===0?0:Math.pow(Math.max(0,g-.5),2)}for(At(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),At(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},_t.default=ot;var De=function(a,n){this.requestManager=a,this.localIdeographFontFamily=n,this.entries={}};De.prototype.setURL=function(s){this.url=s},De.prototype.getGlyphs=function(s,a){var n=this,l=[];for(var g in s)for(var w=0,L=s[g];w<L.length;w+=1)l.push({stack:g,id:L[w]});i.asyncAll(l,function(F,ue){var Ee=F.stack,$e=F.id,rt=n.entries[Ee];rt||(rt=n.entries[Ee]={glyphs:{},requests:{},ranges:{}});var nt=rt.glyphs[$e];if(nt===void 0){if(nt=n._tinySDF(rt,Ee,$e))return rt.glyphs[$e]=nt,void ue(null,{stack:Ee,id:$e,glyph:nt});var Ft=Math.floor($e/256);if(256*Ft>65535)ue(new Error("glyphs > 65535 not supported"));else if(rt.ranges[Ft])ue(null,{stack:Ee,id:$e,glyph:nt});else{var Nt=rt.requests[Ft];Nt||(Nt=rt.requests[Ft]=[],De.loadGlyphRange(Ee,Ft,n.url,n.requestManager,function(Kt,jt){if(jt){for(var Gt in jt)n._doesCharSupportLocalGlyph(+Gt)||(rt.glyphs[+Gt]=jt[+Gt]);rt.ranges[Ft]=!0}for(var nr=0,rr=Nt;nr<rr.length;nr+=1)(0,rr[nr])(Kt,jt);delete rt.requests[Ft]})),Nt.push(function(Kt,jt){Kt?ue(Kt):jt&&ue(null,{stack:Ee,id:$e,glyph:jt[$e]||null})})}}else ue(null,{stack:Ee,id:$e,glyph:nt})},function(F,ue){if(F)a(F);else if(ue){for(var Ee={},$e=0,rt=ue;$e<rt.length;$e+=1){var nt=rt[$e],Ft=nt.stack,Nt=nt.id,Kt=nt.glyph;(Ee[Ft]||(Ee[Ft]={}))[Nt]=Kt&&{id:Kt.id,bitmap:Kt.bitmap.clone(),metrics:Kt.metrics}}a(null,Ee)}})},De.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(i.isChar["CJK Unified Ideographs"](s)||i.isChar["Hangul Syllables"](s)||i.isChar.Hiragana(s)||i.isChar.Katakana(s))},De.prototype._tinySDF=function(s,a,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var g=s.tinySDF;if(!g){var w="400";/bold/i.test(a)?w="900":/medium/i.test(a)?w="500":/light/i.test(a)&&(w="200"),g=s.tinySDF=new De.TinySDF(24,3,8,.25,l,w)}return{id:n,bitmap:new i.AlphaImage({width:30,height:30},g.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},De.loadGlyphRange=function(s,a,n,l,g){var w=256*a,L=w+255,F=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",w+"-"+L),i.ResourceType.Glyphs);i.getArrayBuffer(F,function(ue,Ee){if(ue)g(ue);else if(Ee){for(var $e={},rt=0,nt=i.parseGlyphPBF(Ee);rt<nt.length;rt+=1){var Ft=nt[rt];$e[Ft.id]=Ft}g(null,$e)}})},De.TinySDF=_t;var Ie=function(){this.specification=i.styleSpec.light.position};Ie.prototype.possiblyEvaluate=function(s,a){return i.sphericalToCartesian(s.expression.evaluate(a))},Ie.prototype.interpolate=function(s,a,n){return{x:i.number(s.x,a.x,n),y:i.number(s.y,a.y,n),z:i.number(s.z,a.z,n)}};var Ge=new i.Properties({anchor:new i.DataConstantProperty(i.styleSpec.light.anchor),position:new Ie,color:new i.DataConstantProperty(i.styleSpec.light.color),intensity:new i.DataConstantProperty(i.styleSpec.light.intensity)}),dt=function(s){function a(n){s.call(this),this._transitionable=new i.Transitionable(Ge),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(i.validateLight,n,l))for(var g in n){var w=n[g];i.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-"-transition".length),w):this._transitionable.setValue(g,w)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,l,g){return(!g||g.validate!==!1)&&i.emitValidationErrors(this,n.call(i.validateStyle,i.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.styleSpec})))},a}(i.Evented),we=function(a,n){this.width=a,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};we.prototype.getDash=function(s,a){var n=s.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,a)),this.dashEntry[n]},we.prototype.getDashRanges=function(s,a,n){var l=[],g=s.length%2==1?-s[s.length-1]*n:0,w=s[0]*n,L=!0;l.push({left:g,right:w,isDash:L,zeroLength:s[0]===0});for(var F=s[0],ue=1;ue<s.length;ue++){var Ee=s[ue];l.push({left:g=F*n,right:w=(F+=Ee)*n,isDash:L=!L,zeroLength:Ee===0})}return l},we.prototype.addRoundDash=function(s,a,n){for(var l=a/2,g=-n;g<=n;g++)for(var w=this.width*(this.nextRow+n+g),L=0,F=s[L],ue=0;ue<this.width;ue++){ue/F.right>1&&(F=s[++L]);var Ee=Math.abs(ue-F.left),$e=Math.abs(ue-F.right),rt=Math.min(Ee,$e),nt=void 0,Ft=g/n*(l+1);if(F.isDash){var Nt=l-Math.abs(Ft);nt=Math.sqrt(rt*rt+Nt*Nt)}else nt=l-Math.sqrt(rt*rt+Ft*Ft);this.data[w+ue]=Math.max(0,Math.min(255,nt+128))}},we.prototype.addRegularDash=function(s){for(var a=s.length-1;a>=0;--a){var n=s[a],l=s[a+1];n.zeroLength?s.splice(a,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(a,1))}var g=s[0],w=s[s.length-1];g.isDash===w.isDash&&(g.left=w.left-this.width,w.right=g.right+this.width);for(var L=this.width*this.nextRow,F=0,ue=s[F],Ee=0;Ee<this.width;Ee++){Ee/ue.right>1&&(ue=s[++F]);var $e=Math.abs(Ee-ue.left),rt=Math.abs(Ee-ue.right),nt=Math.min($e,rt);this.data[L+Ee]=Math.max(0,Math.min(255,(ue.isDash?nt:-nt)+128))}},we.prototype.addDash=function(s,a){var n=a?7:0,l=2*n+1;if(this.nextRow+l>this.height)return i.warnOnce("LineAtlas out of space"),null;for(var g=0,w=0;w<s.length;w++)g+=s[w];if(g!==0){var L=this.width/g,F=this.getDashRanges(s,this.width,L);a?this.addRoundDash(F,L,n):this.addRegularDash(F)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:g};return this.nextRow+=l,this.dirty=!0,ue},we.prototype.bind=function(s){var a=s.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var pt=function s(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=i.uniqueId();for(var l=this.workerPool.acquire(this.id),g=0;g<l.length;g++){var w=new s.Actor(l[g],n,this.id);w.name="Worker "+g,this.actors.push(w)}};function Wt(s,a,n){var l=function(w,L){if(w)return n(w);if(L){var F=i.pick(i.extend(L,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(F.vectorLayers=L.vector_layers,F.vectorLayerIds=F.vectorLayers.map(function(ue){return ue.id})),F.tiles=a.canonicalizeTileset(F,s.url),n(null,F)}};return s.url?i.getJSON(a.transformRequest(a.normalizeSourceURL(s.url),i.ResourceType.Source),l):i.browser.frame(function(){return l(null,s)})}pt.prototype.broadcast=function(s,a,n){i.asyncAll(this.actors,function(l,g){l.send(s,a,g)},n=n||function(){})},pt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},pt.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},pt.Actor=i.Actor;var Qt=function(a,n,l){this.bounds=i.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=l||24};Qt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},Qt.prototype.contains=function(s){var a=Math.pow(2,s.z),n=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*a),g=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*a),w=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*a);return s.x>=n&&s.x<g&&s.y>=l&&s.y<w};var ur=function(s){function a(n,l,g,w){if(s.call(this),this.id=n,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(l,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,g){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):g&&(i.extend(n,g),g.bounds&&(n.tileBounds=new Qt(g.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(g.tiles,n.map._requestManager._customAccessToken),i.postMapLoadEvent(g.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},a.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.loadTile=function(n,l){var g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(g,i.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(F,ue){return delete n.request,n.aborted?l(null):F&&F.status!==404?l(F):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",w,L.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",w,L.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(i.Evented),oe=function(s){function a(n,l,g,w){s.call(this),this.id=n,this.dispatcher=g,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},l),i.extend(this,i.pick(l,["url","scheme","tileSize"]))}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,g){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):g&&(i.extend(n,g),g.bounds&&(n.tileBounds=new Qt(g.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(g.tiles),i.postMapLoadEvent(g.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,l){var g=this,w=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=i.getImage(this.map._requestManager.transformRequest(w,i.ResourceType.Tile),function(L,F){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(F){g.map._refreshExpiredTiles&&n.setExpiryData(F),delete F.cacheControl,delete F.expires;var ue=g.map.painter.context,Ee=ue.gl;n.texture=g.map.painter.getTileTexture(F.width),n.texture?n.texture.update(F,{useMipmap:!0}):(n.texture=new i.Texture(ue,F,Ee.RGBA,{useMipmap:!0}),n.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE,Ee.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Ee.texParameterf(Ee.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",i.cacheEntryPossiblyAdded(g.dispatcher),l(null)}})},a.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},a.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},a.prototype.hasTransition=function(){return!1},a}(i.Evented),J=function(s){function a(n,l,g,w){s.call(this,n,l,g,w),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,l){var g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(L,F){L&&(n.state="errored",l(L)),F&&(n.dem=F,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=i.getImage(this.map._requestManager.transformRequest(g,i.ResourceType.Tile),function(L,F){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(F){this.map._refreshExpiredTiles&&n.setExpiryData(F),delete F.cacheControl,delete F.expires;var ue=i.window.ImageBitmap&&F instanceof i.window.ImageBitmap&&i.offscreenCanvasSupported()?F:i.browser.getImageData(F,1),Ee={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Ee,w.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var l=n.canonical,g=Math.pow(2,l.z),w=(l.x-1+g)%g,L=l.x===0?n.wrap-1:n.wrap,F=(l.x+1+g)%g,ue=l.x+1===g?n.wrap+1:n.wrap,Ee={};return Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,w,l.y).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,F,l.y).key]={backfilled:!1},l.y>0&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,w,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,F,l.y-1).key]={backfilled:!1}),l.y+1<g&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,w,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,F,l.y+1).key]={backfilled:!1}),Ee},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(oe),H=function(s){function a(n,l,g,w){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(w),this._data=l.data,this._options=i.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var L=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*L,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*L,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:i.EXTENT,radius:(l.clusterRadius||50)*L,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new i.ErrorEvent(l));else{var g={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(g.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new i.Event("data",g))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)l.fire(new i.ErrorEvent(g));else{var w={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(w.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new i.Event("data",w))}}),this},a.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},a.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},a.prototype.getClusterLeaves=function(n,l,g,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:g},w),this},a.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var g=i.extend({},this.workerOptions),w=this._data;typeof w=="string"?(g.request=this.map._requestManager.transformRequest(i.browser.resolveURL(w),i.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(w),this.actor.send(this.type+".loadData",g,function(L,F){l._removed||F&&F.abandoned||(l._loaded=!0,F&&F.resourceTiming&&F.resourceTiming[l.id]&&(l._resourceTiming=F.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:g.source},null),n(L))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,l){var g=this,w=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(w,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,F){return delete n.request,n.unloadVectorData(),n.aborted?l(null):L?l(L):(n.loadVectorData(F,g.map.painter,w==="reloadTile"),l(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return i.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Se=i.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),be=function(s){function a(n,l,g,w){s.call(this),this.id=n,this.dispatcher=g,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(n,l){var g=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),function(w,L){g._loaded=!0,w?g.fire(new i.ErrorEvent(w)):L&&(g.image=L,n&&(g.coordinates=n),l&&l(),g._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var g=n.map(i.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var F=1/0,ue=1/0,Ee=-1/0,$e=-1/0,rt=0,nt=L;rt<nt.length;rt+=1){var Ft=nt[rt];F=Math.min(F,Ft.x),ue=Math.min(ue,Ft.y),Ee=Math.max(Ee,Ft.x),$e=Math.max($e,Ft.y)}var Nt=Math.max(Ee-F,$e-ue),Kt=Math.max(0,Math.floor(-Math.log(Nt)/Math.LN2)),jt=Math.pow(2,Kt);return new i.CanonicalTileID(Kt,Math.floor((F+Ee)/2*jt),Math.floor((ue+$e)/2*jt))}(g),this.minzoom=this.maxzoom=this.tileID.z;var w=g.map(function(L){return l.tileID.getTilePoint(L)._round()});return this._boundsArray=new i.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,i.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,i.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,i.EXTENT,i.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new i.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},a.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Te=function(s){function a(n,l,g,w){s.call(this,n,l,g,w),this.roundZoom=!0,this.type="video",this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var g=0,w=l.urls;g<w.length;g+=1)this.urls.push(this.map._requestManager.transformRequest(w[g],i.ResourceType.Source).url);i.getVideo(this.urls,function(L,F){n._loaded=!0,L?n.fire(new i.ErrorEvent(L)):F&&(n.video=F,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new i.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(be),me=function(s){function a(n,l,g,w){s.call(this,n,l,g,w),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(L){return!Array.isArray(L)||L.length!==2||L.some(function(F){return typeof F!="number"})})||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof i.window.HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof i.window.HTMLCanvasElement?this.options.canvas:i.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,g=l.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.Texture(l,this.canvas,g.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[w];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var g=l[n];if(isNaN(g)||g<=0)return!0}return!1},a}(be),at={vector:ur,raster:oe,"raster-dem":J,geojson:H,video:Te,image:be,canvas:me};function Jt(s,a){var n=i.identity([]);return i.translate(n,n,[1,1,0]),i.scale(n,n,[.5*s.width,.5*s.height,1]),i.multiply(n,n,s.calculatePosMatrix(a.toUnwrapped()))}function Mt(s,a,n,l,g,w){var L=function(Kt,jt,Gt){if(Kt)for(var nr=0,rr=Kt;nr<rr.length;nr+=1){var Lr=jt[rr[nr]];if(Lr&&Lr.source===Gt&&Lr.type==="fill-extrusion")return!0}else for(var vr in jt){var Sr=jt[vr];if(Sr.source===Gt&&Sr.type==="fill-extrusion")return!0}return!1}(g&&g.layers,a,s.id),F=w.maxPitchScaleFactor(),ue=s.tilesIn(l,F,L);ue.sort(ve);for(var Ee=[],$e=0,rt=ue;$e<rt.length;$e+=1){var nt=rt[$e];Ee.push({wrappedTileID:nt.tileID.wrapped().key,queryResults:nt.tile.queryRenderedFeatures(a,n,s._state,nt.queryGeometry,nt.cameraQueryGeometry,nt.scale,g,w,F,Jt(s.transform,nt.tileID))})}var Ft=function(Kt){for(var jt={},Gt={},nr=0,rr=Kt;nr<rr.length;nr+=1){var Lr=rr[nr],vr=Lr.queryResults,Sr=Lr.wrappedTileID,Ar=Gt[Sr]=Gt[Sr]||{};for(var rn in vr)for(var Xr=vr[rn],mn=Ar[rn]=Ar[rn]||{},Ln=jt[rn]=jt[rn]||[],qn=0,sa=Xr;qn<sa.length;qn+=1){var Sa=sa[qn];mn[Sa.featureIndex]||(mn[Sa.featureIndex]=!0,Ln.push(Sa))}}return jt}(Ee);for(var Nt in Ft)Ft[Nt].forEach(function(Kt){var jt=Kt.feature,Gt=s.getFeatureState(jt.layer["source-layer"],jt.id);jt.source=jt.layer.source,jt.layer["source-layer"]&&(jt.sourceLayer=jt.layer["source-layer"]),jt.state=Gt});return Ft}function ve(s,a){var n=s.tileID,l=a.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var ge=function(a,n){this.max=a,this.onRemove=n,this.reset()};ge.prototype.reset=function(){for(var s in this.data)for(var a=0,n=this.data[s];a<n.length;a+=1){var l=n[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},ge.prototype.add=function(s,a,n){var l=this,g=s.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);var w={value:a,timeout:void 0};if(n!==void 0&&(w.timeout=setTimeout(function(){l.remove(s,w)},n)),this.data[g].push(w),this.order.push(g),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},ge.prototype.has=function(s){return s.wrapped().key in this.data},ge.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},ge.prototype._getAndRemoveByKey=function(s){var a=this.data[s].shift();return a.timeout&&clearTimeout(a.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),a.value},ge.prototype.getByKey=function(s){var a=this.data[s];return a?a[0].value:null},ge.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},ge.prototype.remove=function(s,a){if(!this.has(s))return this;var n=s.wrapped().key,l=a===void 0?0:this.data[n].indexOf(a),g=this.data[n][l];return this.data[n].splice(l,1),g.timeout&&clearTimeout(g.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(g.value),this.order.splice(this.order.indexOf(n),1),this},ge.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},ge.prototype.filter=function(s){var a=[];for(var n in this.data)for(var l=0,g=this.data[n];l<g.length;l+=1){var w=g[l];s(w.value)||a.push(w)}for(var L=0,F=a;L<F.length;L+=1){var ue=F[L];this.remove(ue.value.tileID,ue)}};var He=function(a,n,l){this.context=a;var g=a.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};He.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},He.prototype.updateData=function(s){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},He.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var st={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Oe=function(a,n,l,g){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=g,this.context=a;var w=a.gl;this.buffer=w.createBuffer(),a.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Oe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Oe.prototype.updateData=function(s){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,s.arrayBuffer)},Oe.prototype.enableAttributes=function(s,a){for(var n=0;n<this.attributes.length;n++){var l=a.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},Oe.prototype.setVertexAttribPointers=function(s,a,n){for(var l=0;l<this.attributes.length;l++){var g=this.attributes[l],w=a.attributes[g.name];w!==void 0&&s.vertexAttribPointer(w,g.components,s[st[g.type]],!1,this.itemSize,g.offset+this.itemSize*(n||0))}},Oe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var gt=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};gt.prototype.get=function(){return this.current},gt.prototype.set=function(s){},gt.prototype.getDefault=function(){return this.default},gt.prototype.setDefault=function(){this.set(this.default)};var C=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(gt),R=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(gt),q=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(gt),fe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(gt),We=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(gt),qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(gt),Tt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(gt),it=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(gt),Ut=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(gt),$=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(gt),Qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(gt),ne=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(gt),tt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},a}(gt),kt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(gt),dr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(gt),Ye=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(gt),xt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},a}(gt),bt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(gt),Et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(gt),ze=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(gt),vt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(gt),yt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(gt),Ht=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(gt),hr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(gt),Hr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(gt),gr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(gt),Bn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(gt),zn=function(s){function a(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(gt),oa=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(gt),$n=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(gt),Yn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(gt),On=function(s){function a(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(gt),U=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(On),Z=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(On),le=function(a,n,l,g){this.context=a,this.width=n,this.height=l;var w=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new U(a,w),g&&(this.depthAttachment=new Z(a,w))};le.prototype.destroy=function(){var s=this.context.gl,a=this.colorAttachment.get();if(a&&s.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var xe=function(a,n,l){this.func=a,this.mask=n,this.range=l};xe.ReadOnly=!1,xe.ReadWrite=!0,xe.disabled=new xe(519,xe.ReadOnly,[0,1]);var ut=function(a,n,l,g,w,L){this.test=a,this.ref=n,this.mask=l,this.fail=g,this.depthFail=w,this.pass=L};ut.disabled=new ut({func:519,mask:0},0,0,7680,7680,7680);var wt=function(a,n,l){this.blendFunction=a,this.blendColor=n,this.mask=l};wt.disabled=new wt(wt.Replace=[1,0],i.Color.transparent,[!1,!1,!1,!1]),wt.unblended=new wt(wt.Replace,i.Color.transparent,[!0,!0,!0,!0]),wt.alphaBlended=new wt([1,771],i.Color.transparent,[!0,!0,!0,!0]);var Bt=function(a,n,l){this.enable=a,this.mode=n,this.frontFace=l};Bt.disabled=new Bt(!1,1029,2305),Bt.backCCW=new Bt(!0,1029,2305);var Xe=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new C(this),this.clearDepth=new R(this),this.clearStencil=new q(this),this.colorMask=new fe(this),this.depthMask=new We(this),this.stencilMask=new qe(this),this.stencilFunc=new Tt(this),this.stencilOp=new it(this),this.stencilTest=new Ut(this),this.depthRange=new $(this),this.depthTest=new Qe(this),this.depthFunc=new ne(this),this.blend=new tt(this),this.blendFunc=new kt(this),this.blendColor=new dr(this),this.blendEquation=new Ye(this),this.cullFace=new xt(this),this.cullFaceSide=new bt(this),this.frontFace=new Et(this),this.program=new ze(this),this.activeTexture=new vt(this),this.viewport=new yt(this),this.bindFramebuffer=new Ht(this),this.bindRenderbuffer=new hr(this),this.bindTexture=new Hr(this),this.bindVertexBuffer=new gr(this),this.bindElementBuffer=new Bn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new zn(this),this.pixelStoreUnpack=new oa(this),this.pixelStoreUnpackPremultiplyAlpha=new $n(this),this.pixelStoreUnpackFlipY=new Yn(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};Xe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Xe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Xe.prototype.createIndexBuffer=function(s,a){return new He(this,s,a)},Xe.prototype.createVertexBuffer=function(s,a,n){return new Oe(this,s,a,n)},Xe.prototype.createRenderbuffer=function(s,a,n){var l=this.gl,g=l.createRenderbuffer();return this.bindRenderbuffer.set(g),l.renderbufferStorage(l.RENDERBUFFER,s,a,n),this.bindRenderbuffer.set(null),g},Xe.prototype.createFramebuffer=function(s,a,n){return new le(this,s,a,n)},Xe.prototype.clear=function(s){var a=s.color,n=s.depth,l=this.gl,g=0;a&&(g|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(g|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(g)},Xe.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},Xe.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},Xe.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},Xe.prototype.setColorMode=function(s){i.deepEqual(s.blendFunction,wt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},Xe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Lt=function(s){function a(n,l,g){var w=this;s.call(this),this.id=n,this.dispatcher=g,this.on("data",function(L){L.dataType==="source"&&L.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&L.dataType==="source"&&L.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(L,F,ue,Ee){var $e=new at[F.type](L,F,ue,Ee);if($e.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+$e.id);return i.bindAll(["load","abort","unload","serialize","prepare"],$e),$e}(n,l,g,this),this._tiles={},this._cache=new ge(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new i.SourceFeatureState}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var g=this._tiles[l];g.upload(n),g.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return i.values(this._tiles).map(function(n){return n.tileID}).sort(lr).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var l=this,g=[];for(var w in this._tiles)this._isIdRenderable(w,n)&&g.push(this._tiles[w]);return n?g.sort(function(L,F){var ue=L.tileID,Ee=F.tileID,$e=new i.Point(ue.canonical.x,ue.canonical.y)._rotate(l.transform.angle),rt=new i.Point(Ee.canonical.x,Ee.canonical.y)._rotate(l.transform.angle);return ue.overscaledZ-Ee.overscaledZ||rt.y-$e.y||rt.x-$e.x}).map(function(L){return L.tileID.key}):g.map(function(L){return L.tileID}).sort(lr).map(function(L){return L.key})},a.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,l){var g=this._tiles[n];g&&(g.state!=="loading"&&(g.state=l),this._loadTile(g,this._tileLoaded.bind(this,g,n,l)))},a.prototype._tileLoaded=function(n,l,g,w){if(w)return n.state="errored",void(w.status!==404?this._source.fire(new i.ErrorEvent(w,{tile:n})):this.update(this.transform));n.timeAdded=i.browser.now(),g==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new i.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),g=0;g<l.length;g++){var w=l[g];if(n.neighboringTiles&&n.neighboringTiles[w]){var L=this.getTileByID(w);F(n,L),F(L,n)}}function F(ue,Ee){ue.needsHillshadePrepare=!0;var $e=Ee.tileID.canonical.x-ue.tileID.canonical.x,rt=Ee.tileID.canonical.y-ue.tileID.canonical.y,nt=Math.pow(2,ue.tileID.canonical.z),Ft=Ee.tileID.key;$e===0&&rt===0||Math.abs(rt)>1||(Math.abs($e)>1&&(Math.abs($e+nt)===1?$e+=nt:Math.abs($e-nt)===1&&($e-=nt)),Ee.dem&&ue.dem&&(ue.dem.backfillBorder(Ee.dem,$e,rt),ue.neighboringTiles&&ue.neighboringTiles[Ft]&&(ue.neighboringTiles[Ft].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,l,g,w){for(var L in this._tiles){var F=this._tiles[L];if(!(w[L]||!F.hasData()||F.tileID.overscaledZ<=l||F.tileID.overscaledZ>g)){for(var ue=F.tileID;F&&F.tileID.overscaledZ>l+1;){var Ee=F.tileID.scaledTo(F.tileID.overscaledZ-1);(F=this._tiles[Ee.key])&&F.hasData()&&(ue=Ee)}for(var $e=ue;$e.overscaledZ>l;)if(n[($e=$e.scaledTo($e.overscaledZ-1)).key]){w[ue.key]=ue;break}}}},a.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var g=this._loadedParentTiles[n.key];return g&&g.tileID.overscaledZ>=l?g:null}for(var w=n.overscaledZ-1;w>=l;w--){var L=n.scaledTo(w),F=this._getLoadedTile(L);if(F)return F}},a.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,g=Math.ceil(n.height/this._source.tileSize)+1,w=Math.floor(l*g*5),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(L)},a.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var g={};for(var w in this._tiles){var L=this._tiles[w];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+l),g[L.tileID.key]=L}for(var F in this._tiles=g,this._timers)clearTimeout(this._timers[F]),delete this._timers[F];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},a.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var g;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?g=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ar){return new i.OverscaledTileID(Ar.canonical.z,Ar.wrap,Ar.canonical.z,Ar.canonical.x,Ar.canonical.y)}):(g=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(g=g.filter(function(Ar){return l._source.hasTile(Ar)}))):g=[];var w=n.coveringZoomLevel(this._source),L=Math.max(w-a.maxOverzooming,this._source.minzoom),F=Math.max(w+a.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(g,w);if(zr(this._source.type)){for(var Ee={},$e={},rt=0,nt=Object.keys(ue);rt<nt.length;rt+=1){var Ft=nt[rt],Nt=ue[Ft],Kt=this._tiles[Ft];if(Kt&&!(Kt.fadeEndTime&&Kt.fadeEndTime<=i.browser.now())){var jt=this.findLoadedParent(Nt,L);jt&&(this._addTile(jt.tileID),Ee[jt.tileID.key]=jt.tileID),$e[Ft]=Nt}}for(var Gt in this._retainLoadedChildren($e,w,F,ue),Ee)ue[Gt]||(this._coveredTiles[Gt]=!0,ue[Gt]=Ee[Gt])}for(var nr in ue)this._tiles[nr].clearFadeHold();for(var rr=0,Lr=i.keysDifference(this._tiles,ue);rr<Lr.length;rr+=1){var vr=Lr[rr],Sr=this._tiles[vr];Sr.hasSymbolBuckets&&!Sr.holdingForFade()?Sr.setHoldDuration(this.map._fadeDuration):Sr.hasSymbolBuckets&&!Sr.symbolFadeFinished()||this._removeTile(vr)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,l){for(var g={},w={},L=Math.max(l-a.maxOverzooming,this._source.minzoom),F=Math.max(l+a.maxUnderzooming,this._source.minzoom),ue={},Ee=0,$e=n;Ee<$e.length;Ee+=1){var rt=$e[Ee],nt=this._addTile(rt);g[rt.key]=rt,nt.hasData()||l<this._source.maxzoom&&(ue[rt.key]=rt)}this._retainLoadedChildren(ue,l,F,g);for(var Ft=0,Nt=n;Ft<Nt.length;Ft+=1){var Kt=Nt[Ft],jt=this._tiles[Kt.key];if(!jt.hasData()){if(l+1>this._source.maxzoom){var Gt=Kt.children(this._source.maxzoom)[0],nr=this.getTile(Gt);if(nr&&nr.hasData()){g[Gt.key]=Gt;continue}}else{var rr=Kt.children(this._source.maxzoom);if(g[rr[0].key]&&g[rr[1].key]&&g[rr[2].key]&&g[rr[3].key])continue}for(var Lr=jt.wasRequested(),vr=Kt.overscaledZ-1;vr>=L;--vr){var Sr=Kt.scaledTo(vr);if(w[Sr.key])break;if(w[Sr.key]=!0,!(jt=this.getTile(Sr))&&Lr&&(jt=this._addTile(Sr)),jt&&(g[Sr.key]=Sr,Lr=jt.wasRequested(),jt.hasData()))break}}}return g},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],g=void 0,w=this._tiles[n].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){g=this._loadedParentTiles[w.key];break}l.push(w.key);var L=w.scaledTo(w.overscaledZ-1);if(g=this._getLoadedTile(L))break;w=L}for(var F=0,ue=l;F<ue.length;F+=1)this._loadedParentTiles[ue[F]]=g}},a.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var g=Boolean(l);return g||(l=new i.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,g||this._source.fire(new i.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(n,l){var g=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var w=l.getExpiryTimeout();w&&(this._timers[n]=setTimeout(function(){g._reloadTile(n,"expired"),delete g._timers[n]},w))},a.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,l,g){var w=this,L=[],F=this.transform;if(!F)return L;for(var ue=g?F.getCameraQueryGeometry(n):n,Ee=n.map(function(vr){return F.pointCoordinate(vr)}),$e=ue.map(function(vr){return F.pointCoordinate(vr)}),rt=this.getIds(),nt=1/0,Ft=1/0,Nt=-1/0,Kt=-1/0,jt=0,Gt=$e;jt<Gt.length;jt+=1){var nr=Gt[jt];nt=Math.min(nt,nr.x),Ft=Math.min(Ft,nr.y),Nt=Math.max(Nt,nr.x),Kt=Math.max(Kt,nr.y)}for(var rr=function(Sr){var Ar=w._tiles[rt[Sr]];if(!Ar.holdingForFade()){var rn=Ar.tileID,Xr=Math.pow(2,F.zoom-Ar.tileID.overscaledZ),mn=l*Ar.queryPadding*i.EXTENT/Ar.tileSize/Xr,Ln=[rn.getTilePoint(new i.MercatorCoordinate(nt,Ft)),rn.getTilePoint(new i.MercatorCoordinate(Nt,Kt))];if(Ln[0].x-mn<i.EXTENT&&Ln[0].y-mn<i.EXTENT&&Ln[1].x+mn>=0&&Ln[1].y+mn>=0){var qn=Ee.map(function(Sa){return rn.getTilePoint(Sa)}),sa=$e.map(function(Sa){return rn.getTilePoint(Sa)});L.push({tile:Ar,tileID:rn,queryGeometry:qn,cameraQueryGeometry:sa,scale:Xr})}}},Lr=0;Lr<rt.length;Lr++)rr(Lr);return L},a.prototype.getVisibleCoordinates=function(n){for(var l=this,g=this.getRenderableIds(n).map(function(ue){return l._tiles[ue].tileID}),w=0,L=g;w<L.length;w+=1){var F=L[w];F.posMatrix=this.transform.calculatePosMatrix(F.toUnwrapped())}return g},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(zr(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,l,g){this._state.updateState(n=n||"_geojsonTileLayer",l,g)},a.prototype.removeFeatureState=function(n,l,g){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,g)},a.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(n,l,g){var w=this._tiles[n];w&&w.setDependencies(l,g)},a.prototype.reloadTilesForDependencies=function(n,l){for(var g in this._tiles)this._tiles[g].hasDependency(n,l)&&this._reloadTile(g,"reloading");this._cache.filter(function(w){return!w.hasDependency(n,l)})},a}(i.Evented);function lr(s,a){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return s.overscaledZ-a.overscaledZ||l-n||a.canonical.y-s.canonical.y||a.canonical.x-s.canonical.x}function zr(s){return s==="raster"||s==="image"||s==="video"}function Vr(){return new i.window.Worker(oc.workerUrl)}Lt.maxOverzooming=10,Lt.maxUnderzooming=3;var cr="mapboxgl_preloaded_worker_pool",Ur=function(){this.active={}};Ur.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Ur.workerCount;)this.workers.push(new Vr);return this.active[s]=!0,this.workers.slice()},Ur.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Ur.prototype.isPreloaded=function(){return!!this.active[cr]},Ur.prototype.numActive=function(){return Object.keys(this.active).length};var Mn,ln=Math.floor(i.browser.hardwareConcurrency/2);function er(){return Mn||(Mn=new Ur),Mn}function tn(s,a){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return i.refProperties.forEach(function(g){g in a&&(n[g]=a[g])}),n}function hn(s){s=s.slice();for(var a=Object.create(null),n=0;n<s.length;n++)a[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=tn(s[l],a[s[l].ref]));return s}Ur.workerCount=Math.max(Math.min(ln,6),1);var xn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function yn(s,a,n){n.push({command:xn.addSource,args:[s,a[s]]})}function vn(s,a,n){a.push({command:xn.removeSource,args:[s]}),n[s]=!0}function Pn(s,a,n,l){vn(s,n,l),yn(s,a,n)}function Va(s,a,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;for(l in a[n])if(a[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;return!0}function va(s,a,n,l,g,w){var L;for(L in a=a||{},s=s||{})s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:w,args:[l,L,a[L],g]}));for(L in a)a.hasOwnProperty(L)&&!s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:w,args:[l,L,a[L],g]}))}function Ma(s){return s.id}function Ia(s,a){return s[a.id]=a,s}var Zi=function(a,n){this.reset(a,n)};Zi.prototype.reset=function(s,a){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Zi.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=i.clamp(s,0,1);for(var a=1,n=this._distances[a],l=s*this.paddedLength+this.padding;n<l&&a<this._distances.length;)n=this._distances[++a];var g=a-1,w=this._distances[g],L=n-w,F=L>0?(l-w)/L:0;return this.points[g].mult(1-F).add(this.points[a].mult(F))};var da=function(a,n,l){var g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(a/l),this.yCellCount=Math.ceil(n/l);for(var L=0;L<this.xCellCount*this.yCellCount;L++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function di(s,a,n,l,g){var w=i.create();return a?(i.scale(w,w,[1/g,1/g,1]),n||i.rotateZ(w,w,l.angle)):i.multiply(w,l.labelPlaneMatrix,s),w}function ga(s,a,n,l,g){if(a){var w=i.clone(s);return i.scale(w,w,[g,g,1]),n||i.rotateZ(w,w,-l.angle),w}return l.glCoordMatrix}function ya(s,a){var n=[s.x,s.y,0,1];Yi(n,n,a);var l=n[3];return{point:new i.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function fa(s,a){return .5+s/a*.5}function Si(s,a){var n=s[0]/s[3],l=s[1]/s[3];return n>=-a[0]&&n<=a[0]&&l>=-a[1]&&l<=a[1]}function ns(s,a,n,l,g,w,L,F){var ue=l?s.textSizeData:s.iconSizeData,Ee=i.evaluateSizeForZoom(ue,n.transform.zoom),$e=[256/n.width*2+1,256/n.height*2+1],rt=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;rt.clear();for(var nt=s.lineVertexArray,Ft=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Nt=n.transform.width/n.transform.height,Kt=!1,jt=0;jt<Ft.length;jt++){var Gt=Ft.get(jt);if(Gt.hidden||Gt.writingMode===i.WritingMode.vertical&&!Kt)oi(Gt.numGlyphs,rt);else{Kt=!1;var nr=[Gt.anchorX,Gt.anchorY,0,1];if(i.transformMat4(nr,nr,a),Si(nr,$e)){var rr=fa(n.transform.cameraToCenterDistance,nr[3]),Lr=i.evaluateSizeForFeature(ue,Ee,Gt),vr=L?Lr/rr:Lr*rr,Sr=new i.Point(Gt.anchorX,Gt.anchorY),Ar=ya(Sr,g).point,rn={},Xr=ju(Gt,vr,!1,F,a,g,w,s.glyphOffsetArray,nt,rt,Ar,Sr,rn,Nt);Kt=Xr.useVertical,(Xr.notEnoughRoom||Kt||Xr.needsFlipping&&ju(Gt,vr,!0,F,a,g,w,s.glyphOffsetArray,nt,rt,Ar,Sr,rn,Nt).notEnoughRoom)&&oi(Gt.numGlyphs,rt)}else oi(Gt.numGlyphs,rt)}}l?s.text.dynamicLayoutVertexBuffer.updateData(rt):s.icon.dynamicLayoutVertexBuffer.updateData(rt)}function Xi(s,a,n,l,g,w,L,F,ue,Ee,$e){var rt=F.glyphStartIndex+F.numGlyphs,nt=F.lineStartIndex,Ft=F.lineStartIndex+F.lineLength,Nt=a.getoffsetX(F.glyphStartIndex),Kt=a.getoffsetX(rt-1),jt=Ai(s*Nt,n,l,g,w,L,F.segment,nt,Ft,ue,Ee,$e);if(!jt)return null;var Gt=Ai(s*Kt,n,l,g,w,L,F.segment,nt,Ft,ue,Ee,$e);return Gt?{first:jt,last:Gt}:null}function Vo(s,a,n,l){return s===i.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*l?{useVertical:!0}:(s===i.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function ju(s,a,n,l,g,w,L,F,ue,Ee,$e,rt,nt,Ft){var Nt,Kt=a/24,jt=s.lineOffsetX*Kt,Gt=s.lineOffsetY*Kt;if(s.numGlyphs>1){var nr=s.glyphStartIndex+s.numGlyphs,rr=s.lineStartIndex,Lr=s.lineStartIndex+s.lineLength,vr=Xi(Kt,F,jt,Gt,n,$e,rt,s,ue,w,nt);if(!vr)return{notEnoughRoom:!0};var Sr=ya(vr.first.point,L).point,Ar=ya(vr.last.point,L).point;if(l&&!n){var rn=Vo(s.writingMode,Sr,Ar,Ft);if(rn)return rn}Nt=[vr.first];for(var Xr=s.glyphStartIndex+1;Xr<nr-1;Xr++)Nt.push(Ai(Kt*F.getoffsetX(Xr),jt,Gt,n,$e,rt,s.segment,rr,Lr,ue,w,nt));Nt.push(vr.last)}else{if(l&&!n){var mn=ya(rt,g).point,Ln=s.lineStartIndex+s.segment+1,qn=new i.Point(ue.getx(Ln),ue.gety(Ln)),sa=ya(qn,g),Sa=sa.signedDistanceFromCamera>0?sa.point:Ga(rt,qn,mn,1,g),Wa=Vo(s.writingMode,mn,Sa,Ft);if(Wa)return Wa}var Sn=Ai(Kt*F.getoffsetX(s.glyphStartIndex),jt,Gt,n,$e,rt,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,ue,w,nt);if(!Sn)return{notEnoughRoom:!0};Nt=[Sn]}for(var ua=0,ba=Nt;ua<ba.length;ua+=1){var Wn=ba[ua];i.addDynamicAttributes(Ee,Wn.point,Wn.angle)}return{}}function Ga(s,a,n,l,g){var w=ya(s.add(s.sub(a)._unit()),g).point,L=n.sub(w);return n.add(L._mult(l/L.mag()))}function Ai(s,a,n,l,g,w,L,F,ue,Ee,$e,rt){var nt=l?s-a:s+a,Ft=nt>0?1:-1,Nt=0;l&&(Ft*=-1,Nt=Math.PI),Ft<0&&(Nt+=Math.PI);for(var Kt=Ft>0?F+L:F+L+1,jt=g,Gt=g,nr=0,rr=0,Lr=Math.abs(nt),vr=[];nr+rr<=Lr;){if((Kt+=Ft)<F||Kt>=ue)return null;if(Gt=jt,vr.push(jt),(jt=rt[Kt])===void 0){var Sr=new i.Point(Ee.getx(Kt),Ee.gety(Kt)),Ar=ya(Sr,$e);if(Ar.signedDistanceFromCamera>0)jt=rt[Kt]=Ar.point;else{var rn=Kt-Ft;jt=Ga(nr===0?w:new i.Point(Ee.getx(rn),Ee.gety(rn)),Sr,Gt,Lr-nr+1,$e)}}nr+=rr,rr=Gt.dist(jt)}var Xr=(Lr-nr)/rr,mn=jt.sub(Gt),Ln=mn.mult(Xr)._add(Gt);Ln._add(mn._unit()._perp()._mult(n*Ft));var qn=Nt+Math.atan2(jt.y-Gt.y,jt.x-Gt.x);return vr.push(Ln),{point:Ln,angle:qn,path:vr}}da.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},da.prototype.insert=function(s,a,n,l,g){this._forEachCell(a,n,l,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(g)},da.prototype.insertCircle=function(s,a,n,l){this._forEachCell(a-l,n-l,a+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(a),this.circles.push(n),this.circles.push(l)},da.prototype._insertBoxCell=function(s,a,n,l,g,w){this.boxCells[g].push(w)},da.prototype._insertCircleCell=function(s,a,n,l,g,w){this.circleCells[g].push(w)},da.prototype._query=function(s,a,n,l,g,w){if(n<0||s>this.width||l<0||a>this.height)return!g&&[];var L=[];if(s<=0&&a<=0&&this.width<=n&&this.height<=l){if(g)return!0;for(var F=0;F<this.boxKeys.length;F++)L.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Ee=this.circles[3*ue],$e=this.circles[3*ue+1],rt=this.circles[3*ue+2];L.push({key:this.circleKeys[ue],x1:Ee-rt,y1:$e-rt,x2:Ee+rt,y2:$e+rt})}return w?L.filter(w):L}return this._forEachCell(s,a,n,l,this._queryCell,L,{hitTest:g,seenUids:{box:{},circle:{}}},w),g?L.length>0:L},da.prototype._queryCircle=function(s,a,n,l,g){var w=s-n,L=s+n,F=a-n,ue=a+n;if(L<0||w>this.width||ue<0||F>this.height)return!l&&[];var Ee=[];return this._forEachCell(w,F,L,ue,this._queryCellCircle,Ee,{hitTest:l,circle:{x:s,y:a,radius:n},seenUids:{box:{},circle:{}}},g),l?Ee.length>0:Ee},da.prototype.query=function(s,a,n,l,g){return this._query(s,a,n,l,!1,g)},da.prototype.hitTest=function(s,a,n,l,g){return this._query(s,a,n,l,!0,g)},da.prototype.hitTestCircle=function(s,a,n,l){return this._queryCircle(s,a,n,!0,l)},da.prototype._queryCell=function(s,a,n,l,g,w,L,F){var ue=L.seenUids,Ee=this.boxCells[g];if(Ee!==null)for(var $e=this.bboxes,rt=0,nt=Ee;rt<nt.length;rt+=1){var Ft=nt[rt];if(!ue.box[Ft]){ue.box[Ft]=!0;var Nt=4*Ft;if(s<=$e[Nt+2]&&a<=$e[Nt+3]&&n>=$e[Nt+0]&&l>=$e[Nt+1]&&(!F||F(this.boxKeys[Ft]))){if(L.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[Ft],x1:$e[Nt],y1:$e[Nt+1],x2:$e[Nt+2],y2:$e[Nt+3]})}}}var Kt=this.circleCells[g];if(Kt!==null)for(var jt=this.circles,Gt=0,nr=Kt;Gt<nr.length;Gt+=1){var rr=nr[Gt];if(!ue.circle[rr]){ue.circle[rr]=!0;var Lr=3*rr;if(this._circleAndRectCollide(jt[Lr],jt[Lr+1],jt[Lr+2],s,a,n,l)&&(!F||F(this.circleKeys[rr]))){if(L.hitTest)return w.push(!0),!0;var vr=jt[Lr],Sr=jt[Lr+1],Ar=jt[Lr+2];w.push({key:this.circleKeys[rr],x1:vr-Ar,y1:Sr-Ar,x2:vr+Ar,y2:Sr+Ar})}}}},da.prototype._queryCellCircle=function(s,a,n,l,g,w,L,F){var ue=L.circle,Ee=L.seenUids,$e=this.boxCells[g];if($e!==null)for(var rt=this.bboxes,nt=0,Ft=$e;nt<Ft.length;nt+=1){var Nt=Ft[nt];if(!Ee.box[Nt]){Ee.box[Nt]=!0;var Kt=4*Nt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,rt[Kt+0],rt[Kt+1],rt[Kt+2],rt[Kt+3])&&(!F||F(this.boxKeys[Nt])))return w.push(!0),!0}}var jt=this.circleCells[g];if(jt!==null)for(var Gt=this.circles,nr=0,rr=jt;nr<rr.length;nr+=1){var Lr=rr[nr];if(!Ee.circle[Lr]){Ee.circle[Lr]=!0;var vr=3*Lr;if(this._circlesCollide(Gt[vr],Gt[vr+1],Gt[vr+2],ue.x,ue.y,ue.radius)&&(!F||F(this.circleKeys[Lr])))return w.push(!0),!0}}},da.prototype._forEachCell=function(s,a,n,l,g,w,L,F){for(var ue=this._convertToXCellCoord(s),Ee=this._convertToYCellCoord(a),$e=this._convertToXCellCoord(n),rt=this._convertToYCellCoord(l),nt=ue;nt<=$e;nt++)for(var Ft=Ee;Ft<=rt;Ft++)if(g.call(this,s,a,n,l,this.xCellCount*Ft+nt,w,L,F))return},da.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},da.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},da.prototype._circlesCollide=function(s,a,n,l,g,w){var L=l-s,F=g-a,ue=n+w;return ue*ue>L*L+F*F},da.prototype._circleAndRectCollide=function(s,a,n,l,g,w,L){var F=(w-l)/2,ue=Math.abs(s-(l+F));if(ue>F+n)return!1;var Ee=(L-g)/2,$e=Math.abs(a-(g+Ee));if($e>Ee+n)return!1;if(ue<=F||$e<=Ee)return!0;var rt=ue-F,nt=$e-Ee;return rt*rt+nt*nt<=n*n};var Ko=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function oi(s,a){for(var n=0;n<s;n++){var l=a.length;a.resize(l+4),a.float32.set(Ko,3*l)}}function Yi(s,a,n){var l=a[0],g=a[1];return s[0]=n[0]*l+n[4]*g+n[12],s[1]=n[1]*l+n[5]*g+n[13],s[3]=n[3]*l+n[7]*g+n[15],s}var wo=function(a,n,l){n===void 0&&(n=new da(a.width+200,a.height+200,25)),l===void 0&&(l=new da(a.width+200,a.height+200,25)),this.transform=a,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function Ha(s,a,n){return a*(i.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}wo.prototype.placeCollisionBox=function(s,a,n,l,g){var w=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),L=n*w.perspectiveRatio,F=s.x1*L+w.point.x,ue=s.y1*L+w.point.y,Ee=s.x2*L+w.point.x,$e=s.y2*L+w.point.y;return!this.isInsideGrid(F,ue,Ee,$e)||!a&&this.grid.hitTest(F,ue,Ee,$e,g)?{box:[],offscreen:!1}:{box:[F,ue,Ee,$e],offscreen:this.isOffscreen(F,ue,Ee,$e)}},wo.prototype.placeCollisionCircles=function(s,a,n,l,g,w,L,F,ue,Ee,$e,rt,nt){var Ft=[],Nt=new i.Point(a.anchorX,a.anchorY),Kt=ya(Nt,w),jt=fa(this.transform.cameraToCenterDistance,Kt.signedDistanceFromCamera),Gt=(Ee?g/jt:g*jt)/i.ONE_EM,nr=ya(Nt,L).point,rr=Xi(Gt,l,a.lineOffsetX*Gt,a.lineOffsetY*Gt,!1,nr,Nt,a,n,L,{}),Lr=!1,vr=!1,Sr=!0;if(rr){for(var Ar=.5*rt*jt+nt,rn=new i.Point(-100,-100),Xr=new i.Point(this.screenRightBoundary,this.screenBottomBoundary),mn=new Zi,Ln=rr.first,qn=rr.last,sa=[],Sa=Ln.path.length-1;Sa>=1;Sa--)sa.push(Ln.path[Sa]);for(var Wa=1;Wa<qn.path.length;Wa++)sa.push(qn.path[Wa]);var Sn=2.5*Ar;if(F){var ua=sa.map(function(Gs){return ya(Gs,F)});sa=ua.some(function(Gs){return Gs.signedDistanceFromCamera<=0})?[]:ua.map(function(Gs){return Gs.point})}var ba=[];if(sa.length>0){for(var Wn=sa[0].clone(),Aa=sa[0].clone(),na=1;na<sa.length;na++)Wn.x=Math.min(Wn.x,sa[na].x),Wn.y=Math.min(Wn.y,sa[na].y),Aa.x=Math.max(Aa.x,sa[na].x),Aa.y=Math.max(Aa.y,sa[na].y);ba=Wn.x>=rn.x&&Aa.x<=Xr.x&&Wn.y>=rn.y&&Aa.y<=Xr.y?[sa]:Aa.x<rn.x||Wn.x>Xr.x||Aa.y<rn.y||Wn.y>Xr.y?[]:i.clipLine([sa],rn.x,rn.y,Xr.x,Xr.y)}for(var La=0,za=ba;La<za.length;La+=1){var Gi;mn.reset(za[La],.25*Ar),Gi=mn.length<=.5*Ar?1:Math.ceil(mn.paddedLength/Sn)+1;for(var _i=0;_i<Gi;_i++){var Di=_i/Math.max(Gi-1,1),gi=mn.lerp(Di),Ui=gi.x+100,Qo=gi.y+100;Ft.push(Ui,Qo,Ar,0);var qo=Ui-Ar,vu=Qo-Ar,Mu=Ui+Ar,cs=Qo+Ar;if(Sr=Sr&&this.isOffscreen(qo,vu,Mu,cs),vr=vr||this.isInsideGrid(qo,vu,Mu,cs),!s&&this.grid.hitTestCircle(Ui,Qo,Ar,$e)&&(Lr=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Lr}}}}return{circles:!ue&&Lr||!vr?[]:Ft,offscreen:Sr,collisionDetected:Lr}},wo.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,l=1/0,g=-1/0,w=-1/0,L=0,F=s;L<F.length;L+=1){var ue=F[L],Ee=new i.Point(ue.x+100,ue.y+100);n=Math.min(n,Ee.x),l=Math.min(l,Ee.y),g=Math.max(g,Ee.x),w=Math.max(w,Ee.y),a.push(Ee)}for(var $e={},rt={},nt=0,Ft=this.grid.query(n,l,g,w).concat(this.ignoredGrid.query(n,l,g,w));nt<Ft.length;nt+=1){var Nt=Ft[nt],Kt=Nt.key;if($e[Kt.bucketInstanceId]===void 0&&($e[Kt.bucketInstanceId]={}),!$e[Kt.bucketInstanceId][Kt.featureIndex]){var jt=[new i.Point(Nt.x1,Nt.y1),new i.Point(Nt.x2,Nt.y1),new i.Point(Nt.x2,Nt.y2),new i.Point(Nt.x1,Nt.y2)];i.polygonIntersectsPolygon(a,jt)&&($e[Kt.bucketInstanceId][Kt.featureIndex]=!0,rt[Kt.bucketInstanceId]===void 0&&(rt[Kt.bucketInstanceId]=[]),rt[Kt.bucketInstanceId].push(Kt.featureIndex))}}return rt},wo.prototype.insertCollisionBox=function(s,a,n,l,g){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:g},s[0],s[1],s[2],s[3])},wo.prototype.insertCollisionCircles=function(s,a,n,l,g){for(var w=a?this.ignoredGrid:this.grid,L={bucketInstanceId:n,featureIndex:l,collisionGroupID:g},F=0;F<s.length;F+=4)w.insertCircle(L,s[F],s[F+1],s[F+2])},wo.prototype.projectAndGetPerspectiveRatio=function(s,a,n){var l=[a,n,0,1];return Yi(l,l,s),{point:new i.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},wo.prototype.isOffscreen=function(s,a,n,l){return n<100||s>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},wo.prototype.isInsideGrid=function(s,a,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},wo.prototype.getViewportMatrix=function(){var s=i.identity([]);return i.translate(s,s,[-100,-100,0]),s};var oo=function(a,n,l,g){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):g&&l?1:0,this.placed=l};oo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var so=function(a,n,l,g,w){this.text=new oo(a?a.text:null,n,l,w),this.icon=new oo(a?a.icon:null,n,g,w)};so.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Eu=function(a,n,l){this.text=a,this.icon=n,this.skipFade=l},$o=function(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]},Kl=function(a,n,l,g,w){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=g,this.tileID=w},ks=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function ho(s,a,n,l,g){var w=i.getAnchorAlignment(s),L=-(w.horizontalAlign-.5)*a,F=-(w.verticalAlign-.5)*n,ue=i.evaluateVariableOffset(s,l);return new i.Point(L+ue[0]*g,F+ue[1]*g)}function Vt(s,a,n,l,g,w){var L=s.x1,F=s.x2,ue=s.y1,Ee=s.y2,$e=s.anchorPointX,rt=s.anchorPointY,nt=new i.Point(a,n);return l&&nt._rotate(g?w:-w),{x1:L+nt.x,y1:ue+nt.y,x2:F+nt.x,y2:Ee+nt.y,anchorPointX:$e,anchorPointY:rt}}ks.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var a=++this.maxGroupID;this.collisionGroups[s]={ID:a,predicate:function(l){return l.collisionGroupID===a}}}return this.collisionGroups[s]};var Re=function(a,n,l,g){this.transform=a.clone(),this.collisionIndex=new wo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new ks(l),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function Dt(s,a,n,l,g){s.emplaceBack(a?1:0,n?1:0,l||0,g||0),s.emplaceBack(a?1:0,n?1:0,l||0,g||0),s.emplaceBack(a?1:0,n?1:0,l||0,g||0),s.emplaceBack(a?1:0,n?1:0,l||0,g||0)}Re.prototype.getBucketParts=function(s,a,n,l){var g=n.getBucket(a),w=n.latestFeatureIndex;if(g&&w&&a.id===g.layerIds[0]){var L=n.collisionBoxArray,F=g.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Ee=n.tileSize/i.EXTENT,$e=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),rt=F.get("text-pitch-alignment")==="map",nt=F.get("text-rotation-alignment")==="map",Ft=Ha(n,1,this.transform.zoom),Nt=di($e,rt,nt,this.transform,Ft),Kt=null;if(rt){var jt=ga($e,rt,nt,this.transform,Ft);Kt=i.multiply([],this.transform.labelPlaneMatrix,jt)}this.retainedQueryData[g.bucketInstanceId]=new Kl(g.bucketInstanceId,w,g.sourceLayerIndex,g.index,n.tileID);var Gt={bucket:g,layout:F,posMatrix:$e,textLabelPlaneMatrix:Nt,labelToScreenMatrix:Kt,scale:ue,textPixelRatio:Ee,holdingForFade:n.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(l)for(var nr=0,rr=g.sortKeyRanges;nr<rr.length;nr+=1){var Lr=rr[nr];s.push({sortKey:Lr.sortKey,symbolInstanceStart:Lr.symbolInstanceStart,symbolInstanceEnd:Lr.symbolInstanceEnd,parameters:Gt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:Gt})}},Re.prototype.attemptAnchorPlacement=function(s,a,n,l,g,w,L,F,ue,Ee,$e,rt,nt,Ft,Nt){var Kt,jt=[rt.textOffset0,rt.textOffset1],Gt=ho(s,n,l,jt,g),nr=this.collisionIndex.placeCollisionBox(Vt(a,Gt.x,Gt.y,w,L,this.transform.angle),$e,F,ue,Ee.predicate);if(!Nt||this.collisionIndex.placeCollisionBox(Vt(Nt,Gt.x,Gt.y,w,L,this.transform.angle),$e,F,ue,Ee.predicate).box.length!==0)return nr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[rt.crossTileID]&&this.prevPlacement.placements[rt.crossTileID]&&this.prevPlacement.placements[rt.crossTileID].text&&(Kt=this.prevPlacement.variableOffsets[rt.crossTileID].anchor),this.variableOffsets[rt.crossTileID]={textOffset:jt,width:n,height:l,anchor:s,textBoxScale:g,prevAnchor:Kt},this.markUsedJustification(nt,s,rt,Ft),nt.allowVerticalPlacement&&(this.markUsedOrientation(nt,Ft,rt),this.placedOrientations[rt.crossTileID]=Ft),{shift:Gt,placedGlyphBoxes:nr}):void 0},Re.prototype.placeLayerBucketPart=function(s,a,n){var l=this,g=s.parameters,w=g.bucket,L=g.layout,F=g.posMatrix,ue=g.textLabelPlaneMatrix,Ee=g.labelToScreenMatrix,$e=g.textPixelRatio,rt=g.holdingForFade,nt=g.collisionBoxArray,Ft=g.partiallyEvaluatedTextSize,Nt=g.collisionGroup,Kt=L.get("text-optional"),jt=L.get("icon-optional"),Gt=L.get("text-allow-overlap"),nr=L.get("icon-allow-overlap"),rr=L.get("text-rotation-alignment")==="map",Lr=L.get("text-pitch-alignment")==="map",vr=L.get("icon-text-fit")!=="none",Sr=L.get("symbol-z-order")==="viewport-y",Ar=Gt&&(nr||!w.hasIconData()||jt),rn=nr&&(Gt||!w.hasTextData()||Kt);!w.collisionArrays&&nt&&w.deserializeCollisionBoxes(nt);var Xr=function(Sn,ua){if(!a[Sn.crossTileID])if(rt)l.placements[Sn.crossTileID]=new Eu(!1,!1,!1);else{var ba,Wn=!1,Aa=!1,na=!0,La=null,za={box:null,offscreen:null},Gi={box:null,offscreen:null},_i=null,Di=null,gi=0,Ui=0,Qo=0;ua.textFeatureIndex?gi=ua.textFeatureIndex:Sn.useRuntimeCollisionCircles&&(gi=Sn.featureIndex),ua.verticalTextFeatureIndex&&(Ui=ua.verticalTextFeatureIndex);var qo=ua.textBox;if(qo){var vu=function(Ho){var _o=i.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Ho&&l.prevPlacement){var uo=l.prevPlacement.placedOrientations[Sn.crossTileID];uo&&(l.placedOrientations[Sn.crossTileID]=uo,l.markUsedOrientation(w,_o=uo,Sn))}return _o},Mu=function(Ho,_o){if(w.allowVerticalPlacement&&Sn.numVerticalGlyphVertices>0&&ua.verticalTextBox)for(var uo=0,Ls=w.writingModes;uo<Ls.length&&(Ls[uo]===i.WritingMode.vertical?(za=_o(),Gi=za):za=Ho(),!(za&&za.box&&za.box.length));uo+=1);else za=Ho()};if(L.get("text-variable-anchor")){var cs=L.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[Sn.crossTileID]){var Gs=l.prevPlacement.variableOffsets[Sn.crossTileID];cs.indexOf(Gs.anchor)>0&&(cs=cs.filter(function(No){return No!==Gs.anchor})).unshift(Gs.anchor)}var Pu=function(Ho,_o,uo){for(var Ls=Ho.x2-Ho.x1,nu=Ho.y2-Ho.y1,Hl=Sn.textBoxScale,Gc=vr&&!nr?_o:null,dl={box:[],offscreen:!1},lc=Gt?2*cs.length:cs.length,pl=0;pl<lc;++pl){var Rs=l.attemptAnchorPlacement(cs[pl%cs.length],Ho,Ls,nu,Hl,rr,Lr,$e,F,Nt,pl>=cs.length,Sn,w,uo,Gc);if(Rs&&(dl=Rs.placedGlyphBoxes)&&dl.box&&dl.box.length){Wn=!0,La=Rs.shift;break}}return dl};Mu(function(){return Pu(qo,ua.iconBox,i.WritingMode.horizontal)},function(){var No=ua.verticalTextBox;return w.allowVerticalPlacement&&!(za&&za.box&&za.box.length)&&Sn.numVerticalGlyphVertices>0&&No?Pu(No,ua.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null}}),za&&(Wn=za.box,na=za.offscreen);var sc=vu(za&&za.box);if(!Wn&&l.prevPlacement){var tu=l.prevPlacement.variableOffsets[Sn.crossTileID];tu&&(l.variableOffsets[Sn.crossTileID]=tu,l.markUsedJustification(w,tu.anchor,Sn,sc))}}else{var Xu=function(Ho,_o){var uo=l.collisionIndex.placeCollisionBox(Ho,Gt,$e,F,Nt.predicate);return uo&&uo.box&&uo.box.length&&(l.markUsedOrientation(w,_o,Sn),l.placedOrientations[Sn.crossTileID]=_o),uo};Mu(function(){return Xu(qo,i.WritingMode.horizontal)},function(){var No=ua.verticalTextBox;return w.allowVerticalPlacement&&Sn.numVerticalGlyphVertices>0&&No?Xu(No,i.WritingMode.vertical):{box:null,offscreen:null}}),vu(za&&za.box&&za.box.length)}}if(Wn=(ba=za)&&ba.box&&ba.box.length>0,na=ba&&ba.offscreen,Sn.useRuntimeCollisionCircles){var uc=w.text.placedSymbolArray.get(Sn.centerJustifiedTextSymbolIndex),ru=i.evaluateSizeForFeature(w.textSizeData,Ft,uc),Lu=L.get("text-padding");_i=l.collisionIndex.placeCollisionCircles(Gt,uc,w.lineVertexArray,w.glyphOffsetArray,ru,F,ue,Ee,n,Lr,Nt.predicate,Sn.collisionCircleDiameter,Lu),Wn=Gt||_i.circles.length>0&&!_i.collisionDetected,na=na&&_i.offscreen}if(ua.iconFeatureIndex&&(Qo=ua.iconFeatureIndex),ua.iconBox){var fs=function(Ho){var _o=vr&&La?Vt(Ho,La.x,La.y,rr,Lr,l.transform.angle):Ho;return l.collisionIndex.placeCollisionBox(_o,nr,$e,F,Nt.predicate)};Aa=Gi&&Gi.box&&Gi.box.length&&ua.verticalIconBox?(Di=fs(ua.verticalIconBox)).box.length>0:(Di=fs(ua.iconBox)).box.length>0,na=na&&Di.offscreen}var ao=Kt||Sn.numHorizontalGlyphVertices===0&&Sn.numVerticalGlyphVertices===0,Yu=jt||Sn.numIconVertices===0;if(ao||Yu?Yu?ao||(Aa=Aa&&Wn):Wn=Aa&&Wn:Aa=Wn=Aa&&Wn,Wn&&ba&&ba.box&&l.collisionIndex.insertCollisionBox(ba.box,L.get("text-ignore-placement"),w.bucketInstanceId,Gi&&Gi.box&&Ui?Ui:gi,Nt.ID),Aa&&Di&&l.collisionIndex.insertCollisionBox(Di.box,L.get("icon-ignore-placement"),w.bucketInstanceId,Qo,Nt.ID),_i&&(Wn&&l.collisionIndex.insertCollisionCircles(_i.circles,L.get("text-ignore-placement"),w.bucketInstanceId,gi,Nt.ID),n)){var Gl=w.bucketInstanceId,hs=l.collisionCircleArrays[Gl];hs===void 0&&(hs=l.collisionCircleArrays[Gl]=new $o);for(var Do=0;Do<_i.circles.length;Do+=4)hs.circles.push(_i.circles[Do+0]),hs.circles.push(_i.circles[Do+1]),hs.circles.push(_i.circles[Do+2]),hs.circles.push(_i.collisionDetected?1:0)}l.placements[Sn.crossTileID]=new Eu(Wn||Ar,Aa||rn,na||w.justReloaded),a[Sn.crossTileID]=!0}};if(Sr)for(var mn=w.getSortedSymbolIndexes(this.transform.angle),Ln=mn.length-1;Ln>=0;--Ln){var qn=mn[Ln];Xr(w.symbolInstances.get(qn),w.collisionArrays[qn])}else for(var sa=s.symbolInstanceStart;sa<s.symbolInstanceEnd;sa++)Xr(w.symbolInstances.get(sa),w.collisionArrays[sa]);if(n&&w.bucketInstanceId in this.collisionCircleArrays){var Sa=this.collisionCircleArrays[w.bucketInstanceId];i.invert(Sa.invProjMatrix,F),Sa.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Re.prototype.markUsedJustification=function(s,a,n,l){var g;g=l===i.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[i.getAnchorJustification(a)];for(var w=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];w<L.length;w+=1){var F=L[w];F>=0&&(s.text.placedSymbolArray.get(F).crossTileID=g>=0&&F!==g?0:n.crossTileID)}},Re.prototype.markUsedOrientation=function(s,a,n){for(var l=a===i.WritingMode.horizontal||a===i.WritingMode.horizontalOnly?a:0,g=a===i.WritingMode.vertical?a:0,w=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];w<L.length;w+=1)s.text.placedSymbolArray.get(L[w]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=g)},Re.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(s):1,g=a?a.opacities:{},w=a?a.variableOffsets:{},L=a?a.placedOrientations:{};for(var F in this.placements){var ue=this.placements[F],Ee=g[F];Ee?(this.opacities[F]=new so(Ee,l,ue.text,ue.icon),n=n||ue.text!==Ee.text.placed||ue.icon!==Ee.icon.placed):(this.opacities[F]=new so(null,l,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var $e in g){var rt=g[$e];if(!this.opacities[$e]){var nt=new so(rt,l,!1,!1);nt.isHidden()||(this.opacities[$e]=nt,n=n||rt.text.placed||rt.icon.placed)}}for(var Ft in w)this.variableOffsets[Ft]||!this.opacities[Ft]||this.opacities[Ft].isHidden()||(this.variableOffsets[Ft]=w[Ft]);for(var Nt in L)this.placedOrientations[Nt]||!this.opacities[Nt]||this.opacities[Nt].isHidden()||(this.placedOrientations[Nt]=L[Nt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:s)},Re.prototype.updateLayerOpacities=function(s,a){for(var n={},l=0,g=a;l<g.length;l+=1){var w=g[l],L=w.getBucket(s);L&&w.latestFeatureIndex&&s.id===L.layerIds[0]&&this.updateBucketOpacities(L,n,w.collisionBoxArray)}},Re.prototype.updateBucketOpacities=function(s,a,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var g=s.layers[0].layout,w=new so(null,0,!1,!1,!0),L=g.get("text-allow-overlap"),F=g.get("icon-allow-overlap"),ue=g.get("text-variable-anchor"),Ee=g.get("text-rotation-alignment")==="map",$e=g.get("text-pitch-alignment")==="map",rt=g.get("icon-text-fit")!=="none",nt=new so(null,0,L&&(F||!s.hasIconData()||g.get("icon-optional")),F&&(L||!s.hasTextData()||g.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var Ft=function(nr,rr,Lr){for(var vr=0;vr<rr/4;vr++)nr.opacityVertexArray.emplaceBack(Lr)},Nt=function(nr){var rr=s.symbolInstances.get(nr),Lr=rr.numHorizontalGlyphVertices,vr=rr.numVerticalGlyphVertices,Sr=rr.crossTileID,Ar=l.opacities[Sr];a[Sr]?Ar=w:Ar||(l.opacities[Sr]=Ar=nt),a[Sr]=!0;var rn=rr.numIconVertices>0,Xr=l.placedOrientations[rr.crossTileID],mn=Xr===i.WritingMode.vertical,Ln=Xr===i.WritingMode.horizontal||Xr===i.WritingMode.horizontalOnly;if(Lr>0||vr>0){var qn=Oo(Ar.text);Ft(s.text,Lr,mn?Fu:qn),Ft(s.text,vr,Ln?Fu:qn);var sa=Ar.text.isHidden();[rr.rightJustifiedTextSymbolIndex,rr.centerJustifiedTextSymbolIndex,rr.leftJustifiedTextSymbolIndex].forEach(function(za){za>=0&&(s.text.placedSymbolArray.get(za).hidden=sa||mn?1:0)}),rr.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(rr.verticalPlacedTextSymbolIndex).hidden=sa||Ln?1:0);var Sa=l.variableOffsets[rr.crossTileID];Sa&&l.markUsedJustification(s,Sa.anchor,rr,Xr);var Wa=l.placedOrientations[rr.crossTileID];Wa&&(l.markUsedJustification(s,"left",rr,Wa),l.markUsedOrientation(s,Wa,rr))}if(rn){var Sn=Oo(Ar.icon),ua=!(rt&&rr.verticalPlacedIconSymbolIndex&&mn);rr.placedIconSymbolIndex>=0&&(Ft(s.icon,rr.numIconVertices,ua?Sn:Fu),s.icon.placedSymbolArray.get(rr.placedIconSymbolIndex).hidden=Ar.icon.isHidden()),rr.verticalPlacedIconSymbolIndex>=0&&(Ft(s.icon,rr.numVerticalIconVertices,ua?Fu:Sn),s.icon.placedSymbolArray.get(rr.verticalPlacedIconSymbolIndex).hidden=Ar.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var ba=s.collisionArrays[nr];if(ba){var Wn=new i.Point(0,0);if(ba.textBox||ba.verticalTextBox){var Aa=!0;if(ue){var na=l.variableOffsets[Sr];na?(Wn=ho(na.anchor,na.width,na.height,na.textOffset,na.textBoxScale),Ee&&Wn._rotate($e?l.transform.angle:-l.transform.angle)):Aa=!1}ba.textBox&&Dt(s.textCollisionBox.collisionVertexArray,Ar.text.placed,!Aa||mn,Wn.x,Wn.y),ba.verticalTextBox&&Dt(s.textCollisionBox.collisionVertexArray,Ar.text.placed,!Aa||Ln,Wn.x,Wn.y)}var La=Boolean(!Ln&&ba.verticalIconBox);ba.iconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Ar.icon.placed,La,rt?Wn.x:0,rt?Wn.y:0),ba.verticalIconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Ar.icon.placed,!La,rt?Wn.x:0,rt?Wn.y:0)}}},Kt=0;Kt<s.symbolInstances.length;Kt++)Nt(Kt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var jt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=jt.invProjMatrix,s.placementViewportMatrix=jt.viewportMatrix,s.collisionCircleArray=jt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Re.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Re.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Re.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Re.prototype.stillRecent=function(s,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>s},Re.prototype.setStale=function(){this.stale=!0};var mr=Math.pow(2,25),Qr=Math.pow(2,24),En=Math.pow(2,17),Vn=Math.pow(2,16),Ci=Math.pow(2,9),po=Math.pow(2,8),mo=Math.pow(2,1);function Oo(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var a=s.placed?1:0,n=Math.floor(127*s.opacity);return n*mr+a*Qr+n*En+a*Vn+n*Ci+a*po+n*mo+a}var Fu=0,Ml=function(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ml.prototype.continuePlacement=function(s,a,n,l,g){for(var w=this._bucketParts;this._currentTileIndex<s.length;)if(a.getBucketParts(w,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(L,F){return L.sortKey-F.sortKey}));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,g())return!0;return!1};var bs=function(a,n,l,g,w,L,F){this.placement=new Re(a,w,L,F),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=g,this._done=!1};bs.prototype.isDone=function(){return this._done},bs.prototype.continuePlacement=function(s,a,n){for(var l=this,g=i.browser.now(),w=function(){var Ee=i.browser.now()-g;return!l._forceFullPlacement&&Ee>2};this._currentPlacementIndex>=0;){var L=a[s[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=F)&&(!L.maxzoom||L.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new Ml(L)),this._inProgressLayer.continuePlacement(n[L.source],this.placement,this._showCollisionBoxes,L,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},bs.prototype.commit=function(s){return this.placement.commit(s),this.placement};var vc=512/i.EXTENT/2,Tu=function(a,n,l){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var g=0;g<n.length;g++){var w=n.get(g),L=w.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,a)})}};Tu.prototype.getScaledCoordinates=function(s,a){var n=vc/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*i.EXTENT+s.anchorX)*n),y:Math.floor((a.canonical.y*i.EXTENT+s.anchorY)*n)}},Tu.prototype.findMatches=function(s,a,n){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),g=0;g<s.length;g++){var w=s.get(g);if(!w.crossTileID){var L=this.indexedSymbolInstances[w.key];if(L)for(var F=this.getScaledCoordinates(w,a),ue=0,Ee=L;ue<Ee.length;ue+=1){var $e=Ee[ue];if(Math.abs($e.coord.x-F.x)<=l&&Math.abs($e.coord.y-F.y)<=l&&!n[$e.crossTileID]){n[$e.crossTileID]=!0,w.crossTileID=$e.crossTileID;break}}}}};var Mo=function(){this.maxCrossTileID=0};Mo.prototype.generate=function(){return++this.maxCrossTileID};var zu=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};zu.prototype.handleWrapJump=function(s){var a=Math.round((s-this.lng)/360);if(a!==0)for(var n in this.indexes){var l=this.indexes[n],g={};for(var w in l){var L=l[w];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+a),g[L.tileID.key]=L}this.indexes[n]=g}this.lng=s},zu.prototype.addBucket=function(s,a,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var g=this.usedCrossTileIDs[s.overscaledZ];for(var w in this.indexes){var L=this.indexes[w];if(Number(w)>s.overscaledZ)for(var F in L){var ue=L[F];ue.tileID.isChildOf(s)&&ue.findMatches(a.symbolInstances,s,g)}else{var Ee=L[s.scaledTo(Number(w)).key];Ee&&Ee.findMatches(a.symbolInstances,s,g)}}for(var $e=0;$e<a.symbolInstances.length;$e++){var rt=a.symbolInstances.get($e);rt.crossTileID||(rt.crossTileID=n.generate(),g[rt.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Tu(s,a.symbolInstances,a.bucketInstanceId),!0},zu.prototype.removeBucketCrossTileIDs=function(s,a){for(var n in a.indexedSymbolInstances)for(var l=0,g=a.indexedSymbolInstances[n];l<g.length;l+=1)delete this.usedCrossTileIDs[s][g[l].crossTileID]},zu.prototype.removeStaleBuckets=function(s){var a=!1;for(var n in this.indexes){var l=this.indexes[n];for(var g in l)s[l[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[g]),delete l[g],a=!0)}return a};var Eo=function(){this.layerIndexes={},this.crossTileIDs=new Mo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Eo.prototype.addLayer=function(s,a,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new zu);var g=!1,w={};l.handleWrapJump(n);for(var L=0,F=a;L<F.length;L+=1){var ue=F[L],Ee=ue.getBucket(s);Ee&&s.id===Ee.layerIds[0]&&(Ee.bucketInstanceId||(Ee.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(ue.tileID,Ee,this.crossTileIDs)&&(g=!0),w[Ee.bucketInstanceId]=!0)}return l.removeStaleBuckets(w)&&(g=!0),g},Eo.prototype.pruneUnusedLayers=function(s){var a={};for(var n in s.forEach(function(l){a[l]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var Fi=function(a,n){return i.emitValidationErrors(a,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},Ys=i.pick(xn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ks=i.pick(xn,["setCenter","setZoom","setBearing","setPitch"]),js=function(){var s={},a=i.styleSpec.$version;for(var n in i.styleSpec.$root){var l,g=i.styleSpec.$root[n];g.required&&((l=n==="version"?a:g.type==="array"?[]:{})!=null&&(s[n]=l))}return s}(),Ri=function(s){function a(n,l){var g=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new pt(er(),this),this.imageManager=new Le,this.imageManager.setEventedParent(this),this.glyphManager=new De(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new we(256,512),this.crossTileSymbolIndex=new Eo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new i.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());var w=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(L){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(F,ue){if(i.triggerPluginCompletionEvent(F),ue&&ue.every(function($e){return $e}))for(var Ee in w.sourceCaches)w.sourceCaches[Ee].reload()})}),this.on("data",function(L){if(L.dataType==="source"&&L.sourceDataType==="metadata"){var F=g.sourceCaches[L.sourceId];if(F){var ue=F.getSource();if(ue&&ue.vectorLayerIds)for(var Ee in g._layers){var $e=g._layers[Ee];$e.source===ue.id&&g._validateLayer($e)}}}})}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.loadURL=function(n,l){var g=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"}));var w=typeof l.validate=="boolean"?l.validate:!i.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var L=this.map._requestManager.transformRequest(n,i.ResourceType.Style);this._request=i.getJSON(L,function(F,ue){g._request=null,F?g.fire(new i.ErrorEvent(F)):ue&&g._load(ue,w)})},a.prototype.loadJSON=function(n,l){var g=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.browser.frame(function(){g._request=null,g._load(n,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(js,!1)},a.prototype._load=function(n,l){if(!l||!Fi(this,i.validateStyle(n))){for(var g in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(g,n.sources[g],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var w=hn(this.stylesheet.layers);this._order=w.map(function(Ee){return Ee.id}),this._layers={},this._serializedLayers={};for(var L=0,F=w;L<F.length;L+=1){var ue=F[L];(ue=i.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new dt(this.stylesheet.light),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}},a.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(g,w,L){var F,ue,Ee,$e=i.browser.devicePixelRatio>1?"@2x":"",rt=i.getJSON(w.transformRequest(w.normalizeSpriteURL(g,$e,".json"),i.ResourceType.SpriteJSON),function(Nt,Kt){rt=null,Ee||(Ee=Nt,F=Kt,Ft())}),nt=i.getImage(w.transformRequest(w.normalizeSpriteURL(g,$e,".png"),i.ResourceType.SpriteImage),function(Nt,Kt){nt=null,Ee||(Ee=Nt,ue=Kt,Ft())});function Ft(){if(Ee)L(Ee);else if(F&&ue){var Nt=i.browser.getImageData(ue),Kt={};for(var jt in F){var Gt=F[jt],nr=Gt.width,rr=Gt.height,Lr=Gt.x,vr=Gt.y,Sr=Gt.sdf,Ar=Gt.pixelRatio,rn=Gt.stretchX,Xr=Gt.stretchY,mn=Gt.content,Ln=new i.RGBAImage({width:nr,height:rr});i.RGBAImage.copy(Nt,Ln,{x:Lr,y:vr},{x:0,y:0},{width:nr,height:rr}),Kt[jt]={data:Ln,pixelRatio:Ar,sdf:Sr,stretchX:rn,stretchY:Xr,content:mn}}L(null,Kt)}}return{cancel:function(){rt&&(rt.cancel(),rt=null),nt&&(nt.cancel(),nt=null)}}}(n,this.map._requestManager,function(g,w){if(l._spriteRequest=null,g)l.fire(new i.ErrorEvent(g));else if(w)for(var L in w)l.imageManager.addImage(L,w[L]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new i.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var g=n.sourceLayer;if(g){var w=l.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(g)===-1)&&this.fire(new i.ErrorEvent(new Error('Source layer "'+g+'" does not exist on source "'+w.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var l=[],g=0,w=n;g<w.length;g+=1){var L=this._layers[w[g]];L.type!=="custom"&&l.push(L.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var g=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var L in(g.length||w.length)&&this._updateWorkerLayers(g,w),this._updatedSources){var F=this._updatedSources[L];F==="reload"?this._reloadSource(L):F==="clear"&&this._clearSource(L)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Ee={};for(var $e in this.sourceCaches){var rt=this.sourceCaches[$e];Ee[$e]=rt.used,rt.used=!1}for(var nt=0,Ft=this._order;nt<Ft.length;nt+=1){var Nt=this._layers[Ft[nt]];Nt.recalculate(n,this._availableImages),!Nt.isHidden(n.zoom)&&Nt.source&&(this.sourceCaches[Nt.source].used=!0)}for(var Kt in Ee){var jt=this.sourceCaches[Kt];Ee[Kt]!==jt.used&&jt.fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Kt}))}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new i.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var l=this;if(this._checkLoaded(),Fi(this,i.validateStyle(n)))return!1;(n=i.clone$1(n)).layers=hn(n.layers);var g=function(L,F){if(!L)return[{command:xn.setStyle,args:[F]}];var ue=[];try{if(!i.deepEqual(L.version,F.version))return[{command:xn.setStyle,args:[F]}];i.deepEqual(L.center,F.center)||ue.push({command:xn.setCenter,args:[F.center]}),i.deepEqual(L.zoom,F.zoom)||ue.push({command:xn.setZoom,args:[F.zoom]}),i.deepEqual(L.bearing,F.bearing)||ue.push({command:xn.setBearing,args:[F.bearing]}),i.deepEqual(L.pitch,F.pitch)||ue.push({command:xn.setPitch,args:[F.pitch]}),i.deepEqual(L.sprite,F.sprite)||ue.push({command:xn.setSprite,args:[F.sprite]}),i.deepEqual(L.glyphs,F.glyphs)||ue.push({command:xn.setGlyphs,args:[F.glyphs]}),i.deepEqual(L.transition,F.transition)||ue.push({command:xn.setTransition,args:[F.transition]}),i.deepEqual(L.light,F.light)||ue.push({command:xn.setLight,args:[F.light]});var Ee={},$e=[];!function(nt,Ft,Nt,Kt){var jt;for(jt in Ft=Ft||{},nt=nt||{})nt.hasOwnProperty(jt)&&(Ft.hasOwnProperty(jt)||vn(jt,Nt,Kt));for(jt in Ft)Ft.hasOwnProperty(jt)&&(nt.hasOwnProperty(jt)?i.deepEqual(nt[jt],Ft[jt])||(nt[jt].type==="geojson"&&Ft[jt].type==="geojson"&&Va(nt,Ft,jt)?Nt.push({command:xn.setGeoJSONSourceData,args:[jt,Ft[jt].data]}):Pn(jt,Ft,Nt,Kt)):yn(jt,Ft,Nt))}(L.sources,F.sources,$e,Ee);var rt=[];L.layers&&L.layers.forEach(function(nt){Ee[nt.source]?ue.push({command:xn.removeLayer,args:[nt.id]}):rt.push(nt)}),ue=ue.concat($e),function(nt,Ft,Nt){Ft=Ft||[];var Kt,jt,Gt,nr,rr,Lr,vr,Sr=(nt=nt||[]).map(Ma),Ar=Ft.map(Ma),rn=nt.reduce(Ia,{}),Xr=Ft.reduce(Ia,{}),mn=Sr.slice(),Ln=Object.create(null);for(Kt=0,jt=0;Kt<Sr.length;Kt++)Xr.hasOwnProperty(Gt=Sr[Kt])?jt++:(Nt.push({command:xn.removeLayer,args:[Gt]}),mn.splice(mn.indexOf(Gt,jt),1));for(Kt=0,jt=0;Kt<Ar.length;Kt++)mn[mn.length-1-Kt]!==(Gt=Ar[Ar.length-1-Kt])&&(rn.hasOwnProperty(Gt)?(Nt.push({command:xn.removeLayer,args:[Gt]}),mn.splice(mn.lastIndexOf(Gt,mn.length-jt),1)):jt++,Nt.push({command:xn.addLayer,args:[Xr[Gt],Lr=mn[mn.length-Kt]]}),mn.splice(mn.length-Kt,0,Gt),Ln[Gt]=!0);for(Kt=0;Kt<Ar.length;Kt++)if(nr=rn[Gt=Ar[Kt]],rr=Xr[Gt],!Ln[Gt]&&!i.deepEqual(nr,rr))if(i.deepEqual(nr.source,rr.source)&&i.deepEqual(nr["source-layer"],rr["source-layer"])&&i.deepEqual(nr.type,rr.type)){for(vr in va(nr.layout,rr.layout,Nt,Gt,null,xn.setLayoutProperty),va(nr.paint,rr.paint,Nt,Gt,null,xn.setPaintProperty),i.deepEqual(nr.filter,rr.filter)||Nt.push({command:xn.setFilter,args:[Gt,rr.filter]}),i.deepEqual(nr.minzoom,rr.minzoom)&&i.deepEqual(nr.maxzoom,rr.maxzoom)||Nt.push({command:xn.setLayerZoomRange,args:[Gt,rr.minzoom,rr.maxzoom]}),nr)nr.hasOwnProperty(vr)&&vr!=="layout"&&vr!=="paint"&&vr!=="filter"&&vr!=="metadata"&&vr!=="minzoom"&&vr!=="maxzoom"&&(vr.indexOf("paint.")===0?va(nr[vr],rr[vr],Nt,Gt,vr.slice(6),xn.setPaintProperty):i.deepEqual(nr[vr],rr[vr])||Nt.push({command:xn.setLayerProperty,args:[Gt,vr,rr[vr]]}));for(vr in rr)rr.hasOwnProperty(vr)&&!nr.hasOwnProperty(vr)&&vr!=="layout"&&vr!=="paint"&&vr!=="filter"&&vr!=="metadata"&&vr!=="minzoom"&&vr!=="maxzoom"&&(vr.indexOf("paint.")===0?va(nr[vr],rr[vr],Nt,Gt,vr.slice(6),xn.setPaintProperty):i.deepEqual(nr[vr],rr[vr])||Nt.push({command:xn.setLayerProperty,args:[Gt,vr,rr[vr]]}))}else Nt.push({command:xn.removeLayer,args:[Gt]}),Lr=mn[mn.lastIndexOf(Gt)+1],Nt.push({command:xn.addLayer,args:[rr,Lr]})}(rt,F.layers,ue)}catch(nt){console.warn("Unable to compute style diff:",nt),ue=[{command:xn.setStyle,args:[F]}]}return ue}(this.serialize(),n).filter(function(L){return!(L.command in Ks)});if(g.length===0)return!1;var w=g.filter(function(L){return!(L.command in Ys)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(L){return L.command}).join(", ")+".");return g.forEach(function(L){L.command!=="setTransition"&&l[L.command].apply(l,L.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new i.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new i.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,l,g){var w=this;if(g===void 0&&(g={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(i.validateStyle.source,"sources."+n,l,null,g))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var L=this.sourceCaches[n]=new Lt(n,l,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:L.serialize(),sourceId:n}}),L.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new i.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var g=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],g.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),g.setEventedParent(null),g.clearTiles(),g.onRemove&&g.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,l,g){g===void 0&&(g={}),this._checkLoaded();var w=n.id;if(this.getLayer(w))this.fire(new i.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var L;if(n.type==="custom"){if(Fi(this,i.validateCustomStyleLayer(n)))return;L=i.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(w,n.source),n=i.clone$1(n),n=i.extend(n,{source:w})),this._validate(i.validateStyle.layer,"layers."+w,n,{arrayIndex:-1},g))return;L=i.createStyleLayer(n),this._validateLayer(L),L.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[L.id]=L.serialize()}var F=l?this._order.indexOf(l):this._order.length;if(l&&F===-1)this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(F,0,w),this._layerOrderChanged=!0,this._layers[w]=L,this._removedLayers[w]&&L.source&&L.type!=="custom"){var ue=this._removedLayers[w];delete this._removedLayers[w],ue.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},a.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var g=this._order.indexOf(n);this._order.splice(g,1);var w=l?this._order.indexOf(l):this._order.length;l&&w===-1?this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(w,0,n),this._layerOrderChanged=!0)}}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var g=this._order.indexOf(n);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,l,g){this._checkLoaded();var w=this.getLayer(n);w?w.minzoom===l&&w.maxzoom===g||(l!=null&&(w.minzoom=l),g!=null&&(w.maxzoom=g),this._updateLayer(w)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,l,g){g===void 0&&(g={}),this._checkLoaded();var w=this.getLayer(n);if(w){if(!i.deepEqual(w.filter,l))return l==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(i.validateStyle.filter,"layers."+w.id+".filter",l,null,g)||(w.filter=i.clone$1(l),this._updateLayer(w)))}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return i.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,l,g,w){w===void 0&&(w={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getLayoutProperty(l),g)||(L.setLayoutProperty(l,g,w),this._updateLayer(L)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,l){var g=this.getLayer(n);if(g)return g.getLayoutProperty(l);this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,l,g,w){w===void 0&&(w={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getPaintProperty(l),g)||(L.setPaintProperty(l,g,w)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},a.prototype.setFeatureState=function(n,l){this._checkLoaded();var g=n.source,w=n.sourceLayer,L=this.sourceCaches[g];if(L!==void 0){var F=L.getSource().type;F==="geojson"&&w?this.fire(new i.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):F!=="vector"||w?(n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(w,n.id,l)):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,l){this._checkLoaded();var g=n.source,w=this.sourceCaches[g];if(w!==void 0){var L=w.getSource().type,F=L==="vector"?n.sourceLayer:void 0;L!=="vector"||F?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new i.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(F,n.id,l):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,g=n.sourceLayer,w=this.sourceCaches[l];if(w!==void 0){if(w.getSource().type!=="vector"||g)return n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(g,n.id);this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,g=function(Xr){return l._layers[Xr].type==="fill-extrusion"},w={},L=[],F=this._order.length-1;F>=0;F--){var ue=this._order[F];if(g(ue)){w[ue]=F;for(var Ee=0,$e=n;Ee<$e.length;Ee+=1){var rt=$e[Ee][ue];if(rt)for(var nt=0,Ft=rt;nt<Ft.length;nt+=1)L.push(Ft[nt])}}}L.sort(function(rn,Xr){return Xr.intersectionZ-rn.intersectionZ});for(var Nt=[],Kt=this._order.length-1;Kt>=0;Kt--){var jt=this._order[Kt];if(g(jt))for(var Gt=L.length-1;Gt>=0;Gt--){var nr=L[Gt].feature;if(w[nr.layer.id]<Kt)break;Nt.push(nr),L.pop()}else for(var rr=0,Lr=n;rr<Lr.length;rr+=1){var vr=Lr[rr][jt];if(vr)for(var Sr=0,Ar=vr;Sr<Ar.length;Sr+=1)Nt.push(Ar[Sr].feature)}}return Nt},a.prototype.queryRenderedFeatures=function(n,l,g){l&&l.filter&&this._validate(i.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var w={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,F=l.layers;L<F.length;L+=1){var ue=F[L],Ee=this._layers[ue];if(!Ee)return this.fire(new i.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];w[Ee.source]=!0}}var $e=[];for(var rt in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!w[rt]||$e.push(Mt(this.sourceCaches[rt],this._layers,this._serializedLayers,n,l,g));return this.placement&&$e.push(function(nt,Ft,Nt,Kt,jt,Gt,nr){for(var rr={},Lr=Gt.queryRenderedSymbols(Kt),vr=[],Sr=0,Ar=Object.keys(Lr).map(Number);Sr<Ar.length;Sr+=1)vr.push(nr[Ar[Sr]]);vr.sort(ve);for(var rn=function(){var Sa=mn[Xr],Wa=Sa.featureIndex.lookupSymbolFeatures(Lr[Sa.bucketInstanceId],Ft,Sa.bucketIndex,Sa.sourceLayerIndex,jt.filter,jt.layers,jt.availableImages,nt);for(var Sn in Wa){var ua=rr[Sn]=rr[Sn]||[],ba=Wa[Sn];ba.sort(function(na,La){var za=Sa.featureSortOrder;if(za){var Gi=za.indexOf(na.featureIndex);return za.indexOf(La.featureIndex)-Gi}return La.featureIndex-na.featureIndex});for(var Wn=0,Aa=ba;Wn<Aa.length;Wn+=1)ua.push(Aa[Wn])}},Xr=0,mn=vr;Xr<mn.length;Xr+=1)rn();var Ln=function(Sa){rr[Sa].forEach(function(Wa){var Sn=Wa.feature,ua=Nt[nt[Sa].source].getFeatureState(Sn.layer["source-layer"],Sn.id);Sn.source=Sn.layer.source,Sn.layer["source-layer"]&&(Sn.sourceLayer=Sn.layer["source-layer"]),Sn.state=ua})};for(var qn in rr)Ln(qn);return rr}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures($e)},a.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(i.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var g=this.sourceCaches[n];return g?function(w,L){for(var F=w.getRenderableIds().map(function(Ft){return w.getTileByID(Ft)}),ue=[],Ee={},$e=0;$e<F.length;$e++){var rt=F[$e],nt=rt.tileID.canonical.key;Ee[nt]||(Ee[nt]=!0,rt.querySourceFeatures(ue,L))}return ue}(g,l):[]},a.prototype.addSourceType=function(n,l,g){return a.getSourceType(n)?g(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},g):g(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var g=this.light.getLight(),w=!1;for(var L in n)if(!i.deepEqual(n[L],g[L])){w=!0;break}if(w){var F={now:i.browser.now(),transition:i.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(F)}},a.prototype._validate=function(n,l,g,w,L){return L===void 0&&(L={}),(!L||L.validate!==!1)&&Fi(this,n.call(i.validateStyle,i.extend({key:l,style:this.serialize(),value:g,styleSpec:i.styleSpec},w)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,l,g,w,L){L===void 0&&(L=!1);for(var F=!1,ue=!1,Ee={},$e=0,rt=this._order;$e<rt.length;$e+=1){var nt=this._layers[rt[$e]];if(nt.type==="symbol"){if(!Ee[nt.source]){var Ft=this.sourceCaches[nt.source];Ee[nt.source]=Ft.getRenderableIds(!0).map(function(nr){return Ft.getTileByID(nr)}).sort(function(nr,rr){return rr.tileID.overscaledZ-nr.tileID.overscaledZ||(nr.tileID.isLessThan(rr.tileID)?-1:1)})}var Nt=this.crossTileSymbolIndex.addLayer(nt,Ee[nt.source],n.center.lng);F=F||Nt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.browser.now(),n.zoom))&&(this.pauseablePlacement=new bs(n,this._order,L,l,g,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ee),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.browser.now()),ue=!0),F&&this.pauseablePlacement.placement.setStale()),ue||F)for(var Kt=0,jt=this._order;Kt<jt.length;Kt+=1){var Gt=this._layers[jt[Kt]];Gt.type==="symbol"&&this.placement.updateLayerOpacities(Gt,Ee[Gt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,l,g){this.imageManager.getImages(l.icons,g),this._updateTilesForChangedImages();var w=this.sourceCaches[l.source];w&&w.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(n,l,g){this.glyphManager.getGlyphs(l.stacks,g)},a.prototype.getResource=function(n,l,g){return i.makeRequest(l,g)},a}(i.Evented);Ri.getSourceType=function(s){return at[s]},Ri.setSourceType=function(s,a){at[s]=a},Ri.registerForPluginStateChange=i.registerForPluginStateChange;var Vi=i.createLayout([{name:"a_pos",type:"Int16",components:2}]),xs=ci(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),vl=ci(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qu=ci(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Rt=ci(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),fr=ci("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Mr=ci(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Zn=ci(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Xa=ci("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),vi=ci("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ki=ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ya=ci(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ii=ci(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Go=ci(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Cs=ci(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),pi=ci(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Pl=ci(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),$s=ci(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Es=ci(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),gl=ci(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),cu=ci(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_u=ci(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fu=ci(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Uu=ci(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Js=ci(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Rc=ci(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),pf=ci(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ci(s,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),g=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=w?w.concat(g):g,F={};return{fragmentSource:s=s.replace(n,function(ue,Ee,$e,rt,nt){return F[nt]=!0,Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+nt+`
varying `+$e+" "+rt+" "+nt+`;
#else
uniform `+$e+" "+rt+" u_"+nt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+nt+`
    `+$e+" "+rt+" "+nt+" = u_"+nt+`;
#endif
`}),vertexSource:a=a.replace(n,function(ue,Ee,$e,rt,nt){var Ft=rt==="float"?"vec2":"vec4",Nt=nt.match(/color/)?"color":Ft;return F[nt]?Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+nt+`
uniform lowp float u_`+nt+`_t;
attribute `+$e+" "+Ft+" a_"+nt+`;
varying `+$e+" "+rt+" "+nt+`;
#else
uniform `+$e+" "+rt+" u_"+nt+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+nt+`
    `+nt+" = a_"+nt+`;
#else
    `+$e+" "+rt+" "+nt+" = u_"+nt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+nt+`
    `+nt+" = unpack_mix_"+Nt+"(a_"+nt+", u_"+nt+`_t);
#else
    `+$e+" "+rt+" "+nt+" = u_"+nt+`;
#endif
`:Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+nt+`
uniform lowp float u_`+nt+`_t;
attribute `+$e+" "+Ft+" a_"+nt+`;
#else
uniform `+$e+" "+rt+" u_"+nt+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+nt+`
    `+$e+" "+rt+" "+nt+" = a_"+nt+`;
#else
    `+$e+" "+rt+" "+nt+" = u_"+nt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+nt+`
    `+$e+" "+rt+" "+nt+" = unpack_mix_"+Nt+"(a_"+nt+", u_"+nt+`_t);
#else
    `+$e+" "+rt+" "+nt+" = u_"+nt+`;
#endif
`}),staticAttributes:l,staticUniforms:L}}var Ic=Object.freeze({__proto__:null,prelude:xs,background:vl,backgroundPattern:Qu,circle:Rt,clippingMask:fr,heatmap:Mr,heatmapTexture:Zn,collisionBox:Xa,collisionCircle:vi,debug:Ki,fill:Ya,fillOutline:Ii,fillOutlinePattern:Go,fillPattern:Cs,fillExtrusion:pi,fillExtrusionPattern:Pl,hillshadePrepare:$s,hillshade:Es,line:gl,lineGradient:cu,linePattern:_u,lineSDF:fu,raster:Uu,symbolIcon:Js,symbolSDF:Rc,symbolTextAndIcon:pf}),gc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Qc(s){for(var a=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");a.push(l.pop())}return a}gc.prototype.bind=function(s,a,n,l,g,w,L,F){this.context=s;for(var ue=this.boundPaintVertexBuffers.length!==l.length,Ee=0;!ue&&Ee<l.length;Ee++)this.boundPaintVertexBuffers[Ee]!==l[Ee]&&(ue=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===g&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===F?(s.bindVertexArrayOES.set(this.vao),L&&L.bind(),g&&g.dynamicDraw&&g.bind(),F&&F.bind()):this.freshBind(a,n,l,g,w,L,F)},gc.prototype.freshBind=function(s,a,n,l,g,w,L){var F,ue=s.numAttributes,Ee=this.context,$e=Ee.gl;if(Ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ee.extVertexArrayObject.createVertexArrayOES(),Ee.bindVertexArrayOES.set(this.vao),F=0,this.boundProgram=s,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=L;else{F=Ee.currentNumAttributes||0;for(var rt=ue;rt<F;rt++)$e.disableVertexAttribArray(rt)}a.enableAttributes($e,s);for(var nt=0,Ft=n;nt<Ft.length;nt+=1)Ft[nt].enableAttributes($e,s);w&&w.enableAttributes($e,s),L&&L.enableAttributes($e,s),a.bind(),a.setVertexAttribPointers($e,s,g);for(var Nt=0,Kt=n;Nt<Kt.length;Nt+=1){var jt=Kt[Nt];jt.bind(),jt.setVertexAttribPointers($e,s,g)}w&&(w.bind(),w.setVertexAttribPointers($e,s,g)),l&&l.bind(),L&&(L.bind(),L.setVertexAttribPointers($e,s,g)),Ee.currentNumAttributes=ue},gc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var yl=function(a,n,l,g,w,L){var F=a.gl;this.program=F.createProgram();for(var ue=Qc(l.staticAttributes),Ee=g?g.getBinderAttributes():[],$e=ue.concat(Ee),rt=l.staticUniforms?Qc(l.staticUniforms):[],nt=g?g.getBinderUniforms():[],Ft=[],Nt=0,Kt=rt.concat(nt);Nt<Kt.length;Nt+=1){var jt=Kt[Nt];Ft.indexOf(jt)<0&&Ft.push(jt)}var Gt=g?g.defines():[];L&&Gt.push("#define OVERDRAW_INSPECTOR;");var nr=Gt.concat(xs.fragmentSource,l.fragmentSource).join(`
`),rr=Gt.concat(xs.vertexSource,l.vertexSource).join(`
`),Lr=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(Lr,nr),F.compileShader(Lr),F.attachShader(this.program,Lr);var vr=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(vr,rr),F.compileShader(vr),F.attachShader(this.program,vr),this.attributes={};var Sr={};this.numAttributes=$e.length;for(var Ar=0;Ar<this.numAttributes;Ar++)$e[Ar]&&(F.bindAttribLocation(this.program,Ar,$e[Ar]),this.attributes[$e[Ar]]=Ar);F.linkProgram(this.program),F.deleteShader(vr),F.deleteShader(Lr);for(var rn=0;rn<Ft.length;rn++){var Xr=Ft[rn];if(Xr&&!Sr[Xr]){var mn=F.getUniformLocation(this.program,Xr);mn&&(Sr[Xr]=mn)}}this.fixedUniforms=w(a,Sr),this.binderUniforms=g?g.getUniforms(a,Sr):[]}}};function qc(s,a,n){var l=1/Ha(n,1,a.transform.tileZoom),g=Math.pow(2,n.tileID.overscaledZ),w=n.tileSize*Math.pow(2,a.transform.tileZoom)/g,L=w*(n.tileID.canonical.x+n.tileID.wrap*g),F=w*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[L>>16,F>>16],u_pixel_coord_lower:[65535&L,65535&F]}}yl.prototype.draw=function(s,a,n,l,g,w,L,F,ue,Ee,$e,rt,nt,Ft,Nt,Kt){var jt,Gt=s.gl;if(!this.failedToCreate){for(var nr in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(g),s.setCullFace(w),this.fixedUniforms)this.fixedUniforms[nr].set(L[nr]);Ft&&Ft.setUniforms(s,this.binderUniforms,rt,{zoom:nt});for(var rr=(jt={},jt[Gt.LINES]=2,jt[Gt.TRIANGLES]=3,jt[Gt.LINE_STRIP]=1,jt)[a],Lr=0,vr=$e.get();Lr<vr.length;Lr+=1){var Sr=vr[Lr],Ar=Sr.vaos||(Sr.vaos={});(Ar[F]||(Ar[F]=new gc)).bind(s,this,ue,Ft?Ft.getPaintVertexBuffers():[],Ee,Sr.vertexOffset,Nt,Kt),Gt.drawElements(a,Sr.primitiveLength*rr,Gt.UNSIGNED_SHORT,Sr.primitiveOffset*rr*2)}}};var $i=function(a,n,l,g){var w=n.style.light,L=w.properties.get("position"),F=[L.x,L.y,L.z],ue=i.create$1();w.properties.get("anchor")==="viewport"&&i.fromRotation(ue,-n.transform.angle),i.transformMat3(F,F,ue);var Ee=w.properties.get("color");return{u_matrix:a,u_lightpos:F,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+l,u_opacity:g}},Su=function(a,n,l,g,w,L,F){return i.extend($i(a,n,l,g),qc(L,n,F),{u_height_factor:-Math.pow(2,w.overscaledZ)/F.tileSize/8})},bl=function(a){return{u_matrix:a}},as=function(a,n,l,g){return i.extend(bl(a),qc(l,n,g))},Dc=function(a,n){return{u_matrix:a,u_world:n}},yc=function(a,n,l,g,w){return i.extend(as(a,n,l,g),{u_world:w})},Ll=function(a,n,l,g){var w,L,F=a.transform;if(g.paint.get("circle-pitch-alignment")==="map"){var ue=Ha(l,1,F.zoom);w=!0,L=[ue,ue]}else w=!1,L=F.pixelsToGLUnits;return{u_camera_to_center_distance:F.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:a.translatePosMatrix(n.posMatrix,l,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:i.browser.devicePixelRatio,u_extrude_scale:L}},qu=function(a,n,l){var g=Ha(l,1,n.zoom),w=Math.pow(2,n.zoom-l.tileID.overscaledZ),L=l.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[n.pixelsToGLUnits[0]/(g*w),n.pixelsToGLUnits[1]/(g*w)],u_overscale_factor:L}},Nc=function(a,n,l){return{u_matrix:a,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},hu=function(a,n,l){return l===void 0&&(l=1),{u_matrix:a,u_color:n,u_overlay:0,u_overlay_scale:l}},Au=function(a){return{u_matrix:a}},ef=function(a,n,l,g){return{u_matrix:a,u_extrude_scale:Ha(n,1,l),u_intensity:g}},$l=function(a,n,l){var g=a.transform;return{u_matrix:kc(a,n,l),u_ratio:1/Ha(n,1,g.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ti=function(a,n,l,g){return i.extend($l(a,n,l),{u_image:0,u_image_height:g})},tf=function(a,n,l,g){var w=a.transform,L=Jl(n,w);return{u_matrix:kc(a,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Ha(n,1,w.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_image:0,u_scale:[L,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},mf=function(a,n,l,g,w){var L=a.lineAtlas,F=Jl(n,a.transform),ue=l.layout.get("line-cap")==="round",Ee=L.getDash(g.from,ue),$e=L.getDash(g.to,ue),rt=Ee.width*w.fromScale,nt=$e.width*w.toScale;return i.extend($l(a,n,l),{u_patternscale_a:[F/rt,-Ee.height/2],u_patternscale_b:[F/nt,-$e.height/2],u_sdfgamma:L.width/(256*Math.min(rt,nt)*i.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ee.y,u_tex_y_b:$e.y,u_mix:w.t})};function Jl(s,a){return 1/Ha(s,1,a.tileZoom)}function kc(s,a,n){return s.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Ql=function(a,n,l,g,w){return{u_matrix:a,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(F=w.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(L=w.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:el(w.paint.get("raster-hue-rotate"))};var L,F};function el(s){s*=Math.PI/180;var a=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var Bu,xl=function(a,n,l,g,w,L,F,ue,Ee,$e){var rt=w.transform;return{u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:rt.cameraToCenterDistance,u_pitch:rt.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:rt.width/rt.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:F,u_coord_matrix:ue,u_is_text:+Ee,u_pitch_with_map:+g,u_texsize:$e,u_texture:0}},Po=function(a,n,l,g,w,L,F,ue,Ee,$e,rt){var nt=w.transform;return i.extend(xl(a,n,l,g,w,L,F,ue,Ee,$e),{u_gamma_scale:g?Math.cos(nt._pitch)*nt.cameraToCenterDistance:1,u_device_pixel_ratio:i.browser.devicePixelRatio,u_is_halo:+rt})},ql=function(a,n,l,g,w,L,F,ue,Ee,$e){return i.extend(Po(a,n,l,g,w,L,F,ue,!0,Ee,!0),{u_texsize_icon:$e,u_texture_icon:1})},Rl=function(a,n,l){return{u_matrix:a,u_opacity:n,u_color:l}},Il=function(a,n,l,g,w,L){return i.extend(function(F,ue,Ee,$e){var rt=Ee.imageManager.getPattern(F.from.toString()),nt=Ee.imageManager.getPattern(F.to.toString()),Ft=Ee.imageManager.getPixelSize(),Nt=Ft.width,Kt=Ft.height,jt=Math.pow(2,$e.tileID.overscaledZ),Gt=$e.tileSize*Math.pow(2,Ee.transform.tileZoom)/jt,nr=Gt*($e.tileID.canonical.x+$e.tileID.wrap*jt),rr=Gt*$e.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:rt.tl,u_pattern_br_a:rt.br,u_pattern_tl_b:nt.tl,u_pattern_br_b:nt.br,u_texsize:[Nt,Kt],u_mix:ue.t,u_pattern_size_a:rt.displaySize,u_pattern_size_b:nt.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/Ha($e,1,Ee.transform.tileZoom),u_pixel_coord_upper:[nr>>16,rr>>16],u_pixel_coord_lower:[65535&nr,65535&rr]}}(g,L,l,w),{u_matrix:a,u_opacity:n})},jc={fillExtrusion:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fillExtrusionPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_height_factor:new i.Uniform1f(a,n.u_height_factor),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fill:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},fillPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},fillOutline:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world)}},fillOutlinePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},circle:function(a,n){return{u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_scale_with_map:new i.Uniform1i(a,n.u_scale_with_map),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},collisionBox:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pixels_to_tile_units:new i.Uniform1f(a,n.u_pixels_to_tile_units),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_overscale_factor:new i.Uniform1f(a,n.u_overscale_factor)}},collisionCircle:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_inv_matrix:new i.UniformMatrix4f(a,n.u_inv_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_viewport_size:new i.Uniform2f(a,n.u_viewport_size)}},debug:function(a,n){return{u_color:new i.UniformColor(a,n.u_color),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_overlay:new i.Uniform1i(a,n.u_overlay),u_overlay_scale:new i.Uniform1f(a,n.u_overlay_scale)}},clippingMask:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmap:function(a,n){return{u_extrude_scale:new i.Uniform1f(a,n.u_extrude_scale),u_intensity:new i.Uniform1f(a,n.u_intensity),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmapTexture:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_color_ramp:new i.Uniform1i(a,n.u_color_ramp),u_opacity:new i.Uniform1f(a,n.u_opacity)}},hillshade:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_latrange:new i.Uniform2f(a,n.u_latrange),u_light:new i.Uniform2f(a,n.u_light),u_shadow:new i.UniformColor(a,n.u_shadow),u_highlight:new i.UniformColor(a,n.u_highlight),u_accent:new i.UniformColor(a,n.u_accent)}},hillshadePrepare:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_dimension:new i.Uniform2f(a,n.u_dimension),u_zoom:new i.Uniform1f(a,n.u_zoom),u_unpack:new i.Uniform4f(a,n.u_unpack)}},line:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels)}},lineGradient:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_image:new i.Uniform1i(a,n.u_image),u_image_height:new i.Uniform1f(a,n.u_image_height)}},linePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_texsize:new i.Uniform2f(a,n.u_texsize),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_image:new i.Uniform1i(a,n.u_image),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},lineSDF:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_patternscale_a:new i.Uniform2f(a,n.u_patternscale_a),u_patternscale_b:new i.Uniform2f(a,n.u_patternscale_b),u_sdfgamma:new i.Uniform1f(a,n.u_sdfgamma),u_image:new i.Uniform1i(a,n.u_image),u_tex_y_a:new i.Uniform1f(a,n.u_tex_y_a),u_tex_y_b:new i.Uniform1f(a,n.u_tex_y_b),u_mix:new i.Uniform1f(a,n.u_mix)}},raster:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_tl_parent:new i.Uniform2f(a,n.u_tl_parent),u_scale_parent:new i.Uniform1f(a,n.u_scale_parent),u_buffer_scale:new i.Uniform1f(a,n.u_buffer_scale),u_fade_t:new i.Uniform1f(a,n.u_fade_t),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image0:new i.Uniform1i(a,n.u_image0),u_image1:new i.Uniform1i(a,n.u_image1),u_brightness_low:new i.Uniform1f(a,n.u_brightness_low),u_brightness_high:new i.Uniform1f(a,n.u_brightness_high),u_saturation_factor:new i.Uniform1f(a,n.u_saturation_factor),u_contrast_factor:new i.Uniform1f(a,n.u_contrast_factor),u_spin_weights:new i.Uniform3f(a,n.u_spin_weights)}},symbolIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture)}},symbolSDF:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},symbolTextAndIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texsize_icon:new i.Uniform2f(a,n.u_texsize_icon),u_texture:new i.Uniform1i(a,n.u_texture),u_texture_icon:new i.Uniform1i(a,n.u_texture_icon),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},background:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_color:new i.UniformColor(a,n.u_color)}},backgroundPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image:new i.Uniform1i(a,n.u_image),u_pattern_tl_a:new i.Uniform2f(a,n.u_pattern_tl_a),u_pattern_br_a:new i.Uniform2f(a,n.u_pattern_br_a),u_pattern_tl_b:new i.Uniform2f(a,n.u_pattern_tl_b),u_pattern_br_b:new i.Uniform2f(a,n.u_pattern_br_b),u_texsize:new i.Uniform2f(a,n.u_texsize),u_mix:new i.Uniform1f(a,n.u_mix),u_pattern_size_a:new i.Uniform2f(a,n.u_pattern_size_a),u_pattern_size_b:new i.Uniform2f(a,n.u_pattern_size_b),u_scale_a:new i.Uniform1f(a,n.u_scale_a),u_scale_b:new i.Uniform1f(a,n.u_scale_b),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_tile_units_to_pixels:new i.Uniform1f(a,n.u_tile_units_to_pixels)}}};function El(s,a,n,l,g,w,L){for(var F=s.context,ue=F.gl,Ee=s.useProgram("collisionBox"),$e=[],rt=0,nt=0,Ft=0;Ft<l.length;Ft++){var Nt=l[Ft],Kt=a.getTile(Nt),jt=Kt.getBucket(n);if(jt){var Gt=Nt.posMatrix;g[0]===0&&g[1]===0||(Gt=s.translatePosMatrix(Nt.posMatrix,Kt,g,w));var nr=L?jt.textCollisionBox:jt.iconCollisionBox,rr=jt.collisionCircleArray;if(rr.length>0){var Lr=i.create(),vr=Gt;i.mul(Lr,jt.placementInvProjMatrix,s.transform.glCoordMatrix),i.mul(Lr,Lr,jt.placementViewportMatrix),$e.push({circleArray:rr,circleOffset:nt,transform:vr,invTransform:Lr}),nt=rt+=rr.length/4}nr&&Ee.draw(F,ue.LINES,xe.disabled,ut.disabled,s.colorModeForRenderPass(),Bt.disabled,qu(Gt,s.transform,Kt),n.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,null,s.transform.zoom,null,null,nr.collisionVertexBuffer)}}if(L&&$e.length){var Sr=s.useProgram("collisionCircle"),Ar=new i.StructArrayLayout2f1f2i16;Ar.resize(4*rt),Ar._trim();for(var rn=0,Xr=0,mn=$e;Xr<mn.length;Xr+=1)for(var Ln=mn[Xr],qn=0;qn<Ln.circleArray.length/4;qn++){var sa=4*qn,Sa=Ln.circleArray[sa+0],Wa=Ln.circleArray[sa+1],Sn=Ln.circleArray[sa+2],ua=Ln.circleArray[sa+3];Ar.emplace(rn++,Sa,Wa,Sn,ua,0),Ar.emplace(rn++,Sa,Wa,Sn,ua,1),Ar.emplace(rn++,Sa,Wa,Sn,ua,2),Ar.emplace(rn++,Sa,Wa,Sn,ua,3)}(!Bu||Bu.length<2*rt)&&(Bu=function(Gi){var _i=2*Gi,Di=new i.StructArrayLayout3ui6;Di.resize(_i),Di._trim();for(var gi=0;gi<_i;gi++){var Ui=6*gi;Di.uint16[Ui+0]=4*gi+0,Di.uint16[Ui+1]=4*gi+1,Di.uint16[Ui+2]=4*gi+2,Di.uint16[Ui+3]=4*gi+2,Di.uint16[Ui+4]=4*gi+3,Di.uint16[Ui+5]=4*gi+0}return Di}(rt));for(var ba=F.createIndexBuffer(Bu,!0),Wn=F.createVertexBuffer(Ar,i.collisionCircleLayout.members,!0),Aa=0,na=$e;Aa<na.length;Aa+=1){var La=na[Aa],za=Nc(La.transform,La.invTransform,s.transform);Sr.draw(F,ue.TRIANGLES,xe.disabled,ut.disabled,s.colorModeForRenderPass(),Bt.disabled,za,n.id,Wn,ba,i.SegmentVector.simpleSegment(0,2*La.circleOffset,La.circleArray.length,La.circleArray.length/2),null,s.transform.zoom,null,null,null)}Wn.destroy(),ba.destroy()}}var Qs=i.identity(new Float32Array(16));function eo(s,a,n,l,g,w){var L=i.getAnchorAlignment(s),F=-(L.horizontalAlign-.5)*a,ue=-(L.verticalAlign-.5)*n,Ee=i.evaluateVariableOffset(s,l);return new i.Point((F/g+Ee[0])*w,(ue/g+Ee[1])*w)}function vf(s,a,n,l,g,w,L,F,ue,Ee,$e){var rt=s.text.placedSymbolArray,nt=s.text.dynamicLayoutVertexArray,Ft=s.icon.dynamicLayoutVertexArray,Nt={};nt.clear();for(var Kt=0;Kt<rt.length;Kt++){var jt=rt.get(Kt),Gt=jt.hidden||!jt.crossTileID||s.allowVerticalPlacement&&!jt.placedOrientation?null:l[jt.crossTileID];if(Gt){var nr=new i.Point(jt.anchorX,jt.anchorY),rr=ya(nr,n?F:L),Lr=fa(w.cameraToCenterDistance,rr.signedDistanceFromCamera),vr=g.evaluateSizeForFeature(s.textSizeData,Ee,jt)*Lr/i.ONE_EM;n&&(vr*=s.tilePixelRatio/ue);for(var Sr=eo(Gt.anchor,Gt.width,Gt.height,Gt.textOffset,Gt.textBoxScale,vr),Ar=n?ya(nr.add(Sr),L).point:rr.point.add(a?Sr.rotate(-w.angle):Sr),rn=s.allowVerticalPlacement&&jt.placedOrientation===i.WritingMode.vertical?Math.PI/2:0,Xr=0;Xr<jt.numGlyphs;Xr++)i.addDynamicAttributes(nt,Ar,rn);$e&&jt.associatedIconIndex>=0&&(Nt[jt.associatedIconIndex]={shiftedAnchor:Ar,angle:rn})}else oi(jt.numGlyphs,nt)}if($e){Ft.clear();for(var mn=s.icon.placedSymbolArray,Ln=0;Ln<mn.length;Ln++){var qn=mn.get(Ln);if(qn.hidden)oi(qn.numGlyphs,Ft);else{var sa=Nt[Ln];if(sa)for(var Sa=0;Sa<qn.numGlyphs;Sa++)i.addDynamicAttributes(Ft,sa.shiftedAnchor,sa.angle);else oi(qn.numGlyphs,Ft)}}s.icon.dynamicLayoutVertexBuffer.updateData(Ft)}s.text.dynamicLayoutVertexBuffer.updateData(nt)}function gf(s,a,n){return n.iconsInText&&a?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function Tl(s,a,n,l,g,w,L,F,ue,Ee,$e,rt){for(var nt=s.context,Ft=nt.gl,Nt=s.transform,Kt=F==="map",jt=ue==="map",Gt=Kt&&n.layout.get("symbol-placement")!=="point",nr=Kt&&!jt&&!Gt,rr=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Lr=!1,vr=s.depthModeForSublayer(0,xe.ReadOnly),Sr=n.layout.get("text-variable-anchor"),Ar=[],rn=0,Xr=l;rn<Xr.length;rn+=1){var mn=Xr[rn],Ln=a.getTile(mn),qn=Ln.getBucket(n);if(qn){var sa=g?qn.text:qn.icon;if(sa&&sa.segments.get().length){var Sa=sa.programConfigurations.get(n.id),Wa=g||qn.sdfIcons,Sn=g?qn.textSizeData:qn.iconSizeData,ua=jt||Nt.pitch!==0,ba=s.useProgram(gf(Wa,g,qn),Sa),Wn=i.evaluateSizeForZoom(Sn,Nt.zoom),Aa=void 0,na=[0,0],La=void 0,za=void 0,Gi=null,_i=void 0;if(g)La=Ln.glyphAtlasTexture,za=Ft.LINEAR,Aa=Ln.glyphAtlasTexture.size,qn.iconsInText&&(na=Ln.imageAtlasTexture.size,Gi=Ln.imageAtlasTexture,_i=ua||s.options.rotating||s.options.zooming||Sn.kind==="composite"||Sn.kind==="camera"?Ft.LINEAR:Ft.NEAREST);else{var Di=n.layout.get("icon-size").constantOr(0)!==1||qn.iconsNeedLinear;La=Ln.imageAtlasTexture,za=Wa||s.options.rotating||s.options.zooming||Di||ua?Ft.LINEAR:Ft.NEAREST,Aa=Ln.imageAtlasTexture.size}var gi=Ha(Ln,1,s.transform.zoom),Ui=di(mn.posMatrix,jt,Kt,s.transform,gi),Qo=ga(mn.posMatrix,jt,Kt,s.transform,gi),qo=Sr&&qn.hasTextData(),vu=n.layout.get("icon-text-fit")!=="none"&&qo&&qn.hasIconData();Gt&&ns(qn,mn.posMatrix,s,g,Ui,Qo,jt,Ee);var Mu=s.translatePosMatrix(mn.posMatrix,Ln,w,L),cs=Gt||g&&Sr||vu?Qs:Ui,Gs=s.translatePosMatrix(Qo,Ln,w,L,!0),Pu=Wa&&n.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0,sc={program:ba,buffers:sa,uniformValues:Wa?qn.iconsInText?ql(Sn.kind,Wn,nr,jt,s,Mu,cs,Gs,Aa,na):Po(Sn.kind,Wn,nr,jt,s,Mu,cs,Gs,g,Aa,!0):xl(Sn.kind,Wn,nr,jt,s,Mu,cs,Gs,g,Aa),atlasTexture:La,atlasTextureIcon:Gi,atlasInterpolation:za,atlasInterpolationIcon:_i,isSDF:Wa,hasHalo:Pu};if(rr&&qn.canOverlap){Lr=!0;for(var tu=0,Xu=sa.segments.get();tu<Xu.length;tu+=1){var uc=Xu[tu];Ar.push({segments:new i.SegmentVector([uc]),sortKey:uc.sortKey,state:sc})}}else Ar.push({segments:sa.segments,sortKey:0,state:sc})}}}Lr&&Ar.sort(function(Gl,hs){return Gl.sortKey-hs.sortKey});for(var ru=0,Lu=Ar;ru<Lu.length;ru+=1){var fs=Lu[ru],ao=fs.state;if(nt.activeTexture.set(Ft.TEXTURE0),ao.atlasTexture.bind(ao.atlasInterpolation,Ft.CLAMP_TO_EDGE),ao.atlasTextureIcon&&(nt.activeTexture.set(Ft.TEXTURE1),ao.atlasTextureIcon&&ao.atlasTextureIcon.bind(ao.atlasInterpolationIcon,Ft.CLAMP_TO_EDGE)),ao.isSDF){var Yu=ao.uniformValues;ao.hasHalo&&(Yu.u_is_halo=1,ec(ao.buffers,fs.segments,n,s,ao.program,vr,$e,rt,Yu)),Yu.u_is_halo=0}ec(ao.buffers,fs.segments,n,s,ao.program,vr,$e,rt,ao.uniformValues)}}function ec(s,a,n,l,g,w,L,F,ue){var Ee=l.context;g.draw(Ee,Ee.gl.TRIANGLES,w,L,F,Bt.disabled,ue,n.id,s.layoutVertexBuffer,s.indexBuffer,a,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function tl(s,a,n,l,g,w,L){var F,ue,Ee,$e,rt,nt=s.context.gl,Ft=n.paint.get("fill-pattern"),Nt=Ft&&Ft.constantOr(1),Kt=n.getCrossfadeParameters();L?(ue=Nt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=nt.LINES):(ue=Nt?"fillPattern":"fill",F=nt.TRIANGLES);for(var jt=0,Gt=l;jt<Gt.length;jt+=1){var nr=Gt[jt],rr=a.getTile(nr);if(!Nt||rr.patternsLoaded()){var Lr=rr.getBucket(n);if(Lr){var vr=Lr.programConfigurations.get(n.id),Sr=s.useProgram(ue,vr);Nt&&(s.context.activeTexture.set(nt.TEXTURE0),rr.imageAtlasTexture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE),vr.updatePaintBuffers(Kt));var Ar=Ft.constantOr(null);if(Ar&&rr.imageAtlas){var rn=rr.imageAtlas,Xr=rn.patternPositions[Ar.to.toString()],mn=rn.patternPositions[Ar.from.toString()];Xr&&mn&&vr.setConstantPatternPositions(Xr,mn)}var Ln=s.translatePosMatrix(nr.posMatrix,rr,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(L){$e=Lr.indexBuffer2,rt=Lr.segments2;var qn=[nt.drawingBufferWidth,nt.drawingBufferHeight];Ee=ue==="fillOutlinePattern"&&Nt?yc(Ln,s,Kt,rr,qn):Dc(Ln,qn)}else $e=Lr.indexBuffer,rt=Lr.segments,Ee=Nt?as(Ln,s,Kt,rr):bl(Ln);Sr.draw(s.context,F,g,s.stencilModeForClipping(nr),w,Bt.disabled,Ee,n.id,Lr.layoutVertexBuffer,$e,rt,n.paint,s.transform.zoom,vr)}}}}function Dl(s,a,n,l,g,w,L){for(var F=s.context,ue=F.gl,Ee=n.paint.get("fill-extrusion-pattern"),$e=Ee.constantOr(1),rt=n.getCrossfadeParameters(),nt=n.paint.get("fill-extrusion-opacity"),Ft=0,Nt=l;Ft<Nt.length;Ft+=1){var Kt=Nt[Ft],jt=a.getTile(Kt),Gt=jt.getBucket(n);if(Gt){var nr=Gt.programConfigurations.get(n.id),rr=s.useProgram($e?"fillExtrusionPattern":"fillExtrusion",nr);$e&&(s.context.activeTexture.set(ue.TEXTURE0),jt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),nr.updatePaintBuffers(rt));var Lr=Ee.constantOr(null);if(Lr&&jt.imageAtlas){var vr=jt.imageAtlas,Sr=vr.patternPositions[Lr.to.toString()],Ar=vr.patternPositions[Lr.from.toString()];Sr&&Ar&&nr.setConstantPatternPositions(Sr,Ar)}var rn=s.translatePosMatrix(Kt.posMatrix,jt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Xr=n.paint.get("fill-extrusion-vertical-gradient"),mn=$e?Su(rn,s,Xr,nt,Kt,rt,jt):$i(rn,s,Xr,nt);rr.draw(F,F.gl.TRIANGLES,g,w,L,Bt.backCCW,mn,n.id,Gt.layoutVertexBuffer,Gt.indexBuffer,Gt.segments,n.paint,s.transform.zoom,nr)}}}function bc(s,a,n,l,g,w){var L=s.context,F=L.gl,ue=a.fbo;if(ue){var Ee=s.useProgram("hillshade");L.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,ue.colorAttachment.get());var $e=function(rt,nt,Ft){var Nt=Ft.paint.get("hillshade-shadow-color"),Kt=Ft.paint.get("hillshade-highlight-color"),jt=Ft.paint.get("hillshade-accent-color"),Gt=Ft.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ft.paint.get("hillshade-illumination-anchor")==="viewport"&&(Gt-=rt.transform.angle);var nr,rr,Lr,vr=!rt.options.moving;return{u_matrix:rt.transform.calculatePosMatrix(nt.tileID.toUnwrapped(),vr),u_image:0,u_latrange:(nr=nt.tileID,rr=Math.pow(2,nr.canonical.z),Lr=nr.canonical.y,[new i.MercatorCoordinate(0,Lr/rr).toLngLat().lat,new i.MercatorCoordinate(0,(Lr+1)/rr).toLngLat().lat]),u_light:[Ft.paint.get("hillshade-exaggeration"),Gt],u_shadow:Nt,u_highlight:Kt,u_accent:jt}}(s,a,n);Ee.draw(L,F.TRIANGLES,l,g,w,Bt.disabled,$e,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function xc(s,a,n,l,g,w){var L=s.context,F=L.gl,ue=a.dem;if(ue&&ue.data){var Ee=ue.dim,$e=ue.stride,rt=ue.getPixels();if(L.activeTexture.set(F.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||s.getTileTexture($e),a.demTexture){var nt=a.demTexture;nt.update(rt,{premultiply:!1}),nt.bind(F.NEAREST,F.CLAMP_TO_EDGE)}else a.demTexture=new i.Texture(L,rt,F.RGBA,{premultiply:!1}),a.demTexture.bind(F.NEAREST,F.CLAMP_TO_EDGE);L.activeTexture.set(F.TEXTURE0);var Ft=a.fbo;if(!Ft){var Nt=new i.Texture(L,{width:Ee,height:Ee,data:null},F.RGBA);Nt.bind(F.LINEAR,F.CLAMP_TO_EDGE),(Ft=a.fbo=L.createFramebuffer(Ee,Ee,!0)).colorAttachment.set(Nt.texture)}L.bindFramebuffer.set(Ft.framebuffer),L.viewport.set([0,0,Ee,Ee]),s.useProgram("hillshadePrepare").draw(L,F.TRIANGLES,l,g,w,Bt.disabled,function(Kt,jt){var Gt=jt.stride,nr=i.create();return i.ortho(nr,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(nr,nr,[0,-i.EXTENT,0]),{u_matrix:nr,u_image:1,u_dimension:[Gt,Gt],u_zoom:Kt.overscaledZ,u_unpack:jt.getUnpackVector()}}(a.tileID,ue),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function rl(s,a,n,l,g){var w=l.paint.get("raster-fade-duration");if(w>0){var L=i.browser.now(),F=(L-s.timeAdded)/w,ue=a?(L-a.timeAdded)/w:-1,Ee=n.getSource(),$e=g.coveringZoomLevel({tileSize:Ee.tileSize,roundZoom:Ee.roundZoom}),rt=!a||Math.abs(a.tileID.overscaledZ-$e)>Math.abs(s.tileID.overscaledZ-$e),nt=rt&&s.refreshedUponExpiration?1:i.clamp(rt?F:1-ue,0,1);return s.refreshedUponExpiration&&F>=1&&(s.refreshedUponExpiration=!1),a?{opacity:1,mix:1-nt}:{opacity:nt,mix:0}}return{opacity:1,mix:0}}var rf=new i.Color(1,0,0,1),nl=new i.Color(0,1,0,1),qs=new i.Color(0,0,1,1),_l=new i.Color(1,0,1,1),tc=new i.Color(0,1,1,1);function Fc(s,a,n,l){Fs(s,0,a+n/2,s.transform.width,n,l)}function nf(s,a,n,l){Fs(s,a-n/2,0,n,s.transform.height,l)}function Fs(s,a,n,l,g,w){var L=s.context,F=L.gl;F.enable(F.SCISSOR_TEST),F.scissor(a*i.browser.devicePixelRatio,n*i.browser.devicePixelRatio,l*i.browser.devicePixelRatio,g*i.browser.devicePixelRatio),L.clear({color:w}),F.disable(F.SCISSOR_TEST)}function yf(s,a,n){var l=s.context,g=l.gl,w=n.posMatrix,L=s.useProgram("debug"),F=xe.disabled,ue=ut.disabled,Ee=s.colorModeForRenderPass();l.activeTexture.set(g.TEXTURE0),s.emptyTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),L.draw(l,g.LINE_STRIP,F,ue,Ee,Bt.disabled,hu(w,i.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var $e=a.getTileByID(n.key).latestRawTileData,rt=Math.floor(($e&&$e.byteLength||0)/1024),nt=a.getTile(n).tileSize,Ft=512/Math.min(nt,512)*(n.overscaledZ/s.transform.zoom)*.5,Nt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Nt+=" => "+n.overscaledZ),function(Kt,jt){Kt.initDebugOverlayCanvas();var Gt=Kt.debugOverlayCanvas,nr=Kt.context.gl,rr=Kt.debugOverlayCanvas.getContext("2d");rr.clearRect(0,0,Gt.width,Gt.height),rr.shadowColor="white",rr.shadowBlur=2,rr.lineWidth=1.5,rr.strokeStyle="white",rr.textBaseline="top",rr.font="bold 36px Open Sans, sans-serif",rr.fillText(jt,5,5),rr.strokeText(jt,5,5),Kt.debugOverlayTexture.update(Gt),Kt.debugOverlayTexture.bind(nr.LINEAR,nr.CLAMP_TO_EDGE)}(s,Nt+" "+rt+"kb"),L.draw(l,g.TRIANGLES,F,ue,wt.alphaBlended,Bt.disabled,hu(w,i.Color.transparent,Ft),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var al={symbol:function(a,n,l,g,w){if(a.renderPass==="translucent"){var L=ut.disabled,F=a.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(ue,Ee,$e,rt,nt,Ft,Nt){for(var Kt=Ee.transform,jt=nt==="map",Gt=Ft==="map",nr=0,rr=ue;nr<rr.length;nr+=1){var Lr=rr[nr],vr=rt.getTile(Lr),Sr=vr.getBucket($e);if(Sr&&Sr.text&&Sr.text.segments.get().length){var Ar=i.evaluateSizeForZoom(Sr.textSizeData,Kt.zoom),rn=Ha(vr,1,Ee.transform.zoom),Xr=di(Lr.posMatrix,Gt,jt,Ee.transform,rn),mn=$e.layout.get("icon-text-fit")!=="none"&&Sr.hasIconData();if(Ar){var Ln=Math.pow(2,Kt.zoom-vr.tileID.overscaledZ);vf(Sr,jt,Gt,Nt,i.symbolSize,Kt,Xr,Lr.posMatrix,Ln,Ar,mn)}}}}(g,a,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),w),l.paint.get("icon-opacity").constantOr(1)!==0&&Tl(a,n,l,g,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),L,F),l.paint.get("text-opacity").constantOr(1)!==0&&Tl(a,n,l,g,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),L,F),n.map.showCollisionBoxes&&(El(a,n,l,g,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),El(a,n,l,g,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(a,n,l,g){if(a.renderPass==="translucent"){var w=l.paint.get("circle-opacity"),L=l.paint.get("circle-stroke-width"),F=l.paint.get("circle-stroke-opacity"),ue=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)!==0||L.constantOr(1)!==0&&F.constantOr(1)!==0){for(var Ee=a.context,$e=Ee.gl,rt=a.depthModeForSublayer(0,xe.ReadOnly),nt=ut.disabled,Ft=a.colorModeForRenderPass(),Nt=[],Kt=0;Kt<g.length;Kt++){var jt=g[Kt],Gt=n.getTile(jt),nr=Gt.getBucket(l);if(nr){var rr=nr.programConfigurations.get(l.id),Lr={programConfiguration:rr,program:a.useProgram("circle",rr),layoutVertexBuffer:nr.layoutVertexBuffer,indexBuffer:nr.indexBuffer,uniformValues:Ll(a,jt,Gt,l)};if(ue)for(var vr=0,Sr=nr.segments.get();vr<Sr.length;vr+=1){var Ar=Sr[vr];Nt.push({segments:new i.SegmentVector([Ar]),sortKey:Ar.sortKey,state:Lr})}else Nt.push({segments:nr.segments,sortKey:0,state:Lr})}}ue&&Nt.sort(function(qn,sa){return qn.sortKey-sa.sortKey});for(var rn=0,Xr=Nt;rn<Xr.length;rn+=1){var mn=Xr[rn],Ln=mn.state;Ln.program.draw(Ee,$e.TRIANGLES,rt,nt,Ft,Bt.disabled,Ln.uniformValues,l.id,Ln.layoutVertexBuffer,Ln.indexBuffer,mn.segments,l.paint,a.transform.zoom,Ln.programConfiguration)}}}},heatmap:function(a,n,l,g){if(l.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){var w=a.context,L=w.gl,F=ut.disabled,ue=new wt([L.ONE,L.ONE],i.Color.transparent,[!0,!0,!0,!0]);!function(Nt,Kt,jt){var Gt=Nt.gl;Nt.activeTexture.set(Gt.TEXTURE1),Nt.viewport.set([0,0,Kt.width/4,Kt.height/4]);var nr=jt.heatmapFbo;if(nr)Gt.bindTexture(Gt.TEXTURE_2D,nr.colorAttachment.get()),Nt.bindFramebuffer.set(nr.framebuffer);else{var rr=Gt.createTexture();Gt.bindTexture(Gt.TEXTURE_2D,rr),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_S,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_T,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MIN_FILTER,Gt.LINEAR),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MAG_FILTER,Gt.LINEAR),nr=jt.heatmapFbo=Nt.createFramebuffer(Kt.width/4,Kt.height/4,!1),function(Lr,vr,Sr,Ar){var rn=Lr.gl;rn.texImage2D(rn.TEXTURE_2D,0,rn.RGBA,vr.width/4,vr.height/4,0,rn.RGBA,Lr.extRenderToTextureHalfFloat?Lr.extTextureHalfFloat.HALF_FLOAT_OES:rn.UNSIGNED_BYTE,null),Ar.colorAttachment.set(Sr)}(Nt,Kt,rr,nr)}}(w,a,l),w.clear({color:i.Color.transparent});for(var Ee=0;Ee<g.length;Ee++){var $e=g[Ee];if(!n.hasRenderableParent($e)){var rt=n.getTile($e),nt=rt.getBucket(l);if(nt){var Ft=nt.programConfigurations.get(l.id);a.useProgram("heatmap",Ft).draw(w,L.TRIANGLES,xe.disabled,F,ue,Bt.disabled,ef($e.posMatrix,rt,a.transform.zoom,l.paint.get("heatmap-intensity")),l.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,l.paint,a.transform.zoom,Ft)}}}w.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Nt,Kt){var jt=Nt.context,Gt=jt.gl,nr=Kt.heatmapFbo;if(nr){jt.activeTexture.set(Gt.TEXTURE0),Gt.bindTexture(Gt.TEXTURE_2D,nr.colorAttachment.get()),jt.activeTexture.set(Gt.TEXTURE1);var rr=Kt.colorRampTexture;rr||(rr=Kt.colorRampTexture=new i.Texture(jt,Kt.colorRamp,Gt.RGBA)),rr.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE),Nt.useProgram("heatmapTexture").draw(jt,Gt.TRIANGLES,xe.disabled,ut.disabled,Nt.colorModeForRenderPass(),Bt.disabled,function(Lr,vr,Sr,Ar){var rn=i.create();i.ortho(rn,0,Lr.width,Lr.height,0,0,1);var Xr=Lr.context.gl;return{u_matrix:rn,u_world:[Xr.drawingBufferWidth,Xr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:vr.paint.get("heatmap-opacity")}}(Nt,Kt),Kt.id,Nt.viewportBuffer,Nt.quadTriangleIndexBuffer,Nt.viewportSegments,Kt.paint,Nt.transform.zoom)}}(a,l))},line:function(a,n,l,g){if(a.renderPass==="translucent"){var w=l.paint.get("line-opacity"),L=l.paint.get("line-width");if(w.constantOr(1)!==0&&L.constantOr(1)!==0)for(var F=a.depthModeForSublayer(0,xe.ReadOnly),ue=a.colorModeForRenderPass(),Ee=l.paint.get("line-dasharray"),$e=l.paint.get("line-pattern"),rt=$e.constantOr(1),nt=l.paint.get("line-gradient"),Ft=l.getCrossfadeParameters(),Nt=rt?"linePattern":Ee?"lineSDF":nt?"lineGradient":"line",Kt=a.context,jt=Kt.gl,Gt=!0,nr=0,rr=g;nr<rr.length;nr+=1){var Lr=rr[nr],vr=n.getTile(Lr);if(!rt||vr.patternsLoaded()){var Sr=vr.getBucket(l);if(Sr){var Ar=Sr.programConfigurations.get(l.id),rn=a.context.program.get(),Xr=a.useProgram(Nt,Ar),mn=Gt||Xr.program!==rn,Ln=$e.constantOr(null);if(Ln&&vr.imageAtlas){var qn=vr.imageAtlas,sa=qn.patternPositions[Ln.to.toString()],Sa=qn.patternPositions[Ln.from.toString()];sa&&Sa&&Ar.setConstantPatternPositions(sa,Sa)}var Wa=rt?tf(a,vr,l,Ft):Ee?mf(a,vr,l,Ee,Ft):nt?Ti(a,vr,l,Sr.lineClipsArray.length):$l(a,vr,l);if(rt)Kt.activeTexture.set(jt.TEXTURE0),vr.imageAtlasTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Ar.updatePaintBuffers(Ft);else if(Ee&&(mn||a.lineAtlas.dirty))Kt.activeTexture.set(jt.TEXTURE0),a.lineAtlas.bind(Kt);else if(nt){var Sn=Sr.gradients[l.id],ua=Sn.texture;if(l.gradientVersion!==Sn.version){var ba=256;if(l.stepInterpolant){var Wn=n.getSource().maxzoom,Aa=Lr.canonical.z===Wn?Math.ceil(1<<a.transform.maxZoom-Lr.canonical.z):1;ba=i.clamp(i.nextPowerOfTwo(Sr.maxLineLength/i.EXTENT*1024*Aa),256,Kt.maxTextureSize)}Sn.gradient=i.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:ba,image:Sn.gradient||void 0,clips:Sr.lineClipsArray}),Sn.texture?Sn.texture.update(Sn.gradient):Sn.texture=new i.Texture(Kt,Sn.gradient,jt.RGBA),Sn.version=l.gradientVersion,ua=Sn.texture}Kt.activeTexture.set(jt.TEXTURE0),ua.bind(l.stepInterpolant?jt.NEAREST:jt.LINEAR,jt.CLAMP_TO_EDGE)}Xr.draw(Kt,jt.TRIANGLES,F,a.stencilModeForClipping(Lr),ue,Bt.disabled,Wa,l.id,Sr.layoutVertexBuffer,Sr.indexBuffer,Sr.segments,l.paint,a.transform.zoom,Ar,Sr.layoutVertexBuffer2),Gt=!1}}}}},fill:function(a,n,l,g){var w=l.paint.get("fill-color"),L=l.paint.get("fill-opacity");if(L.constantOr(1)!==0){var F=a.colorModeForRenderPass(),ue=l.paint.get("fill-pattern"),Ee=a.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&w.constantOr(i.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===Ee){var $e=a.depthModeForSublayer(1,a.renderPass==="opaque"?xe.ReadWrite:xe.ReadOnly);tl(a,n,l,g,$e,F,!1)}if(a.renderPass==="translucent"&&l.paint.get("fill-antialias")){var rt=a.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,xe.ReadOnly);tl(a,n,l,g,rt,F,!0)}}},"fill-extrusion":function(a,n,l,g){var w=l.paint.get("fill-extrusion-opacity");if(w!==0&&a.renderPass==="translucent"){var L=new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D);if(w!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Dl(a,n,l,g,L,ut.disabled,wt.disabled),Dl(a,n,l,g,L,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var F=a.colorModeForRenderPass();Dl(a,n,l,g,L,ut.disabled,F)}}},hillshade:function(a,n,l,g){if(a.renderPass==="offscreen"||a.renderPass==="translucent"){for(var w=a.context,L=a.depthModeForSublayer(0,xe.ReadOnly),F=a.colorModeForRenderPass(),ue=a.renderPass==="translucent"?a.stencilConfigForOverlap(g):[{},g],Ee=ue[0],$e=0,rt=ue[1];$e<rt.length;$e+=1){var nt=rt[$e],Ft=n.getTile(nt);Ft.needsHillshadePrepare&&a.renderPass==="offscreen"?xc(a,Ft,l,L,ut.disabled,F):a.renderPass==="translucent"&&bc(a,Ft,l,L,Ee[nt.overscaledZ],F)}w.viewport.set([0,0,a.width,a.height])}},raster:function(a,n,l,g){if(a.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&g.length)for(var w=a.context,L=w.gl,F=n.getSource(),ue=a.useProgram("raster"),Ee=a.colorModeForRenderPass(),$e=F instanceof be?[{},g]:a.stencilConfigForOverlap(g),rt=$e[0],nt=$e[1],Ft=nt[nt.length-1].overscaledZ,Nt=!a.options.moving,Kt=0,jt=nt;Kt<jt.length;Kt+=1){var Gt=jt[Kt],nr=a.depthModeForSublayer(Gt.overscaledZ-Ft,l.paint.get("raster-opacity")===1?xe.ReadWrite:xe.ReadOnly,L.LESS),rr=n.getTile(Gt),Lr=a.transform.calculatePosMatrix(Gt.toUnwrapped(),Nt);rr.registerFadeDuration(l.paint.get("raster-fade-duration"));var vr=n.findLoadedParent(Gt,0),Sr=rl(rr,vr,n,l,a.transform),Ar=void 0,rn=void 0,Xr=l.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;w.activeTexture.set(L.TEXTURE0),rr.texture.bind(Xr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(L.TEXTURE1),vr?(vr.texture.bind(Xr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),Ar=Math.pow(2,vr.tileID.overscaledZ-rr.tileID.overscaledZ),rn=[rr.tileID.canonical.x*Ar%1,rr.tileID.canonical.y*Ar%1]):rr.texture.bind(Xr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);var mn=Ql(Lr,rn||[0,0],Ar||1,Sr,l);F instanceof be?ue.draw(w,L.TRIANGLES,nr,ut.disabled,Ee,Bt.disabled,mn,l.id,F.boundsBuffer,a.quadTriangleIndexBuffer,F.boundsSegments):ue.draw(w,L.TRIANGLES,nr,rt[Gt.overscaledZ],Ee,Bt.disabled,mn,l.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,n,l){var g=l.paint.get("background-color"),w=l.paint.get("background-opacity");if(w!==0){var L=a.context,F=L.gl,ue=a.transform,Ee=ue.tileSize,$e=l.paint.get("background-pattern");if(!a.isPatternMissing($e)){var rt=!$e&&g.a===1&&w===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===rt){var nt=ut.disabled,Ft=a.depthModeForSublayer(0,rt==="opaque"?xe.ReadWrite:xe.ReadOnly),Nt=a.colorModeForRenderPass(),Kt=a.useProgram($e?"backgroundPattern":"background"),jt=ue.coveringTiles({tileSize:Ee});$e&&(L.activeTexture.set(F.TEXTURE0),a.imageManager.bind(a.context));for(var Gt=l.getCrossfadeParameters(),nr=0,rr=jt;nr<rr.length;nr+=1){var Lr=rr[nr],vr=a.transform.calculatePosMatrix(Lr.toUnwrapped()),Sr=$e?Il(vr,w,a,$e,{tileID:Lr,tileSize:Ee},Gt):Rl(vr,w,g);Kt.draw(L,F.TRIANGLES,Ft,nt,Nt,Bt.disabled,Sr,l.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,n,l){for(var g=0;g<l.length;g++)yf(a,n,l[g])},custom:function(a,n,l){var g=a.context,w=l.implementation;if(a.renderPass==="offscreen"){var L=w.prerender;L&&(a.setCustomLayerDefaults(),g.setColorMode(a.colorModeForRenderPass()),L.call(w,g.gl,a.transform.customLayerMatrix()),g.setDirty(),a.setBaseState())}else if(a.renderPass==="translucent"){a.setCustomLayerDefaults(),g.setColorMode(a.colorModeForRenderPass()),g.setStencilMode(ut.disabled);var F=w.renderingMode==="3d"?new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,xe.ReadOnly);g.setDepthMode(F),w.render(g.gl,a.transform.customLayerMatrix()),g.setDirty(),a.setBaseState(),g.bindFramebuffer.set(null)}}},wi=function(a,n){this.context=new Xe(a),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Lt.maxUnderzooming+Lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Eo,this.gpuTimers={}};wi.prototype.resize=function(s,a){if(this.width=s*i.browser.devicePixelRatio,this.height=a*i.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},wi.prototype.setup=function(){var s=this.context,a=new i.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(i.EXTENT,0),a.emplaceBack(0,i.EXTENT),a.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(a,Vi.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);var n=new i.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(i.EXTENT,0),n.emplaceBack(0,i.EXTENT),n.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=s.createVertexBuffer(n,Vi.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);var l=new i.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(i.EXTENT,0,i.EXTENT,0),l.emplaceBack(0,i.EXTENT,0,i.EXTENT),l.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,Se.members),this.rasterBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);var g=new i.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(g,Vi.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);var w=new i.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(w);var L=new i.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(L),this.emptyTexture=new i.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var F=this.context.gl;this.stencilClearMode=new ut({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO)},wi.prototype.clearStencil=function(){var s=this.context,a=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=i.create();i.ortho(n,0,this.width,this.height,0,0,1),i.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,a.TRIANGLES,xe.disabled,this.stencilClearMode,wt.disabled,Bt.disabled,Au(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},wi.prototype._renderTileClippingMasks=function(s,a){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&a&&a.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(wt.disabled),n.setDepthMode(xe.disabled);var g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,L=a;w<L.length;w+=1){var F=L[w],ue=this._tileClippingMaskIDs[F.key]=this.nextStencilID++;g.draw(n,l.TRIANGLES,xe.disabled,new ut({func:l.ALWAYS,mask:0},ue,255,l.KEEP,l.KEEP,l.REPLACE),wt.disabled,Bt.disabled,Au(F.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},wi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,a=this.context.gl;return new ut({func:a.NOTEQUAL,mask:255},s,255,a.KEEP,a.KEEP,a.REPLACE)},wi.prototype.stencilModeForClipping=function(s){var a=this.context.gl;return new ut({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,a.KEEP,a.KEEP,a.REPLACE)},wi.prototype.stencilConfigForOverlap=function(s){var a,n=this.context.gl,l=s.sort(function(ue,Ee){return Ee.overscaledZ-ue.overscaledZ}),g=l[l.length-1].overscaledZ,w=l[0].overscaledZ-g+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var L={},F=0;F<w;F++)L[F+g]=new ut({func:n.GEQUAL,mask:255},F+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=w,[L,l]}return[(a={},a[g]=ut.disabled,a),l]},wi.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new wt([s.CONSTANT_COLOR,s.ONE],new i.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?wt.unblended:wt.alphaBlended},wi.prototype.depthModeForSublayer=function(s,a,n){if(!this.opaquePassEnabledForLayer())return xe.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new xe(n||this.context.gl.LEQUAL,a,[l,l])},wi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},wi.prototype.render=function(s,a){var n=this;this.style=s,this.options=a,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.browser.now()),this.imageManager.beginFrame();var l=this.style._order,g=this.style.sourceCaches;for(var w in g){var L=g[w];L.used&&L.prepare(this.context)}var F,ue,Ee={},$e={},rt={};for(var nt in g){var Ft=g[nt];Ee[nt]=Ft.getVisibleCoordinates(),$e[nt]=Ee[nt].slice().reverse(),rt[nt]=Ft.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Nt=0;Nt<l.length;Nt++)if(this.style._layers[l[Nt]].is3D()){this.opaquePassCutoff=Nt;break}this.renderPass="offscreen";for(var Kt=0,jt=l;Kt<jt.length;Kt+=1){var Gt=this.style._layers[jt[Kt]];if(Gt.hasOffscreenPass()&&!Gt.isHidden(this.transform.zoom)){var nr=$e[Gt.source];(Gt.type==="custom"||nr.length)&&this.renderLayer(this,g[Gt.source],Gt,nr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var rr=this.style._layers[l[this.currentLayer]],Lr=g[rr.source],vr=Ee[rr.source];this._renderTileClippingMasks(rr,vr),this.renderLayer(this,Lr,rr,vr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var Sr=this.style._layers[l[this.currentLayer]],Ar=g[Sr.source],rn=(Sr.type==="symbol"?rt:$e)[Sr.source];this._renderTileClippingMasks(Sr,Ee[Sr.source]),this.renderLayer(this,Ar,Sr,rn)}this.options.showTileBoundaries&&(i.values(this.style._layers).forEach(function(Xr){Xr.source&&!Xr.isHidden(n.transform.zoom)&&(Xr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Xr.source]),(!F||F.getSource().maxzoom<ue.getSource().maxzoom)&&(F=ue))}),F&&al.debug(this,F,F.getVisibleCoordinates())),this.options.showPadding&&function(Xr){var mn=Xr.transform.padding;Fc(Xr,Xr.transform.height-(mn.top||0),3,rf),Fc(Xr,mn.bottom||0,3,nl),nf(Xr,mn.left||0,3,qs),nf(Xr,Xr.transform.width-(mn.right||0),3,_l);var Ln=Xr.transform.centerPoint;!function(qn,sa,Sa,Wa){Fs(qn,sa-1,Sa-10,2,20,Wa),Fs(qn,sa-10,Sa-1,20,2,Wa)}(Xr,Ln.x,Xr.transform.height-Ln.y,tc)}(this),this.context.setDefault()},wi.prototype.renderLayer=function(s,a,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),al[n.type](s,a,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},wi.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},wi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},wi.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},wi.prototype.queryGpuTimers=function(s){var a={};for(var n in s){var l=s[n],g=this.context.extTimerQuery,w=g.getQueryObjectEXT(l.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(l.query),a[n]=w}return a},wi.prototype.translatePosMatrix=function(s,a,n,l,g){if(!n[0]&&!n[1])return s;var w=g?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(w){var L=Math.sin(w),F=Math.cos(w);n=[n[0]*F-n[1]*L,n[0]*L+n[1]*F]}var ue=[g?n[0]:Ha(a,n[0],this.transform.zoom),g?n[1]:Ha(a,n[1],this.transform.zoom),0],Ee=new Float32Array(16);return i.translate(Ee,s,ue),Ee},wi.prototype.saveTileTexture=function(s){var a=this._tileTextures[s.size[0]];a?a.push(s):this._tileTextures[s.size[0]]=[s]},wi.prototype.getTileTexture=function(s){var a=this._tileTextures[s];return a&&a.length>0?a.pop():null},wi.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var a=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!a||!n},wi.prototype.useProgram=function(s,a){this.cache=this.cache||{};var n=""+s+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new yl(this.context,s,Ic[s],a,jc[s],this._showOverdrawInspector)),this.cache[n]},wi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},wi.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},wi.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=i.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},wi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var il=function(a,n){this.points=a,this.planes=n};il.fromInvProjectionMatrix=function(s,a,n){var l=Math.pow(2,n),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return i.transformMat4([],L,s)}).map(function(L){return i.scale$1([],L,1/L[3]/a*l)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var F=i.sub([],g[L[0]],g[L[1]]),ue=i.sub([],g[L[2]],g[L[1]]),Ee=i.normalize([],i.cross([],F,ue)),$e=-i.dot(Ee,g[L[1]]);return Ee.concat($e)});return new il(g,w)};var Vu=function(a,n){this.min=a,this.max=n,this.center=i.scale$2([],i.add([],this.min,this.max),.5)};Vu.prototype.quadrant=function(s){for(var a=[s%2==0,s<2],n=i.clone$2(this.min),l=i.clone$2(this.max),g=0;g<a.length;g++)n[g]=a[g]?this.min[g]:this.center[g],l[g]=a[g]?this.center[g]:this.max[g];return l[2]=this.max[2],new Vu(n,l)},Vu.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},Vu.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},Vu.prototype.intersects=function(s){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var g=s.planes[l],w=0,L=0;L<a.length;L++)w+=i.dot$1(g,a[L])>=0;if(w===0)return 0;w!==a.length&&(n=!1)}if(n)return 2;for(var F=0;F<3;F++){for(var ue=Number.MAX_VALUE,Ee=-Number.MAX_VALUE,$e=0;$e<s.points.length;$e++){var rt=s.points[$e][F]-this.min[F];ue=Math.min(ue,rt),Ee=Math.max(Ee,rt)}if(Ee<0||ue>this.max[F]-this.min[F])return 0}return 1};var ui=function(a,n,l,g){if(a===void 0&&(a=0),n===void 0&&(n=0),l===void 0&&(l=0),g===void 0&&(g=0),isNaN(a)||a<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=l,this.right=g};ui.prototype.interpolate=function(s,a,n){return a.top!=null&&s.top!=null&&(this.top=i.number(s.top,a.top,n)),a.bottom!=null&&s.bottom!=null&&(this.bottom=i.number(s.bottom,a.bottom,n)),a.left!=null&&s.left!=null&&(this.left=i.number(s.left,a.left,n)),a.right!=null&&s.right!=null&&(this.right=i.number(s.right,a.right,n)),this},ui.prototype.getCenter=function(s,a){var n=i.clamp((this.left+s-this.right)/2,0,s),l=i.clamp((this.top+a-this.bottom)/2,0,a);return new i.Point(n,l)},ui.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},ui.prototype.clone=function(){return new ui(this.top,this.bottom,this.left,this.right)},ui.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var kn=function(a,n,l,g,w){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=w===void 0||w,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ui,this._posMatrixCache={},this._alignedPosMatrixCache={}},Oi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};kn.prototype.clone=function(){var s=new kn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},Oi.minZoom.get=function(){return this._minZoom},Oi.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},Oi.maxZoom.get=function(){return this._maxZoom},Oi.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},Oi.minPitch.get=function(){return this._minPitch},Oi.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},Oi.maxPitch.get=function(){return this._maxPitch},Oi.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},Oi.renderWorldCopies.get=function(){return this._renderWorldCopies},Oi.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},Oi.worldSize.get=function(){return this.tileSize*this.scale},Oi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Oi.size.get=function(){return new i.Point(this.width,this.height)},Oi.bearing.get=function(){return-this.angle/Math.PI*180},Oi.bearing.set=function(s){var a=-i.wrap(s,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=i.create$2(),i.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Oi.pitch.get=function(){return this._pitch/Math.PI*180},Oi.pitch.set=function(s){var a=i.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Oi.fov.get=function(){return this._fov/Math.PI*180},Oi.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},Oi.zoom.get=function(){return this._zoom},Oi.zoom.set=function(s){var a=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Oi.center.get=function(){return this._center},Oi.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},Oi.padding.get=function(){return this._edgeInsets.toJSON()},Oi.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},Oi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},kn.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},kn.prototype.interpolatePadding=function(s,a,n){this._unmodified=!1,this._edgeInsets.interpolate(s,a,n),this._constrain(),this._calcMatrices()},kn.prototype.coveringZoomLevel=function(s){var a=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,a)},kn.prototype.getVisibleUnwrappedCoordinates=function(s){var a=[new i.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new i.Point(0,0)),l=this.pointCoordinate(new i.Point(this.width,0)),g=this.pointCoordinate(new i.Point(this.width,this.height)),w=this.pointCoordinate(new i.Point(0,this.height)),L=Math.floor(Math.min(n.x,l.x,g.x,w.x)),F=Math.floor(Math.max(n.x,l.x,g.x,w.x)),ue=L-1;ue<=F+1;ue++)ue!==0&&a.push(new i.UnwrappedTileID(ue,s));return a},kn.prototype.coveringTiles=function(s){var a=this.coveringZoomLevel(s),n=a;if(s.minzoom!==void 0&&a<s.minzoom)return[];s.maxzoom!==void 0&&a>s.maxzoom&&(a=s.maxzoom);var l=i.MercatorCoordinate.fromLngLat(this.center),g=Math.pow(2,a),w=[g*l.x,g*l.y,0],L=il.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),F=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(F=a);var ue=function(mn){return{aabb:new Vu([mn*g,0,0],[(mn+1)*g,g,0]),zoom:0,x:0,y:0,wrap:mn,fullyVisible:!1}},Ee=[],$e=[],rt=a,nt=s.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var Ft=1;Ft<=3;Ft++)Ee.push(ue(-Ft)),Ee.push(ue(Ft));for(Ee.push(ue(0));Ee.length>0;){var Nt=Ee.pop(),Kt=Nt.x,jt=Nt.y,Gt=Nt.fullyVisible;if(!Gt){var nr=Nt.aabb.intersects(L);if(nr===0)continue;Gt=nr===2}var rr=Nt.aabb.distanceX(w),Lr=Nt.aabb.distanceY(w),vr=Math.max(Math.abs(rr),Math.abs(Lr));if(Nt.zoom===rt||vr>3+(1<<rt-Nt.zoom)-2&&Nt.zoom>=F)$e.push({tileID:new i.OverscaledTileID(Nt.zoom===rt?nt:Nt.zoom,Nt.wrap,Nt.zoom,Kt,jt),distanceSq:i.sqrLen([w[0]-.5-Kt,w[1]-.5-jt])});else for(var Sr=0;Sr<4;Sr++){var Ar=(Kt<<1)+Sr%2,rn=(jt<<1)+(Sr>>1);Ee.push({aabb:Nt.aabb.quadrant(Sr),zoom:Nt.zoom+1,x:Ar,y:rn,wrap:Nt.wrap,fullyVisible:Gt})}}return $e.sort(function(Xr,mn){return Xr.distanceSq-mn.distanceSq}).map(function(Xr){return Xr.tileID})},kn.prototype.resize=function(s,a){this.width=s,this.height=a,this.pixelsToGLUnits=[2/s,-2/a],this._constrain(),this._calcMatrices()},Oi.unmodified.get=function(){return this._unmodified},kn.prototype.zoomScale=function(s){return Math.pow(2,s)},kn.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},kn.prototype.project=function(s){var a=i.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new i.Point(i.mercatorXfromLng(s.lng)*this.worldSize,i.mercatorYfromLat(a)*this.worldSize)},kn.prototype.unproject=function(s){return new i.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},Oi.point.get=function(){return this.project(this.center)},kn.prototype.setLocationAtPoint=function(s,a){var n=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(s),w=new i.MercatorCoordinate(g.x-(n.x-l.x),g.y-(n.y-l.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},kn.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},kn.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},kn.prototype.locationCoordinate=function(s){return i.MercatorCoordinate.fromLngLat(s)},kn.prototype.coordinateLocation=function(s){return s.toLngLat()},kn.prototype.pointCoordinate=function(s){var a=[s.x,s.y,0,1],n=[s.x,s.y,1,1];i.transformMat4(a,a,this.pixelMatrixInverse),i.transformMat4(n,n,this.pixelMatrixInverse);var l=a[3],g=n[3],w=a[1]/l,L=n[1]/g,F=a[2]/l,ue=n[2]/g,Ee=F===ue?0:(0-F)/(ue-F);return new i.MercatorCoordinate(i.number(a[0]/l,n[0]/g,Ee)/this.worldSize,i.number(w,L,Ee)/this.worldSize)},kn.prototype.coordinatePoint=function(s){var a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix),new i.Point(a[0]/a[3],a[1]/a[3])},kn.prototype.getBounds=function(){return new i.LngLatBounds().extend(this.pointLocation(new i.Point(0,0))).extend(this.pointLocation(new i.Point(this.width,0))).extend(this.pointLocation(new i.Point(this.width,this.height))).extend(this.pointLocation(new i.Point(0,this.height)))},kn.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new i.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},kn.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},kn.prototype.calculatePosMatrix=function(s,a){a===void 0&&(a=!1);var n=s.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var g=s.canonical,w=this.worldSize/this.zoomScale(g.z),L=g.x+Math.pow(2,g.z)*s.wrap,F=i.identity(new Float64Array(16));return i.translate(F,F,[L*w,g.y*w,0]),i.scale(F,F,[w/i.EXTENT,w/i.EXTENT,1]),i.multiply(F,a?this.alignedProjMatrix:this.projMatrix,F),l[n]=new Float32Array(F),l[n]},kn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},kn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,a,n,l,g=-90,w=90,L=-180,F=180,ue=this.size,Ee=this._unmodified;if(this.latRange){var $e=this.latRange;g=i.mercatorYfromLat($e[1])*this.worldSize,s=(w=i.mercatorYfromLat($e[0])*this.worldSize)-g<ue.y?ue.y/(w-g):0}if(this.lngRange){var rt=this.lngRange;L=i.mercatorXfromLng(rt[0])*this.worldSize,a=(F=i.mercatorXfromLng(rt[1])*this.worldSize)-L<ue.x?ue.x/(F-L):0}var nt=this.point,Ft=Math.max(a||0,s||0);if(Ft)return this.center=this.unproject(new i.Point(a?(F+L)/2:nt.x,s?(w+g)/2:nt.y)),this.zoom+=this.scaleZoom(Ft),this._unmodified=Ee,void(this._constraining=!1);if(this.latRange){var Nt=nt.y,Kt=ue.y/2;Nt-Kt<g&&(l=g+Kt),Nt+Kt>w&&(l=w-Kt)}if(this.lngRange){var jt=nt.x,Gt=ue.x/2;jt-Gt<L&&(n=L+Gt),jt+Gt>F&&(n=F-Gt)}n===void 0&&l===void 0||(this.center=this.unproject(new i.Point(n!==void 0?n:nt.x,l!==void 0?l:nt.y))),this._unmodified=Ee,this._constraining=!1}},kn.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(i.clamp(Math.PI-a-n,.01,Math.PI-.01)),g=this.point,w=g.x,L=g.y,F=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),ue=this.height/50,Ee=new Float64Array(16);i.perspective(Ee,this._fov,this.width/this.height,ue,F),Ee[8]=2*-s.x/this.width,Ee[9]=2*s.y/this.height,i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[0,0,-this.cameraToCenterDistance]),i.rotateX(Ee,Ee,this._pitch),i.rotateZ(Ee,Ee,this.angle),i.translate(Ee,Ee,[-w,-L,0]),this.mercatorMatrix=i.scale([],Ee,[this.worldSize,this.worldSize,this.worldSize]),i.scale(Ee,Ee,[1,1,i.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ee,this.invProjMatrix=i.invert([],this.projMatrix);var $e=this.width%2/2,rt=this.height%2/2,nt=Math.cos(this.angle),Ft=Math.sin(this.angle),Nt=w-Math.round(w)+nt*$e+Ft*rt,Kt=L-Math.round(L)+nt*rt+Ft*$e,jt=new Float64Array(Ee);if(i.translate(jt,jt,[Nt>.5?Nt-1:Nt,Kt>.5?Kt-1:Kt,0]),this.alignedProjMatrix=jt,Ee=i.create(),i.scale(Ee,Ee,[this.width/2,-this.height/2,1]),i.translate(Ee,Ee,[1,-1,0]),this.labelPlaneMatrix=Ee,Ee=i.create(),i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[-1,-1,0]),i.scale(Ee,Ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ee,this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ee=i.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ee,this._posMatrixCache={},this._alignedPosMatrixCache={}}},kn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new i.Point(0,0)),a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},kn.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.Point(0,s))},kn.prototype.getCameraQueryGeometry=function(s){var a=this.getCameraPoint();if(s.length===1)return[s[0],a];for(var n=a.x,l=a.y,g=a.x,w=a.y,L=0,F=s;L<F.length;L+=1){var ue=F[L];n=Math.min(n,ue.x),l=Math.min(l,ue.y),g=Math.max(g,ue.x),w=Math.max(w,ue.y)}return[new i.Point(n,l),new i.Point(g,l),new i.Point(g,w),new i.Point(n,w),new i.Point(n,l)]},Object.defineProperties(kn.prototype,Oi);var ws=function(a){var n,l,g,w;this._hashName=a&&encodeURIComponent(a),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,g=null,w=function(){g=null,l&&(n(),g=setTimeout(w,300),l=!1)},function(){return l=!0,g||w(),g})};ws.prototype.addTo=function(s){return this._map=s,i.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ws.prototype.remove=function(){return i.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ws.prototype.getHashString=function(s){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,l),w=Math.round(a.lng*g)/g,L=Math.round(a.lat*g)/g,F=this._map.getBearing(),ue=this._map.getPitch(),Ee="";if(Ee+=s?"/"+w+"/"+L+"/"+n:n+"/"+L+"/"+w,(F||ue)&&(Ee+="/"+Math.round(10*F)/10),ue&&(Ee+="/"+Math.round(ue)),this._hashName){var $e=this._hashName,rt=!1,nt=i.window.location.hash.slice(1).split("&").map(function(Ft){var Nt=Ft.split("=")[0];return Nt===$e?(rt=!0,Nt+"="+Ee):Ft}).filter(function(Ft){return Ft});return rt||nt.push($e+"="+Ee),"#"+nt.join("&")}return"#"+Ee},ws.prototype._getCurrentHash=function(){var s,a=this,n=i.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},ws.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:a,pitch:+(s[4]||0)}),!0}return!1},ws.prototype._updateHashUnthrottled=function(){var s=i.window.location.href.replace(/(#.+)?$/,this.getHashString());try{i.window.history.replaceState(i.window.history.state,null,s)}catch(a){}};var Nl={linearity:.3,easing:i.bezier(0,0,.3,1)},Gu=i.extend({deceleration:2500,maxSpeed:1400},Nl),ol=i.extend({deceleration:20,maxSpeed:1400},Nl),bf=i.extend({deceleration:1e3,maxSpeed:360},Nl),is=i.extend({deceleration:1e3,maxSpeed:90},Nl),Sl=function(a){this._map=a,this.clear()};function sl(s,a){(!s.duration||s.duration<a.duration)&&(s.duration=a.duration,s.easing=a.easing)}function ul(s,a,n){var l=n.maxSpeed,g=n.linearity,w=n.deceleration,L=i.clamp(s*g/(a/1e3),-l,l),F=Math.abs(L)/(w*g);return{easing:n.easing,duration:1e3*F,amount:L*(F/2)}}Sl.prototype.clear=function(){this._inertiaBuffer=[]},Sl.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.browser.now(),settings:s})},Sl.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,a=i.browser.now();s.length>0&&a-s[0].time>160;)s.shift()},Sl.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new i.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var g=l[n].settings;a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(a.pan.mag()){var F=ul(a.pan.mag(),w,i.extend({},Gu,s||{}));L.offset=a.pan.mult(F.amount/a.pan.mag()),L.center=this._map.transform.center,sl(L,F)}if(a.zoom){var ue=ul(a.zoom,w,ol);L.zoom=this._map.transform.zoom+ue.amount,sl(L,ue)}if(a.bearing){var Ee=ul(a.bearing,w,bf);L.bearing=this._map.transform.bearing+i.clamp(Ee.amount,-179,179),sl(L,Ee)}if(a.pitch){var $e=ul(a.pitch,w,is);L.pitch=this._map.transform.pitch+$e.amount,sl(L,$e)}if(L.zoom||L.bearing){var rt=a.pinchAround===void 0?a.around:a.pinchAround;L.around=rt?this._map.unproject(rt):this._map.getCenter()}return this.clear(),i.extend(L,{noMoveStart:!0})}};var zi=function(s){function a(l,g,w,L){L===void 0&&(L={});var F=D.mousePos(g.getCanvasContainer(),w),ue=g.unproject(F);s.call(this,l,i.extend({point:F,lngLat:ue,originalEvent:w},L)),this._defaultPrevented=!1,this.target=g}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),Ts=function(s){function a(l,g,w){var L=l==="touchend"?w.changedTouches:w.touches,F=D.touchPos(g.getCanvasContainer(),L),ue=F.map(function(rt){return g.unproject(rt)}),Ee=F.reduce(function(rt,nt,Ft,Nt){return rt.add(nt.div(Nt.length))},new i.Point(0,0)),$e=g.unproject(Ee);s.call(this,l,{points:F,point:Ee,lngLats:ue,lngLat:$e,originalEvent:w}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),kl=function(s){function a(l,g,w){s.call(this,l,{originalEvent:w}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),to=function(a,n){this._map=a,this._clickTolerance=n.clickTolerance};to.prototype.reset=function(){delete this._mousedownPos},to.prototype.wheel=function(s){return this._firePreventable(new kl(s.type,this._map,s))},to.prototype.mousedown=function(s,a){return this._mousedownPos=a,this._firePreventable(new zi(s.type,this._map,s))},to.prototype.mouseup=function(s){this._map.fire(new zi(s.type,this._map,s))},to.prototype.click=function(s,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new zi(s.type,this._map,s))},to.prototype.dblclick=function(s){return this._firePreventable(new zi(s.type,this._map,s))},to.prototype.mouseover=function(s){this._map.fire(new zi(s.type,this._map,s))},to.prototype.mouseout=function(s){this._map.fire(new zi(s.type,this._map,s))},to.prototype.touchstart=function(s){return this._firePreventable(new Ts(s.type,this._map,s))},to.prototype.touchmove=function(s){this._map.fire(new Ts(s.type,this._map,s))},to.prototype.touchend=function(s){this._map.fire(new Ts(s.type,this._map,s))},to.prototype.touchcancel=function(s){this._map.fire(new Ts(s.type,this._map,s))},to.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},to.prototype.isEnabled=function(){return!0},to.prototype.isActive=function(){return!1},to.prototype.enable=function(){},to.prototype.disable=function(){};var In=function(a){this._map=a};In.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},In.prototype.mousemove=function(s){this._map.fire(new zi(s.type,this._map,s))},In.prototype.mousedown=function(){this._delayContextMenu=!0},In.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},In.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new zi(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},In.prototype.isEnabled=function(){return!0},In.prototype.isActive=function(){return!1},In.prototype.enable=function(){},In.prototype.disable=function(){};var zs=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1};function ti(s,a){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=a[l];return n}zs.prototype.isEnabled=function(){return!!this._enabled},zs.prototype.isActive=function(){return!!this._active},zs.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},zs.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},zs.prototype.mousedown=function(s,a){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},zs.prototype.mousemoveWindow=function(s,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var g=Math.min(l.x,n.x),w=Math.max(l.x,n.x),L=Math.min(l.y,n.y),F=Math.max(l.y,n.y);D.setTransform(this._box,"translate("+g+"px,"+L+"px)"),this._box.style.width=w-g+"px",this._box.style.height=F-L+"px"}}},zs.prototype.mouseupWindow=function(s,a){var n=this;if(this._active&&s.button===0){var l=this._startPos,g=a;if(this.reset(),D.suppressClick(),l.x!==g.x||l.y!==g.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(L){return L.fitScreenCoordinates(l,g,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},zs.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},zs.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},zs.prototype._fireEvent=function(s,a){return this._map.fire(new i.Event(s,{originalEvent:a}))};var jl=function(a){this.reset(),this.numTouches=a.numTouches};jl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},jl.prototype.touchstart=function(s,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var g=new i.Point(0,0),w=0,L=l;w<L.length;w+=1)g._add(L[w]);return g.div(l.length)}(a),this.touches=ti(n,a)))},jl.prototype.touchmove=function(s,a,n){if(!this.aborted&&this.centroid){var l=ti(n,a);for(var g in this.touches){var w=l[g];(!w||w.dist(this.touches[g])>30)&&(this.aborted=!0)}}},jl.prototype.touchend=function(s,a,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var du=function(a){this.singleTap=new jl(a),this.numTaps=a.numTaps,this.reset()};du.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},du.prototype.touchstart=function(s,a,n){this.singleTap.touchstart(s,a,n)},du.prototype.touchmove=function(s,a,n){this.singleTap.touchmove(s,a,n)},du.prototype.touchend=function(s,a,n){var l=this.singleTap.touchend(s,a,n);if(l){var g=s.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(l)<30;if(g&&w||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Us=function(){this._zoomIn=new du({numTouches:1,numTaps:2}),this._zoomOut=new du({numTouches:2,numTaps:1}),this.reset()};Us.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Us.prototype.touchstart=function(s,a,n){this._zoomIn.touchstart(s,a,n),this._zoomOut.touchstart(s,a,n)},Us.prototype.touchmove=function(s,a,n){this._zoomIn.touchmove(s,a,n),this._zoomOut.touchmove(s,a,n)},Us.prototype.touchend=function(s,a,n){var l=this,g=this._zoomIn.touchend(s,a,n),w=this._zoomOut.touchend(s,a,n);return g?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(F){return F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(g)},{originalEvent:s})}}):w?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(F){return F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(w)},{originalEvent:s})}}):void 0},Us.prototype.touchcancel=function(){this.reset()},Us.prototype.enable=function(){this._enabled=!0},Us.prototype.disable=function(){this._enabled=!1,this.reset()},Us.prototype.isEnabled=function(){return this._enabled},Us.prototype.isActive=function(){return this._active};var ll={0:1,2:2},qr=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};qr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},qr.prototype._correctButton=function(s,a){return!1},qr.prototype._move=function(s,a){return{}},qr.prototype.mousedown=function(s,a){if(!this._lastPoint){var n=D.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=a,this._eventButton=n)}},qr.prototype.mousemoveWindow=function(s,a){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,g){var w=ll[g];return l.buttons===void 0||(l.buttons&w)!==w}(s,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},qr.prototype.mouseupWindow=function(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},qr.prototype.enable=function(){this._enabled=!0},qr.prototype.disable=function(){this._enabled=!1,this.reset()},qr.prototype.isEnabled=function(){return this._enabled},qr.prototype.isActive=function(){return this._active};var Ec=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},a.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},a}(qr),os=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var g=.8*(l.x-n.x);if(g)return this._active=!0,{bearingDelta:g}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(qr),ro=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var g=-.5*(l.y-n.y);if(g)return this._active=!0,{pitchDelta:g}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(qr),Jo=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};Jo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new i.Point(0,0)},Jo.prototype.touchstart=function(s,a,n){return this._calculateTransform(s,a,n)},Jo.prototype.touchmove=function(s,a,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,a,n)},Jo.prototype.touchend=function(s,a,n){this._calculateTransform(s,a,n),this._active&&n.length<this._minTouches&&this.reset()},Jo.prototype.touchcancel=function(){this.reset()},Jo.prototype._calculateTransform=function(s,a,n){n.length>0&&(this._active=!0);var l=ti(n,a),g=new i.Point(0,0),w=new i.Point(0,0),L=0;for(var F in l){var ue=l[F],Ee=this._touches[F];Ee&&(g._add(ue),w._add(ue.sub(Ee)),L++,l[F]=ue)}if(this._touches=l,!(L<this._minTouches)&&w.mag()){var $e=w.div(L);if(this._sum._add($e),!(this._sum.mag()<this._clickTolerance))return{around:g.div(L),panDelta:$e}}},Jo.prototype.enable=function(){this._enabled=!0},Jo.prototype.disable=function(){this._enabled=!1,this.reset()},Jo.prototype.isEnabled=function(){return this._enabled},Jo.prototype.isActive=function(){return this._active};var Os=function(){this.reset()};function Fl(s,a,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return a[l]}function zc(s,a){return Math.log(s/a)/Math.LN2}Os.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Os.prototype._start=function(s){},Os.prototype._move=function(s,a,n){return{}},Os.prototype.touchstart=function(s,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},Os.prototype.touchmove=function(s,a,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,g=l[1],w=Fl(n,a,l[0]),L=Fl(n,a,g);if(w&&L){var F=this._aroundCenter?null:w.add(L).div(2);return this._move([w,L],F,s)}}},Os.prototype.touchend=function(s,a,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,g=l[1],w=Fl(n,a,l[0]),L=Fl(n,a,g);w&&L||(this._active&&D.suppressClick(),this.reset())}},Os.prototype.touchcancel=function(){this.reset()},Os.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Os.prototype.disable=function(){this._enabled=!1,this.reset()},Os.prototype.isEnabled=function(){return this._enabled},Os.prototype.isActive=function(){return this._active};var Bs=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,l){var g=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(zc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zc(this._distance,g),pinchAround:l}},a}(Os);function Cu(s,a){return 180*s.angleWith(a)/Math.PI}var zl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,l){var g=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Cu(this._vector,g),pinchAround:l}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,g=Cu(n,this._startVector);return Math.abs(g)<l},a}(Os);function Ul(s){return Math.abs(s.y)>Math.abs(s.x)}var af=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,Ul(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,l,g){var w=n[0].sub(this._lastPoints[0]),L=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,L,g.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(w.y+L.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,l,g){if(this._valid!==void 0)return this._valid;var w=n.mag()>=2,L=l.mag()>=2;if(w||L){if(!w||!L)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;var F=n.y>0==l.y>0;return Ul(n)&&Ul(l)&&F}},a}(Os),Uc={panStep:100,bearingStep:15,pitchStep:10},Lo=function(){var a=Uc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function ss(s){return s*(2-s)}Lo.prototype.reset=function(){this._active=!1},Lo.prototype.keydown=function(s){var a=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,g=0,w=0,L=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),w=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),w=1);break;case 38:s.shiftKey?g=1:(s.preventDefault(),L=-1);break;case 40:s.shiftKey?g=-1:(s.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(l=0,g=0),{cameraAnimation:function(ue){var Ee=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:ss,zoom:n?Math.round(Ee)+n*(s.shiftKey?2:1):Ee,bearing:ue.getBearing()+l*a._bearingStep,pitch:ue.getPitch()+g*a._pitchStep,offset:[-w*a._panStep,-L*a._panStep],center:ue.getCenter()},{originalEvent:s})}}}},Lo.prototype.enable=function(){this._enabled=!0},Lo.prototype.disable=function(){this._enabled=!1,this.reset()},Lo.prototype.isEnabled=function(){return this._enabled},Lo.prototype.isActive=function(){return this._active},Lo.prototype.disableRotation=function(){this._rotationDisabled=!0},Lo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Pa=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,i.bindAll(["_onTimeout"],this)};Pa.prototype.setZoomRate=function(s){this._defaultZoomRate=s},Pa.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},Pa.prototype.isEnabled=function(){return!!this._enabled},Pa.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Pa.prototype.isZooming=function(){return!!this._zooming},Pa.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},Pa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pa.prototype.wheel=function(s){if(this.isEnabled()){var a=s.deltaMode===i.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=i.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),s.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=s,this._delta-=a,this._active||this._start(s)),s.preventDefault()}},Pa.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},Pa.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=D.mousePos(this._el,s);this._around=i.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Pa.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var g=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(g*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,L=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,F=this._startZoom,ue=this._easing,Ee=!1;if(this._type==="wheel"&&F&&ue){var $e=Math.min((i.browser.now()-this._lastWheelEventTime)/200,1),rt=ue($e);w=i.number(F,L,rt),$e<1?this._frameId||(this._frameId=!0):Ee=!0}else w=L,Ee=!0;return this._active=!0,Ee&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ee,zoomDelta:w-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Pa.prototype._smoothOutEasing=function(s){var a=i.ease;if(this._prevEase){var n=this._prevEase,l=(i.browser.now()-n.start)/n.duration,g=n.easing(l+.01)-n.easing(l),w=.27/Math.sqrt(g*g+1e-4)*.01,L=Math.sqrt(.0729-w*w);a=i.bezier(w,L,.25,1)}return this._prevEase={start:i.browser.now(),duration:s,easing:a},a},Pa.prototype.reset=function(){this._active=!1};var eu=function(a,n){this._clickZoom=a,this._tapZoom=n};eu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},eu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},eu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},eu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ro=function(){this.reset()};Ro.prototype.reset=function(){this._active=!1},Ro.prototype.dblclick=function(s,a){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(a)},{originalEvent:s})}}},Ro.prototype.enable=function(){this._enabled=!0},Ro.prototype.disable=function(){this._enabled=!1,this.reset()},Ro.prototype.isEnabled=function(){return this._enabled},Ro.prototype.isActive=function(){return this._active};var To=function(){this._tap=new du({numTouches:1,numTaps:1}),this.reset()};To.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},To.prototype.touchstart=function(s,a,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,a,n))},To.prototype.touchmove=function(s,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=a[0],g=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(s,a,n)},To.prototype.touchend=function(s,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,a,n)&&(this._tapTime=s.timeStamp)},To.prototype.touchcancel=function(){this.reset()},To.prototype.enable=function(){this._enabled=!0},To.prototype.disable=function(){this._enabled=!1,this.reset()},To.prototype.isEnabled=function(){return this._enabled},To.prototype.isActive=function(){return this._active};var Al=function(a,n,l){this._el=a,this._mousePan=n,this._touchPan=l};Al.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Al.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Al.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Al.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var cl=function(a,n,l){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};cl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},cl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},cl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},cl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var pu=function(a,n,l,g){this._el=a,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};pu.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},pu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},pu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},pu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},pu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},pu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var _s=function(a){return a.zoom||a.drag||a.pitch||a.rotate},Tc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a}(i.Event);function Jn(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var jn=function(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sl(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),i.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[i.window.document,"mousemove",{capture:!0}],[i.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[i.window,"blur",void 0]];for(var g=0,w=this._listeners;g<w.length;g+=1){var L=w[g],F=L[0];D.addEventListener(F,L[1],F===i.window.document?this.handleWindowEvent:this.handleEvent,L[2])}};jn.prototype.destroy=function(){for(var s=0,a=this._listeners;s<a.length;s+=1){var n=a[s],l=n[0];D.removeEventListener(l,n[1],l===i.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},jn.prototype._addDefaultHandlers=function(s){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new to(a,s));var l=a.boxZoom=new zs(a,s);this._add("boxZoom",l);var g=new Us,w=new Ro;a.doubleClickZoom=new eu(w,g),this._add("tapZoom",g),this._add("clickZoom",w);var L=new To;this._add("tapDragZoom",L);var F=a.touchPitch=new af;this._add("touchPitch",F);var ue=new os(s),Ee=new ro(s);a.dragRotate=new cl(s,ue,Ee),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Ee,["mouseRotate"]);var $e=new Ec(s),rt=new Jo(s);a.dragPan=new Al(n,$e,rt),this._add("mousePan",$e),this._add("touchPan",rt,["touchZoom","touchRotate"]);var nt=new zl,Ft=new Bs;a.touchZoomRotate=new pu(n,Ft,nt,L),this._add("touchRotate",nt,["touchPan","touchZoom"]),this._add("touchZoom",Ft,["touchPan","touchRotate"]);var Nt=a.scrollZoom=new Pa(a,this);this._add("scrollZoom",Nt,["mousePan"]);var Kt=a.keyboard=new Lo;this._add("keyboard",Kt),this._add("blockableMapEvent",new In(a));for(var jt=0,Gt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];jt<Gt.length;jt+=1){var nr=Gt[jt];s.interactive&&s[nr]&&a[nr].enable(s[nr])}},jn.prototype._add=function(s,a,n){this._handlers.push({handlerName:s,handler:a,allowed:n}),this._handlersById[s]=a},jn.prototype.stop=function(s){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},jn.prototype.isActive=function(){for(var s=0,a=this._handlers;s<a.length;s+=1)if(a[s].handler.isActive())return!0;return!1},jn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},jn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},jn.prototype.isMoving=function(){return Boolean(_s(this._eventsInProgress))||this.isZooming()},jn.prototype._blockedByActive=function(s,a,n){for(var l in s)if(l!==n&&(!a||a.indexOf(l)<0))return!0;return!1},jn.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},jn.prototype._getMapTouches=function(s){for(var a=[],n=0,l=s;n<l.length;n+=1){var g=l[n];this._el.contains(g.target)&&a.push(g)}return a},jn.prototype.handleEvent=function(s,a){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},g={},w={},L=s.touches?this._getMapTouches(s.touches):void 0,F=L?D.touchPos(this._el,L):D.mousePos(this._el,s),ue=0,Ee=this._handlers;ue<Ee.length;ue+=1){var $e=Ee[ue],rt=$e.handlerName,nt=$e.handler,Ft=$e.allowed;if(nt.isEnabled()){var Nt=void 0;this._blockedByActive(w,Ft,rt)?nt.reset():nt[a||s.type]&&(Nt=nt[a||s.type](s,F,L),this.mergeHandlerResult(l,g,Nt,rt,n),Nt&&Nt.needsRenderFrame&&this._triggerRenderFrame()),(Nt||nt.isActive())&&(w[rt]=nt)}}var Kt={};for(var jt in this._previousActiveHandlers)w[jt]||(Kt[jt]=n);this._previousActiveHandlers=w,(Object.keys(Kt).length||Jn(l))&&(this._changes.push([l,g,Kt]),this._triggerRenderFrame()),(Object.keys(w).length||Jn(l))&&this._map._stop(!0),this._updatingCamera=!1;var Gt=l.cameraAnimation;Gt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Gt(this._map))}else this.stop(!0)},jn.prototype.mergeHandlerResult=function(s,a,n,l,g){if(n){i.extend(s,n);var w={handlerName:l,originalEvent:n.originalEvent||g};n.zoomDelta!==void 0&&(a.zoom=w),n.panDelta!==void 0&&(a.drag=w),n.pitchDelta!==void 0&&(a.pitch=w),n.bearingDelta!==void 0&&(a.rotate=w)}},jn.prototype._applyChanges=function(){for(var s={},a={},n={},l=0,g=this._changes;l<g.length;l+=1){var w=g[l],L=w[0],F=w[1],ue=w[2];L.panDelta&&(s.panDelta=(s.panDelta||new i.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+L.pitchDelta),L.around!==void 0&&(s.around=L.around),L.pinchAround!==void 0&&(s.pinchAround=L.pinchAround),L.noInertia&&(s.noInertia=L.noInertia),i.extend(a,F),i.extend(n,ue)}this._updateMapTransform(s,a,n),this._changes=[]},jn.prototype._updateMapTransform=function(s,a,n){var l=this._map,g=l.transform;if(!Jn(s))return this._fireEvents(a,n,!0);var w=s.panDelta,L=s.zoomDelta,F=s.bearingDelta,ue=s.pitchDelta,Ee=s.around,$e=s.pinchAround;$e!==void 0&&(Ee=$e),l._stop(!0),Ee=Ee||l.transform.centerPoint;var rt=g.pointLocation(w?Ee.sub(w):Ee);F&&(g.bearing+=F),ue&&(g.pitch+=ue),L&&(g.zoom+=L),g.setLocationAtPoint(rt,Ee),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(a,n,!0)},jn.prototype._fireEvents=function(s,a,n){var l=this,g=_s(this._eventsInProgress),w=_s(s),L={};for(var F in s)this._eventsInProgress[F]||(L[F+"start"]=s[F].originalEvent),this._eventsInProgress[F]=s[F];for(var ue in!g&&w&&this._fireEvent("movestart",w.originalEvent),L)this._fireEvent(ue,L[ue]);for(var Ee in w&&this._fireEvent("move",w.originalEvent),s)this._fireEvent(Ee,s[Ee].originalEvent);var $e,rt={};for(var nt in this._eventsInProgress){var Ft=this._eventsInProgress[nt],Nt=Ft.handlerName,Kt=Ft.originalEvent;this._handlersById[Nt].isActive()||(delete this._eventsInProgress[nt],rt[nt+"end"]=$e=a[Nt]||Kt)}for(var jt in rt)this._fireEvent(jt,rt[jt]);var Gt=_s(this._eventsInProgress);if(n&&(g||w)&&!Gt){this._updatingCamera=!0;var nr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),rr=function(vr){return vr!==0&&-l._bearingSnap<vr&&vr<l._bearingSnap};nr?(rr(nr.bearing||this._map.getBearing())&&(nr.bearing=0),this._map.easeTo(nr,{originalEvent:$e})):(this._map.fire(new i.Event("moveend",{originalEvent:$e})),rr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},jn.prototype._fireEvent=function(s,a){this._map.fire(new i.Event(s,a?{originalEvent:a}:{}))},jn.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete s._frameId,s.handleEvent(new Tc("renderFrame",{timeStamp:a})),s._applyChanges()})},jn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var _c=function(s){function a(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,i.bindAll(["_renderFrameCallback"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getCenter=function(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},a.prototype.panBy=function(n,l,g){return n=i.Point.convert(n).mult(-1),this.panTo(this.transform.center,i.extend({offset:n},l),g)},a.prototype.panTo=function(n,l,g){return this.easeTo(i.extend({center:n},l),g)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},a.prototype.zoomTo=function(n,l,g){return this.easeTo(i.extend({zoom:n},l),g)},a.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},a.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},a.prototype.rotateTo=function(n,l,g){return this.easeTo(i.extend({bearing:n},l),g)},a.prototype.resetNorth=function(n,l){return this.rotateTo(0,i.extend({duration:1e3},n),l),this},a.prototype.resetNorthPitch=function(n,l){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},n),l),this},a.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},a.prototype.cameraForBounds=function(n,l){n=i.LngLatBounds.convert(n);var g=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),g,l)},a.prototype._cameraForBoxAndBearing=function(n,l,g,w){var L={top:0,bottom:0,right:0,left:0};if(typeof(w=i.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var F=w.padding;w.padding={top:F,bottom:F,right:F,left:F}}w.padding=i.extend(L,w.padding);var ue=this.transform,Ee=ue.padding,$e=ue.project(i.LngLat.convert(n)),rt=ue.project(i.LngLat.convert(l)),nt=$e.rotate(-g*Math.PI/180),Ft=rt.rotate(-g*Math.PI/180),Nt=new i.Point(Math.max(nt.x,Ft.x),Math.max(nt.y,Ft.y)),Kt=new i.Point(Math.min(nt.x,Ft.x),Math.min(nt.y,Ft.y)),jt=Nt.sub(Kt),Gt=(ue.width-(Ee.left+Ee.right+w.padding.left+w.padding.right))/jt.x,nr=(ue.height-(Ee.top+Ee.bottom+w.padding.top+w.padding.bottom))/jt.y;if(!(nr<0||Gt<0)){var rr=Math.min(ue.scaleZoom(ue.scale*Math.min(Gt,nr)),w.maxZoom),Lr=typeof w.offset.x=="number"?new i.Point(w.offset.x,w.offset.y):i.Point.convert(w.offset),vr=new i.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(g*Math.PI/180),Sr=Lr.add(vr).mult(ue.scale/ue.zoomScale(rr));return{center:ue.unproject($e.add(rt).div(2).sub(Sr)),zoom:rr,bearing:g}}i.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,l,g){return this._fitInternal(this.cameraForBounds(n,l),l,g)},a.prototype.fitScreenCoordinates=function(n,l,g,w,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(i.Point.convert(n)),this.transform.pointLocation(i.Point.convert(l)),g,w),w,L)},a.prototype._fitInternal=function(n,l,g){return n?(delete(l=i.extend(n,l)).padding,l.linear?this.easeTo(l,g):this.flyTo(l,g)):this},a.prototype.jumpTo=function(n,l){this.stop();var g=this.transform,w=!1,L=!1,F=!1;return"zoom"in n&&g.zoom!==+n.zoom&&(w=!0,g.zoom=+n.zoom),n.center!==void 0&&(g.center=i.LngLat.convert(n.center)),"bearing"in n&&g.bearing!==+n.bearing&&(L=!0,g.bearing=+n.bearing),"pitch"in n&&g.pitch!==+n.pitch&&(F=!0,g.pitch=+n.pitch),n.padding==null||g.isPaddingEqual(n.padding)||(g.padding=n.padding),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l)),w&&this.fire(new i.Event("zoomstart",l)).fire(new i.Event("zoom",l)).fire(new i.Event("zoomend",l)),L&&this.fire(new i.Event("rotatestart",l)).fire(new i.Event("rotate",l)).fire(new i.Event("rotateend",l)),F&&this.fire(new i.Event("pitchstart",l)).fire(new i.Event("pitch",l)).fire(new i.Event("pitchend",l)),this.fire(new i.Event("moveend",l))},a.prototype.easeTo=function(n,l){var g=this;this._stop(!1,n.easeId),((n=i.extend({offset:[0,0],duration:500,easing:i.ease},n)).animate===!1||!n.essential&&i.browser.prefersReducedMotion)&&(n.duration=0);var w=this.transform,L=this.getZoom(),F=this.getBearing(),ue=this.getPitch(),Ee=this.getPadding(),$e="zoom"in n?+n.zoom:L,rt="bearing"in n?this._normalizeBearing(n.bearing,F):F,nt="pitch"in n?+n.pitch:ue,Ft="padding"in n?n.padding:w.padding,Nt=i.Point.convert(n.offset),Kt=w.centerPoint.add(Nt),jt=w.pointLocation(Kt),Gt=i.LngLat.convert(n.center||jt);this._normalizeCenter(Gt);var nr,rr,Lr=w.project(jt),vr=w.project(Gt).sub(Lr),Sr=w.zoomScale($e-L);n.around&&(nr=i.LngLat.convert(n.around),rr=w.locationPoint(nr));var Ar={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$e!==L,this._rotating=this._rotating||F!==rt,this._pitching=this._pitching||nt!==ue,this._padding=!w.isPaddingEqual(Ft),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Ar),this._ease(function(rn){if(g._zooming&&(w.zoom=i.number(L,$e,rn)),g._rotating&&(w.bearing=i.number(F,rt,rn)),g._pitching&&(w.pitch=i.number(ue,nt,rn)),g._padding&&(w.interpolatePadding(Ee,Ft,rn),Kt=w.centerPoint.add(Nt)),nr)w.setLocationAtPoint(nr,rr);else{var Xr=w.zoomScale(w.zoom-L),mn=$e>L?Math.min(2,Sr):Math.max(.5,Sr),Ln=Math.pow(mn,1-rn),qn=w.unproject(Lr.add(vr.mult(rn*Ln)).mult(Xr));w.setLocationAtPoint(w.renderWorldCopies?qn.wrap():qn,Kt)}g._fireMoveEvents(l)},function(rn){g._afterEase(l,rn)},n),this},a.prototype._prepareEase=function(n,l,g){g===void 0&&(g={}),this._moving=!0,l||g.moving||this.fire(new i.Event("movestart",n)),this._zooming&&!g.zooming&&this.fire(new i.Event("zoomstart",n)),this._rotating&&!g.rotating&&this.fire(new i.Event("rotatestart",n)),this._pitching&&!g.pitching&&this.fire(new i.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new i.Event("move",n)),this._zooming&&this.fire(new i.Event("zoom",n)),this._rotating&&this.fire(new i.Event("rotate",n)),this._pitching&&this.fire(new i.Event("pitch",n))},a.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var g=this._zooming,w=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new i.Event("zoomend",n)),w&&this.fire(new i.Event("rotateend",n)),L&&this.fire(new i.Event("pitchend",n)),this.fire(new i.Event("moveend",n))}},a.prototype.flyTo=function(n,l){var g=this;if(!n.essential&&i.browser.prefersReducedMotion){var w=i.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,l)}this.stop(),n=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},n);var L=this.transform,F=this.getZoom(),ue=this.getBearing(),Ee=this.getPitch(),$e=this.getPadding(),rt="zoom"in n?i.clamp(+n.zoom,L.minZoom,L.maxZoom):F,nt="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,Ft="pitch"in n?+n.pitch:Ee,Nt="padding"in n?n.padding:L.padding,Kt=L.zoomScale(rt-F),jt=i.Point.convert(n.offset),Gt=L.centerPoint.add(jt),nr=L.pointLocation(Gt),rr=i.LngLat.convert(n.center||nr);this._normalizeCenter(rr);var Lr=L.project(nr),vr=L.project(rr).sub(Lr),Sr=n.curve,Ar=Math.max(L.width,L.height),rn=Ar/Kt,Xr=vr.mag();if("minZoom"in n){var mn=i.clamp(Math.min(n.minZoom,F,rt),L.minZoom,L.maxZoom),Ln=Ar/L.zoomScale(mn-F);Sr=Math.sqrt(Ln/Xr*2)}var qn=Sr*Sr;function sa(na){var La=(rn*rn-Ar*Ar+(na?-1:1)*qn*qn*Xr*Xr)/(2*(na?rn:Ar)*qn*Xr);return Math.log(Math.sqrt(La*La+1)-La)}function Sa(na){return(Math.exp(na)-Math.exp(-na))/2}function Wa(na){return(Math.exp(na)+Math.exp(-na))/2}var Sn=sa(0),ua=function(La){return Wa(Sn)/Wa(Sn+Sr*La)},ba=function(La){return Ar*((Wa(Sn)*(Sa(za=Sn+Sr*La)/Wa(za))-Sa(Sn))/qn)/Xr;var za},Wn=(sa(1)-Sn)/Sr;if(Math.abs(Xr)<1e-6||!isFinite(Wn)){if(Math.abs(Ar-rn)<1e-6)return this.easeTo(n,l);var Aa=rn<Ar?-1:1;Wn=Math.abs(Math.log(rn/Ar))/Sr,ba=function(){return 0},ua=function(La){return Math.exp(Aa*Sr*La)}}return n.duration="duration"in n?+n.duration:1e3*Wn/("screenSpeed"in n?+n.screenSpeed/Sr:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==nt,this._pitching=Ft!==Ee,this._padding=!L.isPaddingEqual(Nt),this._prepareEase(l,!1),this._ease(function(na){var La=na*Wn,za=1/ua(La);L.zoom=na===1?rt:F+L.scaleZoom(za),g._rotating&&(L.bearing=i.number(ue,nt,na)),g._pitching&&(L.pitch=i.number(Ee,Ft,na)),g._padding&&(L.interpolatePadding($e,Nt,na),Gt=L.centerPoint.add(jt));var Gi=na===1?rr:L.unproject(Lr.add(vr.mult(ba(La))).mult(za));L.setLocationAtPoint(L.renderWorldCopies?Gi.wrap():Gi,Gt),g._fireMoveEvents(l)},function(){return g._afterEase(l)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,l)}if(!n){var w=this.handlers;w&&w.stop(!1)}return this},a.prototype._ease=function(n,l,g){g.animate===!1||g.duration===0?(n(1),l()):(this._easeStart=i.browser.now(),this._easeOptions=g,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((i.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,l){n=i.wrap(n,-180,180);var g=Math.abs(n-l);return Math.abs(n-360-l)<g&&(n-=360),Math.abs(n+360-l)<g&&(n+=360),n},a.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var g=n.lng-l.center.lng;n.lng+=g>180?-360:g<-180?360:0}},a}(i.Evented),us=function(a){a===void 0&&(a={}),this.options=a,i.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};us.prototype.getDefaultPosition=function(){return"bottom-right"},us.prototype.onAdd=function(s){var a=this.options&&this.options.compact;return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},us.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},us.prototype._setElementTitle=function(s,a){var n=this._map._getUIString("AttributionControl."+a);s.title=n,s.setAttribute("aria-label",n)},us.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},us.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.config.ACCESS_TOKEN}];if(s){var n=a.reduce(function(l,g,w){return g.value&&(l+=g.key+"="+g.value+(w<a.length-1?"&":"")),l},"?");s.href=i.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}},us.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},us.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(F){return typeof F!="string"?"":F})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var l in n){var g=n[l];if(g.used){var w=g.getSource();w.attribution&&s.indexOf(w.attribution)<0&&s.push(w.attribution)}}s.sort(function(F,ue){return F.length-ue.length});var L=(s=s.filter(function(F,ue){for(var Ee=ue+1;Ee<s.length;Ee++)if(s[Ee].indexOf(F)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,s.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},us.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Io=function(){i.bindAll(["_updateLogo"],this),i.bindAll(["_updateCompact"],this)};Io.prototype.onAdd=function(s){this._map=s,this._container=D.create("div","mapboxgl-ctrl");var a=D.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Io.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Io.prototype.getDefaultPosition=function(){return"bottom-left"},Io.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Io.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var a in s)if(s[a].getSource().mapbox_logo)return!0;return!1}},Io.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var a=s[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var vo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};vo.prototype.add=function(s){var a=++this._id;return this._queue.push({callback:s,id:a,cancelled:!1}),a},vo.prototype.remove=function(s){for(var a=this._currentlyRunning,n=0,l=a?this._queue.concat(a):this._queue;n<l.length;n+=1){var g=l[n];if(g.id===s)return void(g.cancelled=!0)}},vo.prototype.run=function(s){s===void 0&&(s=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=a;n<l.length;n+=1){var g=l[n];if(!g.cancelled&&(g.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},vo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ss={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},wu=i.window.HTMLImageElement,rc=i.window.HTMLElement,Ka=i.window.ImageBitmap,no={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},fl=function(s){function a(l){var g=this;if((l=i.extend({},no,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new kn(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,w,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new vo,this._controls=[],this._mapId=i.uniqueId(),this._locale=i.extend({},Ss,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new i.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=i.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof rc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return g._update(!1)}),this.on("moveend",function(){return g._update(!1)}),this.on("zoom",function(){return g._update(!0)}),i.window!==void 0&&(i.window.addEventListener("online",this._onWindowOnline,!1),i.window.addEventListener("resize",this._onWindowResize,!1),i.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new jn(this,l),this._hash=l.hash&&new ws(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,i.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new us({customAttribution:l.customAttribution})),this.addControl(new Io,l.logoPosition),this.on("style.load",function(){g.transform.unmodified&&g.jumpTo(g.style.stylesheet)}),this.on("data",function(L){g._update(L.dataType==="style"),g.fire(new i.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){g.fire(new i.Event(L.dataType+"dataloading",L))})}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,g){if(g===void 0&&(g=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=l.onAdd(this);this._controls.push(l);var L=this._controlPositions[g];return g.indexOf("bottom")!==-1?L.insertBefore(w,L.firstChild):L.appendChild(w),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var g=this._controls.indexOf(l);return g>-1&&this._controls.splice(g,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var g=this._containerDimensions(),w=g[0],L=g[1];this._resizeCanvas(w,L),this.transform.resize(w,L),this.painter.resize(w,L);var F=!this._moving;return F&&(this.stop(),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l))),this.fire(new i.Event("resize",l)),F&&this.fire(new i.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(i.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(i.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(i.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,g,w){var L,F=this;if(l==="mouseenter"||l==="mouseover"){var ue=!1;return{layer:g,listener:w,delegates:{mousemove:function(rt){var nt=F.getLayer(g)?F.queryRenderedFeatures(rt.point,{layers:[g]}):[];nt.length?ue||(ue=!0,w.call(F,new zi(l,F,rt.originalEvent,{features:nt}))):ue=!1},mouseout:function(){ue=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Ee=!1;return{layer:g,listener:w,delegates:{mousemove:function(rt){(F.getLayer(g)?F.queryRenderedFeatures(rt.point,{layers:[g]}):[]).length?Ee=!0:Ee&&(Ee=!1,w.call(F,new zi(l,F,rt.originalEvent)))},mouseout:function(rt){Ee&&(Ee=!1,w.call(F,new zi(l,F,rt.originalEvent)))}}}}return{layer:g,listener:w,delegates:(L={},L[l]=function($e){var rt=F.getLayer(g)?F.queryRenderedFeatures($e.point,{layers:[g]}):[];rt.length&&($e.features=rt,w.call(F,$e),delete $e.features)},L)}},a.prototype.on=function(l,g,w){if(w===void 0)return s.prototype.on.call(this,l,g);var L=this._createDelegatedListener(l,g,w);for(var F in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(L),L.delegates)this.on(F,L.delegates[F]);return this},a.prototype.once=function(l,g,w){if(w===void 0)return s.prototype.once.call(this,l,g);var L=this._createDelegatedListener(l,g,w);for(var F in L.delegates)this.once(F,L.delegates[F]);return this},a.prototype.off=function(l,g,w){var L=this;return w===void 0?s.prototype.off.call(this,l,g):(this._delegatedListeners&&this._delegatedListeners[l]&&function(F){for(var ue=F[l],Ee=0;Ee<ue.length;Ee++){var $e=ue[Ee];if($e.layer===g&&$e.listener===w){for(var rt in $e.delegates)L.off(rt,$e.delegates[rt]);return ue.splice(Ee,1),L}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,g){if(!this.style)return[];var w;if(g!==void 0||l===void 0||l instanceof i.Point||Array.isArray(l)||(g=l,l=void 0),g=g||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof i.Point||typeof l[0]=="number")w=[i.Point.convert(l)];else{var L=i.Point.convert(l[0]),F=i.Point.convert(l[1]);w=[L,new i.Point(F.x,L.y),F,new i.Point(L.x,F.y),L]}return this.style.queryRenderedFeatures(w,g,this.transform)},a.prototype.querySourceFeatures=function(l,g){return this.style.querySourceFeatures(l,g)},a.prototype.setStyle=function(l,g){return(g=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},g)).diff!==!1&&g.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,g),this):(this._localIdeographFontFamily=g.localIdeographFontFamily,this._updateStyle(l,g))},a.prototype._getUIString=function(l){var g=this._locale[l];if(g==null)throw new Error("Missing UI string '"+l+"'");return g},a.prototype._updateStyle=function(l,g){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new Ri(this,g||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ri(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,g){var w=this;if(typeof l=="string"){var L=this._requestManager.normalizeStyleURL(l),F=this._requestManager.transformRequest(L,i.ResourceType.Style);i.getJSON(F,function(ue,Ee){ue?w.fire(new i.ErrorEvent(ue)):Ee&&w._updateDiff(Ee,g)})}else typeof l=="object"&&this._updateDiff(l,g)},a.prototype._updateDiff=function(l,g){try{this.style.setState(l)&&this._update(!0)}catch(w){i.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(l,g)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():i.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,g){return this._lazyInitEmptyStyle(),this.style.addSource(l,g),this._update(!0)},a.prototype.isSourceLoaded=function(l){var g=this.style&&this.style.sourceCaches[l];if(g!==void 0)return g.loaded();this.fire(new i.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var g in l){var w=l[g]._tiles;for(var L in w){var F=w[L];if(F.state!=="loaded"&&F.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,g,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,g,w)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,g,w){w===void 0&&(w={});var L=w.pixelRatio;L===void 0&&(L=1);var F=w.sdf;F===void 0&&(F=!1);var ue=w.stretchX,Ee=w.stretchY,$e=w.content;if(this._lazyInitEmptyStyle(),g instanceof wu||Ka&&g instanceof Ka){var rt=i.browser.getImageData(g);this.style.addImage(l,{data:new i.RGBAImage({width:rt.width,height:rt.height},rt.data),pixelRatio:L,stretchX:ue,stretchY:Ee,content:$e,sdf:F,version:0})}else{if(g.width===void 0||g.height===void 0)return this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var nt=g;this.style.addImage(l,{data:new i.RGBAImage({width:g.width,height:g.height},new Uint8Array(g.data)),pixelRatio:L,stretchX:ue,stretchY:Ee,content:$e,sdf:F,version:0,userImage:nt}),nt.onAdd&&nt.onAdd(this,l)}},a.prototype.updateImage=function(l,g){var w=this.style.getImage(l);if(!w)return this.fire(new i.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=g instanceof wu||Ka&&g instanceof Ka?i.browser.getImageData(g):g,F=L.width,ue=L.height,Ee=L.data;return F===void 0||ue===void 0?this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):F!==w.data.width||ue!==w.data.height?this.fire(new i.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(Ee,!(g instanceof wu||Ka&&g instanceof Ka)),void this.style.updateImage(l,w))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new i.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,g){i.getImage(this._requestManager.transformRequest(l,i.ResourceType.Image),g)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,g){return this._lazyInitEmptyStyle(),this.style.addLayer(l,g),this._update(!0)},a.prototype.moveLayer=function(l,g){return this.style.moveLayer(l,g),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,g,w){return this.style.setLayerZoomRange(l,g,w),this._update(!0)},a.prototype.setFilter=function(l,g,w){return w===void 0&&(w={}),this.style.setFilter(l,g,w),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,g,w,L){return L===void 0&&(L={}),this.style.setPaintProperty(l,g,w,L),this._update(!0)},a.prototype.getPaintProperty=function(l,g){return this.style.getPaintProperty(l,g)},a.prototype.setLayoutProperty=function(l,g,w,L){return L===void 0&&(L={}),this.style.setLayoutProperty(l,g,w,L),this._update(!0)},a.prototype.getLayoutProperty=function(l,g){return this.style.getLayoutProperty(l,g)},a.prototype.setLight=function(l,g){return g===void 0&&(g={}),this._lazyInitEmptyStyle(),this.style.setLight(l,g),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,g){return this.style.setFeatureState(l,g),this._update()},a.prototype.removeFeatureState=function(l,g){return this.style.removeFeatureState(l,g),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,g=0;return this._container&&(l=this._container.clientWidth||400,g=this._container.clientHeight||300),[l,g]},a.prototype._detectMissingCSS=function(){i.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var g=this._canvasContainer=D.create("div","mapboxgl-canvas-container",l);this._interactive&&g.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",g),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var L=this._controlContainer=D.create("div","mapboxgl-control-container",l),F=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){F[ue]=D.create("div","mapboxgl-ctrl-"+ue,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,g){var w=i.browser.devicePixelRatio||1;this._canvas.width=w*l,this._canvas.height=w*g,this._canvas.style.width=l+"px",this._canvas.style.height=g+"px"},a.prototype._setupPainter=function(){var l=i.extend({},W.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),g=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);g?(this.painter=new wi(g,this.transform),i.webpSupported.testSupport(g)):this.fire(new i.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var g,w=this,L=0,F=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(g=F.createQueryEXT(),F.beginQueryEXT(F.TIME_ELAPSED_EXT,g),L=i.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ee=this.transform.zoom,$e=i.browser.now();this.style.zoomHistory.update(Ee,$e);var rt=new i.EvaluationParameters(Ee,{now:$e,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),nt=rt.crossFadingFactor();nt===1&&nt===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=nt),this.style.update(rt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ft=i.browser.now()-L;F.endQueryEXT(F.TIME_ELAPSED_EXT,g),setTimeout(function(){var jt=F.getQueryObjectEXT(g,F.QUERY_RESULT_EXT)/1e6;F.deleteQueryEXT(g),w.fire(new i.Event("gpu-timing-frame",{cpuTime:Ft,gpuTime:jt}))},50)}if(this.listens("gpu-timing-layer")){var Nt=this.painter.collectGpuTimers();setTimeout(function(){var jt=w.painter.queryGpuTimers(Nt);w.fire(new i.Event("gpu-timing-layer",{layerTimes:jt}))},50)}var Kt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Kt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new i.Event("idle")),!this._loaded||this._fullyLoaded||Kt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,g=this._controls;l<g.length;l+=1)g[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),i.window!==void 0&&(i.window.removeEventListener("resize",this._onWindowResize,!1),i.window.removeEventListener("orientationchange",this._onWindowResize,!1),i.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),mu(this._canvasContainer),mu(this._controlContainer),mu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new i.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=i.browser.frame(function(g){l._frame=null,l._render(g)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,g){i.setCacheLimits(l,g)},n.version.get=function(){return i.version},Object.defineProperties(a.prototype,n),a}(_c);function mu(s){s.parentNode&&s.parentNode.removeChild(s)}var hl={showCompass:!0,showZoom:!0,visualizePitch:!1},Ou=function(a){var n=this;this.options=i.extend({},hl,a),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ou.prototype._updateZoomButtons=function(){var s=this._map.getZoom(),a=s===this._map.getMaxZoom(),n=s===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Ou.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},Ou.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ms(this._map,this._compass,this.options.visualizePitch)),this._container},Ou.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ou.prototype._createButton=function(s,a){var n=D.create("button",s,this._container);return n.type="button",n.addEventListener("click",a),n},Ou.prototype._setButtonTitle=function(s,a){var n=this._map._getUIString("NavigationControl."+a);s.title=n,s.setAttribute("aria-label",n)};var Ms=function(a,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new os({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,l&&(this.mousePitch=new ro({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function Bc(s,a,n){if(s=new i.LngLat(s.lng,s.lat),a){var l=new i.LngLat(s.lng-360,s.lat),g=new i.LngLat(s.lng+360,s.lat),w=n.locationPoint(s).distSqr(a);n.locationPoint(l).distSqr(a)<w?s=l:n.locationPoint(g).distSqr(a)<w&&(s=g)}for(;Math.abs(s.lng-n.center.lng)>180;){var L=n.locationPoint(s);if(L.x>=0&&L.y>=0&&L.x<=n.width&&L.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}Ms.prototype.down=function(s,a){this.mouseRotate.mousedown(s,a),this.mousePitch&&this.mousePitch.mousedown(s,a),D.disableDrag()},Ms.prototype.move=function(s,a){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,a);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var g=this.mousePitch.mousemoveWindow(s,a);g&&g.pitchDelta&&n.setPitch(n.getPitch()+g.pitchDelta)}},Ms.prototype.off=function(){var s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},Ms.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(i.window,"mousemove",this.mousemove),D.removeEventListener(i.window,"mouseup",this.mouseup)},Ms.prototype.mousedown=function(s){this.down(i.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),D.mousePos(this.element,s)),D.addEventListener(i.window,"mousemove",this.mousemove),D.addEventListener(i.window,"mouseup",this.mouseup)},Ms.prototype.mousemove=function(s){this.move(s,D.mousePos(this.element,s))},Ms.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},Ms.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},Ms.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},Ms.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ms.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Vs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xf(s,a,n){var l=s.classList;for(var g in Vs)l.remove("mapboxgl-"+n+"-anchor-"+g);l.add("mapboxgl-"+n+"-anchor-"+a)}var Bl,Vl=function(s){function a(n,l){if(s.call(this),(n instanceof i.window.HTMLElement||l)&&(n=i.extend({element:n},l)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=i.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var g=D.createNS("http://www.w3.org/2000/svg","svg");g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height","41px"),g.setAttributeNS(null,"width","27px"),g.setAttributeNS(null,"viewBox","0 0 27 41");var w=D.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var L=D.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var F=D.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(3.0, 29.0)"),F.setAttributeNS(null,"fill","#000000");for(var ue=0,Ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ue<Ee.length;ue+=1){var $e=Ee[ue],rt=D.createNS("http://www.w3.org/2000/svg","ellipse");rt.setAttributeNS(null,"opacity","0.04"),rt.setAttributeNS(null,"cx","10.5"),rt.setAttributeNS(null,"cy","5.80029008"),rt.setAttributeNS(null,"rx",$e.rx),rt.setAttributeNS(null,"ry",$e.ry),F.appendChild(rt)}var nt=D.createNS("http://www.w3.org/2000/svg","g");nt.setAttributeNS(null,"fill",this._color);var Ft=D.createNS("http://www.w3.org/2000/svg","path");Ft.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),nt.appendChild(Ft);var Nt=D.createNS("http://www.w3.org/2000/svg","g");Nt.setAttributeNS(null,"opacity","0.25"),Nt.setAttributeNS(null,"fill","#000000");var Kt=D.createNS("http://www.w3.org/2000/svg","path");Kt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Nt.appendChild(Kt);var jt=D.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var Gt=D.createNS("http://www.w3.org/2000/svg","g");Gt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var nr=D.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#000000"),nr.setAttributeNS(null,"opacity","0.25"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962");var rr=D.createNS("http://www.w3.org/2000/svg","circle");rr.setAttributeNS(null,"fill","#FFFFFF"),rr.setAttributeNS(null,"cx","5.5"),rr.setAttributeNS(null,"cy","5.5"),rr.setAttributeNS(null,"r","5.4999962"),Gt.appendChild(nr),Gt.appendChild(rr),L.appendChild(F),L.appendChild(nt),L.appendChild(Nt),L.appendChild(jt),L.appendChild(Gt),g.appendChild(L),g.setAttributeNS(null,"height",41*this._scale+"px"),g.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(g),this._offset=i.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Lr){Lr.preventDefault()}),this._element.addEventListener("mousedown",function(Lr){Lr.preventDefault()}),xf(this._element,this._anchor,"marker"),this._popup=null}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var l=n.code,g=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&g!==32&&g!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var l=n.originalEvent.target,g=this._element;this._popup&&(l===g||g.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Bc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,Vs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+g+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=i.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new i.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(i.Evented),Sc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ls=0,Hu=!1,Vc=function(s){function a(n){s.call(this),this.options=i.extend({},Sc,n),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){var l;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Bl!==void 0?l(Bl):i.window.navigator.permissions!==void 0?i.window.navigator.permissions.query({name:"geolocation"}).then(function(g){l(Bl=g.state!=="denied")}):l(Bl=!!i.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ls=0,Hu=!1},a.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),g=n.coords;return l&&(g.longitude<l.getWest()||g.longitude>l.getEast()||g.latitude<l.getSouth()||g.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude),g=n.coords.accuracy,w=this._map.getBearing(),L=i.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(g),L,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),g=this._map.unproject([1,n]),w=l.distanceTo(g),L=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Hu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Vl(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||l._watchState!=="ACTIVE_LOCK"||L.originalEvent&&L.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new i.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ls--,Hu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ls>1?(n={maximumAge:6e5,timeout:0},Hu=!0):(n=this.options.positionOptions,Hu=!1),this._geolocationWatchID=i.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else i.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(i.Evented),Cl={maxWidth:100,unit:"metric"},Wu=function(a){this.options=i.extend({},Cl,a),i.bindAll(["_onMove","setUnit"],this)};function nc(s,a,n){var l=n&&n.maxWidth||100,g=s._container.clientHeight/2,w=s.unproject([0,g]),L=s.unproject([l,g]),F=w.distanceTo(L);if(n&&n.unit==="imperial"){var ue=3.2808*F;ue>5280?Zu(a,l,ue/5280,s._getUIString("ScaleControl.Miles")):Zu(a,l,ue,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Zu(a,l,F/1852,s._getUIString("ScaleControl.NauticalMiles")):F>=1e3?Zu(a,l,F/1e3,s._getUIString("ScaleControl.Kilometers")):Zu(a,l,F,s._getUIString("ScaleControl.Meters"))}function Zu(s,a,n,l){var g,w,L,F=(g=n,(w=Math.pow(10,(""+Math.floor(g)).length-1))*(L=(L=g/w)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(ue){var Ee=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Ee)/Ee}(L)));s.style.width=a*(F/n)+"px",s.innerHTML=F+"&nbsp;"+l}Wu.prototype.getDefaultPosition=function(){return"bottom-left"},Wu.prototype._onMove=function(){nc(this._map,this._container,this.options)},Wu.prototype.onAdd=function(s){return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Wu.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Wu.prototype.setUnit=function(s){this.options.unit=s,nc(this._map,this._container,this.options)};var Ps=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof i.window.HTMLElement?this._container=a.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in i.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in i.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in i.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in i.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ps.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ps.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,i.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ps.prototype._checkFullscreenSupport=function(){return!!(i.window.document.fullscreenEnabled||i.window.document.mozFullScreenEnabled||i.window.document.msFullscreenEnabled||i.window.document.webkitFullscreenEnabled)},Ps.prototype._setupUI=function(){var s=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),i.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ps.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Ps.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ps.prototype._isFullscreen=function(){return this._fullscreen},Ps.prototype._changeIcon=function(){(i.window.document.fullscreenElement||i.window.document.mozFullScreenElement||i.window.document.webkitFullscreenElement||i.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ps.prototype._onClickFullscreen=function(){this._isFullscreen()?i.window.document.exitFullscreen?i.window.document.exitFullscreen():i.window.document.mozCancelFullScreen?i.window.document.mozCancelFullScreen():i.window.document.msExitFullscreen?i.window.document.msExitFullscreen():i.window.document.webkitCancelFullScreen&&i.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var of={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ac=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ic=function(s){function a(n){s.call(this),this.options=i.extend(Object.create(of),n),i.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new i.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new i.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(i.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var l,g=i.window.document.createDocumentFragment(),w=i.window.document.createElement("body");for(w.innerHTML=n;l=w.firstChild;)g.appendChild(l);return this.setDOMContent(g)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(rt){return l._container.classList.add(rt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Bc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var g=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),w=this.options.anchor,L=function rt(nt){if(nt){if(typeof nt=="number"){var Ft=Math.round(Math.sqrt(.5*Math.pow(nt,2)));return{center:new i.Point(0,0),top:new i.Point(0,nt),"top-left":new i.Point(Ft,Ft),"top-right":new i.Point(-Ft,Ft),bottom:new i.Point(0,-nt),"bottom-left":new i.Point(Ft,-Ft),"bottom-right":new i.Point(-Ft,-Ft),left:new i.Point(nt,0),right:new i.Point(-nt,0)}}if(nt instanceof i.Point||Array.isArray(nt)){var Nt=i.Point.convert(nt);return{center:Nt,top:Nt,"top-left":Nt,"top-right":Nt,bottom:Nt,"bottom-left":Nt,"bottom-right":Nt,left:Nt,right:Nt}}return{center:i.Point.convert(nt.center||[0,0]),top:i.Point.convert(nt.top||[0,0]),"top-left":i.Point.convert(nt["top-left"]||[0,0]),"top-right":i.Point.convert(nt["top-right"]||[0,0]),bottom:i.Point.convert(nt.bottom||[0,0]),"bottom-left":i.Point.convert(nt["bottom-left"]||[0,0]),"bottom-right":i.Point.convert(nt["bottom-right"]||[0,0]),left:i.Point.convert(nt.left||[0,0]),right:i.Point.convert(nt.right||[0,0])}}return rt(new i.Point(0,0))}(this.options.offset);if(!w){var F,ue=this._container.offsetWidth,Ee=this._container.offsetHeight;F=g.y+L.bottom.y<Ee?["top"]:g.y>this._map.transform.height-Ee?["bottom"]:[],g.x<ue/2?F.push("left"):g.x>this._map.transform.width-ue/2&&F.push("right"),w=F.length===0?"bottom":F.join("-")}var $e=g.add(L[w]).round();D.setTransform(this._container,Vs[w]+" translate("+$e.x+"px,"+$e.y+"px)"),xf(this._container,w,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(ac);n&&n.focus()}},a.prototype._onClose=function(){this.remove()},a}(i.Evented),oc={version:i.version,supported:W,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:fl,NavigationControl:Ou,GeolocateControl:Vc,AttributionControl:us,ScaleControl:Wu,FullscreenControl:Ps,Popup:ic,Marker:Vl,Style:Ri,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.Point,MercatorCoordinate:i.MercatorCoordinate,Evented:i.Evented,config:i.config,prewarm:function(){er().acquire(cr)},clearPrewarmedResources:function(){var a=Mn;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(cr),Mn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return i.config.ACCESS_TOKEN},set accessToken(s){i.config.ACCESS_TOKEN=s},get baseApiUrl(){return i.config.API_URL},set baseApiUrl(s){i.config.API_URL=s},get workerCount(){return Ur.workerCount},set workerCount(s){Ur.workerCount=s},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){i.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(a){i.clearTileCache(a)},workerUrl:""};return oc}),Y})},"4cb6":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.METADATA_KEY=void 0;var x=o("xfSm");y.METADATA_KEY=x;var m=o("9Fde");Object.defineProperty(y,"Container",{enumerable:!0,get:function(){return m.Container}});var Y=o("FV85");Object.defineProperty(y,"BindingScopeEnum",{enumerable:!0,get:function(){return Y.BindingScopeEnum}}),Object.defineProperty(y,"BindingTypeEnum",{enumerable:!0,get:function(){return Y.BindingTypeEnum}}),Object.defineProperty(y,"TargetTypeEnum",{enumerable:!0,get:function(){return Y.TargetTypeEnum}});var z=o("dxzI");Object.defineProperty(y,"AsyncContainerModule",{enumerable:!0,get:function(){return z.AsyncContainerModule}}),Object.defineProperty(y,"ContainerModule",{enumerable:!0,get:function(){return z.ContainerModule}});var i=o("cZ5Q");Object.defineProperty(y,"injectable",{enumerable:!0,get:function(){return i.injectable}});var W=o("0gSV");Object.defineProperty(y,"tagged",{enumerable:!0,get:function(){return W.tagged}});var D=o("ZzCi");Object.defineProperty(y,"named",{enumerable:!0,get:function(){return D.named}});var Q=o("Yk9n");Object.defineProperty(y,"inject",{enumerable:!0,get:function(){return Q.inject}}),Object.defineProperty(y,"LazyServiceIdentifer",{enumerable:!0,get:function(){return Q.LazyServiceIdentifer}});var ee=o("jYx5");Object.defineProperty(y,"optional",{enumerable:!0,get:function(){return ee.optional}});var ce=o("n2J3");Object.defineProperty(y,"unmanaged",{enumerable:!0,get:function(){return ce.unmanaged}});var K=o("jIg/");Object.defineProperty(y,"multiInject",{enumerable:!0,get:function(){return K.multiInject}});var je=o("oaX6");Object.defineProperty(y,"targetName",{enumerable:!0,get:function(){return je.targetName}});var pe=o("Sk89");Object.defineProperty(y,"postConstruct",{enumerable:!0,get:function(){return pe.postConstruct}});var Ke=o("wnjb");Object.defineProperty(y,"MetadataReader",{enumerable:!0,get:function(){return Ke.MetadataReader}});var Pe=o("d9O0");Object.defineProperty(y,"id",{enumerable:!0,get:function(){return Pe.id}});var ht=o("Ztfv");Object.defineProperty(y,"decorate",{enumerable:!0,get:function(){return ht.decorate}});var Le=o("RR/i");Object.defineProperty(y,"traverseAncerstors",{enumerable:!0,get:function(){return Le.traverseAncerstors}}),Object.defineProperty(y,"taggedConstraint",{enumerable:!0,get:function(){return Le.taggedConstraint}}),Object.defineProperty(y,"namedConstraint",{enumerable:!0,get:function(){return Le.namedConstraint}}),Object.defineProperty(y,"typeConstraint",{enumerable:!0,get:function(){return Le.typeConstraint}});var _t=o("ujMp");Object.defineProperty(y,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return _t.getServiceIdentifierAsString}});var ot=o("78VC");Object.defineProperty(y,"multiBindToService",{enumerable:!0,get:function(){return ot.multiBindToService}})},"4qC0":function(Ue,y,o){var x=o("NykK"),m=o("Z0cm"),Y=o("ExA7"),z="[object String]";function i(W){return typeof W=="string"||!m(W)&&Y(W)&&x(W)==z}Ue.exports=i},"5Tg0":function(Ue,y,o){(function(x){var m=o("Kz5y"),Y=y&&!y.nodeType&&y,z=Y&&typeof x=="object"&&x&&!x.nodeType&&x,i=z&&z.exports===Y,W=i?m.Buffer:void 0,D=W?W.allocUnsafe:void 0;function Q(ee,ce){if(ce)return ee.slice();var K=ee.length,je=D?D(K):new ee.constructor(K);return ee.copy(je),je}x.exports=Q}).call(this,o("YuTi")(Ue))},"5gLl":function(Ue,y,o){"use strict";o.d(y,"a",function(){return K});var x=o("lSNA"),m=o.n(x),Y=o("LvWW"),z=o.n(Y),i=o("AKIq"),W=o.n(i),D=o("cWyK"),Q=o.n(D);function ee(je,pe){var Ke=Object.keys(je);if(Object.getOwnPropertySymbols){var Pe=Object.getOwnPropertySymbols(je);pe&&(Pe=Pe.filter(function(ht){return Object.getOwnPropertyDescriptor(je,ht).enumerable})),Ke.push.apply(Ke,Pe)}return Ke}function ce(je){for(var pe=1;pe<arguments.length;pe++){var Ke=arguments[pe]!=null?arguments[pe]:{};pe%2?ee(Object(Ke),!0).forEach(function(Pe){m()(je,Pe,Ke[Pe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(je,Object.getOwnPropertyDescriptors(Ke)):ee(Object(Ke)).forEach(function(Pe){Object.defineProperty(je,Pe,Object.getOwnPropertyDescriptor(Ke,Pe))})}return je}function K(je,pe){var Ke=[],Pe={};if(je.features=je.features.filter(function(Le){var _t=Le.geometry;return Le!=null&&_t&&_t.type&&_t.coordinates&&_t.coordinates.length>0}),z()(je,!0),je.features.length===0)return{dataArray:[],featureKeys:Pe};var ht=0;return D.flattenEach(je,function(Le,_t){var ot=Object(i.getCoords)(Le),et=_t,Ze=ce(ce({},Le.properties),{},{coordinates:ot,_id:et});Ke.push(Ze)}),{dataArray:Ke,featureKeys:Pe}}},"5ku3":function(Ue,y,o){"use strict";(function(x){o.d(y,"a",function(){return z});var m=o("U8pU"),Y=o("I0ug");function z(){var W=(typeof x=="undefined"?"undefined":Object(m.a)(x))==="object"&&String(x)==="[object process]"&&!x.browser;return!W||Object(Y.a)()}function i(){return z()&&typeof document!="undefined"}}).call(this,o("Q2Ig"))},"5zYK":function(Ue,y,o){"use strict";o.d(y,"a",function(){return ee});var x=o("lSNA"),m=o.n(x),Y=o("RIqP"),z=o.n(Y),i=o("LvWW"),W=o.n(i);function D(ce,K){var je=Object.keys(ce);if(Object.getOwnPropertySymbols){var pe=Object.getOwnPropertySymbols(ce);K&&(pe=pe.filter(function(Ke){return Object.getOwnPropertyDescriptor(ce,Ke).enumerable})),je.push.apply(je,pe)}return je}function Q(ce){for(var K=1;K<arguments.length;K++){var je=arguments[K]!=null?arguments[K]:{};K%2?D(Object(je),!0).forEach(function(pe){m()(ce,pe,je[pe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ce,Object.getOwnPropertyDescriptors(je)):D(Object(je)).forEach(function(pe){Object.defineProperty(ce,pe,Object.getOwnPropertyDescriptor(je,pe))})}return ce}function ee(ce,K){var je=K.x,pe=K.y,Ke=K.x1,Pe=K.y1,ht=K.coordinates,Le=[];return ce.forEach(function(_t,ot){var et=[];if(je&&pe&&(et=[parseFloat(_t[je]),parseFloat(_t[pe])]),je&&pe&&Ke&&Pe){var Ze=[parseFloat(_t[je]),parseFloat(_t[pe])],At=[parseFloat(_t[Ke]),parseFloat(_t[Pe])];et=[Ze,At]}if(ht){var St="Polygon";Array.isArray(ht[0])||(St="Point"),Array.isArray(ht[0])&&!Array.isArray(ht[0][0])&&(St="LineString");var De={type:St,coordinates:z()(_t[ht])};W()(De,!0),et=De.coordinates}var Ie=Q(Q({},_t),{},{_id:ot,coordinates:et});Le.push(Ie)}),{dataArray:Le}}},"6AGu":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingInSyntax=void 0;var x=o("FV85"),m=o("LKzl"),Y=function(){function z(i){this._binding=i}return z.prototype.inRequestScope=function(){return this._binding.scope=x.BindingScopeEnum.Request,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inSingletonScope=function(){return this._binding.scope=x.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inTransientScope=function(){return this._binding.scope=x.BindingScopeEnum.Transient,new m.BindingWhenOnSyntax(this._binding)},z}();y.BindingInSyntax=Y},"6NqC":function(Ue,y){},"6acW":function(Ue,y,o){var x=o("dt0z"),m=o("gQMU");function Y(z){return m(x(z).toLowerCase())}Ue.exports=Y},"6nK8":function(Ue,y,o){var x=o("dVn5"),m=o("fo6e"),Y=o("dt0z"),z=o("9NmV");function i(W,D,Q){return W=Y(W),D=Q?void 0:D,D===void 0?m(W)?z(W):x(W):W.match(D)||[]}Ue.exports=i},"711d":function(Ue,y){function o(x){return function(m){return m==null?void 0:m[x]}}Ue.exports=o},"78VC":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.multiBindToService=void 0,y.multiBindToService=function(x){return function(m){return function(){for(var Y=[],z=0;z<arguments.length;z++)Y[z]=arguments[z];return Y.forEach(function(i){return x.bind(i).toService(m)})}}}},"7Ix3":function(Ue,y){function o(x){var m=[];if(x!=null)for(var Y in Object(x))m.push(Y);return m}Ue.exports=o},"7tbW":function(Ue,y,o){var x=o("LGYb");function m(Y){return Y&&Y.length?x(Y):[]}Ue.exports=m},"8/Fi":function(Ue,y,o){"use strict";var x=o("J4zp"),m=o.n(x),Y=o("9nhX"),z=o.n(Y),i=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function W(pt){return i.indexOf(pt)}var D=2,Q=4,ee=64,ce=128,K=256,je=512,pe=8192,Ke=16384,Pe=32768,ht=32768*2,Le=131072,_t=262144,ot=524288,et=1048576,Ze=2097152,At=4194304,St=8388608,De=16777216,Ie=16777216*2;function Ge(pt,Wt){return pt=z()(Math.floor(pt),0,255),Wt=z()(Math.floor(Wt),0,255),256*pt+Wt}function dt(pt){var Wt=pt.color,Qt=pt.radius,ur=pt.tileX,oe=pt.tileY,J=pt.shape,H=pt.opacity,Se=pt.stroke,be=pt.strokeWidth,Te=pt.strokeOpacity,me=[],at=[],Jt=[],Mt=[Ge(Wt[0],Wt[1]),Ge(Wt[2],Wt[3])],ve=[Ge(Se[0],Se[1]),Ge(Se[2],Se[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ge){var He=m()(ge,2),st=He[0],Oe=He[1];me.push([].concat(Mt,[(st+1)*St+(Oe+1)*Ze+W(J)*Le+Qt,(ur+512)*ot+(oe+512)*ee])),at.push([].concat(ve,[be,Te])),Jt.push([H,0,0,0])}),{packedBuffer:me,packedBuffer2:at,packedBuffer3:Jt}}function we(pt,Wt){if(pt===0&&!Wt)return 0;if(pt===1&&Wt)return 4294967295;var Qt=Wt?1:0,ur=Math.floor(pt*127);return ur*Ie+Qt*De+ur*Le+Qt*ht+ur*je+Qt*K+ur*D+Qt}},"88Gu":function(Ue,y){var o=800,x=16,m=Date.now;function Y(z){var i=0,W=0;return function(){var D=m(),Q=x-(D-W);if(W=D,Q>0){if(++i>=o)return arguments[0]}else i=0;return z.apply(void 0,arguments)}}Ue.exports=Y},"8ml+":function(Ue,y,o){"use strict";var x=o("h1nZ");o.o(x,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return x.CityBuildingLayer}),o.o(x,"Control")&&o.d(y,"Control",function(){return x.Control}),o.o(x,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return x.HeatmapLayer}),o.o(x,"ImageLayer")&&o.d(y,"ImageLayer",function(){return x.ImageLayer}),o.o(x,"LineLayer")&&o.d(y,"LineLayer",function(){return x.LineLayer}),o.o(x,"Logo")&&o.d(y,"Logo",function(){return x.Logo}),o.o(x,"Marker")&&o.d(y,"Marker",function(){return x.Marker}),o.o(x,"PointLayer")&&o.d(y,"PointLayer",function(){return x.PointLayer}),o.o(x,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return x.PolygonLayer}),o.o(x,"Popup")&&o.d(y,"Popup",function(){return x.Popup}),o.o(x,"RasterLayer")&&o.d(y,"RasterLayer",function(){return x.RasterLayer}),o.o(x,"Scale")&&o.d(y,"Scale",function(){return x.Scale}),o.o(x,"Scene")&&o.d(y,"Scene",function(){return x.Scene}),o.o(x,"Zoom")&&o.d(y,"Zoom",function(){return x.Zoom});var m=o("kQ+U");o.d(y,"Scene",function(){return m.a});var Y=o("sxDa");o.d(y,"CityBuildingLayer",function(){return Y.a}),o.d(y,"HeatmapLayer",function(){return Y.b}),o.d(y,"ImageLayer",function(){return Y.c}),o.d(y,"LineLayer",function(){return Y.d}),o.d(y,"PointLayer",function(){return Y.e}),o.d(y,"PolygonLayer",function(){return Y.f}),o.d(y,"RasterLayer",function(){return Y.g});var z=o("k5/I");o.d(y,"Control",function(){return z.a}),o.d(y,"Logo",function(){return z.b}),o.d(y,"Marker",function(){return z.c}),o.d(y,"Popup",function(){return z.d}),o.d(y,"Scale",function(){return z.e}),o.d(y,"Zoom",function(){return z.f});var i=o("Hel2"),W=o("RL2/")},"8uyu":function(Ue,y){},"9Fde":function(Ue,y,o){"use strict";var x=this&&this.__awaiter||function(ht,Le,_t,ot){function et(Ze){return Ze instanceof _t?Ze:new _t(function(At){At(Ze)})}return new(_t||(_t=Promise))(function(Ze,At){function St(Ge){try{Ie(ot.next(Ge))}catch(dt){At(dt)}}function De(Ge){try{Ie(ot.throw(Ge))}catch(dt){At(dt)}}function Ie(Ge){Ge.done?Ze(Ge.value):et(Ge.value).then(St,De)}Ie((ot=ot.apply(ht,Le||[])).next())})},m=this&&this.__generator||function(ht,Le){var _t={label:0,sent:function(){if(Ze[0]&1)throw Ze[1];return Ze[1]},trys:[],ops:[]},ot,et,Ze,At;return At={next:St(0),throw:St(1),return:St(2)},typeof Symbol=="function"&&(At[Symbol.iterator]=function(){return this}),At;function St(Ie){return function(Ge){return De([Ie,Ge])}}function De(Ie){if(ot)throw new TypeError("Generator is already executing.");for(;_t;)try{if(ot=1,et&&(Ze=Ie[0]&2?et.return:Ie[0]?et.throw||((Ze=et.return)&&Ze.call(et),0):et.next)&&!(Ze=Ze.call(et,Ie[1])).done)return Ze;(et=0,Ze)&&(Ie=[Ie[0]&2,Ze.value]);switch(Ie[0]){case 0:case 1:Ze=Ie;break;case 4:return _t.label++,{value:Ie[1],done:!1};case 5:_t.label++,et=Ie[1],Ie=[0];continue;case 7:Ie=_t.ops.pop(),_t.trys.pop();continue;default:if(!(Ze=_t.trys,Ze=Ze.length>0&&Ze[Ze.length-1])&&(Ie[0]===6||Ie[0]===2)){_t=0;continue}if(Ie[0]===3&&(!Ze||Ie[1]>Ze[0]&&Ie[1]<Ze[3])){_t.label=Ie[1];break}if(Ie[0]===6&&_t.label<Ze[1]){_t.label=Ze[1],Ze=Ie;break}if(Ze&&_t.label<Ze[2]){_t.label=Ze[2],_t.ops.push(Ie);break}Ze[2]&&_t.ops.pop(),_t.trys.pop();continue}Ie=Le.call(ht,_t)}catch(Ge){Ie=[6,Ge],et=0}finally{ot=Ze=0}if(Ie[0]&5)throw Ie[1];return{value:Ie[0]?Ie[1]:void 0,done:!0}}};Object.defineProperty(y,"__esModule",{value:!0}),y.Container=void 0;var Y=o("LgvC"),z=o("MON2"),i=o("FV85"),W=o("xfSm"),D=o("wnjb"),Q=o("h7MG"),ee=o("aPG5"),ce=o("gzZq"),K=o("d9O0"),je=o("ujMp"),pe=o("HpQ9"),Ke=o("AwBQ"),Pe=function(){function ht(Le){var _t=Le||{};if(typeof _t!="object")throw new Error(""+z.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(_t.defaultScope===void 0)_t.defaultScope=i.BindingScopeEnum.Transient;else if(_t.defaultScope!==i.BindingScopeEnum.Singleton&&_t.defaultScope!==i.BindingScopeEnum.Transient&&_t.defaultScope!==i.BindingScopeEnum.Request)throw new Error(""+z.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(_t.autoBindInjectable===void 0)_t.autoBindInjectable=!1;else if(typeof _t.autoBindInjectable!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(_t.skipBaseClassChecks===void 0)_t.skipBaseClassChecks=!1;else if(typeof _t.skipBaseClassChecks!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:_t.autoBindInjectable,defaultScope:_t.defaultScope,skipBaseClassChecks:_t.skipBaseClassChecks},this.id=K.id(),this._bindingDictionary=new Ke.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return ht.merge=function(Le,_t){var ot=new ht,et=Q.getBindingDictionary(ot),Ze=Q.getBindingDictionary(Le),At=Q.getBindingDictionary(_t);function St(De,Ie){De.traverse(function(Ge,dt){dt.forEach(function(we){Ie.add(we.serviceIdentifier,we.clone())})})}return St(Ze,et),St(At,et),ot},ht.prototype.load=function(){for(var Le=[],_t=0;_t<arguments.length;_t++)Le[_t]=arguments[_t];for(var ot=this._getContainerModuleHelpersFactory(),et=0,Ze=Le;et<Ze.length;et++){var At=Ze[et],St=ot(At.id);At.registry(St.bindFunction,St.unbindFunction,St.isboundFunction,St.rebindFunction)}},ht.prototype.loadAsync=function(){for(var Le=[],_t=0;_t<arguments.length;_t++)Le[_t]=arguments[_t];return x(this,void 0,void 0,function(){var ot,et,Ze,At,St;return m(this,function(De){switch(De.label){case 0:ot=this._getContainerModuleHelpersFactory(),et=0,Ze=Le,De.label=1;case 1:return et<Ze.length?(At=Ze[et],St=ot(At.id),[4,At.registry(St.bindFunction,St.unbindFunction,St.isboundFunction,St.rebindFunction)]):[3,4];case 2:De.sent(),De.label=3;case 3:return et++,[3,1];case 4:return[2]}})})},ht.prototype.unload=function(){for(var Le=this,_t=[],ot=0;ot<arguments.length;ot++)_t[ot]=arguments[ot];var et=function(At){return function(St){return St.moduleId===At}};_t.forEach(function(Ze){var At=et(Ze.id);Le._bindingDictionary.removeByCondition(At)})},ht.prototype.bind=function(Le){var _t=this.options.defaultScope||i.BindingScopeEnum.Transient,ot=new Y.Binding(Le,_t);return this._bindingDictionary.add(Le,ot),new ce.BindingToSyntax(ot)},ht.prototype.rebind=function(Le){return this.unbind(Le),this.bind(Le)},ht.prototype.unbind=function(Le){try{this._bindingDictionary.remove(Le)}catch(_t){throw new Error(z.CANNOT_UNBIND+" "+je.getServiceIdentifierAsString(Le))}},ht.prototype.unbindAll=function(){this._bindingDictionary=new Ke.Lookup},ht.prototype.isBound=function(Le){var _t=this._bindingDictionary.hasKey(Le);return!_t&&this.parent&&(_t=this.parent.isBound(Le)),_t},ht.prototype.isBoundNamed=function(Le,_t){return this.isBoundTagged(Le,W.NAMED_TAG,_t)},ht.prototype.isBoundTagged=function(Le,_t,ot){var et=!1;if(this._bindingDictionary.hasKey(Le)){var Ze=this._bindingDictionary.get(Le),At=Q.createMockRequest(this,Le,_t,ot);et=Ze.some(function(St){return St.constraint(At)})}return!et&&this.parent&&(et=this.parent.isBoundTagged(Le,_t,ot)),et},ht.prototype.snapshot=function(){this._snapshots.push(pe.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},ht.prototype.restore=function(){var Le=this._snapshots.pop();if(Le===void 0)throw new Error(z.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Le.bindings,this._middleware=Le.middleware},ht.prototype.createChild=function(Le){var _t=new ht(Le||this.options);return _t.parent=this,_t},ht.prototype.applyMiddleware=function(){for(var Le=[],_t=0;_t<arguments.length;_t++)Le[_t]=arguments[_t];var ot=this._middleware?this._middleware:this._planAndResolve();this._middleware=Le.reduce(function(et,Ze){return Ze(et)},ot)},ht.prototype.applyCustomMetadataReader=function(Le){this._metadataReader=Le},ht.prototype.get=function(Le){return this._get(!1,!1,i.TargetTypeEnum.Variable,Le)},ht.prototype.getTagged=function(Le,_t,ot){return this._get(!1,!1,i.TargetTypeEnum.Variable,Le,_t,ot)},ht.prototype.getNamed=function(Le,_t){return this.getTagged(Le,W.NAMED_TAG,_t)},ht.prototype.getAll=function(Le){return this._get(!0,!0,i.TargetTypeEnum.Variable,Le)},ht.prototype.getAllTagged=function(Le,_t,ot){return this._get(!1,!0,i.TargetTypeEnum.Variable,Le,_t,ot)},ht.prototype.getAllNamed=function(Le,_t){return this.getAllTagged(Le,W.NAMED_TAG,_t)},ht.prototype.resolve=function(Le){var _t=this.createChild();return _t.bind(Le).toSelf(),_t.get(Le)},ht.prototype._getContainerModuleHelpersFactory=function(){var Le=this,_t=function(De,Ie){De._binding.moduleId=Ie},ot=function(De){return function(Ie){var Ge=Le.bind.bind(Le),dt=Ge(Ie);return _t(dt,De),dt}},et=function(De){return function(Ie){var Ge=Le.unbind.bind(Le);Ge(Ie)}},Ze=function(De){return function(Ie){var Ge=Le.isBound.bind(Le);return Ge(Ie)}},At=function(De){return function(Ie){var Ge=Le.rebind.bind(Le),dt=Ge(Ie);return _t(dt,De),dt}};return function(St){return{bindFunction:ot(St),isboundFunction:Ze(St),rebindFunction:At(St),unbindFunction:et(St)}}},ht.prototype._get=function(Le,_t,ot,et,Ze,At){var St=null,De={avoidConstraints:Le,contextInterceptor:function(Ge){return Ge},isMultiInject:_t,key:Ze,serviceIdentifier:et,targetType:ot,value:At};if(this._middleware){if(St=this._middleware(De),St==null)throw new Error(z.INVALID_MIDDLEWARE_RETURN)}else St=this._planAndResolve()(De);return St},ht.prototype._planAndResolve=function(){var Le=this;return function(_t){var ot=Q.plan(Le._metadataReader,Le,_t.isMultiInject,_t.targetType,_t.serviceIdentifier,_t.key,_t.value,_t.avoidConstraints);ot=_t.contextInterceptor(ot);var et=ee.resolve(ot);return et}},ht}();y.Container=Pe},"9NmV":function(Ue,y){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+m+Y,i="\\u2700-\\u27bf",W="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",Q="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ee="\\u2000-\\u206f",ce=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",K="A-Z\\xc0-\\xd6\\xd8-\\xde",je="\\ufe0e\\ufe0f",pe=D+Q+ee+ce,Ke="['\u2019]",Pe="["+pe+"]",ht="["+z+"]",Le="\\d+",_t="["+i+"]",ot="["+W+"]",et="[^"+o+pe+Le+i+W+K+"]",Ze="\\ud83c[\\udffb-\\udfff]",At="(?:"+ht+"|"+Ze+")",St="[^"+o+"]",De="(?:\\ud83c[\\udde6-\\uddff]){2}",Ie="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="["+K+"]",dt="\\u200d",we="(?:"+ot+"|"+et+")",pt="(?:"+Ge+"|"+et+")",Wt="(?:"+Ke+"(?:d|ll|m|re|s|t|ve))?",Qt="(?:"+Ke+"(?:D|LL|M|RE|S|T|VE))?",ur=At+"?",oe="["+je+"]?",J="(?:"+dt+"(?:"+[St,De,Ie].join("|")+")"+oe+ur+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Se="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",be=oe+ur+J,Te="(?:"+[_t,De,Ie].join("|")+")"+be,me=RegExp([Ge+"?"+ot+"+"+Wt+"(?="+[Pe,Ge,"$"].join("|")+")",pt+"+"+Qt+"(?="+[Pe,Ge+we,"$"].join("|")+")",Ge+"?"+we+"+"+Wt,Ge+"+"+Qt,Se,H,Le,Te].join("|"),"g");function at(Jt){return Jt.match(me)||[]}Ue.exports=at},"9lTW":function(Ue,y,o){"use strict";(function(x){var m=o("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function Y(we,pt){if(we===pt)return 0;for(var Wt=we.length,Qt=pt.length,ur=0,oe=Math.min(Wt,Qt);ur<oe;++ur)if(we[ur]!==pt[ur]){Wt=we[ur],Qt=pt[ur];break}return Wt<Qt?-1:Qt<Wt?1:0}function z(we){return x.Buffer&&typeof x.Buffer.isBuffer=="function"?x.Buffer.isBuffer(we):!!(we!=null&&we._isBuffer)}var i=o("MCLT"),W=Object.prototype.hasOwnProperty,D=Array.prototype.slice,Q=function(){return function(){}.name==="foo"}();function ee(we){return Object.prototype.toString.call(we)}function ce(we){return z(we)||typeof x.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(we):we?we instanceof DataView?!0:!!(we.buffer&&we.buffer instanceof ArrayBuffer):!1}var K=Ue.exports=_t,je=/\s*function\s+([^\(\s]*)\s*/;function pe(we){if(!i.isFunction(we))return;if(Q)return we.name;var pt=we.toString(),Wt=pt.match(je);return Wt&&Wt[1]}K.AssertionError=function(pt){this.name="AssertionError",this.actual=pt.actual,this.expected=pt.expected,this.operator=pt.operator,pt.message?(this.message=pt.message,this.generatedMessage=!1):(this.message=ht(this),this.generatedMessage=!0);var Wt=pt.stackStartFunction||Le;if(Error.captureStackTrace)Error.captureStackTrace(this,Wt);else{var Qt=new Error;if(Qt.stack){var ur=Qt.stack,oe=pe(Wt),J=ur.indexOf(`
`+oe);if(J>=0){var H=ur.indexOf(`
`,J+1);ur=ur.substring(H+1)}this.stack=ur}}},i.inherits(K.AssertionError,Error);function Ke(we,pt){return typeof we=="string"?we.length<pt?we:we.slice(0,pt):we}function Pe(we){if(Q||!i.isFunction(we))return i.inspect(we);var pt=pe(we),Wt=pt?": "+pt:"";return"[Function"+Wt+"]"}function ht(we){return Ke(Pe(we.actual),128)+" "+we.operator+" "+Ke(Pe(we.expected),128)}function Le(we,pt,Wt,Qt,ur){throw new K.AssertionError({message:Wt,actual:we,expected:pt,operator:Qt,stackStartFunction:ur})}K.fail=Le;function _t(we,pt){we||Le(we,!0,pt,"==",K.ok)}K.ok=_t,K.equal=function(pt,Wt,Qt){pt!=Wt&&Le(pt,Wt,Qt,"==",K.equal)},K.notEqual=function(pt,Wt,Qt){pt==Wt&&Le(pt,Wt,Qt,"!=",K.notEqual)},K.deepEqual=function(pt,Wt,Qt){ot(pt,Wt,!1)||Le(pt,Wt,Qt,"deepEqual",K.deepEqual)},K.deepStrictEqual=function(pt,Wt,Qt){ot(pt,Wt,!0)||Le(pt,Wt,Qt,"deepStrictEqual",K.deepStrictEqual)};function ot(we,pt,Wt,Qt){if(we===pt)return!0;if(z(we)&&z(pt))return Y(we,pt)===0;if(i.isDate(we)&&i.isDate(pt))return we.getTime()===pt.getTime();if(i.isRegExp(we)&&i.isRegExp(pt))return we.source===pt.source&&we.global===pt.global&&we.multiline===pt.multiline&&we.lastIndex===pt.lastIndex&&we.ignoreCase===pt.ignoreCase;if((we===null||typeof we!="object")&&(pt===null||typeof pt!="object"))return Wt?we===pt:we==pt;if(ce(we)&&ce(pt)&&ee(we)===ee(pt)&&!(we instanceof Float32Array||we instanceof Float64Array))return Y(new Uint8Array(we.buffer),new Uint8Array(pt.buffer))===0;if(z(we)!==z(pt))return!1;Qt=Qt||{actual:[],expected:[]};var ur=Qt.actual.indexOf(we);return ur!==-1&&ur===Qt.expected.indexOf(pt)?!0:(Qt.actual.push(we),Qt.expected.push(pt),Ze(we,pt,Wt,Qt))}function et(we){return Object.prototype.toString.call(we)=="[object Arguments]"}function Ze(we,pt,Wt,Qt){if(we==null||pt===null||pt===void 0)return!1;if(i.isPrimitive(we)||i.isPrimitive(pt))return we===pt;if(Wt&&Object.getPrototypeOf(we)!==Object.getPrototypeOf(pt))return!1;var ur=et(we),oe=et(pt);if(ur&&!oe||!ur&&oe)return!1;if(ur)return we=D.call(we),pt=D.call(pt),ot(we,pt,Wt);var J=dt(we),H=dt(pt),Se,be;if(J.length!==H.length)return!1;for(J.sort(),H.sort(),be=J.length-1;be>=0;be--)if(J[be]!==H[be])return!1;for(be=J.length-1;be>=0;be--)if(Se=J[be],!ot(we[Se],pt[Se],Wt,Qt))return!1;return!0}K.notDeepEqual=function(pt,Wt,Qt){ot(pt,Wt,!1)&&Le(pt,Wt,Qt,"notDeepEqual",K.notDeepEqual)},K.notDeepStrictEqual=At;function At(we,pt,Wt){ot(we,pt,!0)&&Le(we,pt,Wt,"notDeepStrictEqual",At)}K.strictEqual=function(pt,Wt,Qt){pt!==Wt&&Le(pt,Wt,Qt,"===",K.strictEqual)},K.notStrictEqual=function(pt,Wt,Qt){pt===Wt&&Le(pt,Wt,Qt,"!==",K.notStrictEqual)};function St(we,pt){if(!we||!pt)return!1;if(Object.prototype.toString.call(pt)=="[object RegExp]")return pt.test(we);try{if(we instanceof pt)return!0}catch(Wt){}return Error.isPrototypeOf(pt)?!1:pt.call({},we)===!0}function De(we){var pt;try{we()}catch(Wt){pt=Wt}return pt}function Ie(we,pt,Wt,Qt){var ur;if(typeof pt!="function")throw new TypeError('"block" argument must be a function');typeof Wt=="string"&&(Qt=Wt,Wt=null),ur=De(pt),Qt=(Wt&&Wt.name?" ("+Wt.name+").":".")+(Qt?" "+Qt:"."),we&&!ur&&Le(ur,Wt,"Missing expected exception"+Qt);var oe=typeof Qt=="string",J=!we&&i.isError(ur),H=!we&&ur&&!Wt;if((J&&oe&&St(ur,Wt)||H)&&Le(ur,Wt,"Got unwanted exception"+Qt),we&&ur&&Wt&&!St(ur,Wt)||!we&&ur)throw ur}K.throws=function(we,pt,Wt){Ie(!0,we,pt,Wt)},K.doesNotThrow=function(we,pt,Wt){Ie(!1,we,pt,Wt)},K.ifError=function(we){if(we)throw we};function Ge(we,pt){we||Le(we,!0,pt,"==",Ge)}K.strict=m(Ge,K,{equal:K.strictEqual,deepEqual:K.deepStrictEqual,notEqual:K.notStrictEqual,notDeepEqual:K.notDeepStrictEqual}),K.strict.strict=K.strict;var dt=Object.keys||function(we){var pt=[];for(var Wt in we)W.call(we,Wt)&&pt.push(Wt);return pt}}).call(this,o("yLpj"))},"9nhX":function(Ue,y,o){var x=o("g4R6"),m=o("tLB3");function Y(z,i,W){return W===void 0&&(W=i,i=void 0),W!==void 0&&(W=m(W),W=W===W?W:0),i!==void 0&&(i=m(i),i=i===i?i:0),x(m(z),i,W)}Ue.exports=Y},AFH1:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x;(function(m){m.TOPRIGHT="topright",m.TOPLEFT="topleft",m.BOTTOMRIGHT="bottomright",m.BOTTOMLEFT="bottomleft"})(x||(x={}))},AKIq:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var x=o("/rf6");function m(ce){if(!ce)throw new Error("coord is required");if(!Array.isArray(ce)){if(ce.type==="Feature"&&ce.geometry!==null&&ce.geometry.type==="Point")return ce.geometry.coordinates;if(ce.type==="Point")return ce.coordinates}if(Array.isArray(ce)&&ce.length>=2&&!Array.isArray(ce[0])&&!Array.isArray(ce[1]))return ce;throw new Error("coord must be GeoJSON Point or an Array of numbers")}y.getCoord=m;function Y(ce){if(Array.isArray(ce))return ce;if(ce.type==="Feature"){if(ce.geometry!==null)return ce.geometry.coordinates}else if(ce.coordinates)return ce.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}y.getCoords=Y;function z(ce){if(ce.length>1&&x.isNumber(ce[0])&&x.isNumber(ce[1]))return!0;if(Array.isArray(ce[0])&&ce[0].length)return z(ce[0]);throw new Error("coordinates must only contain numbers")}y.containsNumber=z;function i(ce,K,je){if(!K||!je)throw new Error("type and name required");if(!ce||ce.type!==K)throw new Error("Invalid input to "+je+": must be a "+K+", given "+ce.type)}y.geojsonType=i;function W(ce,K,je){if(!ce)throw new Error("No feature passed");if(!je)throw new Error(".featureOf() requires a name");if(!ce||ce.type!=="Feature"||!ce.geometry)throw new Error("Invalid input to "+je+", Feature with geometry required");if(!ce.geometry||ce.geometry.type!==K)throw new Error("Invalid input to "+je+": must be a "+K+", given "+ce.geometry.type)}y.featureOf=W;function D(ce,K,je){if(!ce)throw new Error("No featureCollection passed");if(!je)throw new Error(".collectionOf() requires a name");if(!ce||ce.type!=="FeatureCollection")throw new Error("Invalid input to "+je+", FeatureCollection required");for(var pe=0,Ke=ce.features;pe<Ke.length;pe++){var Pe=Ke[pe];if(!Pe||Pe.type!=="Feature"||!Pe.geometry)throw new Error("Invalid input to "+je+", Feature with geometry required");if(!Pe.geometry||Pe.geometry.type!==K)throw new Error("Invalid input to "+je+": must be a "+K+", given "+Pe.geometry.type)}}y.collectionOf=D;function Q(ce){return ce.type==="Feature"?ce.geometry:ce}y.getGeom=Q;function ee(ce,K){return ce.type==="FeatureCollection"?"FeatureCollection":ce.type==="GeometryCollection"?"GeometryCollection":ce.type==="Feature"&&ce.geometry!==null?ce.geometry.type:ce.type}y.getType=ee},APxj:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var x=o("Ucsi");function m(Y,z){z===void 0&&(z=!0);var i=x.makePropertyInjectDecorator(Y,z),W=x.makePropertyInjectNamedDecorator(Y,z),D=x.makePropertyInjectTaggedDecorator(Y,z),Q=x.makePropertyMultiInjectDecorator(Y,z);return{lazyInject:i,lazyInjectNamed:W,lazyInjectTagged:D,lazyMultiInject:Q}}y.default=m},AwBQ:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Lookup=void 0;var x=o("MON2"),m=function(){function Y(){this._map=new Map}return Y.prototype.getMap=function(){return this._map},Y.prototype.add=function(z,i){if(z==null)throw new Error(x.NULL_ARGUMENT);if(i==null)throw new Error(x.NULL_ARGUMENT);var W=this._map.get(z);W!==void 0?(W.push(i),this._map.set(z,W)):this._map.set(z,[i])},Y.prototype.get=function(z){if(z==null)throw new Error(x.NULL_ARGUMENT);var i=this._map.get(z);if(i!==void 0)return i;throw new Error(x.KEY_NOT_FOUND)},Y.prototype.remove=function(z){if(z==null)throw new Error(x.NULL_ARGUMENT);if(!this._map.delete(z))throw new Error(x.KEY_NOT_FOUND)},Y.prototype.removeByCondition=function(z){var i=this;this._map.forEach(function(W,D){var Q=W.filter(function(ee){return!z(ee)});Q.length>0?i._map.set(D,Q):i._map.delete(D)})},Y.prototype.hasKey=function(z){if(z==null)throw new Error(x.NULL_ARGUMENT);return this._map.has(z)},Y.prototype.clone=function(){var z=new Y;return this._map.forEach(function(i,W){i.forEach(function(D){return z.add(W,D.clone())})}),z},Y.prototype.traverse=function(z){this._map.forEach(function(i,W){z(W,i)})},Y}();y.Lookup=m},"B6l+":function(Ue,y,o){var x=o("Sq3C"),m=o("Z1HP"),Y=o("Sxd8"),z=o("dt0z");function i(W,D,Q){W=z(W),D=Y(D);var ee=D?m(W):0;return D&&ee<D?W+x(D-ee,Q):W}Ue.exports=i},BGjm:function(Ue,y){Ue.exports=o;function o(x,m){m||(m=document);var Y=m.head||m.getElementsByTagName("head")[0];if(!Y){Y=m.createElement("head");var z=m.body||m.getElementsByTagName("body")[0];z?z.parentNode.insertBefore(Y,z):m.documentElement.appendChild(Y)}var i=m.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=x:i.appendChild(m.createTextNode(x)),Y.appendChild(i),i}},BMrR:function(Ue,y,o){"use strict";var x=o("qrJ5");y.a=x.a},BkRI:function(Ue,y,o){var x=o("OBhP"),m=1,Y=4;function z(i){return x(i,m|Y)}Ue.exports=z},BpBL:function(Ue,y,o){"use strict";o.d(y,"a",function(){return m});var x=o("Hel2");function m(z,i){var W=i.extent,D=new Promise(function(ee){Y(z,function(ce){ee(ce)})}),Q={images:D,_id:1,dataArray:[{_id:0,coordinates:[[W[0],W[1]],[W[2],W[3]]]}]};return Q}function Y(z,i){var W=z,D=[];if(typeof W=="string")Object(x.o)({url:W},function(ce,K){D.push(K),i(D)});else{var Q=W.length,ee=0;W.forEach(function(ce){Object(x.o)({url:ce},function(K,je){ee++,D.push(je),ee===Q&&i(D)})})}return m}},CZoQ:function(Ue,y){function o(x,m,Y){for(var z=Y-1,i=x.length;++z<i;)if(x[z]===m)return z;return-1}Ue.exports=o},"D+ow":function(Ue,y){},D9lx:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingInWhenOnSyntax=void 0;var x=o("6AGu"),m=o("406g"),Y=o("z4Hk"),z=function(){function i(W){this._binding=W,this._bindingWhenSyntax=new Y.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new m.BindingOnSyntax(this._binding),this._bindingInSyntax=new x.BindingInSyntax(W)}return i.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},i.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},i.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},i.prototype.when=function(W){return this._bindingWhenSyntax.when(W)},i.prototype.whenTargetNamed=function(W){return this._bindingWhenSyntax.whenTargetNamed(W)},i.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},i.prototype.whenTargetTagged=function(W,D){return this._bindingWhenSyntax.whenTargetTagged(W,D)},i.prototype.whenInjectedInto=function(W){return this._bindingWhenSyntax.whenInjectedInto(W)},i.prototype.whenParentNamed=function(W){return this._bindingWhenSyntax.whenParentNamed(W)},i.prototype.whenParentTagged=function(W,D){return this._bindingWhenSyntax.whenParentTagged(W,D)},i.prototype.whenAnyAncestorIs=function(W){return this._bindingWhenSyntax.whenAnyAncestorIs(W)},i.prototype.whenNoAncestorIs=function(W){return this._bindingWhenSyntax.whenNoAncestorIs(W)},i.prototype.whenAnyAncestorNamed=function(W){return this._bindingWhenSyntax.whenAnyAncestorNamed(W)},i.prototype.whenAnyAncestorTagged=function(W,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(W,D)},i.prototype.whenNoAncestorNamed=function(W){return this._bindingWhenSyntax.whenNoAncestorNamed(W)},i.prototype.whenNoAncestorTagged=function(W,D){return this._bindingWhenSyntax.whenNoAncestorTagged(W,D)},i.prototype.whenAnyAncestorMatches=function(W){return this._bindingWhenSyntax.whenAnyAncestorMatches(W)},i.prototype.whenNoAncestorMatches=function(W){return this._bindingWhenSyntax.whenNoAncestorMatches(W)},i.prototype.onActivation=function(W){return this._bindingOnSyntax.onActivation(W)},i}();y.BindingInWhenOnSyntax=z},"Dw+G":function(Ue,y,o){var x=o("juv8"),m=o("mTTR");function Y(z,i){return z&&x(i,m(i),z)}Ue.exports=Y},DzJC:function(Ue,y,o){var x=o("sEfC"),m=o("GoyQ"),Y="Expected a function";function z(i,W,D){var Q=!0,ee=!0;if(typeof i!="function")throw new TypeError(Y);return m(D)&&(Q="leading"in D?!!D.leading:Q,ee="trailing"in D?!!D.trailing:ee),x(i,W,{leading:Q,maxWait:W,trailing:ee})}Ue.exports=z},EA7m:function(Ue,y,o){var x=o("zZ0H"),m=o("Ioao"),Y=o("wclG");function z(i,W){return Y(m(i,W,x),i+"")}Ue.exports=z},EEGq:function(Ue,y,o){var x=o("juv8"),m=o("oCl/");function Y(z,i){return x(z,m(z),i)}Ue.exports=Y},EfZ0:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(Ue,y,o){var x=o("bahg"),m=o("quyA"),Y=o("0JQy");function z(i){return m(i)?Y(i):x(i)}Ue.exports=z},FI6e:function(Ue,y){},FV85:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.TargetTypeEnum=y.BindingTypeEnum=y.BindingScopeEnum=void 0;var x={Request:"Request",Singleton:"Singleton",Transient:"Transient"};y.BindingScopeEnum=x;var m={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};y.BindingTypeEnum=m;var Y={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};y.TargetTypeEnum=Y},FmoU:function(Ue,y,o){"use strict";o.d(y,"a",function(){return et}),o.d(y,"b",function(){return De});var x=function(J,H,Se){J.prototype=H.prototype=Se,Se.constructor=J};function m(J,H){var Se=Object.create(J.prototype);for(var be in H)Se[be]=H[be];return Se}function Y(){}var z=.7,i=1/z,W="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Q="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ee=/^#([0-9a-f]{3,8})$/,ce=new RegExp("^rgb\\("+[W,W,W]+"\\)$"),K=new RegExp("^rgb\\("+[Q,Q,Q]+"\\)$"),je=new RegExp("^rgba\\("+[W,W,W,D]+"\\)$"),pe=new RegExp("^rgba\\("+[Q,Q,Q,D]+"\\)$"),Ke=new RegExp("^hsl\\("+[D,Q,Q]+"\\)$"),Pe=new RegExp("^hsla\\("+[D,Q,Q,D]+"\\)$"),ht={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};x(Y,et,{copy:function(H){return Object.assign(new this.constructor,this,H)},displayable:function(){return this.rgb().displayable()},hex:Le,formatHex:Le,formatHsl:_t,formatRgb:ot,toString:ot});function Le(){return this.rgb().formatHex()}function _t(){return Wt(this).formatHsl()}function ot(){return this.rgb().formatRgb()}function et(J){var H,Se;return J=(J+"").trim().toLowerCase(),(H=ee.exec(J))?(Se=H[1].length,H=parseInt(H[1],16),Se===6?Ze(H):Se===3?new Ie(H>>8&15|H>>4&240,H>>4&15|H&240,(H&15)<<4|H&15,1):Se===8?At(H>>24&255,H>>16&255,H>>8&255,(H&255)/255):Se===4?At(H>>12&15|H>>8&240,H>>8&15|H>>4&240,H>>4&15|H&240,((H&15)<<4|H&15)/255):null):(H=ce.exec(J))?new Ie(H[1],H[2],H[3],1):(H=K.exec(J))?new Ie(H[1]*255/100,H[2]*255/100,H[3]*255/100,1):(H=je.exec(J))?At(H[1],H[2],H[3],H[4]):(H=pe.exec(J))?At(H[1]*255/100,H[2]*255/100,H[3]*255/100,H[4]):(H=Ke.exec(J))?pt(H[1],H[2]/100,H[3]/100,1):(H=Pe.exec(J))?pt(H[1],H[2]/100,H[3]/100,H[4]):ht.hasOwnProperty(J)?Ze(ht[J]):J==="transparent"?new Ie(NaN,NaN,NaN,0):null}function Ze(J){return new Ie(J>>16&255,J>>8&255,J&255,1)}function At(J,H,Se,be){return be<=0&&(J=H=Se=NaN),new Ie(J,H,Se,be)}function St(J){return J instanceof Y||(J=et(J)),J?(J=J.rgb(),new Ie(J.r,J.g,J.b,J.opacity)):new Ie}function De(J,H,Se,be){return arguments.length===1?St(J):new Ie(J,H,Se,be==null?1:be)}function Ie(J,H,Se,be){this.r=+J,this.g=+H,this.b=+Se,this.opacity=+be}x(Ie,De,m(Y,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new Ie(this.r*H,this.g*H,this.b*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new Ie(this.r*H,this.g*H,this.b*H,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ge,formatHex:Ge,formatRgb:dt,toString:dt}));function Ge(){return"#"+we(this.r)+we(this.g)+we(this.b)}function dt(){var J=this.opacity;return J=isNaN(J)?1:Math.max(0,Math.min(1,J)),(J===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(J===1?")":", "+J+")")}function we(J){return J=Math.max(0,Math.min(255,Math.round(J)||0)),(J<16?"0":"")+J.toString(16)}function pt(J,H,Se,be){return be<=0?J=H=Se=NaN:Se<=0||Se>=1?J=H=NaN:H<=0&&(J=NaN),new ur(J,H,Se,be)}function Wt(J){if(J instanceof ur)return new ur(J.h,J.s,J.l,J.opacity);if(J instanceof Y||(J=et(J)),!J)return new ur;if(J instanceof ur)return J;J=J.rgb();var H=J.r/255,Se=J.g/255,be=J.b/255,Te=Math.min(H,Se,be),me=Math.max(H,Se,be),at=NaN,Jt=me-Te,Mt=(me+Te)/2;return Jt?(H===me?at=(Se-be)/Jt+(Se<be)*6:Se===me?at=(be-H)/Jt+2:at=(H-Se)/Jt+4,Jt/=Mt<.5?me+Te:2-me-Te,at*=60):Jt=Mt>0&&Mt<1?0:at,new ur(at,Jt,Mt,J.opacity)}function Qt(J,H,Se,be){return arguments.length===1?Wt(J):new ur(J,H,Se,be==null?1:be)}function ur(J,H,Se,be){this.h=+J,this.s=+H,this.l=+Se,this.opacity=+be}x(ur,Qt,m(Y,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new ur(this.h,this.s,this.l*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new ur(this.h,this.s,this.l*H,this.opacity)},rgb:function(){var H=this.h%360+(this.h<0)*360,Se=isNaN(H)||isNaN(this.s)?0:this.s,be=this.l,Te=be+(be<.5?be:1-be)*Se,me=2*be-Te;return new Ie(oe(H>=240?H-240:H+120,me,Te),oe(H,me,Te),oe(H<120?H+240:H-120,me,Te),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var H=this.opacity;return H=isNaN(H)?1:Math.max(0,Math.min(1,H)),(H===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(H===1?")":", "+H+")")}}));function oe(J,H,Se){return(J<60?H+(Se-H)*J/60:J<180?Se:J<240?H+(Se-H)*(240-J)/60:H)*255}},G6z8:function(Ue,y,o){var x=o("fR/l"),m=o("oCl/"),Y=o("mTTR");function z(i){return x(i,Y,m)}Ue.exports=z},GXnB:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Metadata=void 0;var x=o("xfSm"),m=function(){function Y(z,i){this.key=z,this.value=i}return Y.prototype.toString=function(){return this.key===x.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},Y}();y.Metadata=m},Gi0A:function(Ue,y,o){var x=o("QqLw"),m=o("ExA7"),Y="[object Map]";function z(i){return m(i)&&x(i)==Y}Ue.exports=z},HTcj:function(Ue,y,o){"use strict";var x=o("GNNt"),m=o("wEI+"),Y={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"},z=o("q1tI"),i=o.n(z),W=o("TSYQ"),D=o.n(W),Q=o("jYQm"),ee=function(je){var pe=Object(z.useContext)(Q.a),Ke=je.children,Pe=je.contentWidth,ht=je.className,Le=je.style,_t=Object(z.useContext)(m.b.ConfigContext),ot=_t.getPrefixCls,et=je.prefixCls||ot("pro"),Ze=Pe||pe.contentWidth,At="".concat(et,"-grid-content");return i.a.createElement("div",{className:D()(At,ht,{wide:Ze==="Fixed"}),style:Le},i.a.createElement("div",{className:"".concat(et,"-grid-content-children")},Ke))},ce=y.a=ee},Hel2:function(Ue,y,o){"use strict";o.d(y,"o",function(){return Mt}),o.d(y,"m",function(){return Oe}),o.d(y,"p",function(){return q}),o.d(y,"d",function(){return it}),o.d(y,"q",function(){return $}),o.d(y,"r",function(){return ne}),o.d(y,"j",function(){return tt}),o.d(y,"h",function(){return kt}),o.d(y,"b",function(){return dr}),o.d(y,"i",function(){return Ye}),o.d(y,"s",function(){return bt}),o.d(y,"k",function(){return Et}),o.d(y,"l",function(){return ze}),o.d(y,"n",function(){return vt}),o.d(y,"f",function(){return yt}),o.d(y,"e",function(){return Ht}),o.d(y,"g",function(){return hr}),o.d(y,"a",function(){return x}),o.d(y,"c",function(){return m});var x={};o.r(x),o.d(x,"getContainer",function(){return W}),o.d(x,"trim",function(){return D}),o.d(x,"splitWords",function(){return Q}),o.d(x,"create",function(){return ce}),o.d(x,"remove",function(){return K}),o.d(x,"addClass",function(){return je}),o.d(x,"removeClass",function(){return pe}),o.d(x,"hasClass",function(){return Ke}),o.d(x,"setClass",function(){return Pe}),o.d(x,"getClass",function(){return ht}),o.d(x,"empty",function(){return Le}),o.d(x,"setTransform",function(){return ot}),o.d(x,"triggerResize",function(){return et}),o.d(x,"printCanvas",function(){return Ze});var m={};o.r(m),o.d(m,"sum",function(){return Bn}),o.d(m,"max",function(){return Hr}),o.d(m,"min",function(){return gr}),o.d(m,"mean",function(){return zn}),o.d(m,"mode",function(){return oa}),o.d(m,"statMap",function(){return $n}),o.d(m,"getColumn",function(){return Yn}),o.d(m,"getSatByColumn",function(){return On});function Y(U){var Z=131,le=137,xe=0;U+="x";for(var ut=Math.floor(9007199254740991/le),wt=0;wt<U.length;wt++)xe>ut&&(xe=Math.floor(xe/le)),xe=xe*Z+U.charCodeAt(wt);return xe}function z(U){U=U.toString();for(var Z=5381,le=U.length;le;)Z=Z*33^U.charCodeAt(--le);return Z>>>0}var i=window.document.documentElement.style;function W(U){var Z=U;return typeof U=="string"&&(Z=document.getElementById(U)),Z}function D(U){return U.trim?U.trim():U.replace(/^\s+|\s+$/g,"")}function Q(U){return D(U).split(/\s+/)}function ee(U){if(!i)return U[0];for(var Z in U)if(U[Z]&&U[Z]in i)return U[Z];return U[0]}function ce(U,Z,le){var xe=document.createElement(U);return xe.className=Z||"",le&&le.appendChild(xe),xe}function K(U){var Z=U.parentNode;Z&&Z.removeChild(U)}function je(U,Z){if(U.classList!==void 0)for(var le=Q(Z),xe=0,ut=le.length;xe<ut;xe++)U.classList.add(le[xe]);else if(!Ke(U,Z)){var wt=ht(U);Pe(U,(wt?wt+" ":"")+Z)}}function pe(U,Z){U.classList!==void 0?U.classList.remove(Z):Pe(U,D((" "+ht(U)+" ").replace(" "+Z+" "," ")))}function Ke(U,Z){if(U.classList!==void 0)return U.classList.contains(Z);var le=ht(U);return le.length>0&&new RegExp("(^|\\s)"+Z+"(\\s|$)").test(le)}function Pe(U,Z){U instanceof HTMLElement?U.className=Z:U.className.baseVal=Z}function ht(U){return U instanceof SVGElement&&(U=U.correspondingElement),U.className.baseVal===void 0?U.className:U.className.baseVal}function Le(U){for(;U&&U.firstChild;)U.removeChild(U.firstChild)}var _t=ee(["transform","WebkitTransform"]);function ot(U,Z){U.style[_t]=Z}function et(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var U=window.document.createEvent("UIEvents");U.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(U)}}function Ze(U){var Z=["padding: "+(U.height/2-8)+"px "+U.width/2+"px;","line-height: "+U.height+"px;","background-image: url("+U.toDataURL()+");"];console.log(`%c
`,Z.join(""))}var At=o("lwsE"),St=o.n(At),De=o("W8MJ"),Ie=o.n(De),Ge=o("7W2i"),dt=o.n(Ge),we=o("a1gu"),pt=o.n(we),Wt=o("Nsbk"),Qt=o.n(Wt),ur=o("oShl"),oe=o.n(ur);function J(U){var Z=H();return function(){var xe=Qt()(U),ut;if(Z){var wt=Qt()(this).constructor;ut=Reflect.construct(xe,arguments,wt)}else ut=xe.apply(this,arguments);return pt()(this,ut)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}var Se=function(U){dt()(le,U);var Z=J(le);function le(xe,ut,wt){var Bt;return St()(this,le),Bt=Z.call(this,xe),Bt.status=void 0,Bt.url=void 0,Bt.status=ut,Bt.url=wt,Bt.name=Bt.constructor.name,Bt.message=xe,Bt}return Ie()(le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),le}(oe()(Error));function be(U){var Z=new XMLHttpRequest;Z.open("GET",U.url,!0);for(var le in U.headers)U.headers.hasOwnProperty(le)&&Z.setRequestHeader(le,U.headers[le]);return Z.withCredentials=U.credentials==="include",Z}var Te=function(Z,le){var xe=be(Z);return xe.setRequestHeader("Accept","application/json"),xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){if(xe.status>=200&&xe.status<300&&xe.response){var ut;try{ut=JSON.parse(xe.response)}catch(wt){return le(wt)}le(null,ut)}else xe.status===401?le(new Se("".concat(xe.statusText),xe.status,Z.url)):le(new Se(xe.statusText,xe.status,Z.url))},xe.send(),xe},me=function(Z,le){var xe=be(Z);return xe.responseType="arraybuffer",xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){var ut=xe.response;if(ut.byteLength===0&&xe.status===200)return le(new Error("http status 200 returned without content."));xe.status>=200&&xe.status<300&&xe.response?le(null,{data:ut,cacheControl:xe.getResponseHeader("Cache-Control"),expires:xe.getResponseHeader("Expires")}):le(new Se(xe.statusText,xe.status,Z.url))},xe.send(),xe};function at(U){var Z=window.document.createElement("a");return Z.href=U,Z.protocol===window.document.location.protocol&&Z.host===window.document.location.host}var Jt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Mt=function(Z,le){return me(Z,function(xe,ut){if(xe)le(xe);else if(ut){var wt=new window.Image;wt.crossOrigin="anonymous";var Bt=window.URL||window.webkitURL;wt.onload=function(){le(null,wt),Bt.revokeObjectURL(wt.src)};var Xe=new window.Blob([new Uint8Array(ut.data)],{type:"image/png"});wt.src=ut.data.byteLength?Bt.createObjectURL(Xe):Jt}})},ve=o("J4zp"),ge=o.n(ve),He=o("/rf6"),st=2*Math.PI*6378137/2;function Oe(U){var Z=[Infinity,Infinity,-Infinity,-Infinity];return U.forEach(function(le){var xe=le.coordinates;gt(Z,xe)}),Z}function gt(U,Z){return Array.isArray(Z[0])?Z.forEach(function(le){gt(U,le)}):(U[0]>Z[0]&&(U[0]=Z[0]),U[1]>Z[1]&&(U[1]=Z[1]),U[2]<Z[0]&&(U[2]=Z[0]),U[3]<Z[1]&&(U[3]=Z[1])),U}function C(U,Z){return R(U,Z)}function R(U,Z){return Array.isArray(U[0])?U.map(function(le){return R(le,Z)}):Z(U)}function q(U){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};U=Tt(U,Z);var xe=U[0],ut=U[1],wt=xe*st/180,Bt=Math.log(Math.tan((90+ut)*Math.PI/360))/(Math.PI/180);return Bt=Bt*st/180,le.enable&&(wt=Number(wt.toFixed(le.decimal)),Bt=Number(Bt.toFixed(le.decimal))),U.length===3?[wt,Bt,U[2]]:[wt,Bt]}function fe(U){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,le=U[0],xe=U[1],ut=le/st*180,wt=xe/st*180;return wt=180/Math.PI*(2*Math.atan(Math.exp(wt*Math.PI/180))-Math.PI/2),Z!=null&&(ut=Number(ut.toFixed(Z)),wt=Number(wt.toFixed(Z))),U.length===3?[ut,wt,U[2]]:[ut,wt]}function We(U){if(U==null)throw new Error("lng is required");return(U>180||U<-180)&&(U=U%360,U>180&&(U=-360+U),U<-180&&(U=360+U),U===0&&(U=0)),U}function qe(U){if(U==null)throw new Error("lat is required");return(U>90||U<-90)&&(U=U%180,U>90&&(U=-180+U),U<-90&&(U=180+U),U===0&&(U=0)),U}function Tt(U,Z){if(Z===!1)return U;var le=We(U[0]),xe=qe(U[1]);return xe>85&&(xe=85),xe<-85&&(xe=-85),U.length===3?[le,xe,U[2]]:[le,xe]}function it(U){var Z=85.0511287798,le=Math.max(Math.min(Z,U[1]),-Z),xe=256<<20,ut=Math.PI/180,wt=U[0]*ut,Bt=le*ut;Bt=Math.log(Math.tan(Math.PI/4+Bt/2));var Xe=.5/Math.PI,Lt=.5,lr=-.5/Math.PI;return ut=.5,wt=xe*(Xe*wt+Lt),Bt=xe*(lr*Bt+ut),[Math.floor(wt),Math.floor(Bt)]}function Ut(U){var Z=.5/Math.PI,le=.5,xe=-.5/Math.PI,ut=.5,wt=256<<20,Bt=ge()(U,2),Xe=Bt[0],Lt=Bt[1];Xe=(Xe/wt-le)/Z,Lt=(Lt/wt-ut)/xe,Lt=(Math.atan(Math.pow(Math.E,Lt))-Math.PI/4)*2,ut=Math.PI/180;var lr=Lt/ut,zr=Xe/ut;return[zr,lr]}function $(U,Z,le){var xe=Object(He.degreesToRadians)(Z[1]-U[1]),ut=Object(He.degreesToRadians)(Z[0]-U[0]),wt=Object(He.degreesToRadians)(U[1]),Bt=Object(He.degreesToRadians)(Z[1]),Xe=Math.pow(Math.sin(xe/2),2)+Math.pow(Math.sin(ut/2),2)*Math.cos(wt)*Math.cos(Bt);return Object(He.radiansToLength)(2*Math.atan2(Math.sqrt(Xe),Math.sqrt(1-Xe)),le="meters")}function Qe(U){var Z=Math.PI/180,le=85.0511287798,xe=6378137,ut=Math.max(Math.min(le,U[1]),-le),wt=Math.sin(ut*Z),Bt=xe*U[0]*Z,Xe=xe*Math.log((1+wt)/(1-wt))/2;return[Bt,Xe]}function ne(U,Z){var le=Math.abs(U[1][1]-U[0][1])*Z,xe=Math.abs(U[1][0]-U[0][0])*Z;return[[U[0][0]-xe,U[0][1]-le],[U[1][0]+xe,U[1][1]+le]]}function tt(U,Z){return U[0][0]<=Z[0][0]&&U[0][1]<=Z[0][1]&&U[1][0]>=Z[1][0]&&U[1][1]>=Z[1][1]}function kt(U){return[[U[0],U[1]],[U[2],U[3]]]}var dr=function(){function U(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,le=arguments.length>1?arguments[1]:void 0;St()(this,U),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=Z,this.destroy=le||this.defaultDestroy,this.order=[],this.clear()}return Ie()(U,[{key:"clear",value:function(){var le=this;this.order.forEach(function(xe){le.delete(xe)}),this.cache={},this.order=[]}},{key:"get",value:function(le){var xe=this.cache[le];return xe&&(this.deleteOrder(le),this.appendOrder(le)),xe}},{key:"set",value:function(le,xe){this.cache[le]?(this.delete(le),this.cache[le]=xe,this.appendOrder(le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[le]=xe,this.appendOrder(le))}},{key:"delete",value:function(le){var xe=this.cache[le];xe&&(this.deleteCache(le),this.deleteOrder(le),this.destroy(xe,le))}},{key:"deleteCache",value:function(le){delete this.cache[le]}},{key:"deleteOrder",value:function(le){var xe=this.order.findIndex(function(ut){return ut===le});xe>=0&&this.order.splice(xe,1)}},{key:"appendOrder",value:function(le){this.order.push(le)}},{key:"defaultDestroy",value:function(le,xe){return null}}]),U}();function Ye(U,Z){U.forEach(function(le){if(!Z[le])return;Z[le]=Z[le].bind(Z)})}var xt=o("FmoU");function bt(U){var Z=xt.a(U),le=[0,0,0,0];return Z!=null&&(le[0]=Z.r/255,le[1]=Z.g/255,le[2]=Z.b/255,le[3]=Z.opacity),le}function Et(U){var Z=U&&U[0],le=U&&U[1],xe=U&&U[2],ut=Z+le*256+xe*65536-1;return ut}function ze(U){return[U+1&255,U+1>>8&255,U+1>>8>>8&255]}function vt(U){var Z=document.createElement("canvas"),le=Z.getContext("2d");Z.width=256,Z.height=1;for(var xe=le.createLinearGradient(0,0,256,1),ut=null,wt=U.positions[0],Bt=U.positions[U.positions.length-1],Xe=0;Xe<U.colors.length;++Xe){var Lt=(U.positions[Xe]-wt)/(Bt-wt);xe.addColorStop(Lt,U.colors[Xe])}return le.fillStyle=xe,le.fillRect(0,0,256,1),ut=new Uint8ClampedArray(le.getImageData(0,0,256,1).data),new ImageData(ut,256,1)}var yt;(function(U){U.CENTER="center",U.TOP="top",U["TOP-LEFT"]="top-left",U["TOP-RIGHT"]="top-right",U.BOTTOM="bottom",U["BOTTOM-LEFT"]="bottom-left",U.LEFT="left",U.RIGHT="right"})(yt||(yt={}));var Ht={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hr(U,Z,le){var xe=U.classList;for(var ut in Ht)Ht.hasOwnProperty(ut)&&xe.remove("l7-".concat(le,"-anchor-").concat(ut));xe.add("l7-".concat(le,"-anchor-").concat(Z))}function Hr(U){if(U.length===0)throw new Error("max requires at least one data point");for(var Z=U[0],le=1;le<U.length;le++)U[le]>Z&&(Z=U[le]);return Z*1}function gr(U){if(U.length===0)throw new Error("min requires at least one data point");for(var Z=U[0],le=1;le<U.length;le++)U[le]<Z&&(Z=U[le]);return Z*1}function Bn(U){if(U.length===0)return 0;for(var Z=U[0]*1,le=1;le<U.length;le++)Z+=U[le]*1;return Z}function zn(U){if(U.length===0)throw new Error("mean requires at least one data point");return Bn(U)/U.length}function oa(U){if(U.length===0)throw new Error("mean requires at least one data point");if(U.length<3)return U[0];U.sort();for(var Z=U[0],le=NaN,xe=0,ut=1,wt=1;wt<U.length+1;wt++)U[wt]!==Z?(ut>xe&&(xe=ut,le=Z),ut=1,Z=U[wt]):ut++;return le*1}var $n={min:gr,max:Hr,mean:zn,sum:Bn,mode:oa};function Yn(U,Z){return U.map(function(le){return le[Z]})}function On(U,Z){return $n[U](Z)}},HpQ9:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.ContainerSnapshot=void 0;var x=function(){function m(){}return m.of=function(Y,z){var i=new m;return i.bindings=Y,i.middleware=z,i},m}();y.ContainerSnapshot=x},HthE:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x}),o.d(y,"b",function(){return m});var x;(function(Y){Y[Y.LNGLAT=1]="LNGLAT",Y[Y.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",Y[Y.VECTOR_TILE=3]="VECTOR_TILE",Y[Y.IDENTITY=4]="IDENTITY",Y[Y.P20=5]="P20",Y[Y.P20_OFFSET=6]="P20_OFFSET",Y[Y.METER_OFFSET=7]="METER_OFFSET"})(x||(x={}));var m={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(Ue,y,o){"use strict";(function(x){o.d(y,"a",function(){return Y});var m=o("U8pU");function Y(z){if(typeof window!="undefined"&&Object(m.a)(window.process)==="object"&&window.process.type==="renderer")return!0;if(typeof x!="undefined"&&Object(m.a)(x.versions)==="object"&&Boolean(x.versions.electron))return!0;var i=(typeof navigator=="undefined"?"undefined":Object(m.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,W=z||i;return!!(W&&W.indexOf("Electron")>=0)}}).call(this,o("Q2Ig"))},IOcx:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x}),o.d(y,"b",function(){return pt}),o.d(y,"c",function(){return Wt}),o.d(y,"d",function(){return Qt}),o.d(y,"e",function(){return ur});var x={};o.r(x),o.d(x,"create",function(){return Y}),o.d(x,"clone",function(){return z}),o.d(x,"copy",function(){return i}),o.d(x,"identity",function(){return W}),o.d(x,"fromValues",function(){return D}),o.d(x,"set",function(){return Q}),o.d(x,"transpose",function(){return ee}),o.d(x,"invert",function(){return ce}),o.d(x,"adjoint",function(){return K}),o.d(x,"determinant",function(){return je}),o.d(x,"multiply",function(){return pe}),o.d(x,"rotate",function(){return Ke}),o.d(x,"scale",function(){return Pe}),o.d(x,"fromRotation",function(){return ht}),o.d(x,"fromScaling",function(){return Le}),o.d(x,"str",function(){return _t}),o.d(x,"frob",function(){return ot}),o.d(x,"LDU",function(){return et}),o.d(x,"add",function(){return Ze}),o.d(x,"subtract",function(){return At}),o.d(x,"exactEquals",function(){return St}),o.d(x,"equals",function(){return De}),o.d(x,"multiplyScalar",function(){return Ie}),o.d(x,"multiplyScalarAndAdd",function(){return Ge}),o.d(x,"mul",function(){return dt}),o.d(x,"sub",function(){return we});var m=o("yU0y");function Y(){var oe=new m.a(4);return m.a!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}function z(oe){var J=new m.a(4);return J[0]=oe[0],J[1]=oe[1],J[2]=oe[2],J[3]=oe[3],J}function i(oe,J){return oe[0]=J[0],oe[1]=J[1],oe[2]=J[2],oe[3]=J[3],oe}function W(oe){return oe[0]=1,oe[1]=0,oe[2]=0,oe[3]=1,oe}function D(oe,J,H,Se){var be=new m.a(4);return be[0]=oe,be[1]=J,be[2]=H,be[3]=Se,be}function Q(oe,J,H,Se,be){return oe[0]=J,oe[1]=H,oe[2]=Se,oe[3]=be,oe}function ee(oe,J){if(oe===J){var H=J[1];oe[1]=J[2],oe[2]=H}else oe[0]=J[0],oe[1]=J[2],oe[2]=J[1],oe[3]=J[3];return oe}function ce(oe,J){var H=J[0],Se=J[1],be=J[2],Te=J[3],me=H*Te-be*Se;return me?(me=1/me,oe[0]=Te*me,oe[1]=-Se*me,oe[2]=-be*me,oe[3]=H*me,oe):null}function K(oe,J){var H=J[0];return oe[0]=J[3],oe[1]=-J[1],oe[2]=-J[2],oe[3]=H,oe}function je(oe){return oe[0]*oe[3]-oe[2]*oe[1]}function pe(oe,J,H){var Se=J[0],be=J[1],Te=J[2],me=J[3],at=H[0],Jt=H[1],Mt=H[2],ve=H[3];return oe[0]=Se*at+Te*Jt,oe[1]=be*at+me*Jt,oe[2]=Se*Mt+Te*ve,oe[3]=be*Mt+me*ve,oe}function Ke(oe,J,H){var Se=J[0],be=J[1],Te=J[2],me=J[3],at=Math.sin(H),Jt=Math.cos(H);return oe[0]=Se*Jt+Te*at,oe[1]=be*Jt+me*at,oe[2]=Se*-at+Te*Jt,oe[3]=be*-at+me*Jt,oe}function Pe(oe,J,H){var Se=J[0],be=J[1],Te=J[2],me=J[3],at=H[0],Jt=H[1];return oe[0]=Se*at,oe[1]=be*at,oe[2]=Te*Jt,oe[3]=me*Jt,oe}function ht(oe,J){var H=Math.sin(J),Se=Math.cos(J);return oe[0]=Se,oe[1]=H,oe[2]=-H,oe[3]=Se,oe}function Le(oe,J){return oe[0]=J[0],oe[1]=0,oe[2]=0,oe[3]=J[1],oe}function _t(oe){return"mat2("+oe[0]+", "+oe[1]+", "+oe[2]+", "+oe[3]+")"}function ot(oe){return Math.hypot(oe[0],oe[1],oe[2],oe[3])}function et(oe,J,H,Se){return oe[2]=Se[2]/Se[0],H[0]=Se[0],H[1]=Se[1],H[3]=Se[3]-oe[2]*H[1],[oe,J,H]}function Ze(oe,J,H){return oe[0]=J[0]+H[0],oe[1]=J[1]+H[1],oe[2]=J[2]+H[2],oe[3]=J[3]+H[3],oe}function At(oe,J,H){return oe[0]=J[0]-H[0],oe[1]=J[1]-H[1],oe[2]=J[2]-H[2],oe[3]=J[3]-H[3],oe}function St(oe,J){return oe[0]===J[0]&&oe[1]===J[1]&&oe[2]===J[2]&&oe[3]===J[3]}function De(oe,J){var H=oe[0],Se=oe[1],be=oe[2],Te=oe[3],me=J[0],at=J[1],Jt=J[2],Mt=J[3];return Math.abs(H-me)<=m.b*Math.max(1,Math.abs(H),Math.abs(me))&&Math.abs(Se-at)<=m.b*Math.max(1,Math.abs(Se),Math.abs(at))&&Math.abs(be-Jt)<=m.b*Math.max(1,Math.abs(be),Math.abs(Jt))&&Math.abs(Te-Mt)<=m.b*Math.max(1,Math.abs(Te),Math.abs(Mt))}function Ie(oe,J,H){return oe[0]=J[0]*H,oe[1]=J[1]*H,oe[2]=J[2]*H,oe[3]=J[3]*H,oe}function Ge(oe,J,H,Se){return oe[0]=J[0]+H[0]*Se,oe[1]=J[1]+H[1]*Se,oe[2]=J[2]+H[2]*Se,oe[3]=J[3]+H[3]*Se,oe}var dt=pe,we=At,pt=o("ZaHm"),Wt=o("ZxFD"),Qt=o("n+fv"),ur=o("bl9R")},ISu3:function(Ue,y,o){"use strict";o.d(y,"a",function(){return Y}),o.d(y,"c",function(){return z}),o.d(y,"b",function(){return i}),o.d(y,"d",function(){return W});var x={},m={},Y=function(Q){return m[Q]},z=function(Q,ee){m[Q]=ee},i=function(Q){return x[Q]},W=function(Q,ee){x[Q]=ee}},Ioao:function(Ue,y,o){var x=o("heNW"),m=Math.max;function Y(z,i,W){return i=m(i===void 0?z.length-1:i,0),function(){for(var D=arguments,Q=-1,ee=m(D.length-i,0),ce=Array(ee);++Q<ee;)ce[Q]=D[i+Q];Q=-1;for(var K=Array(i+1);++Q<i;)K[Q]=D[Q];return K[i]=W(ce),x(z,this,K)}}Ue.exports=Y},J2iB:function(Ue,y){function o(x){return x==null}Ue.exports=o},J7lC:function(Ue,y){},K9nA:function(Ue,y,o){"use strict";(function(x,m){o.d(y,"b",function(){return W}),o.d(y,"a",function(){return ee});var Y=o("U8pU"),z={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof x!="undefined"&&x,document:typeof document!="undefined"&&document,process:(typeof m=="undefined"?"undefined":Object(Y.a)(m))==="object"&&m},i=z.self||z.window||z.global,W=z.window||z.self||z.global,D=z.global||z.self||z.window,Q=z.document||{},ee=z.process||{},ce=console}).call(this,o("yLpj"),o("Q2Ig"))},KKCa:function(Ue,y){typeof Object.create=="function"?Ue.exports=function(x,m){x.super_=m,x.prototype=Object.create(m.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}})}:Ue.exports=function(x,m){x.super_=m;var Y=function(){};Y.prototype=m.prototype,x.prototype=new Y,x.prototype.constructor=x}},KwMD:function(Ue,y){function o(x,m,Y,z){for(var i=x.length,W=Y+(z?1:-1);z?W--:++W<i;)if(m(x[W],W,x))return W;return-1}Ue.exports=o},KxBF:function(Ue,y){function o(x,m,Y){var z=-1,i=x.length;m<0&&(m=-m>i?0:i+m),Y=Y>i?i:Y,Y<0&&(Y+=i),i=m>Y?0:Y-m>>>0,m>>>=0;for(var W=Array(i);++z<i;)W[z]=x[z+m];return W}Ue.exports=o},L56e:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x=["mapload"]},LGYb:function(Ue,y,o){var x=o("1hJj"),m=o("jbM+"),Y=o("Xt/L"),z=o("xYSL"),i=o("dQpi"),W=o("rEGp"),D=200;function Q(ee,ce,K){var je=-1,pe=m,Ke=ee.length,Pe=!0,ht=[],Le=ht;if(K)Pe=!1,pe=Y;else if(Ke>=D){var _t=ce?null:i(ee);if(_t)return W(_t);Pe=!1,pe=z,Le=new x}else Le=ce?[]:ht;e:for(;++je<Ke;){var ot=ee[je],et=ce?ce(ot):ot;if(ot=K||ot!==0?ot:0,Pe&&et===et){for(var Ze=Le.length;Ze--;)if(Le[Ze]===et)continue e;ce&&Le.push(et),ht.push(ot)}else pe(Le,et,K)||(Le!==ht&&Le.push(et),ht.push(ot))}return ht}Ue.exports=Q},LKzl:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingWhenOnSyntax=void 0;var x=o("406g"),m=o("z4Hk"),Y=function(){function z(i){this._binding=i,this._bindingWhenSyntax=new m.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new x.BindingOnSyntax(this._binding)}return z.prototype.when=function(i){return this._bindingWhenSyntax.when(i)},z.prototype.whenTargetNamed=function(i){return this._bindingWhenSyntax.whenTargetNamed(i)},z.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},z.prototype.whenTargetTagged=function(i,W){return this._bindingWhenSyntax.whenTargetTagged(i,W)},z.prototype.whenInjectedInto=function(i){return this._bindingWhenSyntax.whenInjectedInto(i)},z.prototype.whenParentNamed=function(i){return this._bindingWhenSyntax.whenParentNamed(i)},z.prototype.whenParentTagged=function(i,W){return this._bindingWhenSyntax.whenParentTagged(i,W)},z.prototype.whenAnyAncestorIs=function(i){return this._bindingWhenSyntax.whenAnyAncestorIs(i)},z.prototype.whenNoAncestorIs=function(i){return this._bindingWhenSyntax.whenNoAncestorIs(i)},z.prototype.whenAnyAncestorNamed=function(i){return this._bindingWhenSyntax.whenAnyAncestorNamed(i)},z.prototype.whenAnyAncestorTagged=function(i,W){return this._bindingWhenSyntax.whenAnyAncestorTagged(i,W)},z.prototype.whenNoAncestorNamed=function(i){return this._bindingWhenSyntax.whenNoAncestorNamed(i)},z.prototype.whenNoAncestorTagged=function(i,W){return this._bindingWhenSyntax.whenNoAncestorTagged(i,W)},z.prototype.whenAnyAncestorMatches=function(i){return this._bindingWhenSyntax.whenAnyAncestorMatches(i)},z.prototype.whenNoAncestorMatches=function(i){return this._bindingWhenSyntax.whenNoAncestorMatches(i)},z.prototype.onActivation=function(i){return this._bindingOnSyntax.onActivation(i)},z}();y.BindingWhenOnSyntax=Y},LcsW:function(Ue,y,o){var x=o("kekF"),m=x(Object.getPrototypeOf,Object);Ue.exports=m},LgvC:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Binding=void 0;var x=o("FV85"),m=o("d9O0"),Y=function(){function z(i,W){this.id=m.id(),this.activated=!1,this.serviceIdentifier=i,this.scope=W,this.type=x.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return z.prototype.clone=function(){var i=new z(this.serviceIdentifier,this.scope);return i.activated=!1,i.implementationType=this.implementationType,i.dynamicValue=this.dynamicValue,i.scope=this.scope,i.type=this.type,i.factory=this.factory,i.provider=this.provider,i.constraint=this.constraint,i.onActivation=this.onActivation,i.cache=this.cache,i},z}();y.Binding=Y},LsHQ:function(Ue,y,o){var x=o("EA7m"),m=o("mv/X");function Y(z){return x(function(i,W){var D=-1,Q=W.length,ee=Q>1?W[Q-1]:void 0,ce=Q>2?W[2]:void 0;for(ee=z.length>3&&typeof ee=="function"?(Q--,ee):void 0,ce&&m(W[0],W[1],ce)&&(ee=Q<3?void 0:ee,Q=1),i=Object(i);++D<Q;){var K=W[D];K&&z(i,K,D,ee)}return i})}Ue.exports=Y},LvWW:function(Ue,y,o){var x=o("mhV4");Ue.exports=m;function m(Q,ee){switch(Q&&Q.type||null){case"FeatureCollection":return Q.features=Q.features.map(Y(m,ee)),Q;case"GeometryCollection":return Q.geometries=Q.geometries.map(Y(m,ee)),Q;case"Feature":return Q.geometry=m(Q.geometry,ee),Q;case"Polygon":case"MultiPolygon":return z(Q,ee);default:return Q}}function Y(Q,ee){return function(ce){return Q(ce,ee)}}function z(Q,ee){return Q.type==="Polygon"?Q.coordinates=i(Q.coordinates,ee):Q.type==="MultiPolygon"&&(Q.coordinates=Q.coordinates.map(Y(i,ee))),Q}function i(Q,ee){ee=!!ee,Q[0]=W(Q[0],ee);for(var ce=1;ce<Q.length;ce++)Q[ce]=W(Q[ce],!ee);return Q}function W(Q,ee){return D(Q)===ee?Q:Q.reverse()}function D(Q){return x.ring(Q)>=0}},MCLT:function(Ue,y,o){(function(x){var m=Object.getOwnPropertyDescriptors||function(me){for(var at=Object.keys(me),Jt={},Mt=0;Mt<at.length;Mt++)Jt[at[Mt]]=Object.getOwnPropertyDescriptor(me,at[Mt]);return Jt},Y=/%[sdj%]/g;y.format=function(Te){if(!Ze(Te)){for(var me=[],at=0;at<arguments.length;at++)me.push(W(arguments[at]));return me.join(" ")}for(var at=1,Jt=arguments,Mt=Jt.length,ve=String(Te).replace(Y,function(He){if(He==="%%")return"%";if(at>=Mt)return He;switch(He){case"%s":return String(Jt[at++]);case"%d":return Number(Jt[at++]);case"%j":try{return JSON.stringify(Jt[at++])}catch(st){return"[Circular]"}default:return He}}),ge=Jt[at];at<Mt;ge=Jt[++at])_t(ge)||!Ie(ge)?ve+=" "+ge:ve+=" "+W(ge);return ve},y.deprecate=function(Te,me){if(typeof x!="undefined"&&x.noDeprecation===!0)return Te;if(typeof x=="undefined")return function(){return y.deprecate(Te,me).apply(this,arguments)};var at=!1;function Jt(){if(!at){if(x.throwDeprecation)throw new Error(me);x.traceDeprecation?console.trace(me):console.error(me),at=!0}return Te.apply(this,arguments)}return Jt};var z={},i;y.debuglog=function(Te){if(St(i)&&(i=Object({NODE_ENV:"production"}).NODE_DEBUG||""),Te=Te.toUpperCase(),!z[Te])if(new RegExp("\\b"+Te+"\\b","i").test(i)){var me=x.pid;z[Te]=function(){var at=y.format.apply(y,arguments);console.error("%s %d: %s",Te,me,at)}}else z[Te]=function(){};return z[Te]};function W(Te,me){var at={seen:[],stylize:Q};return arguments.length>=3&&(at.depth=arguments[2]),arguments.length>=4&&(at.colors=arguments[3]),Le(me)?at.showHidden=me:me&&y._extend(at,me),St(at.showHidden)&&(at.showHidden=!1),St(at.depth)&&(at.depth=2),St(at.colors)&&(at.colors=!1),St(at.customInspect)&&(at.customInspect=!0),at.colors&&(at.stylize=D),ce(at,Te,at.depth)}y.inspect=W,W.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},W.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(Te,me){var at=W.styles[me];return at?"["+W.colors[at][0]+"m"+Te+"["+W.colors[at][1]+"m":Te}function Q(Te,me){return Te}function ee(Te){var me={};return Te.forEach(function(at,Jt){me[at]=!0}),me}function ce(Te,me,at){if(Te.customInspect&&me&&we(me.inspect)&&me.inspect!==y.inspect&&!(me.constructor&&me.constructor.prototype===me)){var Jt=me.inspect(at,Te);return Ze(Jt)||(Jt=ce(Te,Jt,at)),Jt}var Mt=K(Te,me);if(Mt)return Mt;var ve=Object.keys(me),ge=ee(ve);if(Te.showHidden&&(ve=Object.getOwnPropertyNames(me)),dt(me)&&(ve.indexOf("message")>=0||ve.indexOf("description")>=0))return je(me);if(ve.length===0){if(we(me)){var He=me.name?": "+me.name:"";return Te.stylize("[Function"+He+"]","special")}if(De(me))return Te.stylize(RegExp.prototype.toString.call(me),"regexp");if(Ge(me))return Te.stylize(Date.prototype.toString.call(me),"date");if(dt(me))return je(me)}var st="",Oe=!1,gt=["{","}"];if(ht(me)&&(Oe=!0,gt=["[","]"]),we(me)){var C=me.name?": "+me.name:"";st=" [Function"+C+"]"}if(De(me)&&(st=" "+RegExp.prototype.toString.call(me)),Ge(me)&&(st=" "+Date.prototype.toUTCString.call(me)),dt(me)&&(st=" "+je(me)),ve.length===0&&(!Oe||me.length==0))return gt[0]+st+gt[1];if(at<0)return De(me)?Te.stylize(RegExp.prototype.toString.call(me),"regexp"):Te.stylize("[Object]","special");Te.seen.push(me);var R;return Oe?R=pe(Te,me,at,ge,ve):R=ve.map(function(q){return Ke(Te,me,at,ge,q,Oe)}),Te.seen.pop(),Pe(R,st,gt)}function K(Te,me){if(St(me))return Te.stylize("undefined","undefined");if(Ze(me)){var at="'"+JSON.stringify(me).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Te.stylize(at,"string")}if(et(me))return Te.stylize(""+me,"number");if(Le(me))return Te.stylize(""+me,"boolean");if(_t(me))return Te.stylize("null","null")}function je(Te){return"["+Error.prototype.toString.call(Te)+"]"}function pe(Te,me,at,Jt,Mt){for(var ve=[],ge=0,He=me.length;ge<He;++ge)J(me,String(ge))?ve.push(Ke(Te,me,at,Jt,String(ge),!0)):ve.push("");return Mt.forEach(function(st){st.match(/^\d+$/)||ve.push(Ke(Te,me,at,Jt,st,!0))}),ve}function Ke(Te,me,at,Jt,Mt,ve){var ge,He,st;if(st=Object.getOwnPropertyDescriptor(me,Mt)||{value:me[Mt]},st.get?st.set?He=Te.stylize("[Getter/Setter]","special"):He=Te.stylize("[Getter]","special"):st.set&&(He=Te.stylize("[Setter]","special")),J(Jt,Mt)||(ge="["+Mt+"]"),He||(Te.seen.indexOf(st.value)<0?(_t(at)?He=ce(Te,st.value,null):He=ce(Te,st.value,at-1),He.indexOf(`
`)>-1&&(ve?He=He.split(`
`).map(function(Oe){return"  "+Oe}).join(`
`).substr(2):He=`
`+He.split(`
`).map(function(Oe){return"   "+Oe}).join(`
`))):He=Te.stylize("[Circular]","special")),St(ge)){if(ve&&Mt.match(/^\d+$/))return He;ge=JSON.stringify(""+Mt),ge.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ge=ge.substr(1,ge.length-2),ge=Te.stylize(ge,"name")):(ge=ge.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ge=Te.stylize(ge,"string"))}return ge+": "+He}function Pe(Te,me,at){var Jt=0,Mt=Te.reduce(function(ve,ge){return Jt++,ge.indexOf(`
`)>=0&&Jt++,ve+ge.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Mt>60?at[0]+(me===""?"":me+`
 `)+" "+Te.join(`,
  `)+" "+at[1]:at[0]+me+" "+Te.join(", ")+" "+at[1]}function ht(Te){return Array.isArray(Te)}y.isArray=ht;function Le(Te){return typeof Te=="boolean"}y.isBoolean=Le;function _t(Te){return Te===null}y.isNull=_t;function ot(Te){return Te==null}y.isNullOrUndefined=ot;function et(Te){return typeof Te=="number"}y.isNumber=et;function Ze(Te){return typeof Te=="string"}y.isString=Ze;function At(Te){return typeof Te=="symbol"}y.isSymbol=At;function St(Te){return Te===void 0}y.isUndefined=St;function De(Te){return Ie(Te)&&Wt(Te)==="[object RegExp]"}y.isRegExp=De;function Ie(Te){return typeof Te=="object"&&Te!==null}y.isObject=Ie;function Ge(Te){return Ie(Te)&&Wt(Te)==="[object Date]"}y.isDate=Ge;function dt(Te){return Ie(Te)&&(Wt(Te)==="[object Error]"||Te instanceof Error)}y.isError=dt;function we(Te){return typeof Te=="function"}y.isFunction=we;function pt(Te){return Te===null||typeof Te=="boolean"||typeof Te=="number"||typeof Te=="string"||typeof Te=="symbol"||typeof Te=="undefined"}y.isPrimitive=pt,y.isBuffer=o("1gqn");function Wt(Te){return Object.prototype.toString.call(Te)}function Qt(Te){return Te<10?"0"+Te.toString(10):Te.toString(10)}var ur=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var Te=new Date,me=[Qt(Te.getHours()),Qt(Te.getMinutes()),Qt(Te.getSeconds())].join(":");return[Te.getDate(),ur[Te.getMonth()],me].join(" ")}y.log=function(){console.log("%s - %s",oe(),y.format.apply(y,arguments))},y.inherits=o("KKCa"),y._extend=function(Te,me){if(!me||!Ie(me))return Te;for(var at=Object.keys(me),Jt=at.length;Jt--;)Te[at[Jt]]=me[at[Jt]];return Te};function J(Te,me){return Object.prototype.hasOwnProperty.call(Te,me)}var H=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;y.promisify=function(me){if(typeof me!="function")throw new TypeError('The "original" argument must be of type Function');if(H&&me[H]){var at=me[H];if(typeof at!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(at,H,{value:at,enumerable:!1,writable:!1,configurable:!0}),at}function at(){for(var Jt,Mt,ve=new Promise(function(st,Oe){Jt=st,Mt=Oe}),ge=[],He=0;He<arguments.length;He++)ge.push(arguments[He]);ge.push(function(st,Oe){st?Mt(st):Jt(Oe)});try{me.apply(this,ge)}catch(st){Mt(st)}return ve}return Object.setPrototypeOf(at,Object.getPrototypeOf(me)),H&&Object.defineProperty(at,H,{value:at,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(at,m(me))},y.promisify.custom=H;function Se(Te,me){if(!Te){var at=new Error("Promise was rejected with a falsy value");at.reason=Te,Te=at}return me(Te)}function be(Te){if(typeof Te!="function")throw new TypeError('The "original" argument must be of type Function');function me(){for(var at=[],Jt=0;Jt<arguments.length;Jt++)at.push(arguments[Jt]);var Mt=at.pop();if(typeof Mt!="function")throw new TypeError("The last argument must be of type Function");var ve=this,ge=function(){return Mt.apply(ve,arguments)};Te.apply(this,at).then(function(He){x.nextTick(ge,null,He)},function(He){x.nextTick(Se,He,ge)})}return Object.setPrototypeOf(me,Object.getPrototypeOf(Te)),Object.defineProperties(me,m(Te)),me}y.callbackify=be}).call(this,o("Q2Ig"))},MON2:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.STACK_OVERFLOW=y.CIRCULAR_DEPENDENCY_IN_FACTORY=y.POST_CONSTRUCT_ERROR=y.MULTIPLE_POST_CONSTRUCT_METHODS=y.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=y.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=y.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=y.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=y.ARGUMENTS_LENGTH_MISMATCH=y.INVALID_DECORATOR_OPERATION=y.INVALID_TO_SELF_VALUE=y.INVALID_FUNCTION_BINDING=y.INVALID_MIDDLEWARE_RETURN=y.NO_MORE_SNAPSHOTS_AVAILABLE=y.INVALID_BINDING_TYPE=y.NOT_IMPLEMENTED=y.CIRCULAR_DEPENDENCY=y.UNDEFINED_INJECT_ANNOTATION=y.MISSING_INJECT_ANNOTATION=y.MISSING_INJECTABLE_ANNOTATION=y.NOT_REGISTERED=y.CANNOT_UNBIND=y.AMBIGUOUS_MATCH=y.KEY_NOT_FOUND=y.NULL_ARGUMENT=y.DUPLICATED_METADATA=y.DUPLICATED_INJECTABLE_DECORATOR=void 0,y.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",y.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",y.NULL_ARGUMENT="NULL argument",y.KEY_NOT_FOUND="Key Not Found",y.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",y.CANNOT_UNBIND="Could not unbind serviceIdentifier:",y.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",y.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",y.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",y.UNDEFINED_INJECT_ANNOTATION=function(x){return"@inject called with undefined this could mean that the class "+x+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},y.CIRCULAR_DEPENDENCY="Circular dependency found:",y.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",y.INVALID_BINDING_TYPE="Invalid binding type:",y.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",y.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",y.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",y.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",y.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",y.ARGUMENTS_LENGTH_MISMATCH=function(){for(var x=[],m=0;m<arguments.length;m++)x[m]=arguments[m];return"The number of constructor arguments in the derived class "+(x[0]+" must be >= than the number of constructor arguments of its base class.")},y.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",y.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",y.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",y.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",y.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",y.POST_CONSTRUCT_ERROR=function(){for(var x=[],m=0;m<arguments.length;m++)x[m]=arguments[m];return"@postConstruct error in class "+x[0]+": "+x[1]},y.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var x=[],m=0;m<arguments.length;m++)x[m]=arguments[m];return"It looks like there is a circular dependency "+("in one of the '"+x[0]+"' bindings. Please investigate bindings with")+("service identifier '"+x[1]+"'.")},y.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(Ue,y,o){var x=o("hypo"),m=o("ljhN"),Y=Object.prototype,z=Y.hasOwnProperty;function i(W,D,Q){var ee=W[D];(!(z.call(W,D)&&m(ee,Q))||Q===void 0&&!(D in W))&&x(W,D,Q)}Ue.exports=i},O0oS:function(Ue,y,o){var x=o("Cwc5"),m=function(){try{var Y=x(Object,"defineProperty");return Y({},"",{}),Y}catch(z){}}();Ue.exports=m},O1je:function(Ue,y){},OBhP:function(Ue,y,o){var x=o("fmRc"),m=o("gFfm"),Y=o("MrPd"),z=o("WwFo"),i=o("Dw+G"),W=o("5Tg0"),D=o("Q1l4"),Q=o("VOtZ"),ee=o("EEGq"),ce=o("qZTm"),K=o("G6z8"),je=o("QqLw"),pe=o("yHx3"),Ke=o("wrZu"),Pe=o("+iFO"),ht=o("Z0cm"),Le=o("DSRE"),_t=o("zEVN"),ot=o("GoyQ"),et=o("1+5i"),Ze=o("7GkX"),At=o("mTTR"),St=1,De=2,Ie=4,Ge="[object Arguments]",dt="[object Array]",we="[object Boolean]",pt="[object Date]",Wt="[object Error]",Qt="[object Function]",ur="[object GeneratorFunction]",oe="[object Map]",J="[object Number]",H="[object Object]",Se="[object RegExp]",be="[object Set]",Te="[object String]",me="[object Symbol]",at="[object WeakMap]",Jt="[object ArrayBuffer]",Mt="[object DataView]",ve="[object Float32Array]",ge="[object Float64Array]",He="[object Int8Array]",st="[object Int16Array]",Oe="[object Int32Array]",gt="[object Uint8Array]",C="[object Uint8ClampedArray]",R="[object Uint16Array]",q="[object Uint32Array]",fe={};fe[Ge]=fe[dt]=fe[Jt]=fe[Mt]=fe[we]=fe[pt]=fe[ve]=fe[ge]=fe[He]=fe[st]=fe[Oe]=fe[oe]=fe[J]=fe[H]=fe[Se]=fe[be]=fe[Te]=fe[me]=fe[gt]=fe[C]=fe[R]=fe[q]=!0,fe[Wt]=fe[Qt]=fe[at]=!1;function We(qe,Tt,it,Ut,$,Qe){var ne,tt=Tt&St,kt=Tt&De,dr=Tt&Ie;if(it&&(ne=$?it(qe,Ut,$,Qe):it(qe)),ne!==void 0)return ne;if(!ot(qe))return qe;var Ye=ht(qe);if(Ye){if(ne=pe(qe),!tt)return D(qe,ne)}else{var xt=je(qe),bt=xt==Qt||xt==ur;if(Le(qe))return W(qe,tt);if(xt==H||xt==Ge||bt&&!$){if(ne=kt||bt?{}:Pe(qe),!tt)return kt?ee(qe,i(ne,qe)):Q(qe,z(ne,qe))}else{if(!fe[xt])return $?qe:{};ne=Ke(qe,xt,tt)}}Qe||(Qe=new x);var Et=Qe.get(qe);if(Et)return Et;Qe.set(qe,ne),et(qe)?qe.forEach(function(yt){ne.add(We(yt,Tt,it,yt,qe,Qe))}):_t(qe)&&qe.forEach(function(yt,Ht){ne.set(Ht,We(yt,Tt,it,Ht,qe,Qe))});var ze=dr?kt?K:ce:kt?At:Ze,vt=Ye?void 0:ze(qe);return m(vt||qe,function(yt,Ht){vt&&(Ht=yt,yt=qe[Ht]),Y(ne,Ht,We(yt,Tt,it,Ht,qe,Qe))}),ne}Ue.exports=We},PSsN:function(Ue,y){},PUg6:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x;(function(m){m.normal="normal",m.additive="additive",m.subtractive="subtractive",m.min="min",m.max="max",m.none="none"})(x||(x={}))},Q1l4:function(Ue,y){function o(x,m){var Y=-1,z=x.length;for(m||(m=Array(z));++Y<z;)m[Y]=x[Y];return m}Ue.exports=o},QGbF:function(Ue,y){},"QQZ/":function(Ue,y,o){var x=o("Sq3C"),m=o("Z1HP"),Y=o("Sxd8"),z=o("dt0z");function i(W,D,Q){W=z(W),D=Y(D);var ee=D?m(W):0;return D&&ee<D?x(D-ee,Q)+W:W}Ue.exports=i},QcOe:function(Ue,y,o){var x=o("GoyQ"),m=o("6sVZ"),Y=o("7Ix3"),z=Object.prototype,i=z.hasOwnProperty;function W(D){if(!x(D))return Y(D);var Q=m(D),ee=[];for(var ce in D)ce=="constructor"&&(Q||!i.call(D,ce))||ee.push(ce);return ee}Ue.exports=W},QkVN:function(Ue,y,o){var x=o("+Qka"),m=o("LsHQ"),Y=m(function(z,i,W){x(z,i,W)});Ue.exports=Y},"R/W3":function(Ue,y,o){var x=o("KwMD"),m=o("2ajD"),Y=o("CZoQ");function z(i,W,D){return W===W?Y(i,W,D):x(i,m,D)}Ue.exports=z},"RL2/":function(Ue,y,o){"use strict";var x="2.3.1"},RMtq:function(Ue,y){},"RR/i":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.typeConstraint=y.namedConstraint=y.taggedConstraint=y.traverseAncerstors=void 0;var x=o("xfSm"),m=o("GXnB"),Y=function D(Q,ee){var ce=Q.parentRequest;return ce!==null?ee(ce)?!0:D(ce,ee):!1};y.traverseAncerstors=Y;var z=function(Q){return function(ee){var ce=function(je){return je!==null&&je.target!==null&&je.target.matchesTag(Q)(ee)};return ce.metaData=new m.Metadata(Q,ee),ce}};y.taggedConstraint=z;var i=z(x.NAMED_TAG);y.namedConstraint=i;var W=function(Q){return function(ee){var ce=null;if(ee!==null)if(ce=ee.bindings[0],typeof Q=="string"){var K=ce.serviceIdentifier;return K===Q}else{var je=ee.bindings[0].implementationType;return Q===je}return!1}};y.typeConstraint=W},Sk89:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.postConstruct=void 0;var x=o("MON2"),m=o("xfSm"),Y=o("GXnB");function z(){return function(i,W,D){var Q=new Y.Metadata(m.POST_CONSTRUCT,W);if(Reflect.hasOwnMetadata(m.POST_CONSTRUCT,i.constructor))throw new Error(x.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(m.POST_CONSTRUCT,Q,i.constructor)}}y.postConstruct=z},Sq3C:function(Ue,y,o){var x=o("sKgW"),m=o("zoYe"),Y=o("wy8a"),z=o("quyA"),i=o("Z1HP"),W=o("Em2t"),D=Math.ceil;function Q(ee,ce){ce=ce===void 0?" ":m(ce);var K=ce.length;if(K<2)return K?x(ce,ee):ce;var je=x(ce,D(ee/i(ce)));return z(ce)?Y(W(je),0,ee).join(""):je.slice(0,ee)}Ue.exports=Q},Sxd8:function(Ue,y,o){var x=o("ZCgT");function m(Y){var z=x(Y),i=z%1;return z===z?i?z-i:z:0}Ue.exports=m},T1AV:function(Ue,y,o){var x=o("t2Dn"),m=o("5Tg0"),Y=o("yP5f"),z=o("Q1l4"),i=o("+iFO"),W=o("03A+"),D=o("Z0cm"),Q=o("3L66"),ee=o("DSRE"),ce=o("lSCD"),K=o("GoyQ"),je=o("YO3V"),pe=o("c6wG"),Ke=o("itsj"),Pe=o("jeLo");function ht(Le,_t,ot,et,Ze,At,St){var De=Ke(Le,ot),Ie=Ke(_t,ot),Ge=St.get(Ie);if(Ge){x(Le,ot,Ge);return}var dt=At?At(De,Ie,ot+"",Le,_t,St):void 0,we=dt===void 0;if(we){var pt=D(Ie),Wt=!pt&&ee(Ie),Qt=!pt&&!Wt&&pe(Ie);dt=Ie,pt||Wt||Qt?D(De)?dt=De:Q(De)?dt=z(De):Wt?(we=!1,dt=m(Ie,!0)):Qt?(we=!1,dt=Y(Ie,!0)):dt=[]:je(Ie)||W(Ie)?(dt=De,W(De)?dt=Pe(De):(!K(De)||ce(De))&&(dt=i(Ie))):we=!1}we&&(St.set(Ie,dt),Ze(dt,Ie,et,At,St),St.delete(Ie)),x(Le,ot,dt)}Ue.exports=ht},TKrE:function(Ue,y,o){var x=o("qRkn"),m=o("dt0z"),Y=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,z="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",W="\\u20d0-\\u20ff",D=z+i+W,Q="["+D+"]",ee=RegExp(Q,"g");function ce(K){return K=m(K),K&&K.replace(Y,x).replace(ee,"")}Ue.exports=ce},"U+yc":function(Ue,y){function o(x,m,Y,z,i){var W={};return Object.keys(z).forEach(function(D){W[D]=z[D]}),W.enumerable=!!W.enumerable,W.configurable=!!W.configurable,("value"in W||W.initializer)&&(W.writable=!0),W=Y.slice().reverse().reduce(function(D,Q){return Q(x,m,D)||D},W),i&&W.initializer!==void 0&&(W.value=W.initializer?W.initializer.call(i):void 0,W.initializer=void 0),W.initializer===void 0&&(Object.defineProperty(x,m,W),W=null),W}Ue.exports=o},U1ZX:function(Ue,y){},UB5X:function(Ue,y,o){var x=o("NykK"),m=o("ExA7"),Y="[object Number]";function z(i){return typeof i=="number"||m(i)&&x(i)==Y}Ue.exports=z},Ucsi:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var x=Symbol.for("INJECTION");function m(D,Q,ee,ce){function K(){return ce&&!Reflect.hasMetadata(x,this,Q)&&Reflect.defineMetadata(x,ee(),this,Q),Reflect.hasMetadata(x,this,Q)?Reflect.getMetadata(x,this,Q):ee()}function je(pe){Reflect.defineMetadata(x,pe,this,Q)}Object.defineProperty(D,Q,{configurable:!0,enumerable:!0,get:K,set:je})}function Y(D,Q){return function(ee){return function(ce,K){var je=function(){return D.get(ee)};m(ce,K,je,Q)}}}y.makePropertyInjectDecorator=Y;function z(D,Q){return function(ee,ce){return function(K,je){var pe=function(){return D.getNamed(ee,ce)};m(K,je,pe,Q)}}}y.makePropertyInjectNamedDecorator=z;function i(D,Q){return function(ee,ce,K){return function(je,pe){var Ke=function(){return D.getTagged(ee,ce,K)};m(je,pe,Ke,Q)}}}y.makePropertyInjectTaggedDecorator=i;function W(D,Q){return function(ee){return function(ce,K){var je=function(){return D.getAll(ee)};m(ce,K,je,Q)}}}y.makePropertyMultiInjectDecorator=W},V1cb:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x;(function(m){m.Hover="hover",m.Click="click",m.Select="select",m.Active="active",m.Drag="drag"})(x||(x={}))},VIsB:function(Ue,y,o){"use strict";o.d(y,"a",function(){return W});var x=o("Hel2");function m(je,pe){var Ke;if(typeof Symbol=="undefined"||je[Symbol.iterator]==null){if(Array.isArray(je)||(Ke=Y(je))||pe&&je&&typeof je.length=="number"){Ke&&(je=Ke);var Pe=0,ht=function(){};return{s:ht,n:function(){return Pe>=je.length?{done:!0}:{done:!1,value:je[Pe++]}},e:function(Ze){throw Ze},f:ht}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Le=!0,_t=!1,ot;return{s:function(){Ke=je[Symbol.iterator]()},n:function(){var Ze=Ke.next();return Le=Ze.done,Ze},e:function(Ze){_t=!0,ot=Ze},f:function(){try{!Le&&Ke.return!=null&&Ke.return()}finally{if(_t)throw ot}}}}function Y(je,pe){if(!je)return;if(typeof je=="string")return z(je,pe);var Ke=Object.prototype.toString.call(je).slice(8,-1);if(Ke==="Object"&&je.constructor&&(Ke=je.constructor.name),Ke==="Map"||Ke==="Set")return Array.from(je);if(Ke==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ke))return z(je,pe)}function z(je,pe){(pe==null||pe>je.length)&&(pe=je.length);for(var Ke=0,Pe=new Array(pe);Ke<pe;Ke++)Pe[Ke]=je[Ke];return Pe}var i=6378e3;function W(je,pe){var Ke=je.dataArray,Pe=pe.size,ht=Pe===void 0?10:Pe,Le=ht/(2*Math.PI*i)*(256<<20)/2,_t=D(Ke,ht),ot=_t.gridHash,et=_t.gridOffset,Ze=K(ot,et,pe);return{yOffset:Le,xOffset:Le,radius:Le,type:"grid",dataArray:Ze}}function D(je,pe){var Ke=Infinity,Pe=-Infinity,ht,Le=m(je),_t;try{for(Le.s();!(_t=Le.n()).done;){var ot=_t.value;ht=ot.coordinates[1],Number.isFinite(ht)&&(Ke=ht<Ke?ht:Ke,Pe=ht>Pe?ht:Pe)}}catch(Qt){Le.e(Qt)}finally{Le.f()}var et=(Ke+Pe)/2,Ze=Q(pe,et);if(Ze.xOffset<=0||Ze.yOffset<=0)return{gridHash:{},gridOffset:Ze};var At={},St=m(je),De;try{for(St.s();!(De=St.n()).done;){var Ie=De.value,Ge=Ie.coordinates[1],dt=Ie.coordinates[0];if(Number.isFinite(Ge)&&Number.isFinite(dt)){var we=Math.floor((Ge+90)/Ze.yOffset),pt=Math.floor((dt+180)/Ze.xOffset),Wt="".concat(we,"-").concat(pt);At[Wt]=At[Wt]||{count:0,points:[]},At[Wt].count+=1,At[Wt].points.push(Ie)}}}catch(Qt){St.e(Qt)}finally{St.f()}return{gridHash:At,gridOffset:Ze}}function Q(je,pe){var Ke=ee(je),Pe=ce(pe,je);return{yOffset:Ke,xOffset:Pe}}function ee(je){return je/i*(180/Math.PI)}function ce(je,pe){return pe/i*(180/Math.PI)/Math.cos(je*Math.PI/180)}function K(je,pe,Ke){return Object.keys(je).reduce(function(Pe,ht,Le){var _t=ht.split("-"),ot=parseInt(_t[0],10),et=parseInt(_t[1],10),Ze={};if(Ke.field&&Ke.method){var At=x.c.getColumn(je[ht].points,Ke.field);Ze[Ke.method]=x.c.statMap[Ke.method](At)}return Object.assign(Ze,{_id:Le,coordinates:Object(x.d)([-180+pe.xOffset*(et+.5),-90+pe.yOffset*(ot+.5)]),rawData:je[ht].points,count:je[ht].count}),Pe.push(Ze),Pe},[])}},VOtZ:function(Ue,y,o){var x=o("juv8"),m=o("MvSz");function Y(z,i){return x(z,m(z),i)}Ue.exports=Y},VmRL:function(Ue,y,o){"use strict";Ue.exports=x,Ue.exports.default=x;function x(oe,J,H){H=H||2;var Se=J&&J.length,be=Se?J[0]*H:oe.length,Te=m(oe,0,be,H,!0),me=[];if(!Te||Te.next===Te.prev)return me;var at,Jt,Mt,ve,ge,He,st;if(Se&&(Te=ee(oe,J,Te,H)),oe.length>80*H){at=Mt=oe[0],Jt=ve=oe[1];for(var Oe=H;Oe<be;Oe+=H)ge=oe[Oe],He=oe[Oe+1],ge<at&&(at=ge),He<Jt&&(Jt=He),ge>Mt&&(Mt=ge),He>ve&&(ve=He);st=Math.max(Mt-at,ve-Jt),st=st!==0?1/st:0}return z(Te,me,H,at,Jt,st),me}function m(oe,J,H,Se,be){var Te,me;if(be===ur(oe,J,H,Se)>0)for(Te=J;Te<H;Te+=Se)me=pt(Te,oe[Te],oe[Te+1],me);else for(Te=H-Se;Te>=J;Te-=Se)me=pt(Te,oe[Te],oe[Te+1],me);return me&&Ze(me,me.next)&&(Wt(me),me=me.next),me}function Y(oe,J){if(!oe)return oe;J||(J=oe);var H=oe,Se;do if(Se=!1,!H.steiner&&(Ze(H,H.next)||et(H.prev,H,H.next)===0)){if(Wt(H),H=J=H.prev,H===H.next)break;Se=!0}else H=H.next;while(Se||H!==J);return J}function z(oe,J,H,Se,be,Te,me){if(!oe)return;!me&&Te&&Ke(oe,Se,be,Te);for(var at=oe,Jt,Mt;oe.prev!==oe.next;){if(Jt=oe.prev,Mt=oe.next,Te?W(oe,Se,be,Te):i(oe)){J.push(Jt.i/H),J.push(oe.i/H),J.push(Mt.i/H),Wt(oe),oe=Mt.next,at=Mt.next;continue}if(oe=Mt,oe===at){me?me===1?(oe=D(Y(oe),J,H),z(oe,J,H,Se,be,Te,2)):me===2&&Q(oe,J,H,Se,be,Te):z(Y(oe),J,H,Se,be,Te,1);break}}}function i(oe){var J=oe.prev,H=oe,Se=oe.next;if(et(J,H,Se)>=0)return!1;for(var be=oe.next.next;be!==oe.prev;){if(_t(J.x,J.y,H.x,H.y,Se.x,Se.y,be.x,be.y)&&et(be.prev,be,be.next)>=0)return!1;be=be.next}return!0}function W(oe,J,H,Se){var be=oe.prev,Te=oe,me=oe.next;if(et(be,Te,me)>=0)return!1;for(var at=be.x<Te.x?be.x<me.x?be.x:me.x:Te.x<me.x?Te.x:me.x,Jt=be.y<Te.y?be.y<me.y?be.y:me.y:Te.y<me.y?Te.y:me.y,Mt=be.x>Te.x?be.x>me.x?be.x:me.x:Te.x>me.x?Te.x:me.x,ve=be.y>Te.y?be.y>me.y?be.y:me.y:Te.y>me.y?Te.y:me.y,ge=ht(at,Jt,J,H,Se),He=ht(Mt,ve,J,H,Se),st=oe.prevZ,Oe=oe.nextZ;st&&st.z>=ge&&Oe&&Oe.z<=He;){if(st!==oe.prev&&st!==oe.next&&_t(be.x,be.y,Te.x,Te.y,me.x,me.y,st.x,st.y)&&et(st.prev,st,st.next)>=0)return!1;if(st=st.prevZ,Oe!==oe.prev&&Oe!==oe.next&&_t(be.x,be.y,Te.x,Te.y,me.x,me.y,Oe.x,Oe.y)&&et(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}for(;st&&st.z>=ge;){if(st!==oe.prev&&st!==oe.next&&_t(be.x,be.y,Te.x,Te.y,me.x,me.y,st.x,st.y)&&et(st.prev,st,st.next)>=0)return!1;st=st.prevZ}for(;Oe&&Oe.z<=He;){if(Oe!==oe.prev&&Oe!==oe.next&&_t(be.x,be.y,Te.x,Te.y,me.x,me.y,Oe.x,Oe.y)&&et(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function D(oe,J,H){var Se=oe;do{var be=Se.prev,Te=Se.next.next;!Ze(be,Te)&&At(be,Se,Se.next,Te)&&Ge(be,Te)&&Ge(Te,be)&&(J.push(be.i/H),J.push(Se.i/H),J.push(Te.i/H),Wt(Se),Wt(Se.next),Se=oe=Te),Se=Se.next}while(Se!==oe);return Y(Se)}function Q(oe,J,H,Se,be,Te){var me=oe;do{for(var at=me.next.next;at!==me.prev;){if(me.i!==at.i&&ot(me,at)){var Jt=we(me,at);me=Y(me,me.next),Jt=Y(Jt,Jt.next),z(me,J,H,Se,be,Te),z(Jt,J,H,Se,be,Te);return}at=at.next}me=me.next}while(me!==oe)}function ee(oe,J,H,Se){var be=[],Te,me,at,Jt,Mt;for(Te=0,me=J.length;Te<me;Te++)at=J[Te]*Se,Jt=Te<me-1?J[Te+1]*Se:oe.length,Mt=m(oe,at,Jt,Se,!1),Mt===Mt.next&&(Mt.steiner=!0),be.push(Le(Mt));for(be.sort(ce),Te=0;Te<be.length;Te++)K(be[Te],H),H=Y(H,H.next);return H}function ce(oe,J){return oe.x-J.x}function K(oe,J){if(J=je(oe,J),J){var H=we(J,oe);Y(J,J.next),Y(H,H.next)}}function je(oe,J){var H=J,Se=oe.x,be=oe.y,Te=-Infinity,me;do{if(be<=H.y&&be>=H.next.y&&H.next.y!==H.y){var at=H.x+(be-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(at<=Se&&at>Te){if(Te=at,at===Se){if(be===H.y)return H;if(be===H.next.y)return H.next}me=H.x<H.next.x?H:H.next}}H=H.next}while(H!==J);if(!me)return null;if(Se===Te)return me;var Jt=me,Mt=me.x,ve=me.y,ge=Infinity,He;H=me;do Se>=H.x&&H.x>=Mt&&Se!==H.x&&_t(be<ve?Se:Te,be,Mt,ve,be<ve?Te:Se,be,H.x,H.y)&&(He=Math.abs(be-H.y)/(Se-H.x),Ge(H,oe)&&(He<ge||He===ge&&(H.x>me.x||H.x===me.x&&pe(me,H)))&&(me=H,ge=He)),H=H.next;while(H!==Jt);return me}function pe(oe,J){return et(oe.prev,oe,J.prev)<0&&et(J.next,oe,oe.next)<0}function Ke(oe,J,H,Se){var be=oe;do be.z===null&&(be.z=ht(be.x,be.y,J,H,Se)),be.prevZ=be.prev,be.nextZ=be.next,be=be.next;while(be!==oe);be.prevZ.nextZ=null,be.prevZ=null,Pe(be)}function Pe(oe){var J,H,Se,be,Te,me,at,Jt,Mt=1;do{for(H=oe,oe=null,Te=null,me=0;H;){for(me++,Se=H,at=0,J=0;J<Mt&&!(at++,Se=Se.nextZ,!Se);J++);for(Jt=Mt;at>0||Jt>0&&Se;)at!==0&&(Jt===0||!Se||H.z<=Se.z)?(be=H,H=H.nextZ,at--):(be=Se,Se=Se.nextZ,Jt--),Te?Te.nextZ=be:oe=be,be.prevZ=Te,Te=be;H=Se}Te.nextZ=null,Mt*=2}while(me>1);return oe}function ht(oe,J,H,Se,be){return oe=32767*(oe-H)*be,J=32767*(J-Se)*be,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,J=(J|J<<8)&16711935,J=(J|J<<4)&252645135,J=(J|J<<2)&858993459,J=(J|J<<1)&1431655765,oe|J<<1}function Le(oe){var J=oe,H=oe;do(J.x<H.x||J.x===H.x&&J.y<H.y)&&(H=J),J=J.next;while(J!==oe);return H}function _t(oe,J,H,Se,be,Te,me,at){return(be-me)*(J-at)-(oe-me)*(Te-at)>=0&&(oe-me)*(Se-at)-(H-me)*(J-at)>=0&&(H-me)*(Te-at)-(be-me)*(Se-at)>=0}function ot(oe,J){return oe.next.i!==J.i&&oe.prev.i!==J.i&&!Ie(oe,J)&&(Ge(oe,J)&&Ge(J,oe)&&dt(oe,J)&&(et(oe.prev,oe,J.prev)||et(oe,J.prev,J))||Ze(oe,J)&&et(oe.prev,oe,oe.next)>0&&et(J.prev,J,J.next)>0)}function et(oe,J,H){return(J.y-oe.y)*(H.x-J.x)-(J.x-oe.x)*(H.y-J.y)}function Ze(oe,J){return oe.x===J.x&&oe.y===J.y}function At(oe,J,H,Se){var be=De(et(oe,J,H)),Te=De(et(oe,J,Se)),me=De(et(H,Se,oe)),at=De(et(H,Se,J));return be!==Te&&me!==at||(be===0&&St(oe,H,J)||(Te===0&&St(oe,Se,J)||me===0&&St(H,oe,Se)))?!0:!!(at===0&&St(H,J,Se))}function St(oe,J,H){return J.x<=Math.max(oe.x,H.x)&&J.x>=Math.min(oe.x,H.x)&&J.y<=Math.max(oe.y,H.y)&&J.y>=Math.min(oe.y,H.y)}function De(oe){return oe>0?1:oe<0?-1:0}function Ie(oe,J){var H=oe;do{if(H.i!==oe.i&&H.next.i!==oe.i&&H.i!==J.i&&H.next.i!==J.i&&At(H,H.next,oe,J))return!0;H=H.next}while(H!==oe);return!1}function Ge(oe,J){return et(oe.prev,oe,oe.next)<0?et(oe,J,oe.next)>=0&&et(oe,oe.prev,J)>=0:et(oe,J,oe.prev)<0||et(oe,oe.next,J)<0}function dt(oe,J){var H=oe,Se=!1,be=(oe.x+J.x)/2,Te=(oe.y+J.y)/2;do H.y>Te!==H.next.y>Te&&H.next.y!==H.y&&be<(H.next.x-H.x)*(Te-H.y)/(H.next.y-H.y)+H.x&&(Se=!Se),H=H.next;while(H!==oe);return Se}function we(oe,J){var H=new Qt(oe.i,oe.x,oe.y),Se=new Qt(J.i,J.x,J.y),be=oe.next,Te=J.prev;return oe.next=J,J.prev=oe,H.next=be,be.prev=H,Se.next=H,H.prev=Se,Te.next=Se,Se.prev=Te,Se}function pt(oe,J,H,Se){var be=new Qt(oe,J,H);return Se?(be.next=Se.next,be.prev=Se,Se.next.prev=be,Se.next=be):(be.prev=be,be.next=be),be}function Wt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function Qt(oe,J,H){this.i=oe,this.x=J,this.y=H,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}x.deviation=function(oe,J,H,Se){var be=J&&J.length,Te=be?J[0]*H:oe.length,me=Math.abs(ur(oe,0,Te,H));if(be)for(var at=0,Jt=J.length;at<Jt;at++){var Mt=J[at]*H,ve=at<Jt-1?J[at+1]*H:oe.length;me-=Math.abs(ur(oe,Mt,ve,H))}var ge=0;for(at=0;at<Se.length;at+=3){var He=Se[at]*H,st=Se[at+1]*H,Oe=Se[at+2]*H;ge+=Math.abs((oe[He]-oe[Oe])*(oe[st+1]-oe[He+1])-(oe[He]-oe[st])*(oe[Oe+1]-oe[He+1]))}return me===0&&ge===0?0:Math.abs((ge-me)/me)};function ur(oe,J,H,Se){for(var be=0,Te=J,me=H-Se;Te<H;Te+=Se)be+=(oe[me]-oe[Te])*(oe[Te+1]+oe[me+1]),me=Te;return be}x.flatten=function(oe){for(var J=oe[0][0].length,H={vertices:[],holes:[],dimensions:J},Se=0,be=0;be<oe.length;be++){for(var Te=0;Te<oe[be].length;Te++)for(var me=0;me<J;me++)H.vertices.push(oe[be][Te][me]);be>0&&(Se+=oe[be-1].length,H.holes.push(Se))}return H}},WFAs:function(Ue,y){var o=Array.isArray;Ue.exports=o},WwFo:function(Ue,y,o){var x=o("juv8"),m=o("7GkX");function Y(z,i){return z&&x(i,m(i),z)}Ue.exports=Y},XYm9:function(Ue,y,o){var x=o("+K+b");function m(Y,z){var i=z?x(Y.buffer):Y.buffer;return new Y.constructor(i,Y.byteOffset,Y.byteLength)}Ue.exports=m},"Xt/L":function(Ue,y){function o(x,m,Y){for(var z=-1,i=x==null?0:x.length;++z<i;)if(Y(m,x[z]))return!0;return!1}Ue.exports=o},Y8BV:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});function x(m,Y){var z=Y.callback;return z&&(m.dataArray=m.dataArray.filter(z)),m}},YO3V:function(Ue,y,o){var x=o("NykK"),m=o("LcsW"),Y=o("ExA7"),z="[object Object]",i=Function.prototype,W=Object.prototype,D=i.toString,Q=W.hasOwnProperty,ee=D.call(Object);function ce(K){if(!Y(K)||x(K)!=z)return!1;var je=m(K);if(je===null)return!0;var pe=Q.call(je,"constructor")&&je.constructor;return typeof pe=="function"&&pe instanceof pe&&D.call(pe)==ee}Ue.exports=ce},Yk9n:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.inject=y.LazyServiceIdentifer=void 0;var x=o("MON2"),m=o("xfSm"),Y=o("GXnB"),z=o("Ztfv"),i=function(){function D(Q){this._cb=Q}return D.prototype.unwrap=function(){return this._cb()},D}();y.LazyServiceIdentifer=i;function W(D){return function(Q,ee,ce){if(D===void 0)throw new Error(x.UNDEFINED_INJECT_ANNOTATION(Q.name));var K=new Y.Metadata(m.INJECT_TAG,D);typeof ce=="number"?z.tagParameter(Q,ee,ce,K):z.tagProperty(Q,ee,K)}}y.inject=W},Z1HP:function(Ue,y,o){var x=o("ycre"),m=o("quyA"),Y=o("q4HE");function z(i){return m(i)?Y(i):x(i)}Ue.exports=z},ZCgT:function(Ue,y,o){var x=o("tLB3"),m=1/0,Y=17976931348623157e292;function z(i){if(!i)return i===0?i:0;if(i=x(i),i===m||i===-m){var W=i<0?-1:1;return W*Y}return i===i?i:0}Ue.exports=z},ZK94:function(Ue,y){Ue.exports.RADIUS=6378137,Ue.exports.FLATTENING=1/298.257223563,Ue.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(Ue,y,o){"use strict";o.r(y),o.d(y,"create",function(){return m}),o.d(y,"clone",function(){return Y}),o.d(y,"copy",function(){return z}),o.d(y,"fromValues",function(){return i}),o.d(y,"set",function(){return W}),o.d(y,"identity",function(){return D}),o.d(y,"transpose",function(){return Q}),o.d(y,"invert",function(){return ee}),o.d(y,"adjoint",function(){return ce}),o.d(y,"determinant",function(){return K}),o.d(y,"multiply",function(){return je}),o.d(y,"translate",function(){return pe}),o.d(y,"scale",function(){return Ke}),o.d(y,"rotate",function(){return Pe}),o.d(y,"rotateX",function(){return ht}),o.d(y,"rotateY",function(){return Le}),o.d(y,"rotateZ",function(){return _t}),o.d(y,"fromTranslation",function(){return ot}),o.d(y,"fromScaling",function(){return et}),o.d(y,"fromRotation",function(){return Ze}),o.d(y,"fromXRotation",function(){return At}),o.d(y,"fromYRotation",function(){return St}),o.d(y,"fromZRotation",function(){return De}),o.d(y,"fromRotationTranslation",function(){return Ie}),o.d(y,"fromQuat2",function(){return Ge}),o.d(y,"getTranslation",function(){return dt}),o.d(y,"getScaling",function(){return we}),o.d(y,"getRotation",function(){return pt}),o.d(y,"fromRotationTranslationScale",function(){return Wt}),o.d(y,"fromRotationTranslationScaleOrigin",function(){return Qt}),o.d(y,"fromQuat",function(){return ur}),o.d(y,"frustum",function(){return oe}),o.d(y,"perspective",function(){return J}),o.d(y,"perspectiveFromFieldOfView",function(){return H}),o.d(y,"ortho",function(){return Se}),o.d(y,"lookAt",function(){return be}),o.d(y,"targetTo",function(){return Te}),o.d(y,"str",function(){return me}),o.d(y,"frob",function(){return at}),o.d(y,"add",function(){return Jt}),o.d(y,"subtract",function(){return Mt}),o.d(y,"multiplyScalar",function(){return ve}),o.d(y,"multiplyScalarAndAdd",function(){return ge}),o.d(y,"exactEquals",function(){return He}),o.d(y,"equals",function(){return st}),o.d(y,"mul",function(){return Oe}),o.d(y,"sub",function(){return gt});var x=o("yU0y");function m(){var C=new x.a(16);return x.a!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function Y(C){var R=new x.a(16);return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=C[4],R[5]=C[5],R[6]=C[6],R[7]=C[7],R[8]=C[8],R[9]=C[9],R[10]=C[10],R[11]=C[11],R[12]=C[12],R[13]=C[13],R[14]=C[14],R[15]=C[15],R}function z(C,R){return C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function i(C,R,q,fe,We,qe,Tt,it,Ut,$,Qe,ne,tt,kt,dr,Ye){var xt=new x.a(16);return xt[0]=C,xt[1]=R,xt[2]=q,xt[3]=fe,xt[4]=We,xt[5]=qe,xt[6]=Tt,xt[7]=it,xt[8]=Ut,xt[9]=$,xt[10]=Qe,xt[11]=ne,xt[12]=tt,xt[13]=kt,xt[14]=dr,xt[15]=Ye,xt}function W(C,R,q,fe,We,qe,Tt,it,Ut,$,Qe,ne,tt,kt,dr,Ye,xt){return C[0]=R,C[1]=q,C[2]=fe,C[3]=We,C[4]=qe,C[5]=Tt,C[6]=it,C[7]=Ut,C[8]=$,C[9]=Qe,C[10]=ne,C[11]=tt,C[12]=kt,C[13]=dr,C[14]=Ye,C[15]=xt,C}function D(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Q(C,R){if(C===R){var q=R[1],fe=R[2],We=R[3],qe=R[6],Tt=R[7],it=R[11];C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=q,C[6]=R[9],C[7]=R[13],C[8]=fe,C[9]=qe,C[11]=R[14],C[12]=We,C[13]=Tt,C[14]=it}else C[0]=R[0],C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=R[1],C[5]=R[5],C[6]=R[9],C[7]=R[13],C[8]=R[2],C[9]=R[6],C[10]=R[10],C[11]=R[14],C[12]=R[3],C[13]=R[7],C[14]=R[11],C[15]=R[15];return C}function ee(C,R){var q=R[0],fe=R[1],We=R[2],qe=R[3],Tt=R[4],it=R[5],Ut=R[6],$=R[7],Qe=R[8],ne=R[9],tt=R[10],kt=R[11],dr=R[12],Ye=R[13],xt=R[14],bt=R[15],Et=q*it-fe*Tt,ze=q*Ut-We*Tt,vt=q*$-qe*Tt,yt=fe*Ut-We*it,Ht=fe*$-qe*it,hr=We*$-qe*Ut,Hr=Qe*Ye-ne*dr,gr=Qe*xt-tt*dr,Bn=Qe*bt-kt*dr,zn=ne*xt-tt*Ye,oa=ne*bt-kt*Ye,$n=tt*bt-kt*xt,Yn=Et*$n-ze*oa+vt*zn+yt*Bn-Ht*gr+hr*Hr;return Yn?(Yn=1/Yn,C[0]=(it*$n-Ut*oa+$*zn)*Yn,C[1]=(We*oa-fe*$n-qe*zn)*Yn,C[2]=(Ye*hr-xt*Ht+bt*yt)*Yn,C[3]=(tt*Ht-ne*hr-kt*yt)*Yn,C[4]=(Ut*Bn-Tt*$n-$*gr)*Yn,C[5]=(q*$n-We*Bn+qe*gr)*Yn,C[6]=(xt*vt-dr*hr-bt*ze)*Yn,C[7]=(Qe*hr-tt*vt+kt*ze)*Yn,C[8]=(Tt*oa-it*Bn+$*Hr)*Yn,C[9]=(fe*Bn-q*oa-qe*Hr)*Yn,C[10]=(dr*Ht-Ye*vt+bt*Et)*Yn,C[11]=(ne*vt-Qe*Ht-kt*Et)*Yn,C[12]=(it*gr-Tt*zn-Ut*Hr)*Yn,C[13]=(q*zn-fe*gr+We*Hr)*Yn,C[14]=(Ye*ze-dr*yt-xt*Et)*Yn,C[15]=(Qe*yt-ne*ze+tt*Et)*Yn,C):null}function ce(C,R){var q=R[0],fe=R[1],We=R[2],qe=R[3],Tt=R[4],it=R[5],Ut=R[6],$=R[7],Qe=R[8],ne=R[9],tt=R[10],kt=R[11],dr=R[12],Ye=R[13],xt=R[14],bt=R[15];return C[0]=it*(tt*bt-kt*xt)-ne*(Ut*bt-$*xt)+Ye*(Ut*kt-$*tt),C[1]=-(fe*(tt*bt-kt*xt)-ne*(We*bt-qe*xt)+Ye*(We*kt-qe*tt)),C[2]=fe*(Ut*bt-$*xt)-it*(We*bt-qe*xt)+Ye*(We*$-qe*Ut),C[3]=-(fe*(Ut*kt-$*tt)-it*(We*kt-qe*tt)+ne*(We*$-qe*Ut)),C[4]=-(Tt*(tt*bt-kt*xt)-Qe*(Ut*bt-$*xt)+dr*(Ut*kt-$*tt)),C[5]=q*(tt*bt-kt*xt)-Qe*(We*bt-qe*xt)+dr*(We*kt-qe*tt),C[6]=-(q*(Ut*bt-$*xt)-Tt*(We*bt-qe*xt)+dr*(We*$-qe*Ut)),C[7]=q*(Ut*kt-$*tt)-Tt*(We*kt-qe*tt)+Qe*(We*$-qe*Ut),C[8]=Tt*(ne*bt-kt*Ye)-Qe*(it*bt-$*Ye)+dr*(it*kt-$*ne),C[9]=-(q*(ne*bt-kt*Ye)-Qe*(fe*bt-qe*Ye)+dr*(fe*kt-qe*ne)),C[10]=q*(it*bt-$*Ye)-Tt*(fe*bt-qe*Ye)+dr*(fe*$-qe*it),C[11]=-(q*(it*kt-$*ne)-Tt*(fe*kt-qe*ne)+Qe*(fe*$-qe*it)),C[12]=-(Tt*(ne*xt-tt*Ye)-Qe*(it*xt-Ut*Ye)+dr*(it*tt-Ut*ne)),C[13]=q*(ne*xt-tt*Ye)-Qe*(fe*xt-We*Ye)+dr*(fe*tt-We*ne),C[14]=-(q*(it*xt-Ut*Ye)-Tt*(fe*xt-We*Ye)+dr*(fe*Ut-We*it)),C[15]=q*(it*tt-Ut*ne)-Tt*(fe*tt-We*ne)+Qe*(fe*Ut-We*it),C}function K(C){var R=C[0],q=C[1],fe=C[2],We=C[3],qe=C[4],Tt=C[5],it=C[6],Ut=C[7],$=C[8],Qe=C[9],ne=C[10],tt=C[11],kt=C[12],dr=C[13],Ye=C[14],xt=C[15],bt=R*Tt-q*qe,Et=R*it-fe*qe,ze=R*Ut-We*qe,vt=q*it-fe*Tt,yt=q*Ut-We*Tt,Ht=fe*Ut-We*it,hr=$*dr-Qe*kt,Hr=$*Ye-ne*kt,gr=$*xt-tt*kt,Bn=Qe*Ye-ne*dr,zn=Qe*xt-tt*dr,oa=ne*xt-tt*Ye;return bt*oa-Et*zn+ze*Bn+vt*gr-yt*Hr+Ht*hr}function je(C,R,q){var fe=R[0],We=R[1],qe=R[2],Tt=R[3],it=R[4],Ut=R[5],$=R[6],Qe=R[7],ne=R[8],tt=R[9],kt=R[10],dr=R[11],Ye=R[12],xt=R[13],bt=R[14],Et=R[15],ze=q[0],vt=q[1],yt=q[2],Ht=q[3];return C[0]=ze*fe+vt*it+yt*ne+Ht*Ye,C[1]=ze*We+vt*Ut+yt*tt+Ht*xt,C[2]=ze*qe+vt*$+yt*kt+Ht*bt,C[3]=ze*Tt+vt*Qe+yt*dr+Ht*Et,ze=q[4],vt=q[5],yt=q[6],Ht=q[7],C[4]=ze*fe+vt*it+yt*ne+Ht*Ye,C[5]=ze*We+vt*Ut+yt*tt+Ht*xt,C[6]=ze*qe+vt*$+yt*kt+Ht*bt,C[7]=ze*Tt+vt*Qe+yt*dr+Ht*Et,ze=q[8],vt=q[9],yt=q[10],Ht=q[11],C[8]=ze*fe+vt*it+yt*ne+Ht*Ye,C[9]=ze*We+vt*Ut+yt*tt+Ht*xt,C[10]=ze*qe+vt*$+yt*kt+Ht*bt,C[11]=ze*Tt+vt*Qe+yt*dr+Ht*Et,ze=q[12],vt=q[13],yt=q[14],Ht=q[15],C[12]=ze*fe+vt*it+yt*ne+Ht*Ye,C[13]=ze*We+vt*Ut+yt*tt+Ht*xt,C[14]=ze*qe+vt*$+yt*kt+Ht*bt,C[15]=ze*Tt+vt*Qe+yt*dr+Ht*Et,C}function pe(C,R,q){var fe=q[0],We=q[1],qe=q[2],Tt,it,Ut,$,Qe,ne,tt,kt,dr,Ye,xt,bt;return R===C?(C[12]=R[0]*fe+R[4]*We+R[8]*qe+R[12],C[13]=R[1]*fe+R[5]*We+R[9]*qe+R[13],C[14]=R[2]*fe+R[6]*We+R[10]*qe+R[14],C[15]=R[3]*fe+R[7]*We+R[11]*qe+R[15]):(Tt=R[0],it=R[1],Ut=R[2],$=R[3],Qe=R[4],ne=R[5],tt=R[6],kt=R[7],dr=R[8],Ye=R[9],xt=R[10],bt=R[11],C[0]=Tt,C[1]=it,C[2]=Ut,C[3]=$,C[4]=Qe,C[5]=ne,C[6]=tt,C[7]=kt,C[8]=dr,C[9]=Ye,C[10]=xt,C[11]=bt,C[12]=Tt*fe+Qe*We+dr*qe+R[12],C[13]=it*fe+ne*We+Ye*qe+R[13],C[14]=Ut*fe+tt*We+xt*qe+R[14],C[15]=$*fe+kt*We+bt*qe+R[15]),C}function Ke(C,R,q){var fe=q[0],We=q[1],qe=q[2];return C[0]=R[0]*fe,C[1]=R[1]*fe,C[2]=R[2]*fe,C[3]=R[3]*fe,C[4]=R[4]*We,C[5]=R[5]*We,C[6]=R[6]*We,C[7]=R[7]*We,C[8]=R[8]*qe,C[9]=R[9]*qe,C[10]=R[10]*qe,C[11]=R[11]*qe,C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function Pe(C,R,q,fe){var We=fe[0],qe=fe[1],Tt=fe[2],it=Math.hypot(We,qe,Tt),Ut,$,Qe,ne,tt,kt,dr,Ye,xt,bt,Et,ze,vt,yt,Ht,hr,Hr,gr,Bn,zn,oa,$n,Yn,On;return it<x.b?null:(it=1/it,We*=it,qe*=it,Tt*=it,Ut=Math.sin(q),$=Math.cos(q),Qe=1-$,ne=R[0],tt=R[1],kt=R[2],dr=R[3],Ye=R[4],xt=R[5],bt=R[6],Et=R[7],ze=R[8],vt=R[9],yt=R[10],Ht=R[11],hr=We*We*Qe+$,Hr=qe*We*Qe+Tt*Ut,gr=Tt*We*Qe-qe*Ut,Bn=We*qe*Qe-Tt*Ut,zn=qe*qe*Qe+$,oa=Tt*qe*Qe+We*Ut,$n=We*Tt*Qe+qe*Ut,Yn=qe*Tt*Qe-We*Ut,On=Tt*Tt*Qe+$,C[0]=ne*hr+Ye*Hr+ze*gr,C[1]=tt*hr+xt*Hr+vt*gr,C[2]=kt*hr+bt*Hr+yt*gr,C[3]=dr*hr+Et*Hr+Ht*gr,C[4]=ne*Bn+Ye*zn+ze*oa,C[5]=tt*Bn+xt*zn+vt*oa,C[6]=kt*Bn+bt*zn+yt*oa,C[7]=dr*Bn+Et*zn+Ht*oa,C[8]=ne*$n+Ye*Yn+ze*On,C[9]=tt*$n+xt*Yn+vt*On,C[10]=kt*$n+bt*Yn+yt*On,C[11]=dr*$n+Et*Yn+Ht*On,R!==C&&(C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C)}function ht(C,R,q){var fe=Math.sin(q),We=Math.cos(q),qe=R[4],Tt=R[5],it=R[6],Ut=R[7],$=R[8],Qe=R[9],ne=R[10],tt=R[11];return R!==C&&(C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[4]=qe*We+$*fe,C[5]=Tt*We+Qe*fe,C[6]=it*We+ne*fe,C[7]=Ut*We+tt*fe,C[8]=$*We-qe*fe,C[9]=Qe*We-Tt*fe,C[10]=ne*We-it*fe,C[11]=tt*We-Ut*fe,C}function Le(C,R,q){var fe=Math.sin(q),We=Math.cos(q),qe=R[0],Tt=R[1],it=R[2],Ut=R[3],$=R[8],Qe=R[9],ne=R[10],tt=R[11];return R!==C&&(C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=qe*We-$*fe,C[1]=Tt*We-Qe*fe,C[2]=it*We-ne*fe,C[3]=Ut*We-tt*fe,C[8]=qe*fe+$*We,C[9]=Tt*fe+Qe*We,C[10]=it*fe+ne*We,C[11]=Ut*fe+tt*We,C}function _t(C,R,q){var fe=Math.sin(q),We=Math.cos(q),qe=R[0],Tt=R[1],it=R[2],Ut=R[3],$=R[4],Qe=R[5],ne=R[6],tt=R[7];return R!==C&&(C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=qe*We+$*fe,C[1]=Tt*We+Qe*fe,C[2]=it*We+ne*fe,C[3]=Ut*We+tt*fe,C[4]=$*We-qe*fe,C[5]=Qe*We-Tt*fe,C[6]=ne*We-it*fe,C[7]=tt*We-Ut*fe,C}function ot(C,R){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=R[0],C[13]=R[1],C[14]=R[2],C[15]=1,C}function et(C,R){return C[0]=R[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=R[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=R[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ze(C,R,q){var fe=q[0],We=q[1],qe=q[2],Tt=Math.hypot(fe,We,qe),it,Ut,$;return Tt<x.b?null:(Tt=1/Tt,fe*=Tt,We*=Tt,qe*=Tt,it=Math.sin(R),Ut=Math.cos(R),$=1-Ut,C[0]=fe*fe*$+Ut,C[1]=We*fe*$+qe*it,C[2]=qe*fe*$-We*it,C[3]=0,C[4]=fe*We*$-qe*it,C[5]=We*We*$+Ut,C[6]=qe*We*$+fe*it,C[7]=0,C[8]=fe*qe*$+We*it,C[9]=We*qe*$-fe*it,C[10]=qe*qe*$+Ut,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function At(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=fe,C[6]=q,C[7]=0,C[8]=0,C[9]=-q,C[10]=fe,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function St(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=fe,C[1]=0,C[2]=-q,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=q,C[9]=0,C[10]=fe,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function De(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=fe,C[1]=q,C[2]=0,C[3]=0,C[4]=-q,C[5]=fe,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ie(C,R,q){var fe=R[0],We=R[1],qe=R[2],Tt=R[3],it=fe+fe,Ut=We+We,$=qe+qe,Qe=fe*it,ne=fe*Ut,tt=fe*$,kt=We*Ut,dr=We*$,Ye=qe*$,xt=Tt*it,bt=Tt*Ut,Et=Tt*$;return C[0]=1-(kt+Ye),C[1]=ne+Et,C[2]=tt-bt,C[3]=0,C[4]=ne-Et,C[5]=1-(Qe+Ye),C[6]=dr+xt,C[7]=0,C[8]=tt+bt,C[9]=dr-xt,C[10]=1-(Qe+kt),C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Ge(C,R){var q=new x.a(3),fe=-R[0],We=-R[1],qe=-R[2],Tt=R[3],it=R[4],Ut=R[5],$=R[6],Qe=R[7],ne=fe*fe+We*We+qe*qe+Tt*Tt;return ne>0?(q[0]=(it*Tt+Qe*fe+Ut*qe-$*We)*2/ne,q[1]=(Ut*Tt+Qe*We+$*fe-it*qe)*2/ne,q[2]=($*Tt+Qe*qe+it*We-Ut*fe)*2/ne):(q[0]=(it*Tt+Qe*fe+Ut*qe-$*We)*2,q[1]=(Ut*Tt+Qe*We+$*fe-it*qe)*2,q[2]=($*Tt+Qe*qe+it*We-Ut*fe)*2),Ie(C,R,q),C}function dt(C,R){return C[0]=R[12],C[1]=R[13],C[2]=R[14],C}function we(C,R){var q=R[0],fe=R[1],We=R[2],qe=R[4],Tt=R[5],it=R[6],Ut=R[8],$=R[9],Qe=R[10];return C[0]=Math.hypot(q,fe,We),C[1]=Math.hypot(qe,Tt,it),C[2]=Math.hypot(Ut,$,Qe),C}function pt(C,R){var q=new x.a(3);we(q,R);var fe=1/q[0],We=1/q[1],qe=1/q[2],Tt=R[0]*fe,it=R[1]*We,Ut=R[2]*qe,$=R[4]*fe,Qe=R[5]*We,ne=R[6]*qe,tt=R[8]*fe,kt=R[9]*We,dr=R[10]*qe,Ye=Tt+Qe+dr,xt=0;return Ye>0?(xt=Math.sqrt(Ye+1)*2,C[3]=.25*xt,C[0]=(ne-kt)/xt,C[1]=(tt-Ut)/xt,C[2]=(it-$)/xt):Tt>Qe&&Tt>dr?(xt=Math.sqrt(1+Tt-Qe-dr)*2,C[3]=(ne-kt)/xt,C[0]=.25*xt,C[1]=(it+$)/xt,C[2]=(tt+Ut)/xt):Qe>dr?(xt=Math.sqrt(1+Qe-Tt-dr)*2,C[3]=(tt-Ut)/xt,C[0]=(it+$)/xt,C[1]=.25*xt,C[2]=(ne+kt)/xt):(xt=Math.sqrt(1+dr-Tt-Qe)*2,C[3]=(it-$)/xt,C[0]=(tt+Ut)/xt,C[1]=(ne+kt)/xt,C[2]=.25*xt),C}function Wt(C,R,q,fe){var We=R[0],qe=R[1],Tt=R[2],it=R[3],Ut=We+We,$=qe+qe,Qe=Tt+Tt,ne=We*Ut,tt=We*$,kt=We*Qe,dr=qe*$,Ye=qe*Qe,xt=Tt*Qe,bt=it*Ut,Et=it*$,ze=it*Qe,vt=fe[0],yt=fe[1],Ht=fe[2];return C[0]=(1-(dr+xt))*vt,C[1]=(tt+ze)*vt,C[2]=(kt-Et)*vt,C[3]=0,C[4]=(tt-ze)*yt,C[5]=(1-(ne+xt))*yt,C[6]=(Ye+bt)*yt,C[7]=0,C[8]=(kt+Et)*Ht,C[9]=(Ye-bt)*Ht,C[10]=(1-(ne+dr))*Ht,C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Qt(C,R,q,fe,We){var qe=R[0],Tt=R[1],it=R[2],Ut=R[3],$=qe+qe,Qe=Tt+Tt,ne=it+it,tt=qe*$,kt=qe*Qe,dr=qe*ne,Ye=Tt*Qe,xt=Tt*ne,bt=it*ne,Et=Ut*$,ze=Ut*Qe,vt=Ut*ne,yt=fe[0],Ht=fe[1],hr=fe[2],Hr=We[0],gr=We[1],Bn=We[2],zn=(1-(Ye+bt))*yt,oa=(kt+vt)*yt,$n=(dr-ze)*yt,Yn=(kt-vt)*Ht,On=(1-(tt+bt))*Ht,U=(xt+Et)*Ht,Z=(dr+ze)*hr,le=(xt-Et)*hr,xe=(1-(tt+Ye))*hr;return C[0]=zn,C[1]=oa,C[2]=$n,C[3]=0,C[4]=Yn,C[5]=On,C[6]=U,C[7]=0,C[8]=Z,C[9]=le,C[10]=xe,C[11]=0,C[12]=q[0]+Hr-(zn*Hr+Yn*gr+Z*Bn),C[13]=q[1]+gr-(oa*Hr+On*gr+le*Bn),C[14]=q[2]+Bn-($n*Hr+U*gr+xe*Bn),C[15]=1,C}function ur(C,R){var q=R[0],fe=R[1],We=R[2],qe=R[3],Tt=q+q,it=fe+fe,Ut=We+We,$=q*Tt,Qe=fe*Tt,ne=fe*it,tt=We*Tt,kt=We*it,dr=We*Ut,Ye=qe*Tt,xt=qe*it,bt=qe*Ut;return C[0]=1-ne-dr,C[1]=Qe+bt,C[2]=tt-xt,C[3]=0,C[4]=Qe-bt,C[5]=1-$-dr,C[6]=kt+Ye,C[7]=0,C[8]=tt+xt,C[9]=kt-Ye,C[10]=1-$-ne,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function oe(C,R,q,fe,We,qe,Tt){var it=1/(q-R),Ut=1/(We-fe),$=1/(qe-Tt);return C[0]=qe*2*it,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=qe*2*Ut,C[6]=0,C[7]=0,C[8]=(q+R)*it,C[9]=(We+fe)*Ut,C[10]=(Tt+qe)*$,C[11]=-1,C[12]=0,C[13]=0,C[14]=Tt*qe*2*$,C[15]=0,C}function J(C,R,q,fe,We){var qe=1/Math.tan(R/2),Tt;return C[0]=qe/q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=qe,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,We!=null&&We!==Infinity?(Tt=1/(fe-We),C[10]=(We+fe)*Tt,C[14]=2*We*fe*Tt):(C[10]=-1,C[14]=-2*fe),C}function H(C,R,q,fe){var We=Math.tan(R.upDegrees*Math.PI/180),qe=Math.tan(R.downDegrees*Math.PI/180),Tt=Math.tan(R.leftDegrees*Math.PI/180),it=Math.tan(R.rightDegrees*Math.PI/180),Ut=2/(Tt+it),$=2/(We+qe);return C[0]=Ut,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=$,C[6]=0,C[7]=0,C[8]=-((Tt-it)*Ut*.5),C[9]=(We-qe)*$*.5,C[10]=fe/(q-fe),C[11]=-1,C[12]=0,C[13]=0,C[14]=fe*q/(q-fe),C[15]=0,C}function Se(C,R,q,fe,We,qe,Tt){var it=1/(R-q),Ut=1/(fe-We),$=1/(qe-Tt);return C[0]=-2*it,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Ut,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*$,C[11]=0,C[12]=(R+q)*it,C[13]=(We+fe)*Ut,C[14]=(Tt+qe)*$,C[15]=1,C}function be(C,R,q,fe){var We,qe,Tt,it,Ut,$,Qe,ne,tt,kt,dr=R[0],Ye=R[1],xt=R[2],bt=fe[0],Et=fe[1],ze=fe[2],vt=q[0],yt=q[1],Ht=q[2];return Math.abs(dr-vt)<x.b&&Math.abs(Ye-yt)<x.b&&Math.abs(xt-Ht)<x.b?D(C):(Qe=dr-vt,ne=Ye-yt,tt=xt-Ht,kt=1/Math.hypot(Qe,ne,tt),Qe*=kt,ne*=kt,tt*=kt,We=Et*tt-ze*ne,qe=ze*Qe-bt*tt,Tt=bt*ne-Et*Qe,kt=Math.hypot(We,qe,Tt),kt?(kt=1/kt,We*=kt,qe*=kt,Tt*=kt):(We=0,qe=0,Tt=0),it=ne*Tt-tt*qe,Ut=tt*We-Qe*Tt,$=Qe*qe-ne*We,kt=Math.hypot(it,Ut,$),kt?(kt=1/kt,it*=kt,Ut*=kt,$*=kt):(it=0,Ut=0,$=0),C[0]=We,C[1]=it,C[2]=Qe,C[3]=0,C[4]=qe,C[5]=Ut,C[6]=ne,C[7]=0,C[8]=Tt,C[9]=$,C[10]=tt,C[11]=0,C[12]=-(We*dr+qe*Ye+Tt*xt),C[13]=-(it*dr+Ut*Ye+$*xt),C[14]=-(Qe*dr+ne*Ye+tt*xt),C[15]=1,C)}function Te(C,R,q,fe){var We=R[0],qe=R[1],Tt=R[2],it=fe[0],Ut=fe[1],$=fe[2],Qe=We-q[0],ne=qe-q[1],tt=Tt-q[2],kt=Qe*Qe+ne*ne+tt*tt;kt>0&&(kt=1/Math.sqrt(kt),Qe*=kt,ne*=kt,tt*=kt);var dr=Ut*tt-$*ne,Ye=$*Qe-it*tt,xt=it*ne-Ut*Qe;return kt=dr*dr+Ye*Ye+xt*xt,kt>0&&(kt=1/Math.sqrt(kt),dr*=kt,Ye*=kt,xt*=kt),C[0]=dr,C[1]=Ye,C[2]=xt,C[3]=0,C[4]=ne*xt-tt*Ye,C[5]=tt*dr-Qe*xt,C[6]=Qe*Ye-ne*dr,C[7]=0,C[8]=Qe,C[9]=ne,C[10]=tt,C[11]=0,C[12]=We,C[13]=qe,C[14]=Tt,C[15]=1,C}function me(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function at(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function Jt(C,R,q){return C[0]=R[0]+q[0],C[1]=R[1]+q[1],C[2]=R[2]+q[2],C[3]=R[3]+q[3],C[4]=R[4]+q[4],C[5]=R[5]+q[5],C[6]=R[6]+q[6],C[7]=R[7]+q[7],C[8]=R[8]+q[8],C[9]=R[9]+q[9],C[10]=R[10]+q[10],C[11]=R[11]+q[11],C[12]=R[12]+q[12],C[13]=R[13]+q[13],C[14]=R[14]+q[14],C[15]=R[15]+q[15],C}function Mt(C,R,q){return C[0]=R[0]-q[0],C[1]=R[1]-q[1],C[2]=R[2]-q[2],C[3]=R[3]-q[3],C[4]=R[4]-q[4],C[5]=R[5]-q[5],C[6]=R[6]-q[6],C[7]=R[7]-q[7],C[8]=R[8]-q[8],C[9]=R[9]-q[9],C[10]=R[10]-q[10],C[11]=R[11]-q[11],C[12]=R[12]-q[12],C[13]=R[13]-q[13],C[14]=R[14]-q[14],C[15]=R[15]-q[15],C}function ve(C,R,q){return C[0]=R[0]*q,C[1]=R[1]*q,C[2]=R[2]*q,C[3]=R[3]*q,C[4]=R[4]*q,C[5]=R[5]*q,C[6]=R[6]*q,C[7]=R[7]*q,C[8]=R[8]*q,C[9]=R[9]*q,C[10]=R[10]*q,C[11]=R[11]*q,C[12]=R[12]*q,C[13]=R[13]*q,C[14]=R[14]*q,C[15]=R[15]*q,C}function ge(C,R,q,fe){return C[0]=R[0]+q[0]*fe,C[1]=R[1]+q[1]*fe,C[2]=R[2]+q[2]*fe,C[3]=R[3]+q[3]*fe,C[4]=R[4]+q[4]*fe,C[5]=R[5]+q[5]*fe,C[6]=R[6]+q[6]*fe,C[7]=R[7]+q[7]*fe,C[8]=R[8]+q[8]*fe,C[9]=R[9]+q[9]*fe,C[10]=R[10]+q[10]*fe,C[11]=R[11]+q[11]*fe,C[12]=R[12]+q[12]*fe,C[13]=R[13]+q[13]*fe,C[14]=R[14]+q[14]*fe,C[15]=R[15]+q[15]*fe,C}function He(C,R){return C[0]===R[0]&&C[1]===R[1]&&C[2]===R[2]&&C[3]===R[3]&&C[4]===R[4]&&C[5]===R[5]&&C[6]===R[6]&&C[7]===R[7]&&C[8]===R[8]&&C[9]===R[9]&&C[10]===R[10]&&C[11]===R[11]&&C[12]===R[12]&&C[13]===R[13]&&C[14]===R[14]&&C[15]===R[15]}function st(C,R){var q=C[0],fe=C[1],We=C[2],qe=C[3],Tt=C[4],it=C[5],Ut=C[6],$=C[7],Qe=C[8],ne=C[9],tt=C[10],kt=C[11],dr=C[12],Ye=C[13],xt=C[14],bt=C[15],Et=R[0],ze=R[1],vt=R[2],yt=R[3],Ht=R[4],hr=R[5],Hr=R[6],gr=R[7],Bn=R[8],zn=R[9],oa=R[10],$n=R[11],Yn=R[12],On=R[13],U=R[14],Z=R[15];return Math.abs(q-Et)<=x.b*Math.max(1,Math.abs(q),Math.abs(Et))&&Math.abs(fe-ze)<=x.b*Math.max(1,Math.abs(fe),Math.abs(ze))&&Math.abs(We-vt)<=x.b*Math.max(1,Math.abs(We),Math.abs(vt))&&Math.abs(qe-yt)<=x.b*Math.max(1,Math.abs(qe),Math.abs(yt))&&Math.abs(Tt-Ht)<=x.b*Math.max(1,Math.abs(Tt),Math.abs(Ht))&&Math.abs(it-hr)<=x.b*Math.max(1,Math.abs(it),Math.abs(hr))&&Math.abs(Ut-Hr)<=x.b*Math.max(1,Math.abs(Ut),Math.abs(Hr))&&Math.abs($-gr)<=x.b*Math.max(1,Math.abs($),Math.abs(gr))&&Math.abs(Qe-Bn)<=x.b*Math.max(1,Math.abs(Qe),Math.abs(Bn))&&Math.abs(ne-zn)<=x.b*Math.max(1,Math.abs(ne),Math.abs(zn))&&Math.abs(tt-oa)<=x.b*Math.max(1,Math.abs(tt),Math.abs(oa))&&Math.abs(kt-$n)<=x.b*Math.max(1,Math.abs(kt),Math.abs($n))&&Math.abs(dr-Yn)<=x.b*Math.max(1,Math.abs(dr),Math.abs(Yn))&&Math.abs(Ye-On)<=x.b*Math.max(1,Math.abs(Ye),Math.abs(On))&&Math.abs(xt-U)<=x.b*Math.max(1,Math.abs(xt),Math.abs(U))&&Math.abs(bt-Z)<=x.b*Math.max(1,Math.abs(bt),Math.abs(Z))}var Oe=je,gt=Mt},Ztfv:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.tagProperty=y.tagParameter=y.decorate=void 0;var x=o("MON2"),m=o("xfSm");function Y(ee,ce,K,je){var pe=m.TAGGED;i(pe,ee,ce,je,K)}y.tagParameter=Y;function z(ee,ce,K){var je=m.TAGGED_PROP;i(je,ee.constructor,ce,K)}y.tagProperty=z;function i(ee,ce,K,je,pe){var Ke={},Pe=typeof pe=="number",ht=pe!==void 0&&Pe?pe.toString():K;if(Pe&&K!==void 0)throw new Error(x.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(ee,ce)&&(Ke=Reflect.getMetadata(ee,ce));var Le=Ke[ht];if(!Array.isArray(Le))Le=[];else for(var _t=0,ot=Le;_t<ot.length;_t++){var et=ot[_t];if(et.key===je.key)throw new Error(x.DUPLICATED_METADATA+" "+et.key.toString())}Le.push(je),Ke[ht]=Le,Reflect.defineMetadata(ee,Ke,ce)}function W(ee,ce){Reflect.decorate(ee,ce)}function D(ee,ce){return function(K,je){ce(K,je,ee)}}function Q(ee,ce,K){typeof K=="number"?W([D(K,ee)],ce):typeof K=="string"?Reflect.decorate([ee],ce,K):W([ee],ce)}y.decorate=Q},ZxFD:function(Ue,y,o){"use strict";o.r(y),o.d(y,"create",function(){return m}),o.d(y,"clone",function(){return Y}),o.d(y,"fromValues",function(){return z}),o.d(y,"copy",function(){return i}),o.d(y,"set",function(){return W}),o.d(y,"add",function(){return D}),o.d(y,"subtract",function(){return Q}),o.d(y,"multiply",function(){return ee}),o.d(y,"divide",function(){return ce}),o.d(y,"ceil",function(){return K}),o.d(y,"floor",function(){return je}),o.d(y,"min",function(){return pe}),o.d(y,"max",function(){return Ke}),o.d(y,"round",function(){return Pe}),o.d(y,"scale",function(){return ht}),o.d(y,"scaleAndAdd",function(){return Le}),o.d(y,"distance",function(){return _t}),o.d(y,"squaredDistance",function(){return ot}),o.d(y,"length",function(){return et}),o.d(y,"squaredLength",function(){return Ze}),o.d(y,"negate",function(){return At}),o.d(y,"inverse",function(){return St}),o.d(y,"normalize",function(){return De}),o.d(y,"dot",function(){return Ie}),o.d(y,"cross",function(){return Ge}),o.d(y,"lerp",function(){return dt}),o.d(y,"random",function(){return we}),o.d(y,"transformMat2",function(){return pt}),o.d(y,"transformMat2d",function(){return Wt}),o.d(y,"transformMat3",function(){return Qt}),o.d(y,"transformMat4",function(){return ur}),o.d(y,"rotate",function(){return oe}),o.d(y,"angle",function(){return J}),o.d(y,"zero",function(){return H}),o.d(y,"str",function(){return Se}),o.d(y,"exactEquals",function(){return be}),o.d(y,"equals",function(){return Te}),o.d(y,"len",function(){return me}),o.d(y,"sub",function(){return at}),o.d(y,"mul",function(){return Jt}),o.d(y,"div",function(){return Mt}),o.d(y,"dist",function(){return ve}),o.d(y,"sqrDist",function(){return ge}),o.d(y,"sqrLen",function(){return He}),o.d(y,"forEach",function(){return st});var x=o("yU0y");function m(){var Oe=new x.a(2);return x.a!=Float32Array&&(Oe[0]=0,Oe[1]=0),Oe}function Y(Oe){var gt=new x.a(2);return gt[0]=Oe[0],gt[1]=Oe[1],gt}function z(Oe,gt){var C=new x.a(2);return C[0]=Oe,C[1]=gt,C}function i(Oe,gt){return Oe[0]=gt[0],Oe[1]=gt[1],Oe}function W(Oe,gt,C){return Oe[0]=gt,Oe[1]=C,Oe}function D(Oe,gt,C){return Oe[0]=gt[0]+C[0],Oe[1]=gt[1]+C[1],Oe}function Q(Oe,gt,C){return Oe[0]=gt[0]-C[0],Oe[1]=gt[1]-C[1],Oe}function ee(Oe,gt,C){return Oe[0]=gt[0]*C[0],Oe[1]=gt[1]*C[1],Oe}function ce(Oe,gt,C){return Oe[0]=gt[0]/C[0],Oe[1]=gt[1]/C[1],Oe}function K(Oe,gt){return Oe[0]=Math.ceil(gt[0]),Oe[1]=Math.ceil(gt[1]),Oe}function je(Oe,gt){return Oe[0]=Math.floor(gt[0]),Oe[1]=Math.floor(gt[1]),Oe}function pe(Oe,gt,C){return Oe[0]=Math.min(gt[0],C[0]),Oe[1]=Math.min(gt[1],C[1]),Oe}function Ke(Oe,gt,C){return Oe[0]=Math.max(gt[0],C[0]),Oe[1]=Math.max(gt[1],C[1]),Oe}function Pe(Oe,gt){return Oe[0]=Math.round(gt[0]),Oe[1]=Math.round(gt[1]),Oe}function ht(Oe,gt,C){return Oe[0]=gt[0]*C,Oe[1]=gt[1]*C,Oe}function Le(Oe,gt,C,R){return Oe[0]=gt[0]+C[0]*R,Oe[1]=gt[1]+C[1]*R,Oe}function _t(Oe,gt){var C=gt[0]-Oe[0],R=gt[1]-Oe[1];return Math.hypot(C,R)}function ot(Oe,gt){var C=gt[0]-Oe[0],R=gt[1]-Oe[1];return C*C+R*R}function et(Oe){var gt=Oe[0],C=Oe[1];return Math.hypot(gt,C)}function Ze(Oe){var gt=Oe[0],C=Oe[1];return gt*gt+C*C}function At(Oe,gt){return Oe[0]=-gt[0],Oe[1]=-gt[1],Oe}function St(Oe,gt){return Oe[0]=1/gt[0],Oe[1]=1/gt[1],Oe}function De(Oe,gt){var C=gt[0],R=gt[1],q=C*C+R*R;return q>0&&(q=1/Math.sqrt(q)),Oe[0]=gt[0]*q,Oe[1]=gt[1]*q,Oe}function Ie(Oe,gt){return Oe[0]*gt[0]+Oe[1]*gt[1]}function Ge(Oe,gt,C){var R=gt[0]*C[1]-gt[1]*C[0];return Oe[0]=Oe[1]=0,Oe[2]=R,Oe}function dt(Oe,gt,C,R){var q=gt[0],fe=gt[1];return Oe[0]=q+R*(C[0]-q),Oe[1]=fe+R*(C[1]-fe),Oe}function we(Oe,gt){gt=gt||1;var C=x.c()*2*Math.PI;return Oe[0]=Math.cos(C)*gt,Oe[1]=Math.sin(C)*gt,Oe}function pt(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[2]*q,Oe[1]=C[1]*R+C[3]*q,Oe}function Wt(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[2]*q+C[4],Oe[1]=C[1]*R+C[3]*q+C[5],Oe}function Qt(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[3]*q+C[6],Oe[1]=C[1]*R+C[4]*q+C[7],Oe}function ur(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[4]*q+C[12],Oe[1]=C[1]*R+C[5]*q+C[13],Oe}function oe(Oe,gt,C,R){var q=gt[0]-C[0],fe=gt[1]-C[1],We=Math.sin(R),qe=Math.cos(R);return Oe[0]=q*qe-fe*We+C[0],Oe[1]=q*We+fe*qe+C[1],Oe}function J(Oe,gt){var C=Oe[0],R=Oe[1],q=gt[0],fe=gt[1],We=Math.sqrt(C*C+R*R)*Math.sqrt(q*q+fe*fe),qe=We&&(C*q+R*fe)/We;return Math.acos(Math.min(Math.max(qe,-1),1))}function H(Oe){return Oe[0]=0,Oe[1]=0,Oe}function Se(Oe){return"vec2("+Oe[0]+", "+Oe[1]+")"}function be(Oe,gt){return Oe[0]===gt[0]&&Oe[1]===gt[1]}function Te(Oe,gt){var C=Oe[0],R=Oe[1],q=gt[0],fe=gt[1];return Math.abs(C-q)<=x.b*Math.max(1,Math.abs(C),Math.abs(q))&&Math.abs(R-fe)<=x.b*Math.max(1,Math.abs(R),Math.abs(fe))}var me=et,at=Q,Jt=ee,Mt=ce,ve=_t,ge=ot,He=Ze,st=function(){var Oe=m();return function(gt,C,R,q,fe,We){var qe,Tt;for(C||(C=2),R||(R=0),q?Tt=Math.min(q*C+R,gt.length):Tt=gt.length,qe=R;qe<Tt;qe+=C)Oe[0]=gt[qe],Oe[1]=gt[qe+1],fe(Oe,Oe,We),gt[qe]=Oe[0],gt[qe+1]=Oe[1];return gt}}()},ZzCi:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.named=void 0;var x=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function z(i){return function(W,D,Q){var ee=new m.Metadata(x.NAMED_TAG,i);typeof Q=="number"?Y.tagParameter(W,D,Q,ee):Y.tagProperty(W,D,ee)}}y.named=z},a5Wf:function(Ue,y,o){"use strict";o.r(y);var x=o("IzEo"),m=o("bx4M"),Y=o("14J3"),z=o("BMrR"),i=o("jCWc"),W=o("kPKH"),D=o("1OyB"),Q=o("vuIU"),ee=o("Ji7U"),ce=o("LK+K"),K=o("aHsQ"),je=o("sGsY"),pe=o("nKUr"),Ke=o("9kvl"),Pe=o("q1tI"),ht=o.n(Pe),Le=o("HTcj"),_t=o("ZhIB"),ot=o.n(_t),et=o("yP6+"),Ze=o("VTBJ");function At(O){var d=O.style;d.height="100%";var c=parseInt("".concat(getComputedStyle(O).height),10),p=parseInt("".concat(getComputedStyle(O).paddingTop),10)+parseInt("".concat(getComputedStyle(O).paddingBottom),10);return c-p}function St(O){if(!O)return 0;var d=O,c=At(d),p=d.parentNode;return p&&(c=At(p)),c}function De(){return function(O){var d=function(c){Object(ee.a)(T,c);var p=Object(ce.a)(T);function T(){var j;Object(D.a)(this,T);for(var I=arguments.length,k=new Array(I),X=0;X<I;X++)k[X]=arguments[X];return j=p.call.apply(p,[this].concat(k)),j.state={computedHeight:0},j.root=null,j.handleRoot=function(ae){j.root=ae},j}return Object(Q.a)(T,[{key:"componentDidMount",value:function(){var I=this.props.height;if(!I&&this.root){var k=St(this.root);this.setState({computedHeight:k}),k<1&&(k=St(this.root),this.setState({computedHeight:k}))}}},{key:"render",value:function(){var I=this.props.height,k=this.state.computedHeight,X=I||k;return Object(pe.jsx)("div",{ref:this.handleRoot,"data-inspector-line":"70","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/autoHeight.tsx",children:X>0&&Object(pe.jsx)(O,Object(Ze.a)(Object(Ze.a)({},this.props),{},{height:X,"data-inspector-line":"71","data-inspector-column":"22","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/autoHeight.tsx"}))})}}]),T}(ht.a.Component);return d}}var Ie=De,Ge=et.Guide.Arc,dt=et.Guide.Html,we=et.Guide.Line,pt=function(d){switch(d){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};et.Shape.registerShape&&et.Shape.registerShape("point","pointer",{drawShape:function(d,c){var p=d.points[0];p=this.parsePoint(p);var T=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:T.x,y1:T.y,x2:p.x,y2:p.y,stroke:d.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:T.x,y:T.y,r:6,stroke:d.color,lineWidth:3,fill:"#fff"}})}});var Wt=function(d){var c=d.title,p=d.height,T=p===void 0?1:p,j=d.percent,I=d.forceFit,k=I===void 0?!0:I,X=d.formatter,ae=X===void 0?pt:X,Je=d.color,Ne=Je===void 0?"#2F9CFF":Je,Me=d.bgColor,mt=Me===void 0?"#F0F2F5":Me,ke={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},ct=[{value:j/10}],Be=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((ct[0].value*10).toFixed(2),`%
    </div>
  </div>`)},It={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Object(pe.jsxs)(et.Chart,{height:T,data:ct,scale:ke,padding:[-16,0,16,0],forceFit:k,"data-inspector-line":"107","data-inspector-column":"4","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx",children:[Object(pe.jsx)(et.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8,"data-inspector-line":"108","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(et.Axis,{name:"1",line:void 0,"data-inspector-line":"109","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(et.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:ae,textStyle:It},"data-inspector-line":"110","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsxs)(et.Guide,{"data-inspector-line":"122","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx",children:[Object(pe.jsx)(we,{start:[3,.905],end:[3,.85],lineStyle:{stroke:Ne,lineDash:void 0,lineWidth:2},"data-inspector-line":"123","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(we,{start:[5,.905],end:[5,.85],lineStyle:{stroke:Ne,lineDash:void 0,lineWidth:3},"data-inspector-line":"132","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(we,{start:[7,.905],end:[7,.85],lineStyle:{stroke:Ne,lineDash:void 0,lineWidth:3},"data-inspector-line":"141","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(Ge,{start:[0,.965],end:[10,.965],style:{stroke:mt,lineWidth:10},"data-inspector-line":"150","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(Ge,{start:[0,.965],end:[ct[0].value,.965],style:{stroke:Ne,lineWidth:10},"data-inspector-line":"158","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"}),Object(pe.jsx)(dt,{position:["50%","95%"],html:Be(),"data-inspector-line":"166","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"})]}),Object(pe.jsx)(et.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:Ne,active:!1,"data-inspector-line":"168","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Gauge/index.tsx"})]})},Qt=Ie()(Wt),ur={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"},oe=function(d){var c=d.height,p=c===void 0?1:c,T=d.data,j=T===void 0?[]:T,I=d.forceFit,k=I===void 0?!0:I,X=d.color,ae=X===void 0?"rgba(24, 144, 255, 0.2)":X,Je=d.borderColor,Ne=Je===void 0?"#1089ff":Je,Me=d.scale,mt=Me===void 0?{x:{},y:{}}:Me,ke=d.borderWidth,ct=ke===void 0?2:ke,Be=d.line,It=d.xAxis,$t=d.yAxis,ar=d.animate,tr=ar===void 0?!0:ar,pr=[36,5,30,5],wr={x:Object(Ze.a)({type:"cat",range:[0,1]},mt.x),y:Object(Ze.a)({min:0},mt.y)},$r=["x*y",function(un,_n){return{name:un,value:_n}}],Cn=p+54;return Object(pe.jsx)("div",{className:ur.miniChart,style:{height:p},"data-inspector-line":"71","data-inspector-column":"4","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx",children:Object(pe.jsx)("div",{className:ur.chartContent,"data-inspector-line":"72","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx",children:p>0&&Object(pe.jsxs)(et.Chart,{animate:tr,scale:wr,height:Cn,forceFit:k,data:j,padding:pr,"data-inspector-line":"74","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx",children:[Object(pe.jsx)(et.Axis,Object(Ze.a)(Object(Ze.a)({name:"x",label:null,line:null,tickLine:null,grid:null},It),{},{"data-inspector-line":"82","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),"axis-x"),Object(pe.jsx)(et.Axis,Object(Ze.a)(Object(Ze.a)({name:"y",label:null,line:null,tickLine:null,grid:null},$t),{},{"data-inspector-line":"91","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),"axis-y"),Object(pe.jsx)(et.Tooltip,{showTitle:!1,crosshairs:!1,"data-inspector-line":"100","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),Object(pe.jsx)(et.Geom,{type:"area",position:"x*y",color:ae,tooltip:$r,shape:"smooth",style:{fillOpacity:1},"data-inspector-line":"101","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}),Be?Object(pe.jsx)(et.Geom,{type:"line",position:"x*y",shape:"smooth",color:Ne,size:ct,tooltip:!1,"data-inspector-line":"112","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"}):Object(pe.jsx)("span",{style:{display:"none"},"data-inspector-line":"121","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/MiniArea/index.tsx"})]})})})},J=Ie()(oe),H=o("/zsF"),Se=o("PArb"),be=o("rePB"),Te=o("cQSq"),me=o.n(Te),at=o("9/5/"),Jt=o.n(at),Mt=o("Jssm"),ve=o.n(Mt),ge=o("TSYQ"),He=o.n(ge),st={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"},Oe=function(O){Object(ee.a)(c,O);var d=Object(ce.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={legendData:[],legendBlock:!1},p.chart=void 0,p.root=void 0,p.requestRef=0,p.resize=Jt()(function(){var k=p.props.hasLegend,X=p.state.legendBlock;if(!k||!p.root){window.removeEventListener("resize",p.resize);return}p.root&&p.root.parentNode&&p.root.parentNode.clientWidth<=380?X||p.setState({legendBlock:!0}):X&&p.setState({legendBlock:!1})},300),p.getG2Instance=function(k){p.chart=k,requestAnimationFrame(function(){p.getLegendData(),p.resize()})},p.getLegendData=function(){if(!p.chart)return;var k=p.chart.getAllGeoms()[0];if(!k)return;var X=k.get("dataArray")||[],ae=X.map(function(Je){var Ne=Je[0]._origin;return Ne.color=Je[0].color,Ne.checked=!0,Ne});p.setState({legendData:ae})},p.handleRoot=function(k){p.root=k},p.handleLegendClick=function(k,X){var ae=k;ae.checked=!ae.checked;var Je=p.state.legendData;Je[X]=ae;var Ne=Je.filter(function(Me){return Me.checked}).map(function(Me){return Me.x});p.chart&&p.chart.filter("x",function(Me){return Ne.indexOf("".concat(Me))>-1}),p.setState({legendData:Je})},p}return Object(Q.a)(c,[{key:"componentDidMount",value:function(){var T=this;window.addEventListener("resize",function(){T.requestRef=requestAnimationFrame(function(){return T.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(T){var j=this.props.data;j!==T.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var T,j=this,I=this.props,k=I.valueFormat,X=I.subTitle,ae=I.total,Je=I.hasLegend,Ne=Je===void 0?!1:Je,Me=I.className,mt=I.style,ke=I.height,ct=ke===void 0?0:ke,Be=I.forceFit,It=Be===void 0?!0:Be,$t=I.percent,ar=I.color,tr=I.inner,pr=tr===void 0?.75:tr,wr=I.animate,$r=wr===void 0?!0:wr,Cn=I.colors,un=I.lineWidth,_n=un===void 0?1:un,Kn=this.state,ka=Kn.legendData,Ei=Kn.legendBlock,Pi=He()(st.pie,Me,(T={},Object(be.a)(T,st.hasLegend,!!Ne),Object(be.a)(T,st.legendBlock,Ei),T)),Du=this.props,ou=Du.data,Xl=Du.selected,Ds=Xl===void 0?!0:Xl,Ns=Du.tooltip,Yl=Ns===void 0?!0:Ns,dc=ou||[],yu=Ds,Mc=Yl,Co=Cn;dc=dc||[],yu=yu||!0,Mc=Mc||!0;var _a,Ol={x:{type:"cat",range:[0,1]},y:{min:0}};($t||$t===0)&&(yu=!1,Mc=!1,_a=function(Gf){return Gf==="\u5360\u6BD4"?ar||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},dc=[{x:"\u5360\u6BD4",y:parseFloat("".concat($t))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat($t))}]);var nh=["x*percent",function(pc,Gf){return{name:pc,value:"".concat((Gf*100).toFixed(2),"%")}}],fh=[12,0,12,0],Nh=new Te.DataView;return Nh.source(dc).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Object(pe.jsxs)("div",{ref:this.handleRoot,className:Pi,style:mt,"data-inspector-line":"249","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[Object(pe.jsx)(ve.a,{maxFontSize:25,"data-inspector-line":"250","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:Object(pe.jsxs)("div",{className:st.chart,"data-inspector-line":"251","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[Object(pe.jsxs)(et.Chart,{scale:Ol,height:ct,forceFit:It,data:Nh,padding:fh,animate:$r,onGetG2Instance:this.getG2Instance,"data-inspector-line":"252","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[!!Mc&&Object(pe.jsx)(et.Tooltip,{showTitle:!1,"data-inspector-line":"261","data-inspector-column":"28","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)(et.Coord,{type:"theta",innerRadius:pr,"data-inspector-line":"262","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)(et.Geom,{style:{lineWidth:_n,stroke:"#fff"},tooltip:Mc?nh:void 0,type:"intervalStack",position:"percent",color:["x",$t||$t===0?_a:Co],selected:yu,"data-inspector-line":"263","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"})]}),(X||ae)&&Object(pe.jsxs)("div",{className:st.total,"data-inspector-line":"274","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[X&&Object(pe.jsx)("h4",{className:"pie-sub-title","data-inspector-line":"275","data-inspector-column":"29","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:X}),ae&&Object(pe.jsx)("div",{className:"pie-stat","data-inspector-line":"278","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:typeof ae=="function"?ae():ae})]})]})}),Ne&&Object(pe.jsx)("ul",{className:st.legend,"data-inspector-line":"286","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:ka.map(function(pc,Gf){return Object(pe.jsxs)("li",{onClick:function(){return j.handleLegendClick(pc,Gf)},"data-inspector-line":"288","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:[Object(pe.jsx)("span",{className:st.dot,style:{backgroundColor:pc.checked?pc.color:"#aaa"},"data-inspector-line":"289","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)("span",{className:st.legendTitle,"data-inspector-line":"295","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:pc.x}),Object(pe.jsx)(Se.a,{type:"vertical","data-inspector-line":"296","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx"}),Object(pe.jsx)("span",{className:st.percent,"data-inspector-line":"297","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:"".concat((Number.isNaN(pc.percent)?0:pc.percent*100).toFixed(2),"%")}),Object(pe.jsx)("span",{className:st.value,"data-inspector-line":"300","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Pie/index.tsx",children:k?k(pc.y):pc.y})]},pc.x)})})]})}}]),c}(Pe.Component),gt=Ie()(Oe),C=o("ODXe"),R={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"},q="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",fe=function(O){Object(ee.a)(c,O);var d=Object(ce.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={dv:null,height:0,width:0},p.requestRef=0,p.isUnmount=!1,p.root=void 0,p.imageMask=void 0,p.resize=function(){p.requestRef=requestAnimationFrame(function(){p.renderChart(p.props)})},p.saveRootRef=function(k){p.root=k},p.initTagCloud=function(){function k(X){return Object(Ze.a)(Object(Ze.a)({},X.style),{},{fillOpacity:X.opacity,fontSize:X.origin._origin.size,rotate:X.origin._origin.rotate,text:X.origin._origin.text,textAlign:"center",fontFamily:X.origin._origin.font,fill:X.color,textBaseline:"Alphabetic"})}et.Shape.registerShape("point","cloud",{drawShape:function(ae,Je){var Ne=k(ae);return Je.addShape("text",{attrs:Object(Ze.a)(Object(Ze.a)({},Ne),{},{x:ae.x,y:ae.y})})}})},p.renderChart=Jt()(function(k){var X=k||p.props,ae=X.data,Je=X.height;if(ae.length<1||!p.root)return;var Ne=Je,Me=p.root.offsetWidth,mt=function(){var ct=new me.a.View().source(ae),Be=ct.range("value"),It=Object(C.a)(Be,2),$t=It[0],ar=It[1];if(ct.transform({type:"tag-cloud",fields:["name","value"],imageMask:p.imageMask,font:"Verdana",size:[Me,Ne],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(pr){var wr=Math.pow((pr.value-$t)/(ar-$t),2);return wr*(17.5-5)+5}}),p.isUnmount)return;p.setState({dv:ct,width:Me,height:Ne})};p.imageMask?mt():(p.imageMask=new Image,p.imageMask.crossOrigin="",p.imageMask.src=q,p.imageMask.onload=mt)},200),p}return Object(Q.a)(c,[{key:"componentDidMount",value:function(){var T=this;requestAnimationFrame(function(){T.initTagCloud(),T.renderChart(T.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(T){var j=this.props.data;T&&JSON.stringify(T.data)!==JSON.stringify(j)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var T=this.props,j=T.className,I=T.height,k=this.state,X=k.dv,ae=k.width,Je=k.height;return Object(pe.jsx)("div",{className:He()(R.tagCloud,j),style:{width:"100%",height:I},ref:this.saveRootRef,"data-inspector-line":"174","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx",children:X&&Object(pe.jsxs)(et.Chart,{width:ae,height:Je,data:X,padding:0,scale:{x:{nice:!1},y:{nice:!1}},"data-inspector-line":"180","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx",children:[Object(pe.jsx)(et.Tooltip,{showTitle:!1,"data-inspector-line":"190","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx"}),Object(pe.jsx)(et.Coord,{reflect:"y","data-inspector-line":"191","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx"}),Object(pe.jsx)(et.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Me,mt){return{name:Me,value:mt}}],"data-inspector-line":"192","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/TagCloud/index.tsx"})]})})}}]),c}(Pe.Component),We=Ie()(fe),qe={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"},Tt=function(O){Object(ee.a)(c,O);var d=Object(ce.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={radio:1},p.timer=0,p.root=null,p.node=null,p.resize=function(){if(p.root){var k=p.props.height,X=k===void 0?1:k,ae=p.root.parentNode,Je=ae.offsetWidth;p.setState({radio:Je<X?Je/X:1})}},p}return Object(Q.a)(c,[{key:"componentDidMount",value:function(){var T=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return T.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(T){var j=this.props.percent;T.percent!==j&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(T){var j=this.props,I=j.percent,k=j.color,X=k===void 0?"#1890FF":k,ae=I/100,Je=this;if(cancelAnimationFrame(this.timer),!this.node||ae!==0&&!ae)return;var Ne=this.node,Me=Ne.getContext("2d");if(!Me)return;var mt=Ne.width,ke=Ne.height,ct=mt/2,Be=2,It=ct-Be;Me.beginPath(),Me.lineWidth=Be*2;for(var $t=mt-Be,ar=$t/8,tr=.2,pr=tr,wr=Be,$r=0,Cn=0,un=.005,_n=[],Kn=ct-Be,ka=-(Math.PI/2),Ei=!0,Pi=ka;Pi<ka+2*Math.PI;Pi+=1/(8*Math.PI))_n.push([ct+Kn*Math.cos(Pi),ct+Kn*Math.sin(Pi)]);var Du=_n.shift();Me.strokeStyle=X,Me.moveTo(Du[0],Du[1]);function ou(){if(!Me)return;Me.beginPath(),Me.save();for(var Ds=[],Ns=wr;Ns<=wr+$t;Ns+=20/$t){var Yl=$r+(wr+Ns)/ar,dc=Math.sin(Yl)*pr,yu=Ns,Mc=2*It*(1-Cn)+(ct-It)-ar*dc;Me.lineTo(yu,Mc),Ds.push([yu,Mc])}var Co=Ds.shift();Me.lineTo(wr+$t,ke),Me.lineTo(wr,ke),Me.lineTo(Co[0],Co[1]);var _a=Me.createLinearGradient(0,0,0,ke);_a.addColorStop(0,"#ffffff"),_a.addColorStop(1,X),Me.fillStyle=_a,Me.fill(),Me.restore()}function Xl(){if(!Me)return;if(Me.clearRect(0,0,mt,ke),Ei&&T!=="update")if(_n.length){var Ds=_n.shift();Me.lineTo(Ds[0],Ds[1]),Me.stroke()}else Ei=!1,Me.lineTo(Du[0],Du[1]),Me.stroke(),_n=[],Me.globalCompositeOperation="destination-over",Me.beginPath(),Me.lineWidth=Be,Me.arc(ct,ct,Kn,0,2*Math.PI,!0),Me.beginPath(),Me.save(),Me.arc(ct,ct,ct-3*Be,0,2*Math.PI,!0),Me.restore(),Me.clip(),Me.fillStyle=X;else{if(ae>=.85){if(pr>tr/4){var Ns=tr*.01;pr-=Ns}}else if(ae<=.1){if(pr<tr*1.5){var Yl=tr*.01;pr+=Yl}}else{if(pr<=tr){var dc=tr*.01;pr+=dc}if(pr>=tr){var yu=tr*.01;pr-=yu}}ae-Cn>0&&(Cn+=un),ae-Cn<0&&(Cn-=un),$r+=.07,ou()}Je.timer=requestAnimationFrame(Xl)}Xl()}},{key:"render",value:function(){var T=this,j=this.state.radio,I=this.props,k=I.percent,X=I.title,ae=I.height,Je=ae===void 0?1:ae;return Object(pe.jsxs)("div",{className:qe.waterWave,ref:function(Me){return T.root=Me},style:{transform:"scale(".concat(j,")")},"data-inspector-line":"214","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:[Object(pe.jsx)("div",{style:{width:Je,height:Je,overflow:"hidden"},"data-inspector-line":"219","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:Object(pe.jsx)("canvas",{className:qe.waterWaveCanvasWrapper,ref:function(Me){return T.node=Me},width:Je*2,height:Je*2,"data-inspector-line":"220","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx"})}),Object(pe.jsxs)("div",{className:qe.text,style:{width:Je},"data-inspector-line":"227","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:[X&&Object(pe.jsx)("span",{"data-inspector-line":"228","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:X}),Object(pe.jsxs)("h4",{"data-inspector-line":"229","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/WaterWave/index.tsx",children:[k,"%"]})]})]})}}]),c}(Pe.Component),it=Ie()(Tt),Ut=o("o0o1"),$=o.n(Ut),Qe=o("HaE+"),ne=Object(Pe.createContext)({});function tt(){return Object(Pe.useContext)(ne)}var kt=o("8ml+"),dr=o("lwsE"),Ye=o.n(dr),xt=o("W8MJ"),bt=o.n(xt),Et=o("7W2i"),ze=o.n(Et),vt=o("a1gu"),yt=o.n(vt),Ht=o("Nsbk"),hr=o.n(Ht),Hr=o("lSNA"),gr=o.n(Hr),Bn=o("yG8O"),zn=o.n(Bn),oa=o("U+yc"),$n=o.n(oa),Yn=o("1ABj"),On=o("h1nZ"),U,Z,le,xe,ut,wt;function Bt(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Xe(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?Bt(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):Bt(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}var Lt=(U=Object(On.lazyInject)(On.TYPES.ILogService),Z=Object(On.lazyInject)(On.TYPES.IGlobalConfigService),le=(wt=function(){function O(d){Ye()(this,O),zn()(this,"logger",xe,this),zn()(this,"configService",ut,this),this.config=void 0,this.config=d}return bt()(O,[{key:"setContainer",value:function(c,p){c.bind(On.TYPES.MapConfig).toConstantValue(Xe(Xe({},this.config),{},{id:p})),c.bind(On.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),O}(),wt),xe=$n()(le.prototype,"logger",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=$n()(le.prototype,"configService",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le),lr=o("QILm"),zr=o.n(lr),Vr=o("yXPU"),cr=o.n(Vr),Ur=o("hi0z"),Mn=o.n(Ur),ln=o("Hel2"),er=o("IOcx"),tn=o("4cb6"),hn={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},xn=o("J4zp"),yn=o.n(xn),vn=Math.PI/180,Pn=function(){function O(){Ye()(this,O),this.projectionMatrix=er.b.create(),this.viewMatrix=er.b.create(),this.viewProjectionMatrix=er.b.create(),this.ViewProjectionMatrixUncentered=er.b.create(),this.viewUncenteredMatrix=er.b.create(),this.zoom=void 0,this.center=void 0}return bt()(O,[{key:"syncWithMapCamera",value:function(c){var p=c.zoom,T=p===void 0?1:p,j=c.pitch,I=j===void 0?0:j,k=c.bearing,X=k===void 0?0:k,ae=c.center,Je=ae===void 0?[0,0]:ae,Ne=c.offsetOrigin,Me=Ne===void 0?[0,0]:Ne,mt=c.cameraHeight,ke=mt===void 0?1:mt,ct=c.aspect,Be=ct===void 0?1:ct,It=c.near,$t=It===void 0?.1:It,ar=c.far,tr=ar===void 0?1e3:ar,pr=c.fov,wr=pr===void 0?0:pr;this.zoom=T,this.center=Je;var $r=I*vn,Cn=(360-X)*vn;er.b.perspective(this.projectionMatrix,wr,Be,$t,tr);var un=er.d.fromValues(ke*Math.sin($r)*Math.sin(Cn),-ke*Math.sin($r)*Math.cos(Cn),ke*Math.cos($r)),_n=er.d.fromValues(-Math.cos($r)*Math.sin(Cn),Math.cos($r)*Math.cos(Cn),Math.sin($r));er.b.lookAt(this.viewMatrix,un,er.d.fromValues(0,0,0),_n),this.viewUncenteredMatrix=er.b.clone(this.viewMatrix),er.b.translate(this.viewMatrix,this.viewMatrix,er.d.fromValues(-Me[0],Me[1],0)),er.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),er.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=yn()(this.center,2),p=c[0],T=c[1];return[p,T]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){var T=85.0511287798,j=Math.max(Math.min(T,c[1]),-T),I=256<<20,k=Math.PI/180,X=c[0]*k,ae=j*k;ae=Math.log(Math.tan(Math.PI/4+ae/2));var Je=.5/Math.PI,Ne=.5,Me=-.5/Math.PI;return k=.5,X=I*(Je*X+Ne)-215440491,ae=-(I*(Me*ae+k)-106744817),[X,ae]}}]),O}(),Va,va,Ma,Ia,Zi,da,di,ga,ya,fa,Si,ns,Xi,Vo;function ju(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Ga(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?ju(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):ju(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}o("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var Ai=0;window.forceWebGL=!0;var Ko="15cd8a57710d40c9b7c0e3cc120f1200",oi="1.4.15",Yi="amap-script",wo=!1,Ha=[],oo=12,so=(Va=Object(tn.injectable)(),va=Object(tn.inject)(On.TYPES.IGlobalConfigService),Ma=Object(tn.inject)(On.TYPES.ILogService),Ia=Object(tn.inject)(On.TYPES.MapConfig),Zi=Object(tn.inject)(On.TYPES.ICoordinateSystemService),da=Object(tn.inject)(On.TYPES.IEventEmitter),Va(di=(ga=(Vo=function(){function O(){var d=this;Ye()(this,O),this.map=void 0,zn()(this,"configService",ya,this),zn()(this,"logger",fa,this),zn()(this,"config",Si,this),zn()(this,"coordinateSystemService",ns,this),zn()(this,"eventEmitter",Xi,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var p=c.camera,T=p.fov,j=p.near,I=p.far,k=p.height,X=p.pitch,ae=p.rotation,Je=p.aspect,Ne=p.position,Me=d.getCenter(),mt=Me.lng,ke=Me.lat;d.cameraChangedCallback&&(d.viewport.syncWithMapCamera({aspect:Je,bearing:360-ae,far:I,fov:T,cameraHeight:k,near:j,pitch:X,zoom:d.map.getZoom()-1,center:[mt,ke],offsetOrigin:[Ne.x,Ne.y]}),d.viewport.getZoom()>oo?d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.P20_OFFSET):d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.P20),d.cameraChangedCallback(d.viewport))}}return bt()(O,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var p=c.getElementsByClassName("amap-maps")[0];this.markerContainer=ln.a.create("div","l7-marker-container",p)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(c,p)}},{key:"off",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,p):this.map.off(c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),p=c.getNorthEast(),T=c.getSouthWest(),j=this.getCenter(),I=j.lng>p.getLng()||j.lng<T.getLng()?180-p.getLng():p.getLng(),k=j.lng<T.getLng()?T.getLng()-180:T.getLng();return[[k,T.getLat()],[I,p.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,p){this.map.setZoomAndCenter(c,p)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var p=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:p.getLng(),lat:p.getLat()}}},{key:"lngLatToPixel",value:function(c){var p=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:p.getX(),y:p.getY()}}},{key:"containerToLngLat",value:function(c){var p=new AMap.Pixel(c[0],c[1]),T=this.map.containerToLngLat(p);return{lng:T==null?void 0:T.getLng(),lat:T==null?void 0:T.getLat()}}},{key:"lngLatToContainer",value:function(c){var p=new AMap.LngLat(c[0],c[1]),T=this.map.lngLatToContainer(p);return{x:T.getX(),y:T.getY()}}},{key:"lngLatToMercator",value:function(c,p){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,p,T){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},k=this.viewport.projectFlat(c),X=er.b.create();return er.b.translate(X,X,er.d.fromValues(k[0],k[1],p)),er.b.scale(X,X,er.d.fromValues(j[0],j[1],j[2])),er.b.rotateX(X,X,T[0]),er.b.rotateY(X,X,T[1]),er.b.rotateZ(X,X,T[2]),X}},{key:"init",value:function(){var d=cr()($.a.mark(function p(){var T=this,j,I,k,X,ae,Je,Ne,Me,mt,ke,ct,Be,It,$t;return $.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return j=this.config,I=j.id,k=j.style,X=k===void 0?"light":k,ae=j.minZoom,Je=ae===void 0?0:ae,Ne=j.maxZoom,Me=Ne===void 0?18:Ne,mt=j.token,ke=mt===void 0?Ko:mt,ct=j.mapInstance,Be=j.plugin,It=Be===void 0?[]:Be,$t=zr()(j,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),tr.next=3,new Promise(function(pr){var wr=function(){if(ct)T.map=ct,T.$mapContainer=T.map.getContainer(),setTimeout(function(){T.map.on("camerachange",T.handleCameraChanged),pr()},30);else{T.$mapContainer=T.creatAmapContainer(I);var Cn=new AMap.Map(T.$mapContainer,Ga({mapStyle:T.getMapStyle(X),zooms:[Je,Me],viewMode:"3D"},$t));Cn.on("camerachange",T.handleCameraChanged),T.map=Cn,setTimeout(function(){pr()},10)}};!wo&&!ct?(ke===Ko&&T.logger.warn(T.configService.getSceneWarninfo("MapToken")),wo=!0,It.push("Map3D"),Mn.a.load({key:ke,version:oi,plugins:It}).then(function($r){wr(),Ha.length&&(Ha.forEach(function(Cn){return Cn()}),Ha=[])}).catch(function($r){throw new Error($r)})):wo&&window.AMap||ct?wr():Ha.push(wr)});case 3:this.viewport=new Pn;case 4:case"end":return tr.stop()}},p,this)}));function c(){return d.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var p,T=(p=this.getContainer())===null||p===void 0?void 0:p.getElementsByClassName("amap-layer")[0],j=c==="jpg"?T==null?void 0:T.toDataURL("image/jpeg"):T==null?void 0:T.toDataURL("image/png");return j}},{key:"emit",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).emit.apply(p,[c].concat(j))}},{key:"once",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).once.apply(p,[c].concat(j))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(Yi);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return hn[c]?hn[c]:c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var T=document.createElement("div");return T.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,T.id="l7_amap_div"+Ai++,p.appendChild(T),T}}]),O}(),Vo),ya=$n()(ga.prototype,"configService",[va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa=$n()(ga.prototype,"logger",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=$n()(ga.prototype,"config",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ns=$n()(ga.prototype,"coordinateSystemService",[Zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=$n()(ga.prototype,"eventEmitter",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ga))||di);function Eu(O){var d=$o();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Kl=function(O){ze()(c,O);var d=Eu(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return so}}]),c}(Lt);function ks(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function ho(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?ks(Object(c),!0).forEach(function(p){Vt(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):ks(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function Vt(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function Re(O,d){return Vn(O)||En(O,d)||mr(O,d)||Dt()}function Dt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mr(O,d){if(!O)return;if(typeof O=="string")return Qr(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Qr(O,d)}function Qr(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function En(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function Vn(O){if(Array.isArray(O))return O}var Ci=ht.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=O.option,j=O.onSceneLoaded,I=Object(Pe.createRef)(),k=Object(Pe.useState)(),X=Re(k,2),ae=X[0],Je=X[1];return Object(Pe.useEffect)(function(){var Ne=new kt.Scene(ho(ho({id:I.current},T),{},{map:new Kl(p)}));return Ne.on("loaded",function(){Je(Ne),j&&j(Ne)}),function(){Ne.destroy()}},[]),Object(Pe.useEffect)(function(){ae&&p.style&&ae.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(Pe.useEffect)(function(){ae&&p.zoom&&ae.setZoom(p.zoom)},[p.zoom]),Object(Pe.useEffect)(function(){ae&&p.center&&ae.setCenter(p.center)},[JSON.stringify(p.center)]),Object(Pe.useEffect)(function(){ae&&p.pitch&&ae.setPitch(p.pitch)},[p.pitch]),Object(Pe.useEffect)(function(){ae&&p.rotation&&ae.setRotation(p.rotation)},[p.rotation]),ht.a.createElement(ne.Provider,{value:ae},Object(Pe.createElement)("div",{ref:I,style:d,className:c},ae&&O.children))}),po=Ci,mo=o("4ZJM"),Oo=o.n(mo),Fu=o("md7G"),Ml=o("foSv"),bs=o("JX7q"),vc=o("bl9R");function Tu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Mo(O,d){var c=vc.transformMat4([],d,O);return vc.scale(c,c,1/c[3]),c}function zu(O,d){var c=O%d;return c<0?d+c:c}function Eo(O,d,c){return c*d+(1-c)*O}var Fi=o("ZaHm"),Ys=o("ZxFD"),Ks=o("n+fv");function js(O,d){if(!O)throw new Error(d||"viewport-mercator-project: assertion failed.")}var Ri=Math.PI,Vi=Ri/4,xs=Ri/180,vl=180/Ri,Qu=512,Rt=4003e4,fr=1.5;function Mr(O){return Math.pow(2,O)}function Zn(O){return Math.log2(O)}function Xa(O,d){var c=Object(C.a)(O,2),p=c[0],T=c[1];js(Number.isFinite(p)&&Number.isFinite(d)),js(Number.isFinite(T)&&T>=-90&&T<=90,"invalid latitude"),d*=Qu;var j=p*xs,I=T*xs,k=d*(j+Ri)/(2*Ri),X=d*(Ri-Math.log(Math.tan(Vi+I*.5)))/(2*Ri);return[k,X]}function vi(O,d){var c=Object(C.a)(O,2),p=c[0],T=c[1];d*=Qu;var j=p/d*(2*Ri)-Ri,I=2*(Math.atan(Math.exp(Ri-T/d*(2*Ri)))-Vi);return[j*vl,I*vl]}function Ki(O){var d=O.latitude;js(Number.isFinite(d));var c=Math.cos(d*xs);return Zn(Rt*c)-9}function Ya(O){var d=O.latitude,c=O.longitude,p=O.zoom,T=O.scale,j=O.highPrecision,I=j===void 0?!1:j;T=T!==void 0?T:Mr(p),js(Number.isFinite(d)&&Number.isFinite(c)&&Number.isFinite(T));var k={},X=Qu*T,ae=Math.cos(d*xs),Je=X/360,Ne=Je/ae,Me=X/Rt/ae;if(k.pixelsPerMeter=[Me,-Me,Me],k.metersPerPixel=[1/Me,-1/Me,1/Me],k.pixelsPerDegree=[Je,-Ne,Me],k.degreesPerPixel=[1/Je,-1/Ne,1/Me],I){var mt=xs*Math.tan(d*xs)/ae,ke=Je*mt/2,ct=X/Rt*mt,Be=ct/Ne*Me;k.pixelsPerDegree2=[0,-ke,ct],k.pixelsPerMeter2=[Be,0,Be]}return k}function Ii(O,d){var c=Object(C.a)(O,3),p=c[0],T=c[1],j=c[2],I=Object(C.a)(d,3),k=I[0],X=I[1],ae=I[2],Je=1,Ne=Ya({longitude:p,latitude:T,scale:Je,highPrecision:!0}),Me=Ne.pixelsPerMeter,mt=Ne.pixelsPerMeter2,ke=Xa(O,Je);ke[0]+=k*(Me[0]+mt[0]*X),ke[1]+=X*(Me[1]+mt[1]*X);var ct=vi(ke,Je),Be=(j||0)+(ae||0);return Number.isFinite(j)||Number.isFinite(ae)?[ct[0],ct[1],Be]:ct}function Go(O){var d=O.height,c=O.pitch,p=O.bearing,T=O.altitude,j=O.center,I=j===void 0?null:j,k=O.flipY,X=k===void 0?!1:k,ae=Tu();return Fi.translate(ae,ae,[0,0,-T]),Fi.scale(ae,ae,[1,1,1/d]),Fi.rotateX(ae,ae,-c*xs),Fi.rotateZ(ae,ae,p*xs),X&&Fi.scale(ae,ae,[1,-1,1]),I&&Fi.translate(ae,ae,Ks.negate([],I)),ae}function Cs(O){var d=O.width,c=O.height,p=O.altitude,T=p===void 0?fr:p,j=O.pitch,I=j===void 0?0:j,k=O.nearZMultiplier,X=k===void 0?1:k,ae=O.farZMultiplier,Je=ae===void 0?1:ae,Ne=I*xs,Me=Math.atan(.5/T),mt=Math.sin(Me)*T/Math.sin(Math.PI/2-Ne-Me),ke=Math.cos(Math.PI/2-Ne)*mt+T;return{fov:2*Math.atan(c/2/T),aspect:d/c,focalDistance:T,near:X,far:ke*Je}}function pi(O){var d=O.width,c=O.height,p=O.pitch,T=O.altitude,j=O.nearZMultiplier,I=O.farZMultiplier,k=Cs({width:d,height:c,altitude:T,pitch:p,nearZMultiplier:j,farZMultiplier:I}),X=k.fov,ae=k.aspect,Je=k.near,Ne=k.far,Me=Fi.perspective([],X,ae,Je,Ne);return Me}function Pl(O,d){var c=Object(C.a)(O,3),p=c[0],T=c[1],j=c[2],I=j===void 0?0:j;return js(Number.isFinite(p)&&Number.isFinite(T)&&Number.isFinite(I)),Mo(d,[p,T,I,1])}function $s(O,d){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,p=Object(C.a)(O,3),T=p[0],j=p[1],I=p[2];if(js(Number.isFinite(T)&&Number.isFinite(j),"invalid pixel coordinate"),Number.isFinite(I)){var k=Mo(d,[T,j,I,1]);return k}var X=Mo(d,[T,j,0,1]),ae=Mo(d,[T,j,1,1]),Je=X[2],Ne=ae[2],Me=Je===Ne?0:((c||0)-Je)/(Ne-Je);return Ys.lerp([],X,ae,Me)}var Es=Tu(),gl=function(){function O(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=d.width,p=d.height,T=d.viewMatrix,j=T===void 0?Es:T,I=d.projectionMatrix,k=I===void 0?Es:I;Object(D.a)(this,O),this.width=c||1,this.height=p||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=j,this.projectionMatrix=k;var X=Tu();Fi.multiply(X,X,this.projectionMatrix),Fi.multiply(X,X,this.viewMatrix),this.viewProjectionMatrix=X;var ae=Tu();Fi.scale(ae,ae,[this.width/2,-this.height/2,1]),Fi.translate(ae,ae,[1,-1,0]),Fi.multiply(ae,ae,this.viewProjectionMatrix);var Je=Fi.invert(Tu(),ae);if(!Je)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=ae,this.pixelUnprojectionMatrix=Je,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(Q.a)(O,[{key:"equals",value:function(c){return c instanceof O?c.width===this.width&&c.height===this.height&&Fi.equals(c.projectionMatrix,this.projectionMatrix)&&Fi.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=p.topLeft,j=T===void 0?!0:T,I=this.projectPosition(c),k=Pl(I,this.pixelProjectionMatrix),X=Object(C.a)(k,2),ae=X[0],Je=X[1],Ne=j?Je:this.height-Je;return c.length===2?[ae,Ne]:[ae,Ne,k[2]]}},{key:"unproject",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=p.topLeft,j=T===void 0?!0:T,I=p.targetZ,k=Object(C.a)(c,3),X=k[0],ae=k[1],Je=k[2],Ne=j?ae:this.height-ae,Me=I&&I*this.pixelsPerMeter,mt=$s([X,Ne,Je],this.pixelUnprojectionMatrix,Me),ke=this.unprojectPosition(mt),ct=Object(C.a)(ke,3),Be=ct[0],It=ct[1],$t=ct[2];return Number.isFinite(Je)?[Be,It,$t]:Number.isFinite(I)?[Be,It,I]:[Be,It]}},{key:"projectPosition",value:function(c){var p=this.projectFlat(c),T=Object(C.a)(p,2),j=T[0],I=T[1],k=(c[2]||0)*this.pixelsPerMeter;return[j,I,k]}},{key:"unprojectPosition",value:function(c){var p=this.unprojectFlat(c),T=Object(C.a)(p,2),j=T[0],I=T[1],k=(c[2]||0)/this.pixelsPerMeter;return[j,I,k]}},{key:"projectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),O}();function cu(O){var d=O.width,c=O.height,p=O.bounds,T=O.minExtent,j=T===void 0?0:T,I=O.maxZoom,k=I===void 0?24:I,X=O.padding,ae=X===void 0?0:X,Je=O.offset,Ne=Je===void 0?[0,0]:Je,Me=Object(C.a)(p,2),mt=Object(C.a)(Me[0],2),ke=mt[0],ct=mt[1],Be=Object(C.a)(Me[1],2),It=Be[0],$t=Be[1];if(Number.isFinite(ae)){var ar=ae;ae={top:ar,bottom:ar,left:ar,right:ar}}else js(Number.isFinite(ae.top)&&Number.isFinite(ae.bottom)&&Number.isFinite(ae.left)&&Number.isFinite(ae.right));var tr=new _u({width:d,height:c,longitude:0,latitude:0,zoom:0}),pr=tr.project([ke,$t]),wr=tr.project([It,ct]),$r=[Math.max(Math.abs(wr[0]-pr[0]),j),Math.max(Math.abs(wr[1]-pr[1]),j)],Cn=[d-ae.left-ae.right-Math.abs(Ne[0])*2,c-ae.top-ae.bottom-Math.abs(Ne[1])*2];js(Cn[0]>0&&Cn[1]>0);var un=Cn[0]/$r[0],_n=Cn[1]/$r[1],Kn=(ae.right-ae.left)/2/un,ka=(ae.bottom-ae.top)/2/_n,Ei=[(wr[0]+pr[0])/2+Kn,(wr[1]+pr[1])/2+ka],Pi=tr.unproject(Ei),Du=tr.zoom+Math.log2(Math.abs(Math.min(un,_n)));return{longitude:Pi[0],latitude:Pi[1],zoom:Math.min(Du,k)}}var _u=function(O){Object(ee.a)(d,O);function d(){var c,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=p.width,j=p.height,I=p.latitude,k=I===void 0?0:I,X=p.longitude,ae=X===void 0?0:X,Je=p.zoom,Ne=Je===void 0?0:Je,Me=p.pitch,mt=Me===void 0?0:Me,ke=p.bearing,ct=ke===void 0?0:ke,Be=p.altitude,It=Be===void 0?1.5:Be,$t=p.nearZMultiplier,ar=p.farZMultiplier;Object(D.a)(this,d),T=T||1,j=j||1;var tr=Mr(Ne);It=Math.max(.75,It);var pr=Xa([ae,k],tr);pr[2]=0;var wr=pi({width:T,height:j,pitch:mt,bearing:ct,altitude:It,nearZMultiplier:$t||1/j,farZMultiplier:ar||1.01}),$r=Go({height:j,center:pr,pitch:mt,bearing:ct,altitude:It,flipY:!0});return c=Object(Fu.a)(this,Object(Ml.a)(d).call(this,{width:T,height:j,viewMatrix:$r,projectionMatrix:wr})),c.latitude=k,c.longitude=ae,c.zoom=Ne,c.pitch=mt,c.bearing=ct,c.altitude=It,c.scale=tr,c.center=pr,c.pixelsPerMeter=Ya(Object(bs.a)(Object(bs.a)(c))).pixelsPerMeter[2],Object.freeze(Object(bs.a)(Object(bs.a)(c))),c}return Object(Q.a)(d,[{key:"projectFlat",value:function(p){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Xa(p,T)}},{key:"unprojectFlat",value:function(p){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return vi(p,T)}},{key:"getMapCenterByLngLatPosition",value:function(p){var T=p.lngLat,j=p.pos,I=$s(j,this.pixelUnprojectionMatrix),k=Xa(T,this.scale),X=Ys.add([],k,Ys.negate([],I)),ae=Ys.add([],this.center,X);return vi(ae,this.scale)}},{key:"getLocationAtPoint",value:function(p){var T=p.lngLat,j=p.pos;return this.getMapCenterByLngLatPosition({lngLat:T,pos:j})}},{key:"fitBounds",value:function(p){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},j=this.width,I=this.height,k=cu(Object.assign({width:j,height:I,bounds:p},T)),X=k.longitude,ae=k.latitude,Je=k.zoom;return new d({width:j,height:I,longitude:X,latitude:ae,zoom:Je})}}]),d}(gl),fu=function(){function O(){Ye()(this,O),this.viewport=void 0}return bt()(O,[{key:"syncWithMapCamera",value:function(c){var p=c.center,T=c.zoom,j=c.pitch,I=c.bearing,k=c.viewportHeight,X=c.viewportWidth;this.viewport=new _u({width:X,height:k,longitude:p&&p[0],latitude:p&&p[1],zoom:T,pitch:j,bearing:I})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),O}(),Uu={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Js,Rc,pf,ci,Ic,gc,Qc,yl,qc,$i,Su,bl,as,Dc;function yc(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Ll(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?yc(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):yc(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Oo.a;var qu={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Nc=0,hu=12,Au="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",ef=(Js=Object(tn.injectable)(),Rc=Object(tn.inject)(On.TYPES.MapConfig),pf=Object(tn.inject)(On.TYPES.IGlobalConfigService),ci=Object(tn.inject)(On.TYPES.ILogService),Ic=Object(tn.inject)(On.TYPES.ICoordinateSystemService),gc=Object(tn.inject)(On.TYPES.IEventEmitter),Js(Qc=(yl=(Dc=function(){function O(){var d=this;Ye()(this,O),this.map=void 0,zn()(this,"config",qc,this),zn()(this,"configService",$i,this),zn()(this,"logger",Su,this),zn()(this,"coordinateSystemService",bl,this),zn()(this,"eventEmitter",as,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=d.map.getCenter().wrap(),p=c.lat,T=c.lng;d.viewport.syncWithMapCamera({bearing:d.map.getBearing(),center:[T,p],viewportHeight:d.map.transform.height,pitch:d.map.getPitch(),viewportWidth:d.map.transform.width,zoom:d.map.getZoom(),cameraHeight:0}),d.viewport.getZoom()>hu?d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT_OFFSET):d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT),d.cameraChangedCallback(d.viewport)}}return bt()(O,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=ln.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(qu[c]||c,p)}},{key:"off",value:function(c,p){this.map.off(qu[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){var T=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),j=T.x,I=j===void 0?0:j,k=T.y,X=k===void 0?0:k,ae=T.z,Je=ae===void 0?0:ae;return{x:I,y:X,z:Je}}},{key:"getModelMatrix",value:function(c,p,T){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},k=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),X=k.meterInMercatorCoordinateUnits(),ae=er.b.create();return er.b.translate(ae,ae,er.d.fromValues(k.x-I.x,k.y-I.y,k.z||0-I.z)),er.b.scale(ae,ae,er.d.fromValues(X*j[0],-X*j[1],X*j[2])),er.b.rotateX(ae,ae,T[0]),er.b.rotateY(ae,ae,T[1]),er.b.rotateZ(ae,ae,T[2]),ae}},{key:"init",value:function(){var d=cr()($.a.mark(function p(){var T,j,I,k,X,ae,Je,Ne,Me,mt,ke,ct,Be;return $.a.wrap(function($t){for(;;)switch($t.prev=$t.next){case 0:T=this.config,j=T.id,I=j===void 0?"map":j,k=T.attributionControl,X=k===void 0?!1:k,ae=T.style,Je=ae===void 0?"light":ae,Ne=T.token,Me=Ne===void 0?Au:Ne,mt=T.rotation,ke=mt===void 0?0:mt,ct=T.mapInstance,Be=zr()(T,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new fu,!ct&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Me===Au&&Je!=="blank"&&!window.mapboxgl.accessToken&&!ct&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!ct&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Me),ct?(this.map=ct,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(I),this.map=new window.mapboxgl.Map(Ll({container:this.$mapContainer,style:this.getMapStyle(Je),attributionControl:X,bearing:ke},Be))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return $t.stop()}},p,this)}));function c(){return d.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).emit.apply(p,[c].concat(j))}},{key:"once",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).once.apply(p,[c].concat(j))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),T=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return T}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var T=document.createElement("div");return T.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,T.id="l7_mapbox_div"+Nc++,p.appendChild(T),T}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:Uu[c]?Uu[c]:c}}]),O}(),Dc),qc=$n()(yl.prototype,"config",[Rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$i=$n()(yl.prototype,"configService",[pf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Su=$n()(yl.prototype,"logger",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl=$n()(yl.prototype,"coordinateSystemService",[Ic],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as=$n()(yl.prototype,"eventEmitter",[gc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl))||Qc);function $l(O){var d=Ti();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Ti(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var tf=function(O){ze()(c,O);var d=$l(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return ef}}]),c}(Lt);function mf(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Jl(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?mf(Object(c),!0).forEach(function(p){kc(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):mf(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function kc(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function Ql(O,d){return ql(O)||Po(O,d)||Bu(O,d)||el()}function el(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bu(O,d){if(!O)return;if(typeof O=="string")return xl(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return xl(O,d)}function xl(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function Po(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function ql(O){if(Array.isArray(O))return O}var Rl=ht.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=O.option,j=O.onSceneLoaded,I=Object(Pe.createRef)(),k=Object(Pe.useState)(),X=Ql(k,2),ae=X[0],Je=X[1];return Object(Pe.useEffect)(function(){var Ne=new kt.Scene(Jl(Jl({id:I.current},T),{},{map:new tf(p)}));return Ne.on("loaded",function(){Je(Ne),j&&j(Ne)}),function(){Ne.destroy()}},[]),Object(Pe.useEffect)(function(){ae&&p.style&&ae.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(Pe.useEffect)(function(){ae&&p.zoom&&ae.setZoom(p.zoom)},[p.zoom]),Object(Pe.useEffect)(function(){ae&&p.center&&ae.setCenter(p.center)},[JSON.stringify(p.center)]),Object(Pe.useEffect)(function(){ae&&p.pitch!==void 0&&ae.setPitch(p.pitch||0)},[p.pitch]),Object(Pe.useEffect)(function(){ae&&p.rotation&&ae.setRotation(p.rotation)},[p.rotation]),ht.a.createElement(ne.Provider,{value:ae},Object(Pe.createElement)("div",{ref:I,style:d,className:c},ae&&O.children))}),Il=Rl,jc=o("PJYZ"),El=o.n(jc),Qs=o("QkVN"),eo=o.n(Qs),vf=o("uhBA"),gf=o("cDf5"),Tl=o.n(gf),ec=o("zvhG"),tl=o.n(ec);function Dl(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=bc(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function bc(O,d){if(!O)return;if(typeof O=="string")return xc(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return xc(O,d)}function xc(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var rl;function rf(O,d,c){var p=c-d,T=((O-d)%p+p)%p+d;return T===d?c:T}function nl(O,d,c){return Math.min(c,Math.max(d,O))}function qs(O,d,c){return O*(1-c)+d*c}function _l(O,d,c,p){var T=new tl.a(O,d,c,p);return function(j){return T.solve(j)}}var tc=_l(.25,.1,.25,1);function Fc(){return window.matchMedia?(rl==null&&(rl=window.matchMedia("(prefers-reduced-motion: reduce)")),rl.matches):!1}function nf(O,d){var c={},p=Dl(d),T;try{for(p.s();!(T=p.n()).done;){var j=T.value;j in O&&(c[j]=O[j])}}catch(I){p.e(I)}finally{p.f()}return c}var Fs=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),yf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,al=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function wi(O){var d=yf(O);return{cancel:function(){return al(d)}}}var il=function(){bt()(O,null,[{key:"convert",value:function(c){return c instanceof O?c:new O(c)}}]);function O(d,c){Ye()(this,O),this.ne=void 0,this.sw=void 0,d&&(c?this.setSouthWest(d).setNorthEast(c):d.length===4?this.setSouthWest([d[0],d[1]]).setNorthEast([d[2],d[3]]):this.setSouthWest(d[0]).setNorthEast(d[1]))}return bt()(O,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof ui?new ui(c.lng,c.lat):ui.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof ui?new ui(c.lng,c.lat):ui.convert(c),this}},{key:"extend",value:function(c){var p=this.sw,T=this.ne,j,I;if(c instanceof ui)j=c,I=c;else if(c instanceof O){if(j=c.sw,I=c.ne,!j||!I)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var k=c;return this.extend(O.convert(k))}else{var X=c;return this.extend(ui.convert(X))}return this}return!p&&!T?(this.sw=new ui(j.lng,j.lat),this.ne=new ui(I.lng,I.lat)):(p.lng=Math.min(j.lng,p.lng),p.lat=Math.min(j.lat,p.lat),T.lng=Math.max(I.lng,T.lng),T.lat=Math.max(I.lat,T.lat)),this}},{key:"getCenter",value:function(){return new ui((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new ui(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new ui(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var p=ui.convert(c),T=p.lng,j=p.lat,I=this.sw.lat<=j&&j<=this.ne.lat,k=this.sw.lng<=T&&T<=this.ne.lng;return this.sw.lng>this.ne.lng&&(k=this.sw.lng>=T&&T>=this.ne.lng),I&&k}}]),O}(),Vu=63710088e-1,ui=function(){bt()(O,null,[{key:"convert",value:function(c){if(c instanceof O)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new O(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&Tl()(c)==="object"&&c!==null){var p="lng"in c?c.lng:c.lon;return new O(Number(p),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function O(d,c){if(Ye()(this,O),this.lng=void 0,this.lat=void 0,isNaN(d)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(d,", ").concat(c,")"));if(this.lng=+d,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return bt()(O,[{key:"wrap",value:function(){return new O(rf(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=40075017,T=360*c/p,j=T/Math.cos(Math.PI/180*this.lat);return new il(new O(this.lng-j,this.lat-T),new O(this.lng+j,this.lat+T))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var p=Math.PI/180,T=this.lat*p,j=c.lat*p,I=Math.sin(T)*Math.sin(j)+Math.cos(T)*Math.cos(j)*Math.cos((c.lng-this.lng)*p),k=Vu*Math.acos(Math.min(I,1));return k}}]),O}(),kn=function(){bt()(O,null,[{key:"convert",value:function(c){return c instanceof O?c:Array.isArray(c)?new O(c[0],c[1]):c}}]);function O(d,c){Ye()(this,O),this.x=void 0,this.y=void 0,this.x=d,this.y=c}return bt()(O,[{key:"clone",value:function(){return new O(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var p=Math.cos(c),T=Math.sin(c),j=p*this.x-T*this.y,I=T*this.x+p*this.y;return this.x=j,this.y=I,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,p){var T=Math.cos(c),j=Math.sin(c),I=p.x+T*(this.x-p.x)-j*(this.y-p.y),k=p.y+j*(this.x-p.x)+T*(this.y-p.y);return this.x=I,this.y=k,this}},{key:"roateAround",value:function(c,p){return this.clone()._rotateAround(c,p)}},{key:"_matMult",value:function(c){var p=c[0]*this.x+c[1]*this.y,T=c[2]*this.x+c[3]*this.y;return this.x=p,this.y=T,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var p=c.x-this.x,T=c.y-this.y;return p*p+T*T}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,p){return Math.atan2(this.x*p-this.y*c,this.x*c+this.y*p)}}]),O}(),Oi=function(){function O(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Ye()(this,O),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(d)||d<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=c,this.left=p,this.right=T}return bt()(O,[{key:"interpolate",value:function(c,p,T){return p.top!=null&&c.top!=null&&(this.top=qs(c.top,p.top,T)),p.bottom!=null&&c.bottom!=null&&(this.bottom=qs(c.bottom,p.bottom,T)),p.left!=null&&c.left!=null&&(this.left=qs(c.left,p.left,T)),p.right!=null&&c.right!=null&&(this.right=qs(c.right,p.right,T)),this}},{key:"getCenter",value:function(c,p){var T=nl((this.left+c-this.right)/2,0,c),j=nl((this.top+p-this.bottom)/2,0,p);return new kn(T,j)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new O(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),O}(),ws=2*Math.PI*Vu;function Nl(O){return ws*Math.cos(O*Math.PI/180)}function Gu(O){return(180+O)/360}function ol(O){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+O*Math.PI/360)))/360}function bf(O,d){return O/Nl(d)}function is(O){return O*360-180}function Sl(O){var d=180-O*360;return 360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90}function sl(O,d){return O*Nl(Sl(d))}function ul(O){return 1/Math.cos(O*Math.PI/180)}var zi=function(){bt()(O,null,[{key:"fromLngLat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=ui.convert(c);return new O(Gu(T.lng),ol(T.lat),bf(p,T.lat))}}]);function O(d,c){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Ye()(this,O),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+d,this.y=+c,this.z=+p}return bt()(O,[{key:"toLngLat",value:function(){return new ui(is(this.x),Sl(this.y))}},{key:"toAltitude",value:function(){return sl(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/ws*ul(Sl(this.y))}}]),O}();function Ts(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=kl(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function kl(O,d){if(!O)return;if(typeof O=="string")return to(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return to(O,d)}function to(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var In=8192,zs=function(){bt()(O,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){if(this._minZoom===c)return;this._minZoom=c,this.zoom=Math.max(this.zoom,c)}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){if(this._maxZoom===c)return;this._maxZoom=c,this.zoom=Math.min(this.zoom,c)}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){if(this._minPitch===c)return;this._minPitch=c,this._pitch=Math.max(this._pitch,c)}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){if(this._maxPitch===c)return;this._maxPitch=c,this._pitch=Math.min(this._pitch,c)}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new kn(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var p=-rf(c,-180,180)*Math.PI/180;if(this.angle===p)return;this.unmodified=!1,this.angle=p,this.calcMatrices(),this.rotationMatrix=er.a.create(),er.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var p=nl(c,this._minPitch,this._maxPitch)/180*Math.PI;if(this._pitch===p)return;this.unmodified=!1,this._pitch=p,this.calcMatrices()}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){if(c=Math.max(.01,Math.min(60,c)),this._fov===c)return;this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(c){var p=Math.min(Math.max(c,this._minZoom),this._maxZoom);if(this._zoom===p)return;this.unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this.constrain(),this.calcMatrices()}},{key:"center",get:function(){return this._center},set:function(c){if(c.lat===this._center.lat&&c.lng===this._center.lng)return;this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices()}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){if(this.edgeInsets.equals(c))return;this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices()}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function O(d,c,p,T,j){Ye()(this,O),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=j===void 0?!0:j,this._minZoom=d||0,this._maxZoom=c||22,this._minPitch=p==null?0:p,this._maxPitch=T==null?60:T,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ui(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new Oi,this.posMatrixCache={},this.alignedPosMatrixCache={}}return bt()(O,[{key:"clone",value:function(){var c=new O(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,p,T){this.unmodified=!1,this.edgeInsets.interpolate(c,p,T),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var p=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,p)}},{key:"resize",value:function(c,p){this.width=c,this.height=p,this.pixelsToGLUnits=[2/c,-2/p],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var p=nl(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new kn(Gu(c.lng)*this.worldSize,ol(p)*this.worldSize)}},{key:"unproject",value:function(c){return new zi(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,p){var T=this.pointCoordinate(p),j=this.pointCoordinate(this.centerPoint),I=this.locationCoordinate(c),k=new zi(I.x-(T.x-j.x),I.y-(T.y-j.y));this.center=this.coordinateLocation(k),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var p=0,T=new Float32Array([c.x,c.y,0,1]),j=new Float32Array([c.x,c.y,1,1]);er.e.transformMat4(T,T,this.pixelMatrixInverse),er.e.transformMat4(j,j,this.pixelMatrixInverse);var I=T[3],k=j[3],X=T[0]/I,ae=j[0]/k,Je=T[1]/I,Ne=j[1]/k,Me=T[2]/I,mt=j[2]/k,ke=Me===mt?0:(p-Me)/(mt-Me);return new zi(qs(X,ae,ke)/this.worldSize,qs(Je,Ne,ke)/this.worldSize)}},{key:"getBounds",value:function(){return new il().extend(this.pointLocation(new kn(0,0))).extend(this.pointLocation(new kn(this.width,0))).extend(this.pointLocation(new kn(this.width,this.height))).extend(this.pointLocation(new kn(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new il([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new kn(0,0)),p=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),T=er.e.transformMat4(p,p,this.pixelMatrix);return T[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,p=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new kn(0,p))}},{key:"getCameraQueryGeometry",value:function(c){var p=this.getCameraPoint();if(c.length===1)return[c[0],p];var T=p.x,j=p.y,I=p.x,k=p.y,X=Ts(c),ae;try{for(X.s();!(ae=X.n()).done;){var Je=ae.value;T=Math.min(T,Je.x),j=Math.min(j,Je.y),I=Math.max(I,Je.x),k=Math.max(k,Je.y)}}catch(Ne){X.e(Ne)}finally{X.f()}return[new kn(T,j),new kn(I,j),new kn(I,k),new kn(T,k),new kn(T,j)]}},{key:"coordinatePoint",value:function(c){var p=er.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return er.e.transformMat4(p,p,this.pixelMatrix),new kn(p[0]/p[3],p[1]/p[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return zi.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!this.center||!this.width||!this.height||this.constraining)return;this.constraining=!0;var c=-90,p=90,T=-180,j=180,I,k,X,ae,Je=this.size,Ne=this.unmodified;if(this.latRange){var Me=this.latRange;c=ol(Me[1])*this.worldSize,p=ol(Me[0])*this.worldSize,I=p-c<Je.y?Je.y/(p-c):0}if(this.lngRange){var mt=this.lngRange;T=Gu(mt[0])*this.worldSize,j=Gu(mt[1])*this.worldSize,k=j-T<Je.x?Je.x/(j-T):0}var ke=this.point,ct=Math.max(k||0,I||0);if(ct){this.center=this.unproject(new kn(k?(j+T)/2:ke.x,I?(p+c)/2:ke.y)),this.zoom+=this.scaleZoom(ct),this.unmodified=Ne,this.constraining=!1;return}if(this.latRange){var Be=ke.y,It=Je.y/2;Be-It<c&&(ae=c+It),Be+It>p&&(ae=p-It)}if(this.lngRange){var $t=ke.x,ar=Je.x/2;$t-ar<T&&(X=T+ar),$t+ar>j&&(X=j-ar)}(X!==void 0||ae!==void 0)&&(this.center=this.unproject(new kn(X!==void 0?X:ke.x,ae!==void 0?ae:ke.y))),this.unmodified=Ne,this.constraining=!1}},{key:"calcMatrices",value:function(){if(!this.height)return;var c=this._fov/2,p=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var T=Math.PI/2+this._pitch,j=this._fov*(.5+p.y/this.height),I=Math.sin(j)*this.cameraToCenterDistance/Math.sin(nl(Math.PI-T-j,.01,Math.PI-.01)),k=this.point,X=k.x,ae=k.y,Je=Math.cos(Math.PI/2-this._pitch)*I+this.cameraToCenterDistance,Ne=Je*1.01,Me=this.height/50,mt=er.b.create();er.b.perspective(mt,this._fov,this.width/this.height,Me,Ne),mt[8]=-p.x*2/this.width,mt[9]=p.y*2/this.height,er.b.scale(mt,mt,[1,-1,1]),er.b.translate(mt,mt,[0,0,-this.cameraToCenterDistance]),er.b.rotateX(mt,mt,this._pitch),er.b.rotateZ(mt,mt,this.angle),er.b.translate(mt,mt,[-X,-ae,0]),this.mercatorMatrix=er.b.scale(er.b.create(),mt,[this.worldSize,this.worldSize,this.worldSize]),er.b.scale(mt,mt,er.d.fromValues(1,1,bf(1,this.center.lat)*this.worldSize)),this.projMatrix=mt,this.invProjMatrix=er.b.invert(er.b.create(),this.projMatrix);var ke=this.width%2/2,ct=this.height%2/2,Be=Math.cos(this.angle),It=Math.sin(this.angle),$t=X-Math.round(X)+Be*ke+It*ct,ar=ae-Math.round(ae)+Be*ct+It*ke,tr=er.b.clone(mt);if(er.b.translate(tr,tr,[$t>.5?$t-1:$t,ar>.5?ar-1:ar,0]),this.alignedProjMatrix=tr,mt=er.b.create(),er.b.scale(mt,mt,[this.width/2,-this.height/2,1]),er.b.translate(mt,mt,[1,-1,0]),this.labelPlaneMatrix=mt,mt=er.b.create(),er.b.scale(mt,mt,[1,-1,1]),er.b.translate(mt,mt,[-1,-1,0]),er.b.scale(mt,mt,[2/this.width,2/this.height,1]),this.glCoordMatrix=mt,this.pixelMatrix=er.b.multiply(er.b.create(),this.labelPlaneMatrix,this.projMatrix),mt=er.b.invert(er.b.create(),this.pixelMatrix),!mt)throw new Error("failed to invert matrix");this.pixelMatrixInverse=mt,this.posMatrixCache={},this.alignedPosMatrixCache={}}}]),O}(),ti=function O(d){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ye()(this,O),this.type=void 0,eo()(this,c),this.type=d};function jl(O){var d=du();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function du(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Us=function(O){ze()(c,O);var d=jl(c);function c(p){var T;Ye()(this,c),T=d.call(this),T.transform=void 0,T.options=void 0,T.moving=void 0,T.zooming=void 0,T.rotating=void 0,T.pitching=void 0,T.padding=void 0,T.bearingSnap=void 0,T.easeEndTimeoutID=void 0,T.easeStart=void 0,T.easeOptions=void 0,T.easeId=void 0,T.onEaseFrame=void 0,T.onEaseEnd=void 0,T.easeFrameId=void 0,T.renderFrameCallback=function(){var Je=Math.min((Fs()-T.easeStart)/T.easeOptions.duration,1);T.onEaseFrame(T.easeOptions.easing(Je)),Je<1?T.easeFrameId=T.requestRenderFrame(T.renderFrameCallback):T.stop()},T.options=p;var j=p.minZoom,I=p.maxZoom,k=p.minPitch,X=p.maxPitch,ae=p.renderWorldCopies;return T.moving=!1,T.zooming=!1,T.bearingSnap=p.bearingSnap,T.transform=new zs(j,I,k,X,ae),T}return bt()(c,[{key:"requestRenderFrame",value:function(T){return 0}},{key:"cancelRenderFrame",value:function(T){return}},{key:"getCenter",value:function(){var T=this.transform.center,j=T.lng,I=T.lat;return new ui(j,I)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(T,j){return this.jumpTo({center:T},j)}},{key:"setPitch",value:function(T,j){return this.jumpTo({pitch:T},j),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(T,j,I){return this.easeTo(eo()({center:T},j),I)}},{key:"zoomOut",value:function(T,j){return this.zoomTo(this.getZoom()-1,T,j),this}},{key:"setBearing",value:function(T,j){return this.jumpTo({bearing:T},j),this}},{key:"setZoom",value:function(T,j){return this.jumpTo({zoom:T},j),this}},{key:"zoomIn",value:function(T,j){return this.zoomTo(this.getZoom()+1,T,j),this}},{key:"zoomTo",value:function(T,j,I){return this.easeTo(eo()({zoom:T},j),I)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(T,j){return this.jumpTo({padding:T},j),this}},{key:"rotateTo",value:function(T,j,I){return this.easeTo(eo()({bearing:T},j),I)}},{key:"resetNorth",value:function(T,j){return this.rotateTo(0,eo()({duration:1e3},T),j),this}},{key:"resetNorthPitch",value:function(T,j){return this.easeTo(eo()({bearing:0,pitch:0,duration:1e3},T),j),this}},{key:"fitBounds",value:function(T,j,I){return this.fitInternal(this.cameraForBounds(T,j),j,I)}},{key:"cameraForBounds",value:function(T,j){return T=il.convert(T),this.cameraForBoxAndBearing(T.getNorthWest(),T.getSouthEast(),0,j)}},{key:"snapToNorth",value:function(T,j){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(T,j):this}},{key:"jumpTo",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=arguments.length>1?arguments[1]:void 0;this.stop();var I=this.transform,k=!1,X=!1,ae=!1;return T.zoom&&I.zoom!==+T.zoom&&(k=!0,I.zoom=+T.zoom),T.center!==void 0&&(I.center=ui.convert(T.center)),T.bearing&&I.bearing!==+T.bearing&&(X=!0,I.bearing=+T.bearing),T.pitch&&I.pitch!==+T.pitch&&(ae=!0,I.pitch=+T.pitch),T.padding!=null&&!I.isPaddingEqual(T.padding)&&(I.padding=T.padding),this.emit("movestart",new ti("movestart",j)),this.emit("move",new ti("move",j)),k&&(this.emit("zoomstart",new ti("zoomstart",j)),this.emit("zoom",new ti("zoom",j)),this.emit("zoomend",new ti("zoomend",j))),X&&(this.emit("rotatestart",new ti("rotatestart",j)),this.emit("rotate",new ti("rotate",j)),this.emit("rotateend",new ti("rotateend",j))),ae&&(this.emit("pitchstart",new ti("pitchstart",j)),this.emit("pitch",new ti("pitch",j)),this.emit("pitchend",new ti("pitchend",j))),this.emit("moveend",new ti("moveend",j))}},{key:"easeTo",value:function(){var T=this,j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=arguments.length>1?arguments[1]:void 0;j=eo()({offset:[0,0],duration:500,easing:tc},j),(j.animate===!1||!j.essential&&Fc())&&(j.duration=0);var k=this.transform,X=this.getZoom(),ae=this.getBearing(),Je=this.getPitch(),Ne=this.getPadding(),Me=j.zoom?+j.zoom:X,mt=j.bearing?this.normalizeBearing(j.bearing,ae):ae,ke=j.pitch?+j.pitch:Je,ct=j.padding?j.padding:k.padding,Be=kn.convert(j.offset),It=k.centerPoint.add(Be),$t=k.pointLocation(It),ar=ui.convert(j.center||$t);this.normalizeCenter(ar);var tr=k.project($t),pr=k.project(ar).sub(tr),wr=k.zoomScale(Me-X),$r,Cn;j.around&&($r=ui.convert(j.around),Cn=k.locationPoint($r));var un={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Me!==X,this.rotating=this.rotating||ae!==mt,this.pitching=this.pitching||ke!==Je,this.padding=!k.isPaddingEqual(ct),this.easeId=j.easeId,this.prepareEase(I,j.noMoveStart,un),clearTimeout(this.easeEndTimeoutID),this.ease(function(_n){if(T.zooming&&(k.zoom=qs(X,Me,_n)),T.rotating&&(k.bearing=qs(ae,mt,_n)),T.pitching&&(k.pitch=qs(Je,ke,_n)),T.padding&&(k.interpolatePadding(Ne,ct,_n),It=k.centerPoint.add(Be)),$r)k.setLocationAtPoint($r,Cn);else{var Kn=k.zoomScale(k.zoom-X),ka=Me>X?Math.min(2,wr):Math.max(.5,wr),Ei=Math.pow(ka,1-_n),Pi=k.unproject(tr.add(pr.mult(_n*Ei)).mult(Kn));k.setLocationAtPoint(k.renderWorldCopies?Pi.wrap():Pi,It)}T.fireMoveEvents(I)},function(_n){T.afterEase(I,_n)},j),this}},{key:"flyTo",value:function(){var T=this,j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=arguments.length>1?arguments[1]:void 0;if(!j.essential&&Fc()){var k=nf(j,["center","zoom","bearing","pitch","around"]);return this.jumpTo(k,I)}this.stop(),j=eo()({offset:[0,0],speed:1.2,curve:1.42,easing:tc},j);var X=this.transform,ae=this.getZoom(),Je=this.getBearing(),Ne=this.getPitch(),Me=this.getPadding(),mt=j.zoom?nl(+j.zoom,X.minZoom,X.maxZoom):ae,ke=j.bearing?this.normalizeBearing(j.bearing,Je):Je,ct=j.pitch?+j.pitch:Ne,Be="padding"in j?j.padding:X.padding,It=X.zoomScale(mt-ae),$t=kn.convert(j.offset),ar=X.centerPoint.add($t),tr=X.pointLocation(ar),pr=ui.convert(j.center||tr);this.normalizeCenter(pr);var wr=X.project(tr),$r=X.project(pr).sub(wr),Cn=j.curve,un=Math.max(X.width,X.height),_n=un/It,Kn=$r.mag();if("minZoom"in j){var ka=nl(Math.min(j.minZoom,ae,mt),X.minZoom,X.maxZoom),Ei=un/X.zoomScale(ka-ae);Cn=Math.sqrt(Ei/Kn*2)}var Pi=Cn*Cn;function Du(_a){var Ol=(_n*_n-un*un+(_a?-1:1)*Pi*Pi*Kn*Kn)/(2*(_a?_n:un)*Pi*Kn);return Math.log(Math.sqrt(Ol*Ol+1)-Ol)}function ou(_a){return(Math.exp(_a)-Math.exp(-_a))/2}function Xl(_a){return(Math.exp(_a)+Math.exp(-_a))/2}function Ds(_a){return ou(_a)/Xl(_a)}var Ns=Du(0),Yl=function(Ol){return Xl(Ns)/Xl(Ns+Cn*Ol)},dc=function(Ol){return un*((Xl(Ns)*Ds(Ns+Cn*Ol)-ou(Ns))/Pi)/Kn},yu=(Du(1)-Ns)/Cn;if(Math.abs(Kn)<1e-6||!isFinite(yu)){if(Math.abs(un-_n)<1e-6)return this.easeTo(j,I);var Mc=_n<un?-1:1;yu=Math.abs(Math.log(_n/un))/Cn,dc=function(){return 0},Yl=function(Ol){return Math.exp(Mc*Cn*Ol)}}if("duration"in j)j.duration=+j.duration;else{var Co="screenSpeed"in j?+j.screenSpeed/Cn:+j.speed;j.duration=1e3*yu/Co}return j.maxDuration&&j.duration>j.maxDuration&&(j.duration=0),this.zooming=!0,this.rotating=Je!==ke,this.pitching=ct!==Ne,this.padding=!X.isPaddingEqual(Be),this.prepareEase(I,!1),this.ease(function(_a){var Ol=_a*yu,nh=1/Yl(Ol);X.zoom=_a===1?mt:ae+X.scaleZoom(nh),T.rotating&&(X.bearing=qs(Je,ke,_a)),T.pitching&&(X.pitch=qs(Ne,ct,_a)),T.padding&&(X.interpolatePadding(Me,Be,_a),ar=X.centerPoint.add($t));var fh=_a===1?pr:X.unproject(wr.add($r.mult(dc(Ol))).mult(nh));X.setLocationAtPoint(X.renderWorldCopies?fh.wrap():fh,ar),T.fireMoveEvents(I)},function(){return T.afterEase(I)},j),this}},{key:"fitScreenCoordinates",value:function(T,j,I,k,X){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(kn.convert(T)),this.transform.pointLocation(kn.convert(j)),I,k),k,X)}},{key:"stop",value:function(T,j){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var I=this.onEaseEnd;delete this.onEaseEnd,I.call(this,j)}return this}},{key:"normalizeBearing",value:function(T,j){T=rf(T,-180,180);var I=Math.abs(T-j);return Math.abs(T-360-j)<I&&(T-=360),Math.abs(T+360-j)<I&&(T+=360),T}},{key:"normalizeCenter",value:function(T){var j=this.transform;if(!j.renderWorldCopies||j.lngRange)return;var I=T.lng-j.center.lng;T.lng+=I>180?-360:I<-180?360:0}},{key:"fireMoveEvents",value:function(T){this.emit("move",new ti("move",T)),this.zooming&&this.emit("zoom",new ti("zoom",T)),this.rotating&&this.emit("rotate",new ti("rotate",T)),this.pitching&&this.emit("rotate",new ti("pitch",T))}},{key:"prepareEase",value:function(T){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!j&&!I.moving&&this.emit("movestart",new ti("movestart",T)),this.zooming&&!I.zooming&&this.emit("zoomstart",new ti("zoomstart",T)),this.rotating&&!I.rotating&&this.emit("rotatestart",new ti("rotatestart",T)),this.pitching&&!I.pitching&&this.emit("pitchstart",new ti("pitchstart",T))}},{key:"afterEase",value:function(T,j){if(this.easeId&&j&&this.easeId===j)return;delete this.easeId;var I=this.zooming,k=this.rotating,X=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,I&&this.emit("zoomend",new ti("zoomend",T)),k&&this.emit("rotateend",new ti("rotateend",T)),X&&this.emit("pitchend",new ti("pitchend",T)),this.emit("moveend",new ti("moveend",T))}},{key:"ease",value:function(T,j,I){I.animate===!1||I.duration===0?(T(1),j()):(this.easeStart=Fs(),this.easeOptions=I,this.onEaseFrame=T,this.onEaseEnd=j,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(T,j,I,k){var X={top:0,bottom:0,right:0,left:0};if(k=eo()({padding:X,offset:[0,0],maxZoom:this.transform.maxZoom},k),typeof k.padding=="number"){var ae=k.padding;k.padding={top:ae,bottom:ae,right:ae,left:ae}}k.padding=eo()(X,k.padding);var Je=this.transform,Ne=Je.padding,Me=Je.project(ui.convert(T)),mt=Je.project(ui.convert(j)),ke=Me.rotate(-I*Math.PI/180),ct=mt.rotate(-I*Math.PI/180),Be=new kn(Math.max(ke.x,ct.x),Math.max(ke.y,ct.y)),It=new kn(Math.min(ke.x,ct.x),Math.min(ke.y,ct.y)),$t=Be.sub(It),ar=(Je.width-(Ne.left+Ne.right+k.padding.left+k.padding.right))/$t.x,tr=(Je.height-(Ne.top+Ne.bottom+k.padding.top+k.padding.bottom))/$t.y;if(tr<0||ar<0)return;var pr=Math.min(Je.scaleZoom(Je.scale*Math.min(ar,tr)),k.maxZoom),wr=kn.convert(k.offset),$r=(k.padding.left-k.padding.right)/2,Cn=(k.padding.top-k.padding.bottom)/2,un=new kn(wr.x+$r,wr.y+Cn),_n=un.mult(Je.scale/Je.zoomScale(pr)),Kn=Je.unproject(Me.add(mt).div(2).sub(_n));return{center:Kn,zoom:pr,bearing:I}}},{key:"fitInternal",value:function(T,j,I){return T?(j=eo()(T,j),delete j.padding,j.linear?this.easeTo(j,I):this.flyTo(j,I)):this}}]),c}(vf.EventEmitter);function ll(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=qr(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function qr(O,d){if(!O)return;if(typeof O=="string")return Ec(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ec(O,d)}function Ec(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var os={},ro=os;os.create=function(O,d,c){var p=window.document.createElement(O);return d!==void 0&&(p.className=d),c&&c.appendChild(p),p},os.createNS=function(O,d){var c=window.document.createElementNS(O,d);return c};var Jo=window.document&&window.document.documentElement.style;function Os(O){if(!Jo)return O[0];var d=ll(O),c;try{for(d.s();!(c=d.n()).done;){var p=c.value;if(p in Jo)return p}}catch(T){d.e(T)}finally{d.f()}return O[0]}var Fl=Os(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),zc;os.disableDrag=function(){Jo&&Fl&&(zc=Jo[Fl],Jo[Fl]="none")},os.enableDrag=function(){Jo&&Fl&&(Jo[Fl]=zc)};var Bs=Os(["transform","WebkitTransform"]);os.setTransform=function(O,d){O.style[Bs]=d};var Cu=!1;try{var zl=Object.defineProperty({},"passive",{get:function(){Cu=!0}});window.addEventListener("test",zl,zl),window.removeEventListener("test",zl,zl)}catch(O){Cu=!1}os.addEventListener=function(O,d,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&Cu?O.addEventListener(d,c,p):O.addEventListener(d,c,p.capture)},os.removeEventListener=function(O,d,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&Cu?O.removeEventListener(d,c,p):O.removeEventListener(d,c,p.capture)};var Ul=function O(d){d.preventDefault(),d.stopPropagation(),window.removeEventListener("click",O,!0)};os.suppressClick=function(){window.addEventListener("click",Ul,!0),window.setTimeout(function(){window.removeEventListener("click",Ul,!0)},0)},os.mousePos=function(O,d){var c=O.getBoundingClientRect();return new kn(d.clientX-c.left-O.clientLeft,d.clientY-c.top-O.clientTop)},os.touchPos=function(O,d){var c=O.getBoundingClientRect(),p=[],T=ll(d),j;try{for(T.s();!(j=T.n()).done;){var I=j.value;p.push(new kn(I.clientX-c.left-O.clientLeft,I.clientY-c.top-O.clientTop))}}catch(k){T.e(k)}finally{T.f()}return p},os.mouseButton=function(O){return typeof window.InstallTrigger!="undefined"&&O.button===2&&O.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:O.button},os.remove=function(O){O.parentNode&&O.parentNode.removeChild(O)};function af(O){var d=Uc();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Uc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Lo=function(O){ze()(c,O);var d=af(c);function c(p,T,j){var I,k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Ye()(this,c);var X=ro.mousePos(T.getCanvasContainer(),j),ae=T.unproject(X);return I=d.call(this,p,eo()({point:X,lngLat:ae,originalEvent:j},k)),I.type=void 0,I.target=void 0,I.originalEvent=void 0,I.point=void 0,I.lngLat=void 0,I.defaultPrevented=void 0,I.defaultPrevented=!1,I.target=T,I}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ti);function ss(O){var d=Pa();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var eu=function(O){ze()(c,O);var d=ss(c);function c(p,T,j){var I;Ye()(this,c);var k=p==="touchend"?j.changedTouches:j.touches,X=ro.touchPos(T.getCanvasContainer(),k),ae=X.map(function(Me){return T.unproject(Me)}),Je=X.reduce(function(Me,mt,ke,ct){return Me.add(mt.div(ct.length))},new kn(0,0)),Ne=T.unproject(Je);return I=d.call(this,p,{points:X,point:Je,lngLats:ae,lngLat:Ne,originalEvent:j}),I.type=void 0,I.target=void 0,I.originalEvent=void 0,I.lngLat=void 0,I.point=void 0,I.points=void 0,I.lngLats=void 0,I.defaultPrevented=void 0,I.defaultPrevented=!1,I}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ti);function Ro(O){var d=To();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function To(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Al=function(O){ze()(c,O);var d=Ro(c);function c(p,T,j){var I;return Ye()(this,c),I=d.call(this,p,{originalEvent:j}),I.type=void 0,I.originalEvent=void 0,I.defaultPrevented=void 0,I.target=void 0,I.defaultPrevented=!1,I}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ti),cl=function(){function O(d){Ye()(this,O),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=d}return bt()(O,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new Lo("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new Lo(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),O}(),pu=function(){function O(d,c){Ye()(this,O),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=d,this.el=d.getCanvasContainer(),this.container=d.getContainer(),this.clickTolerance=c.clickTolerance||1}return bt()(O,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){if(this.isEnabled())return;this.enabled=!0}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"mousedown",value:function(c,p){if(!this.isEnabled())return;if(!(c.shiftKey&&c.button===0))return;ro.disableDrag(),this.startPos=this.lastPos=p,this.active=!0}},{key:"mousemoveWindow",value:function(c,p){if(!this.active)return;var T=p;if(this.lastPos.equals(T)||!this.box&&T.dist(this.startPos)<this.clickTolerance)return;var j=this.startPos;this.lastPos=T,this.box||(this.box=ro.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var I=Math.min(j.x,T.x),k=Math.max(j.x,T.x),X=Math.min(j.y,T.y),ae=Math.max(j.y,T.y);ro.setTransform(this.box,"translate(".concat(I,"px,").concat(X,"px)")),this.box&&(this.box.style.width="".concat(k-I,"px"),this.box.style.height="".concat(ae-X,"px"))}},{key:"mouseupWindow",value:function(c,p){var T=this;if(!this.active)return;if(c.button!==0)return;var j=this.startPos,I=p;if(this.reset(),ro.suppressClick(),j.x===I.x&&j.y===I.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new ti("boxzoomend",{originalEvent:c})),{cameraAnimation:function(X){return X.fitScreenCoordinates(j,I,T.map.getBearing(),{linear:!0})}}}},{key:"keydown",value:function(c){if(!this.active)return;c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(ro.remove(this.box),this.box=null),ro.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,p){return this.map.emit(c,new ti(c,{originalEvent:p}))}}]),O}(),_s=pu,Tc=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,p){return c.preventDefault(),{cameraAnimation:function(j){j.easeTo({duration:300,zoom:j.getZoom()+(c.shiftKey?-1:1),around:j.unproject(p)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}();function Jn(O){var d=jn();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function jn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var _c=function(O){ze()(c,O);var d=Jn(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.type="renderFrame",p.timeStamp=void 0,p}return c}(ti);function us(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=Io(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function Io(O,d){if(!O)return;if(typeof O=="string")return vo(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return vo(O,d)}function vo(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var Ss={linearity:.3,easing:_l(0,0,.3,1)},wu=eo()({deceleration:2500,maxSpeed:1400},Ss),rc=eo()({deceleration:20,maxSpeed:1400},Ss),Ka=eo()({deceleration:1e3,maxSpeed:360},Ss),no=eo()({deceleration:1e3,maxSpeed:90},Ss),fl=function(){function O(d){Ye()(this,O),this.map=void 0,this.inertiaBuffer=void 0,this.map=d,this.clear()}return bt()(O,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:Fs(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,p=Fs(),T=160;c.length>0&&p-c[0].time>T;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),this.inertiaBuffer.length<2)return;var p={zoom:0,bearing:0,pitch:0,pan:new kn(0,0),pinchAround:void 0,around:void 0},T=us(this.inertiaBuffer),j;try{for(T.s();!(j=T.n()).done;){var I=j.value.settings;p.zoom+=I.zoomDelta||0,p.bearing+=I.bearingDelta||0,p.pitch+=I.pitchDelta||0,I.panDelta&&p.pan._add(I.panDelta),I.around&&(p.around=I.around),I.pinchAround&&(p.pinchAround=I.pinchAround)}}catch(ct){T.e(ct)}finally{T.f()}var k=this.inertiaBuffer[this.inertiaBuffer.length-1],X=k.time-this.inertiaBuffer[0].time,ae={};if(p.pan.mag()){var Je=hl(p.pan.mag(),X,eo()({},wu,c||{}));ae.offset=p.pan.mult(Je.amount/p.pan.mag()),ae.center=this.map.transform.center,mu(ae,Je)}if(p.zoom){var Ne=hl(p.zoom,X,rc);ae.zoom=this.map.transform.zoom+Ne.amount,mu(ae,Ne)}if(p.bearing){var Me=hl(p.bearing,X,Ka);ae.bearing=this.map.transform.bearing+nl(Me.amount,-179,179),mu(ae,Me)}if(p.pitch){var mt=hl(p.pitch,X,no);ae.pitch=this.map.transform.pitch+mt.amount,mu(ae,mt)}if(ae.zoom||ae.bearing){var ke=p.pinchAround===void 0?p.around:p.pinchAround;ae.around=ke?this.map.unproject(ke):this.map.getCenter()}return this.clear(),eo()(ae,{noMoveStart:!0})}}]),O}();function mu(O,d){(!O.duration||O.duration<d.duration)&&(O.duration=d.duration,O.easing=d.easing)}function hl(O,d,c){var p=c.maxSpeed,T=c.linearity,j=c.deceleration,I=nl(O*T/(d/1e3),-p,p),k=Math.abs(I)/(j*T);return{easing:c.easing,duration:k*1e3,amount:I*(k/2)}}var Ou={panStep:100,bearingStep:15,pitchStep:10},Ms=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var d=Ou;this.panStep=d.panStep,this.bearingStep=d.bearingStep,this.pitchStep=d.pitchStep}return bt()(O,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var p=this;if(c.altKey||c.ctrlKey||c.metaKey)return;var T=0,j=0,I=0,k=0,X=0;switch(c.keyCode){case 61:case 107:case 171:case 187:T=1;break;case 189:case 109:case 173:T=-1;break;case 37:c.shiftKey?j=-1:(c.preventDefault(),k=-1);break;case 39:c.shiftKey?j=1:(c.preventDefault(),k=1);break;case 38:c.shiftKey?I=1:(c.preventDefault(),X=-1);break;case 40:c.shiftKey?I=-1:(c.preventDefault(),X=1);break;default:return}return{cameraAnimation:function(Je){var Ne=Je.getZoom();Je.easeTo({duration:300,easeId:"keyboardHandler",easing:Bc,zoom:T?Math.round(Ne)+T*(c.shiftKey?2:1):Ne,bearing:Je.getBearing()+j*p.bearingStep,pitch:Je.getPitch()+I*p.pitchStep,offset:[-k*p.panStep,-X*p.panStep],center:Je.getCenter()},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}();function Bc(O){return O*(2-O)}var Vs=Ms,xf=function(){function O(d,c){Ye()(this,O),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=d,this.clickTolerance=c.clickTolerance}return bt()(O,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new Al(c.type,this.map,c))}},{key:"mousedown",value:function(c,p){return this.mousedownPos=p,this.firePreventable(new Lo(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"click",value:function(c,p){if(this.mousedownPos&&this.mousedownPos.dist(p)>=this.clickTolerance)return;this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new Lo(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new Lo(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new eu(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),O}(),Bl=o("iWIM"),Vl=o.n(Bl),Sc,ls=0,Hu=2,Vc=(Sc={},gr()(Sc,ls,1),gr()(Sc,Hu,2),Sc);function Cl(O,d){var c=Vc[d];return O.buttons===void 0||(O.buttons&c)!==c}var Wu=function(){function O(d){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=d.clickTolerance||1}return bt()(O,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,p){if(this.lastPoint)return;var T=ro.mouseButton(c);if(!this.correctButton(c,T))return;this.lastPoint=p,this.eventButton=T}},{key:"mousemoveWindow",value:function(c,p){var T=this.lastPoint;if(!T)return;if(c.preventDefault(),Cl(c,this.eventButton)){this.reset();return}return!this.moved&&p.dist(T)<this.clickTolerance?void 0:(this.moved=!0,this.lastPoint=p,this.move(T,p))}},{key:"mouseupWindow",value:function(c){if(!this.lastPoint)return;var p=ro.mouseButton(c);if(p!==this.eventButton)return;this.moved&&ro.suppressClick(),this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,p){return!1}},{key:"move",value:function(c,p){return}}]),O}();function nc(O){var d=Zu();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function Zu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Ps=function(O){ze()(c,O);var d=nc(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"mousedown",value:function(T,j){Vl()(hr()(c.prototype),"mousedown",this).call(this,T,j),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(T,j){return{around:j,panDelta:j.sub(T)}}},{key:"correctButton",value:function(T,j){return j===ls&&!T.ctrlKey}}]),c}(Wu);function of(O){var d=ac();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function ac(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var ic=function(O){ze()(c,O);var d=of(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"correctButton",value:function(T,j){return j===ls&&T.ctrlKey||j===Hu}},{key:"move",value:function(T,j){var I=-.5,k=(j.y-T.y)*I;if(k)return this.active=!0,{pitchDelta:k}}},{key:"contextmenu",value:function(T){T.preventDefault()}}]),c}(Wu);function oc(O){var d=s();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function s(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var a=function(O){ze()(c,O);var d=oc(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"contextmenu",value:function(T){T.preventDefault()}},{key:"correctButton",value:function(T,j){return j===ls&&T.ctrlKey||j===Hu}},{key:"move",value:function(T,j){var I=.8,k=(j.x-T.x)*I;if(k)return this.active=!0,{bearingDelta:k}}}]),c}(Wu),n=4.000244140625,l=1/100,g=1/450,w=2,L=function(){function O(d,c){var p=this;Ye()(this,O),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!p.frameId)return;if(p.frameId=null,!p.isActive())return;var T=p.map.transform;if(p.delta!==0){var j=p.type==="wheel"&&Math.abs(p.delta)>n?p.wheelZoomRate:p.defaultZoomRate,I=w/(1+Math.exp(-Math.abs(p.delta*j)));p.delta<0&&I!==0&&(I=1/I);var k=typeof p.targetZoom=="number"?T.zoomScale(p.targetZoom):T.scale;p.targetZoom=Math.min(T.maxZoom,Math.max(T.minZoom,T.scaleZoom(k*I))),p.type==="wheel"&&(p.startZoom=T.zoom,p.easing=p.smoothOutEasing(200)),p.delta=0}var X=typeof p.targetZoom=="number"?p.targetZoom:T.zoom,ae=p.startZoom,Je=p.easing,Ne=!1,Me;if(p.type==="wheel"&&ae&&Je){var mt=Math.min((Fs()-p.lastWheelEventTime)/200,1),ke=Je(mt);Me=qs(ae,X,ke),mt<1?p.frameId||(p.frameId=!0):Ne=!0}else Me=X,Ne=!0;return p.active=!0,Ne&&(p.active=!1,p.finishTimeout=setTimeout(function(){p.zooming=!1,p.handler.triggerRenderFrame(),delete p.targetZoom,delete p.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ne,zoomDelta:Me-T.zoom,around:p.aroundPoint,originalEvent:p.lastWheelEvent}},this.map=d,this.el=d.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=l,this.wheelZoomRate=g}return bt()(O,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){if(this.isEnabled())return;this.enabled=!0,this.aroundCenter=c&&c.around==="center"}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"wheel",value:function(c){if(!this.isEnabled())return;var p=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,T=Fs(),j=T-(this.lastWheelEventTime||0);this.lastWheelEventTime=T,p!==0&&p%n===0?this.type="wheel":p!==0&&Math.abs(p)<4?this.type="trackpad":j>400?(this.type=null,this.lastValue=p,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(j*p)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,p+=this.lastValue)),c.shiftKey&&p&&(p=p/4),this.type&&(this.lastWheelEvent=c,this.delta-=p,this.active||this.start(c)),c.preventDefault()}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!this.delta)return;this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var p=ro.mousePos(this.el,c);this.around=ui.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(p)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}},{key:"smoothOutEasing",value:function(c){var p=tc;if(this.prevEase){var T=this.prevEase,j=(Fs()-T.start)/T.duration,I=T.easing(j+.01)-T.easing(j),k=.27/Math.sqrt(I*I+1e-4)*.01,X=Math.sqrt(.27*.27-k*k);p=_l(k,X,.25,1)}return this.prevEase={start:Fs(),duration:c,easing:p},p}}]),O}(),F=L,ue=function(){function O(d,c){Ye()(this,O),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=d,this.tapZoom=c}return bt()(O,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),O}(),Ee=function(){function O(d,c,p){Ye()(this,O),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=d,this.mousePan=c,this.touchPan=p}return bt()(O,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),O}(),$e=function(){function O(d,c,p){Ye()(this,O),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=d.pitchWithRotate,this.mouseRotate=c,this.mousePitch=p}return bt()(O,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),O}(),rt=function(){function O(d,c,p,T){Ye()(this,O),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=d,this.touchZoom=c,this.touchRotate=p,this.tapDragZoom=T,this.rotationDisabled=!1,this.enabled=!0}return bt()(O,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),O}();function nt(O,d){for(var c={},p=0;p<O.length;p++)c[O[p].identifier]=d[p];return c}function Ft(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=Nt(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function Nt(O,d){if(!O)return;if(typeof O=="string")return Kt(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Kt(O,d)}function Kt(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function jt(O){var d=new kn(0,0),c=Ft(O),p;try{for(c.s();!(p=c.n()).done;){var T=p.value;d._add(T)}}catch(j){c.e(j)}finally{c.f()}return d.div(O.length)}var Gt=500,nr=500,rr=30,Lr=function(){function O(d){Ye()(this,O),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=d.numTouches}return bt()(O,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,p,T){if((this.centroid||T.length>this.numTouches)&&(this.aborted=!0),this.aborted)return;this.startTime===void 0&&(this.startTime=c.timeStamp),T.length===this.numTouches&&(this.centroid=jt(p),this.touches=nt(T,p))}},{key:"touchmove",value:function(c,p,T){if(this.aborted||!this.centroid)return;var j=nt(T,p);for(var I in this.touches)if(this.touches[I]){var k=this.touches[I],X=j[I];(!X||X.dist(k)>rr)&&(this.aborted=!0)}}},{key:"touchend",value:function(c,p,T){if((!this.centroid||c.timeStamp-this.startTime>nr)&&(this.aborted=!0),T.length===0){var j=!this.aborted&&this.centroid;if(this.reset(),j)return j}}}]),O}(),vr=function(){function O(d){Ye()(this,O),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new Lr(d),this.numTaps=d.numTaps,this.reset()}return bt()(O,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,p,T){this.singleTap.touchstart(c,p,T)}},{key:"touchmove",value:function(c,p,T){this.singleTap.touchmove(c,p,T)}},{key:"touchend",value:function(c,p,T){var j=this.singleTap.touchend(c,p,T);if(j){var I=c.timeStamp-this.lastTime<Gt,k=!this.lastTap||this.lastTap.dist(j)<rr;if((!I||!k)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=j,this.count===this.numTaps)return this.reset(),j}}}]),O}(),Sr=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new vr({numTouches:1,numTaps:1}),this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,p,T){if(this.swipePoint)return;this.tapTime&&c.timeStamp-this.tapTime>Gt&&this.reset(),this.tapTime?T.length>0&&(this.swipePoint=p[0],this.swipeTouch=T[0].identifier):this.tap.touchstart(c,p,T)}},{key:"touchmove",value:function(c,p,T){if(!this.tapTime)this.tap.touchmove(c,p,T);else if(this.swipePoint){if(T[0].identifier!==this.swipeTouch)return;var j=p[0],I=j.y-this.swipePoint.y;return this.swipePoint=j,c.preventDefault(),this.active=!0,{zoomDelta:I/128}}}},{key:"touchend",value:function(c,p,T){if(this.tapTime)this.swipePoint&&(T.length===0&&this.reset());else{var j=this.tap.touchend(c,p,T);j&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}(),Ar=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new vr({numTouches:1,numTaps:2}),this.zoomOut=new vr({numTouches:2,numTaps:1}),this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,p,T){this.zoomIn.touchstart(c,p,T),this.zoomOut.touchstart(c,p,T)}},{key:"touchmove",value:function(c,p,T){this.zoomIn.touchmove(c,p,T),this.zoomOut.touchmove(c,p,T)}},{key:"touchend",value:function(c,p,T){var j=this,I=this.zoomIn.touchend(c,p,T),k=this.zoomOut.touchend(c,p,T);if(I)return this.active=!0,c.preventDefault(),setTimeout(function(){return j.reset()},0),{cameraAnimation:function(ae){return ae.easeTo({duration:300,zoom:ae.getZoom()+1,around:ae.unproject(I)},{originalEvent:c})}};if(k)return this.active=!0,c.preventDefault(),setTimeout(function(){return j.reset()},0),{cameraAnimation:function(ae){return ae.easeTo({duration:300,zoom:ae.getZoom()-1,around:ae.unproject(k)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}(),rn=function(){function O(d){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=d.clickTolerance||1,this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new kn(0,0)}},{key:"touchstart",value:function(c,p,T){return this.calculateTransform(c,p,T)}},{key:"touchmove",value:function(c,p,T){return this.active?(c.preventDefault(),this.calculateTransform(c,p,T)):void 0}},{key:"touchend",value:function(c,p,T){this.calculateTransform(c,p,T),this.active&&T.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,p,T){T.length>0&&(this.active=!0);var j=nt(T,p),I=new kn(0,0),k=new kn(0,0),X=0;for(var ae in j)if(j[ae]){var Je=j[ae],Ne=this.touches[ae];Ne&&(I._add(Je),k._add(Je.sub(Ne)),X++,j[ae]=Je)}if(this.touches=j,X<this.minTouches||!k.mag())return;var Me=k.div(X);if(this.sum._add(Me),this.sum.mag()<this.clickTolerance)return;var mt=I.div(X);return{around:mt,panDelta:Me}}}]),O}(),Xr=function(){function O(){Ye()(this,O),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return bt()(O,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){return}},{key:"move",value:function(c,p,T){return}},{key:"touchstart",value:function(c,p,T){if(this.firstTwoTouches||T.length<2)return;this.firstTwoTouches=[T[0].identifier,T[1].identifier],this.start([p[0],p[1]])}},{key:"touchmove",value:function(c,p,T){if(!this.firstTwoTouches)return;c.preventDefault();var j=yn()(this.firstTwoTouches,2),I=j[0],k=j[1],X=mn(T,p,I),ae=mn(T,p,k);if(!X||!ae)return;var Je=this.aroundCenter?null:X.add(ae).div(2);return this.move([X,ae],Je,c)}},{key:"touchend",value:function(c,p,T){if(!this.firstTwoTouches)return;var j=yn()(this.firstTwoTouches,2),I=j[0],k=j[1],X=mn(T,p,I),ae=mn(T,p,k);if(X&&ae)return;this.active&&ro.suppressClick(),this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),O}();function mn(O,d,c){for(var p=0;p<O.length;p++)if(O[p].identifier===c)return d[p]}function Ln(O){var d=qn();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function qn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}function sa(O){return Math.abs(O.y)>Math.abs(O.x)}var Sa=100,Wa=function(O){ze()(c,O);var d=Ln(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.valid=void 0,p.firstMove=void 0,p.lastPoints=void 0,p}return bt()(c,[{key:"reset",value:function(){Vl()(hr()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(T){this.lastPoints=T,sa(T[0].sub(T[1]))&&(this.valid=!1)}},{key:"move",value:function(T,j,I){var k=T[0].sub(this.lastPoints[0]),X=T[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(k,X,I.timeStamp),!this.valid)return;this.lastPoints=T,this.active=!0;var ae=(k.y+X.y)/2,Je=-.5;return{pitchDelta:ae*Je}}},{key:"gestureBeginsVertically",value:function(T,j,I){if(this.valid!==void 0)return this.valid;var k=2,X=T.mag()>=k,ae=j.mag()>=k;if(!X&&!ae)return;if(!X||!ae)return this.firstMove===void 0&&(this.firstMove=I),I-this.firstMove<Sa?void 0:!1;var Je=T.y>0===j.y>0;return sa(T)&&sa(j)&&Je}}]),c}(Xr);function Sn(O){var d=ua();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function ua(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var ba=25;function Wn(O,d){return O.angleWith(d)*180/Math.PI}var Aa=function(O){ze()(c,O);var d=Sn(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.minDiameter=void 0,p}return bt()(c,[{key:"reset",value:function(){Vl()(hr()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(T){this.startVector=this.vector=T[0].sub(T[1]),this.minDiameter=T[0].dist(T[1])}},{key:"move",value:function(T,j){var I=this.vector;return this.vector=T[0].sub(T[1]),!this.active&&this.isBelowThreshold(this.vector)?void 0:(this.active=!0,{bearingDelta:Wn(this.vector,I),pinchAround:j})}},{key:"isBelowThreshold",value:function(T){this.minDiameter=Math.min(this.minDiameter,T.mag());var j=Math.PI*this.minDiameter,I=ba/j*360,k=Wn(T,this.startVector);return Math.abs(k)<I}}]),c}(Xr);function na(O){var d=La();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function La(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var za=.1;function Gi(O,d){return Math.log(O/d)/Math.LN2}var _i=function(O){ze()(c,O);var d=na(c);function c(){var p;Ye()(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.distance=void 0,p.startDistance=void 0,p}return bt()(c,[{key:"reset",value:function(){Vl()(hr()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(T){this.startDistance=this.distance=T[0].dist(T[1])}},{key:"move",value:function(T,j){var I=this.distance;return this.distance=T[0].dist(T[1]),!this.active&&Math.abs(Gi(this.distance,this.startDistance))<za?void 0:(this.active=!0,{zoomDelta:Gi(this.distance,I),pinchAround:j})}}]),c}(Xr);function Di(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=gi(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function gi(O,d){if(!O)return;if(typeof O=="string")return Ui(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ui(O,d)}function Ui(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var Qo=function(d){return d.zoom||d.drag||d.pitch||d.rotate};function qo(O){return O.panDelta&&O.panDelta.mag()||O.zoomDelta||O.bearingDelta||O.pitchDelta}var vu=function(){function O(d,c){var p=this;Ye()(this,O),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(Ne){p.handleEvent(Ne,"".concat(Ne.type,"Window"))},this.handleEvent=function(Ne,Me){if(Ne.type==="blur"){p.stop();return}p.updatingCamera=!0;var mt=Ne.type==="renderFrame"?void 0:Ne,ke={needsRenderFrame:!1},ct={},Be={},It=Ne.touches?p.getMapTouches(Ne.touches):void 0,$t=It?ro.touchPos(p.el,It):ro.mousePos(p.el,Ne),ar=Di(p.handlers),tr;try{for(ar.s();!(tr=ar.n()).done;){var pr=tr.value,wr=pr.handlerName,$r=pr.handler,Cn=pr.allowed;if(!$r.isEnabled())continue;var un=void 0;if(p.blockedByActive(Be,Cn,wr))$r.reset();else{var _n=Me||Ne.type;$r&&$r[_n]&&(un=$r[_n](Ne,$t,It),p.mergeIHandlerResult(ke,ct,un,wr,mt),un&&un.needsRenderFrame&&p.triggerRenderFrame())}(un||$r.isActive())&&(Be[wr]=$r)}}catch(Pi){ar.e(Pi)}finally{ar.f()}var Kn={};for(var ka in p.previousActiveHandlers)Be[ka]||(Kn[ka]=mt);p.previousActiveHandlers=Be,(Object.keys(Kn).length||qo(ke))&&(p.changes.push([ke,ct,Kn]),p.triggerRenderFrame()),(Object.keys(Be).length||qo(ke))&&p.map.stop(!0),p.updatingCamera=!1;var Ei=ke.cameraAnimation;Ei&&(p.inertia.clear(),p.fireEvents({},{}),p.changes=[],Ei(p.map))},this.map=d,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new fl(d),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var T=this.el;this.listeners=[[T,"touchstart",{passive:!1}],[T,"touchmove",{passive:!1}],[T,"touchend",void 0],[T,"touchcancel",void 0],[T,"mousedown",void 0],[T,"mousemove",void 0],[T,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[T,"mouseover",void 0],[T,"mouseout",void 0],[T,"dblclick",void 0],[T,"click",void 0],[T,"keydown",{capture:!1}],[T,"keyup",void 0],[T,"wheel",{passive:!1}],[T,"contextmenu",void 0],[window,"blur",void 0]];var j=Di(this.listeners),I;try{for(j.s();!(I=j.n()).done;){var k=yn()(I.value,3),X=k[0],ae=k[1],Je=k[2];ro.addEventListener(X,ae,X===window.document?this.handleWindowEvent:this.handleEvent,Je)}}catch(Ne){j.e(Ne)}finally{j.f()}}return bt()(O,[{key:"destroy",value:function(){var c=Di(this.listeners),p;try{for(c.s();!(p=c.n()).done;){var T=yn()(p.value,3),j=T[0],I=T[1],k=T[2];ro.removeEventListener(j,I,j===window.document?this.handleWindowEvent:this.handleEvent,k)}}catch(X){c.e(X)}finally{c.f()}}},{key:"stop",value:function(){if(this.updatingCamera)return;var c=Di(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var T=p.value.handler;T.reset()}}catch(j){c.e(j)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}},{key:"isActive",value:function(){var c=Di(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var T=p.value.handler;if(T.isActive())return!0}}catch(j){c.e(j)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(Qo(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,p,T,j,I){if(!T)return;eo()(c,T);var k={handlerName:j,originalEvent:T.originalEvent||I};T.zoomDelta!==void 0&&(p.zoom=k),T.panDelta!==void 0&&(p.drag=k),T.pitchDelta!==void 0&&(p.pitch=k),T.bearingDelta!==void 0&&(p.rotate=k)}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(p){delete c.frameId,c.handleEvent(new _c("renderFrame",{timeStamp:p})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var p=this.map,T=p.getCanvasContainer();this.add("mapEvent",new xf(p,c));var j=p.boxZoom=new _s(p,c);this.add("boxZoom",j);var I=new Ar,k=new Tc;p.doubleClickZoom=new ue(k,I),this.add("tapZoom",I),this.add("clickZoom",k);var X=new Sr;this.add("tapDragZoom",X);var ae=p.touchPitch=new Wa;this.add("touchPitch",ae);var Je=new ic(c),Ne=new a(c);p.dragRotate=new $e(c,Je,Ne),this.add("mouseRotate",Je,["mousePitch"]),this.add("mousePitch",Ne,["mouseRotate"]);var Me=new Ps(c),mt=new rn(c);p.dragPan=new Ee(T,Me,mt),this.add("mousePan",Me),this.add("touchPan",mt,["touchZoom","touchRotate"]);var ke=new Aa,ct=new _i;p.touchZoomRotate=new rt(T,ct,ke,X),this.add("touchRotate",ke,["touchPan","touchZoom"]),this.add("touchZoom",ct,["touchPan","touchRotate"]);var Be=p.scrollZoom=new F(p,this);this.add("scrollZoom",Be,["mousePan"]);var It=p.keyboard=new Vs;this.add("keyboard",It),this.add("blockableMapEvent",new cl(p));for(var $t=0,ar=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];$t<ar.length;$t++){var tr=ar[$t];c.interactive&&c[tr]&&p[tr].enable(c[tr])}}},{key:"add",value:function(c,p,T){this.handlers.push({handlerName:c,handler:p,allowed:T}),this.handlersById[c]=p}},{key:"blockedByActive",value:function(c,p,T){for(var j in c){if(j===T)continue;if(!p||p.indexOf(j)<0)return!0}return!1}},{key:"getMapTouches",value:function(c){var p=[],T=Di(c),j;try{for(T.s();!(j=T.n()).done;){var I=j.value,k=I.target;this.el.contains(k)&&p.push(I)}}catch(X){T.e(X)}finally{T.f()}return p}},{key:"applyChanges",value:function(){var c={},p={},T={},j=Di(this.changes),I;try{for(j.s();!(I=j.n()).done;){var k=yn()(I.value,3),X=k[0],ae=k[1],Je=k[2];X.panDelta&&(c.panDelta=(c.panDelta||new kn(0,0))._add(X.panDelta)),X.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+X.zoomDelta),X.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+X.bearingDelta),X.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+X.pitchDelta),X.around!==void 0&&(c.around=X.around),X.pinchAround!==void 0&&(c.pinchAround=X.pinchAround),X.noInertia&&(c.noInertia=X.noInertia),eo()(p,ae),eo()(T,Je)}}catch(Ne){j.e(Ne)}finally{j.f()}this.updateMapTransform(c,p,T),this.changes=[]}},{key:"updateMapTransform",value:function(c,p,T){var j=this.map,I=j.transform;if(!qo(c))return this.fireEvents(p,T);var k=c.panDelta,X=c.zoomDelta,ae=c.bearingDelta,Je=c.pitchDelta,Ne=c.pinchAround,Me=c.around;Ne!==void 0&&(Me=Ne),j.stop(!0),Me=Me||j.transform.centerPoint;var mt=I.pointLocation(k?Me.sub(k):Me);ae&&(I.bearing+=ae),Je&&(I.pitch+=Je),X&&(I.zoom+=X),I.setLocationAtPoint(mt,Me),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(p,T)}},{key:"fireEvents",value:function(c,p){var T=this,j=Qo(this.eventsInProgress),I=Qo(c),k={};for(var X in c)if(c[X]){var ae=c[X].originalEvent;this.eventsInProgress[X]||(k["".concat(X,"start")]=ae),this.eventsInProgress[X]=c[X]}!j&&I&&this.fireEvent("movestart",I.originalEvent);for(var Je in k)k[Je]&&this.fireEvent(Je,k[Je]);c.rotate&&(this.bearingChanged=!0),I&&this.fireEvent("move",I.originalEvent);for(var Ne in c)if(c[Ne]){var Me=c[Ne].originalEvent;this.fireEvent(Ne,Me)}var mt={},ke;for(var ct in this.eventsInProgress)if(this.eventsInProgress[ct]){var Be=this.eventsInProgress[ct],It=Be.handlerName,$t=Be.originalEvent;this.handlersById[It].isActive()||(delete this.eventsInProgress[ct],ke=p[It]||$t,mt["".concat(ct,"end")]=ke)}for(var ar in mt)mt[ar]&&this.fireEvent(ar,mt[ar]);var tr=Qo(this.eventsInProgress);if((j||I)&&!tr){this.updatingCamera=!0;var pr=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),wr=function(Cn){return Cn!==0&&-T.bearingSnap<Cn&&Cn<T.bearingSnap};pr?(wr(pr.bearing||this.map.getBearing())&&(pr.bearing=0),this.map.easeTo(pr,{originalEvent:ke})):(this.map.emit("moveend",new ti("moveend",{originalEvent:ke})),wr(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,p){this.map.emit(c,new ti(c,p?{originalEvent:p}:{}))}}]),O}(),Mu=vu,cs=o("DzJC"),Gs=o.n(cs),Pu=function(){function O(d){var c=this;Ye()(this,O),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var p=c.getCurrentHash();if(p.length>=3&&!p.some(function(j){return isNaN(+j)})){var T=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(p[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:T,pitch:+(p[4]||0)}),!0}return!1},this.getCurrentHash=function(){var p=window.location.hash.replace("#","");if(c.hashName){var T;return p.split("&").map(function(j){return j.split("=")}).forEach(function(j){j[0]===c.hashName&&(T=j)}),(T&&T[1]||"").split("/")}return p.split("/")},this.updateHashUnthrottled=function(){var p=c.getHashString();try{window.history.replaceState(window.history.state,"",p)}catch(T){}},this.hashName=d&&encodeURIComponent(d),this.updateHash=Gs()(this.updateHashUnthrottled,30*1e3/100)}return bt()(O,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var p=this.map.getCenter(),T=Math.round(this.map.getZoom()*100)/100,j=Math.ceil((T*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,j),k=Math.round(p.lng*I)/I,X=Math.round(p.lat*I)/I,ae=this.map.getBearing(),Je=this.map.getPitch(),Ne="";if(c?Ne+="/".concat(k,"/").concat(X,"/").concat(T):Ne+="".concat(T,"/").concat(X,"/").concat(k),(ae||Je)&&(Ne+="/".concat(Math.round(ae*10)/10)),Je&&(Ne+="/".concat(Math.round(Je))),this.hashName){var Me=this.hashName,mt=!1,ke=window.location.hash.slice(1).split("&").map(function(ct){var Be=ct.split("=")[0];return Be===Me?(mt=!0,"".concat(Be,"=").concat(Ne)):ct}).filter(function(ct){return ct});return mt||ke.push("".concat(Me,"=").concat(Ne)),"#".concat(ke.join("&"))}return"#".concat(Ne)}}]),O}(),sc=Pu,tu=null,Xu=[],uc=30,ru=1e3/uc,Lu=window.performance,fs={create:"create",load:"load",fullLoad:"fullLoad"},ao={mark:function(d){Lu.mark(d)},frame:function(d){var c=d;if(tu!=null){var p=c-tu;Xu.push(p)}tu=c},clearMetrics:function(){tu=null,Xu=[],Lu.clearMeasures("loadTime"),Lu.clearMeasures("fullLoadTime");for(var d in fs)Lu.clearMarks(fs[d])},getPerformanceMetrics:function(){var d=Lu.measure("loadTime",fs.create,fs.load).duration,c=Lu.measure("fullLoadTime",fs.create,fs.fullLoad).duration,p=Xu.length,T=Xu.reduce(function(X,ae){return X+ae},0)/p/1e3,j=1/T,I=Xu.filter(function(X){return X>ru}).reduce(function(X,ae){return X+(ae-ru)/ru},0),k=I/(p+I)*100;return{loadTime:d,fullLoadTime:c,fps:j,percentDroppedFrames:k}}};function Yu(O,d){var c;if(typeof Symbol=="undefined"||O[Symbol.iterator]==null){if(Array.isArray(O)||(c=Gl(O))||d&&O&&typeof O.length=="number"){c&&(O=c);var p=0,T=function(){};return{s:T,n:function(){return p>=O.length?{done:!0}:{done:!1,value:O[p++]}},e:function(ae){throw ae},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,I=!1,k;return{s:function(){c=O[Symbol.iterator]()},n:function(){var ae=c.next();return j=ae.done,ae},e:function(ae){I=!0,k=ae},f:function(){try{!j&&c.return!=null&&c.return()}finally{if(I)throw k}}}}function Gl(O,d){if(!O)return;if(typeof O=="string")return hs(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return hs(O,d)}function hs(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}var Do=function(){function O(){Ye()(this,O),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return bt()(O,[{key:"add",value:function(c){var p=++this.id,T=this.queue;return T.push({callback:c,id:p,cancelled:!1}),p}},{key:"remove",value:function(c){var p=this.currentlyRunning,T=p?this.queue.concat(p):this.queue,j=Yu(T),I;try{for(j.s();!(I=j.n()).done;){var k=I.value;if(k.id===c){k.cancelled=!0;return}}}catch(X){j.e(X)}finally{j.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=this.currentlyRunning=this.queue;this.queue=[];var T=Yu(p),j;try{for(T.s();!(j=T.n()).done;){var I=j.value;if(I.cancelled)continue;if(I.callback(c),this.cleared)break}}catch(k){T.e(k)}finally{T.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),O}(),No=Do;function Ho(O){var d=_o();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}o("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var uo=-2,Ls=22,nu=0,Hl=60,Gc={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:uo,maxZoom:Ls,minPitch:nu,maxPitch:Hl,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},dl=function(O){ze()(c,O);var d=Ho(c);function c(p){var T;Ye()(this,c),T=d.call(this,eo()({},Gc,p)),T.doubleClickZoom=void 0,T.dragRotate=void 0,T.dragPan=void 0,T.touchZoomRotate=void 0,T.scrollZoom=void 0,T.keyboard=void 0,T.touchPitch=void 0,T.boxZoom=void 0,T.handlers=void 0,T.container=void 0,T.canvas=void 0,T.canvasContainer=void 0,T.renderTaskQueue=new No,T.frame=void 0,T.trackResize=!0,T.hash=void 0,T.onWindowOnline=function(){T.update()},T.onWindowResize=function(I){T.trackResize&&T.resize({originalEvent:I}).update()},T.initContainer(),T.resize(),T.handlers=new Mu(El()(T),T.options),typeof window!="undefined"&&(window.addEventListener("online",T.onWindowOnline,!1),window.addEventListener("resize",T.onWindowResize,!1),window.addEventListener("orientationchange",T.onWindowResize,!1));var j=typeof p.hash=="string"&&p.hash||void 0;return p.hash&&(T.hash=new sc(j).addTo(El()(T))),(!T.hash||!T.hash.onHashChange())&&(T.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(T.resize(),T.fitBounds(p.bounds,eo()({},p.fitBoundsOptions,{duration:0})))),T}return bt()(c,[{key:"resize",value:function(T){var j=this.containerDimensions(),I=j[0],k=j[1];this.transform.resize(I,k);var X=!this.moving;return X&&(this.stop(),this.emit("movestart",new Event("movestart",T)),this.emit("move",new Event("move",T))),this.emit("resize",new Event("resize",T)),X&&this.emit("moveend",new Event("moveend",T)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(T){return this.transform.locationPoint(ui.convert(T))}},{key:"unproject",value:function(T){return this.transform.pointLocation(kn.convert(T))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(T){this.transform.setMaxBounds(il.convert(T))}},{key:"setStyle",value:function(T){return}},{key:"setMinZoom",value:function(T){if(T=T==null?uo:T,T>=uo&&T<=this.transform.maxZoom)return this.transform.minZoom=T,this.getZoom()<T&&this.setZoom(T),this;throw new Error("minZoom must be between ".concat(uo," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(T){if(T=T==null?Ls:T,T>=this.transform.minZoom)return this.transform.maxZoom=T,this.getZoom()>T&&this.setZoom(T),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(T){if(T=T==null?nu:T,T<nu)throw new Error("minPitch must be greater than or equal to ".concat(nu));if(T>=nu&&T<=this.transform.maxPitch)return this.transform.minPitch=T,this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between ".concat(nu," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(T){if(T=T==null?Hl:T,T>Hl)throw new Error("maxPitch must be less than or equal to ".concat(Hl));if(T>=this.transform.minPitch)return this.transform.maxPitch=T,this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(T){this.transform.renderWorldCopies=!!T}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(T){return this.update(),this.renderTaskQueue.add(T)}},{key:"cancelRenderFrame",value:function(T){return this.renderTaskQueue.remove(T)}},{key:"triggerRepaint",value:function(){var T=this;this.frame||(this.frame=wi(function(j){ao.frame(j),T.frame=null,T.update(j)}))}},{key:"update",value:function(T){var j=this;this.frame||(this.frame=wi(function(I){ao.frame(I),j.frame=null,j.renderTaskQueue.run(T)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var T=this.container;T.classList.add("l7-map");var j=this.canvasContainer=ln.a.create("div","l7-canvas-container",T);this.options.interactive&&j.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var T=0,j=0;return this.container&&(T=this.container.clientWidth||400,j=this.container.clientHeight||300),[T,j]}},{key:"resizeCanvas",value:function(T,j){var I=window.devicePixelRatio||1;this.canvas.width=I*T,this.canvas.height=I*j,this.canvas.style.width="".concat(T,"px"),this.canvas.style.height="".concat(j,"px")}}]),c}(Us),lc=function(){function O(){Ye()(this,O),this.viewport=void 0}return bt()(O,[{key:"syncWithMapCamera",value:function(c){var p=c.center,T=c.zoom,j=c.pitch,I=c.bearing,k=c.viewportHeight,X=c.viewportWidth;this.viewport=new _u({width:X,height:k,longitude:p&&p[0],latitude:p&&p[1],zoom:T,pitch:j,bearing:I})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),O}(),pl={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Rs,go,Ac,ds,sf,Cf,wf,Cc,Ku,Ef,uf,Of,Ru,cc;function Df(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Hc(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?Df(Object(c),!0).forEach(function(p){gr()(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):Df(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}var wc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Qf=12,qf=(Rs=Object(tn.injectable)(),go=Object(tn.inject)(On.TYPES.MapConfig),Ac=Object(tn.inject)(On.TYPES.IGlobalConfigService),ds=Object(tn.inject)(On.TYPES.ILogService),sf=Object(tn.inject)(On.TYPES.ICoordinateSystemService),Cf=Object(tn.inject)(On.TYPES.IEventEmitter),Rs(wf=(Cc=(cc=function(){function O(){var d=this;Ye()(this,O),this.map=void 0,zn()(this,"config",Ku,this),zn()(this,"configService",Ef,this),zn()(this,"logger",uf,this),zn()(this,"coordinateSystemService",Of,this),zn()(this,"eventEmitter",Ru,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=d.map.getCenter(),p=c.lat,T=c.lng;d.viewport.syncWithMapCamera({bearing:d.map.getBearing(),center:[T,p],viewportHeight:d.map.transform.height,pitch:d.map.getPitch(),viewportWidth:d.map.transform.width,zoom:d.map.getZoom(),cameraHeight:0}),d.viewport.getZoom()>Qf?d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT_OFFSET):d.coordinateSystemService.setCoordinateSystem(On.CoordinateSystem.LNGLAT),d.cameraChangedCallback(d.viewport)}}return bt()(O,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=ln.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){On.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(wc[c]||c,p)}},{key:"off",value:function(c,p){this.map.off(wc[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,p,T){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var d=cr()($.a.mark(function p(){var T,j,I,k,X,ae,Je,Ne,Me,mt,ke;return $.a.wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:T=this.config,j=T.id,I=j===void 0?"map":j,k=T.attributionControl,X=k===void 0?!1:k,ae=T.style,Je=ae===void 0?"light":ae,Ne=T.rotation,Me=Ne===void 0?0:Ne,mt=T.mapInstance,ke=zr()(T,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new lc,mt?(this.map=mt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(I),this.map=new dl(Hc({container:this.$mapContainer,style:this.getMapStyle(Je),bearing:Me},ke))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return Be.stop()}},p,this)}));function c(){return d.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).emit.apply(p,[c].concat(j))}},{key:"once",value:function(c){for(var p,T=arguments.length,j=new Array(T>1?T-1:0),I=1;I<T;I++)j[I-1]=arguments[I];(p=this.eventEmitter).once.apply(p,[c].concat(j))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),T=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return T}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;return typeof c=="string"&&(p=document.getElementById(c)),p}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:pl[c]?pl[c]:c}}]),O}(),cc),Ku=$n()(Cc.prototype,"config",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ef=$n()(Cc.prototype,"configService",[Ac],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uf=$n()(Cc.prototype,"logger",[ds],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Of=$n()(Cc.prototype,"coordinateSystemService",[sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ru=$n()(Cc.prototype,"eventEmitter",[Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc))||wf);function eh(O){var d=th();return function(){var p=hr()(O),T;if(d){var j=hr()(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return yt()(this,T)}}function th(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}var Mf=function(O){ze()(c,O);var d=eh(c);function c(){return Ye()(this,c),d.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return qf}}]),c}(Lt);function rh(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Wl(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?rh(Object(c),!0).forEach(function(p){lf(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):rh(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function lf(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function io(O,d){return wl(O)||au(O,d)||Tf(O,d)||fc()}function fc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tf(O,d){if(!O)return;if(typeof O=="string")return Oc(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Oc(O,d)}function Oc(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function au(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function wl(O){if(Array.isArray(O))return O}var _f=ht.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=O.option,j=O.onSceneLoaded,I=Object(Pe.createRef)(),k=Object(Pe.useState)(),X=io(k,2),ae=X[0],Je=X[1];return Object(Pe.useEffect)(function(){var Ne=new kt.Scene(Wl(Wl({id:I.current},T),{},{map:new Mf(p)}));return Ne.on("loaded",function(){Je(Ne),j&&j(Ne)}),function(){Ne.destroy()}},[]),Object(Pe.useEffect)(function(){ae&&p.style&&ae.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(Pe.useEffect)(function(){ae&&p.zoom&&ae.setZoom(p.zoom)},[p.zoom]),Object(Pe.useEffect)(function(){ae&&p.center&&ae.setCenter(p.center)},[JSON.stringify(p.center)]),Object(Pe.useEffect)(function(){ae&&p.pitch&&ae.setPitch(p.pitch)},[p.pitch]),Object(Pe.useEffect)(function(){ae&&p.rotation&&ae.setRotation(p.rotation)},[p.rotation]),ht.a.createElement(ne.Provider,{value:ae},Object(Pe.createElement)("div",{ref:I,style:d,className:c},ae&&O.children))}),Nf=_f;function Wc(O,d){return se(O)||re(O,d)||Zc(O,d)||cf()}function cf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zc(O,d){if(!O)return;if(typeof O=="string")return ml(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ml(O,d)}function ml(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function re(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function se(O){if(Array.isArray(O))return O}var N=ht.a.memo(function(O){var d=O.style,c=O.className,p=O.map,T=Object(Pe.createRef)(),j=Object(Pe.useState)(),I=Wc(j,2),k=I[0],X=I[1];return Object(Pe.useEffect)(function(){var ae=new kt.Scene({id:T.current,map:p});return ae.on("loaded",function(){X(ae)}),function(){ae.destroy()}},[]),ht.a.createElement(ne.Provider,{value:k},Object(Pe.createElement)("div",{ref:T,style:d,className:c},k&&O.children))});function G(O,d){return or(O)||sr(O,d)||ft(O,d)||Ae()}function Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ft(O,d){if(!O)return;if(typeof O=="string")return Xt(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Xt(O,d)}function Xt(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function sr(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function or(O){if(Array.isArray(O))return O}var Ir=ht.a.memo(function(d){var c=tt(),p=Object(Pe.useState)(),T=G(p,2),j=T[1],I=d.type,k=d.position;return Object(Pe.useEffect)(function(){var X;switch(I){case"scale":X=new kt.Scale({position:k||"bottomright"});break;case"zoom":X=new kt.Zoom({position:k||"topright"});break;case"logo":X=new kt.Logo({position:k||"bottomleft"})}return j(X),c.addControl(X),function(){c.removeControl(X)}},[I,k]),null}),an=o("i8i4"),Gn=Pe.useEffect,ea=Pe.useState;function la(O){var d=O.className,c=O.style,p=O.children,T=O.position,j=tt(),I=document.createElement("div");return Gn(function(){var k=new kt.Control({position:T});return k.onAdd=function(){if(d&&(I.className=d),c){var X=Object.keys(c).map(function(ae){return"".concat(ae,":").concat(c[ae])}).join(";");I.style.cssText=X}return I},j.addControl(k),function(){j.removeControl(k)}},[]),Object(an.createPortal)(p,I)}var qa=Object(Pe.createContext)({});function Fa(){return Object(Pe.useContext)(qa)}var yi=Pe.useEffect,Ja=Pe.memo(function(d){var c=d.layer,p=d.active;return yi(function(){c.active(p.option)},[JSON.stringify(p)]),null}),Bi=Pe.useEffect,So=Pe.memo(function(d){var c=d.layer,p=d.animate;return Bi(function(){c.animate(p)},[JSON.stringify(p)]),null}),yo=Pe.useEffect,Hi=Pe.memo(function(d){var c=d.layer,p=d.color;return yo(function(){p.field?c.color(p.field,p.values):c.color(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),ko=Pe.useEffect,Qa=Pe.memo(function(d){var c=d.layer,p=d.filter;return ko(function(){p.field&&c.filter(p.field,p.values)},[p.field,p.values,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),lo=Pe.useEffect,iu=Pe.memo(function(d){var c=d.layer,p=d.scale;return lo(function(){c.scale(p.values)},[p.values]),null}),bi=Pe.useEffect,Ni=Pe.memo(function(d){var c=d.layer,p=d.select;return bi(function(){c.select(p.option)},[JSON.stringify(p)]),null}),xa=Pe.useEffect,Ao=Pe.memo(function(d){var c=d.layer,p=d.shape;return xa(function(){p.field?c.shape(p.field,p.values):c.shape(p.values)},[p.field,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),hc=Pe.useEffect,kf=Pe.memo(function(d){var c=d.layer,p=d.size;return hc(function(){p.field?c.size(p.field,p.values):c.size(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null});function uh(O,d){if(O==null)return{};var c=jf(O,d),p,T;if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(O);for(T=0;T<j.length;T++){if(p=j[T],d.indexOf(p)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(O,p))continue;c[p]=O[p]}}return c}function jf(O,d){if(O==null)return{};var c={},p=Object.keys(O),T,j;for(j=0;j<p.length;j++){if(T=p[j],d.indexOf(T)>=0)continue;c[T]=O[T]}return c}var Iu=Pe.useEffect,Ff=Pe.memo(function(d){var c=d.layer,p=d.source,T=p.data,j=uh(p,["data"]);return Iu(function(){c.inited?c.setData(T,j):c.source(T,j),j.autoFit&&c.fitBounds(j&&j.fitBoundsOptions)},[T,JSON.stringify(j)]),null}),ff=Pe.useEffect,zf=Pe.memo(function(d){var c=d.layer,p=d.style;return ff(function(){c.style(p)},Object.keys(p).map(function(T){return p[T]})),null});function Th(O,d){return ch(O)||Bf(O,d)||Sf(O,d)||lh()}function lh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sf(O,d){if(!O)return;if(typeof O=="string")return Uf(O,d);var c=Object.prototype.toString.call(O).slice(8,-1);if(c==="Object"&&O.constructor&&(c=O.constructor.name),c==="Map"||c==="Set")return Array.from(O);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Uf(O,d)}function Uf(O,d){(d==null||d>O.length)&&(d=O.length);for(var c=0,p=new Array(d);c<d;c++)p[c]=O[c];return p}function Bf(O,d){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(O)))return;var c=[],p=!0,T=!1,j=void 0;try{for(var I=O[Symbol.iterator](),k;!(p=(k=I.next()).done)&&!(c.push(k.value),d&&c.length===d);p=!0);}catch(X){T=!0,j=X}finally{try{!p&&I.return!=null&&I.return()}finally{if(T)throw j}}return c}function ch(O){if(Array.isArray(O))return O}var Vf=Pe.useEffect,Pf=Pe.useState;function Zl(O,d){var c=d.source,p=d.color,T=d.shape,j=d.style,I=d.size,k=d.scale,X=d.active,ae=d.select,Je=d.filter,Ne=d.animate,Me=d.options,mt=d.onLayerLoaded,ke=tt(),ct=Pf(),Be=Th(ct,2),It=Be[0],$t=Be[1];if(!It){var ar;switch(O){case"polygonLayer":ar=new kt.PolygonLayer(Me);break;case"lineLayer":ar=new kt.LineLayer(Me);break;case"pointLayer":ar=new kt.PointLayer(Me);break;case"heatmapLayer":ar=new kt.HeatmapLayer(Me);break;case"rasterLayer":ar=new kt.RasterLayer(Me);break;case"imageLayer":ar=new kt.ImageLayer(Me);break;case"citybuildingLayer":ar=new kt.CityBuildingLayer(Me);break;default:ar=new kt.PolygonLayer(Me)}ar.on("inited",function(){mt&&mt(ar,ke)}),$t(ar)}return Vf(function(){if(It!==void 0)return ke.addLayer(It),function(){ke.removeLayer(It)}},[]),Vf(function(){It&&ke.render()}),Vf(function(){It&&It.inited&&Me&&It.updateLayerConfig(Me)},[Me==null?void 0:Me.minZoom,Me==null?void 0:Me.maxZoom,Me==null?void 0:Me.visible]),Vf(function(){It&&It.inited&&Me&&Me.zIndex&&It.setIndex(Me.zIndex)},[Me==null?void 0:Me.zIndex]),Vf(function(){It&&It.inited&&Me&&Me.blend&&It.setBlend(Me.blend)},[Me==null?void 0:Me.blend]),It!=null?Pe.createElement(qa.Provider,{value:It},Pe.createElement(Ff,{layer:It,source:c}),k&&Pe.createElement(iu,{layer:It,scale:k}),p&&Pe.createElement(Hi,{layer:It,color:p}),I&&Pe.createElement(kf,{layer:It,size:I}),T&&Pe.createElement(Ao,{layer:It,shape:T}),j&&Pe.createElement(zf,{layer:It,style:j}),X&&Pe.createElement(Ja,{layer:It,active:X}),ae&&Pe.createElement(Ni,{layer:It,select:ae}),Je&&Pe.createElement(Qa,{layer:It,filter:Je}),Ne&&Pe.createElement(So,{layer:It,animate:Ne}),d.children):null}var Dh=Pe.memo(function(d){return Zl("polygonLayer",d)}),ye=Pe.memo(function(d){return Zl("lineLayer",d)}),Fe=Pe.memo(function(d){return Zl("pointLayer",d)}),Ot=Pe.memo(function(d){return Zl("heatmapLayer",d)}),xr=Pe.memo(function(d){return Zl("rasterLayer",d)}),Pr=Pe.memo(function(d){return Zl("imageLayer",d)}),Cr=Pe.memo(function(d){return Zl("citybuildingLayer",d)}),Er=Pe.useEffect,Wr=Pe.memo(function(O){var d=O.type,c=O.handler,p=Fa();return Er(function(){return p.off(d,c),p.on(d,c),function(){p.off(d,c)}},[d,c]),null}),on={color:"color"},en=Pe.memo(function(O){var d=O.className,c=O.style,p=O.title,T=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return Pe.createElement("div",null,Pe.createElement("div",null,T.map(function(j,I){return Pe.createElement("div",{key:I.toString(),style:{background:j.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-T.length)/T.length+"%",marginRight:"1%",padding:5}})})),Pe.createElement("div",null,T.map(function(j,I){return Pe.createElement("div",{key:I.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-T.length)/T.length+"%",marginRight:"1%"}},j.title)})))});function Yr(O){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yr=function(c){return typeof c}:Yr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Yr(O)}function cn(O,d){var c=Object.keys(O);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(O);d&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),c.push.apply(c,p)}return c}function Tn(O){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?cn(Object(c),!0).forEach(function(p){dn(O,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(c)):cn(Object(c)).forEach(function(p){Object.defineProperty(O,p,Object.getOwnPropertyDescriptor(c,p))})}return O}function dn(O,d,c){return d in O?Object.defineProperty(O,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):O[d]=c,O}function nn(O,d){if(!(O instanceof d))throw new TypeError("Cannot call a class as a function")}function Tr(O,d){for(var c=0;c<d.length;c++){var p=d[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(O,p.key,p)}}function br(O,d,c){return d&&Tr(O.prototype,d),c&&Tr(O,c),O}function Zr(O,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(d&&d.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),d&&wn(O,d)}function wn(O,d){return wn=Object.setPrototypeOf||function(p,T){return p.__proto__=T,p},wn(O,d)}function Rr(O){var d=Br();return function(){var p=Fr(O),T;if(d){var j=Fr(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return ta(this,T)}}function ta(O,d){return d&&(Yr(d)==="object"||typeof d=="function")?d:Jr(O)}function Jr(O){if(O===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O}function Br(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}function Fr(O){return Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Fr(O)}var Kr=function(O){Zr(c,O);var d=Rr(c);function c(p){var T;return nn(this,c),T=d.call(this,p),T.el=document.createElement("div"),T}return br(c,[{key:"componentDidMount",value:function(){var T=this.props,j=T.lnglat,I=T.children,k=T.option,X=new kt.Popup(Tn(Tn({},k),{},{stopPropagation:!1}));j&&X.setLnglat(j),I&&X.setDOMContent(this.el),this.popup=X,this.scene.addPopup(X)}},{key:"componentDidUpdate",value:function(T){var j,I,k,X,ae,Je,Ne=Array.isArray(T.lnglat)?T.lnglat:[T==null||((j=T.lnglat)===null||j===void 0)?void 0:j.lng,T==null||((I=T.lnglat)===null||I===void 0)?void 0:I.lat],Me=Array.isArray(this.props.lnglat)?this.props.lnglat:[(k=this.props)===null||k===void 0||((X=k.lnglat)===null||X===void 0)?void 0:X.lng,(ae=this.props)===null||ae===void 0||((Je=ae.lnglat)===null||Je===void 0)?void 0:Je.lat],mt=Ne.toString()!==Me.toString();mt&&(this.popup.remove(),this.popup=new kt.Popup(Tn(Tn({},this.props.option),{},{stopPropagation:!1})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var T=this;return Pe.createElement(ne.Consumer,{},function(j){return j&&(T.scene=j),Object(an.createPortal)(T.props.children,T.el)})}}]),c}(Pe.PureComponent);function Hn(O){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Hn=function(c){return typeof c}:Hn=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Hn(O)}function aa(O,d){if(!(O instanceof d))throw new TypeError("Cannot call a class as a function")}function sn(O,d){for(var c=0;c<d.length;c++){var p=d[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(O,p.key,p)}}function Gr(O,d,c){return d&&sn(O.prototype,d),c&&sn(O,c),O}function jr(O,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(d&&d.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),d&&ha(O,d)}function ha(O,d){return ha=Object.setPrototypeOf||function(p,T){return p.__proto__=T,p},ha(O,d)}function pa(O){var d=Oa();return function(){var p=Da(O),T;if(d){var j=Da(this).constructor;T=Reflect.construct(p,arguments,j)}else T=p.apply(this,arguments);return Un(this,T)}}function Un(O,d){return d&&(Hn(d)==="object"||typeof d=="function")?d:Ua(O)}function Ua(O){if(O===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O}function Oa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}function Da(O){return Da=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Da(O)}var fi=function(O){jr(c,O);var d=pa(c);function c(p){var T;return aa(this,c),T=d.call(this,p),T.el=document.createElement("div"),T}return Gr(c,[{key:"componentDidMount",value:function(){var T=this.props,j=T.lnglat,I=T.children,k=T.option,X=T.onMarkerLoaded,ae=new kt.Marker(k);j&&ae.setLnglat(j),I&&ae.setElement(this.el),this.marker=ae,X&&X(ae),this.scene.addMarker(ae)}},{key:"componentDidUpdate",value:function(T){var j,I=(T==null?void 0:T.lnglat.toString())!==((j=this.props)===null||j===void 0?void 0:j.lnglat.toString());I&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var T=this;return Pe.createElement(ne.Consumer,{},function(j){return j&&(T.scene=j),Object(an.createPortal)(T.props.children,T.el)})}}]),c}(Pe.PureComponent),jo=Pe.useEffect,ps=Pe.memo(function(O){var d=O.type,c=O.handler,p=tt();return jo(function(){return p.on(d,c),function(){p.off(d,c)}},[d]),null}),ei=ps,co=Pe.useEffect,Mi=Pe.memo(function(d){var c=d.name,p=d.url,T=tt();return co(function(){T.addImage(c,p)},[c,p]),null}),ms=o("tbuW"),Wo=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],Zo=function(O){Object(ee.a)(c,O);var d=Object(ce.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={data:null,grid:null,loading:!1},p}return Object(Q.a)(c,[{key:"componentDidMount",value:function(){var p=Object(Qe.a)($.a.mark(function j(){var I,k,X,ae;return $.a.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return Ne.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Me){return Me.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Me){return Me.json()})]);case 2:I=Ne.sent,k=Object(C.a)(I,2),X=k[0],ae=k[1],this.setState({data:X,grid:ae,loading:!0});case 7:case"end":return Ne.stop()}},j,this)}));function T(){return p.apply(this,arguments)}return T}()},{key:"render",value:function(){var T=this.state,j=T.data,I=T.grid,k=T.loading;return k===!1?Object(pe.jsx)(ms.a,{"data-inspector-line":"32","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"}):Object(pe.jsxs)(Il,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"},"data-inspector-line":"34","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx",children:[I&&Object(pe.jsx)(Ot,{source:{data:I,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8},"data-inspector-line":"48","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"},"1"),j&&[Object(pe.jsx)(Fe,{options:{autoFit:!0},source:{data:j},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Wo},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8},"data-inspector-line":"74","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"},"2"),Object(pe.jsx)(Fe,{source:{data:j},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(ae){return ae>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0},"data-inspector-line":"114","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/Charts/Map/index.tsx"},"5")]]})}}]),c}(Pe.Component),es={Pie:gt,WaterWave:it,Gauge:Qt,MiniArea:J,TagCloud:We,Map:Zo},Is=o("KQm4"),Wi={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"};function ia(O){return O*1<10?"0".concat(O):O}function Hs(){for(var O=[],d=0;d<24;d+=1)O.push({x:"".concat(ia(d),":00"),y:Math.floor(Math.random()*200)+d*50});return O}var xi=function(O){Object(ee.a)(c,O);var d=Object(ce.a)(c);function c(){var p;Object(D.a)(this,c);for(var T=arguments.length,j=new Array(T),I=0;I<T;I++)j[I]=arguments[I];return p=d.call.apply(d,[this].concat(j)),p.state={activeData:Hs()},p.timer=void 0,p.requestRef=void 0,p.loopData=function(){p.requestRef=requestAnimationFrame(function(){p.timer=window.setTimeout(function(){p.setState({activeData:Hs()},function(){p.loopData()})},1e3)})},p}return Object(Q.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var T=this.state.activeData,j=T===void 0?[]:T;return Object(pe.jsxs)("div",{className:Wi.activeChart,"data-inspector-line":"61","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsx)(je.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F","data-inspector-line":"62","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"}),Object(pe.jsx)("div",{style:{marginTop:32},"data-inspector-line":"63","data-inspector-column":"8","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:Object(pe.jsx)(J,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:j,"data-inspector-line":"64","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"})}),j&&Object(pe.jsxs)("div",{"data-inspector-line":"84","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsxs)("div",{className:Wi.activeChartGrid,"data-inspector-line":"85","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsxs)("p",{"data-inspector-line":"86","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(Is.a)(j).sort()[j.length-1].y+200," \u4EBF\u5143"]}),Object(pe.jsxs)("p",{"data-inspector-line":"87","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(Is.a)(j).sort()[Math.floor(j.length/2)].y," \u4EBF\u5143"]})]}),Object(pe.jsx)("div",{className:Wi.dashedLine,"data-inspector-line":"89","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:Object(pe.jsx)("div",{className:Wi.line,"data-inspector-line":"90","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"})}),Object(pe.jsx)("div",{className:Wi.dashedLine,"data-inspector-line":"92","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:Object(pe.jsx)("div",{className:Wi.line,"data-inspector-line":"93","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx"})})]}),j&&Object(pe.jsxs)("div",{className:Wi.activeChartLegend,"data-inspector-line":"98","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:[Object(pe.jsx)("span",{"data-inspector-line":"99","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:"00:00"}),Object(pe.jsx)("span",{"data-inspector-line":"100","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:j[Math.floor(j.length/2)].x}),Object(pe.jsx)("span",{"data-inspector-line":"101","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/components/ActiveChart/index.tsx",children:j[j.length-1].x})]})]})}}]),c}(Pe.Component),An={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"},Ra=je.a.Countdown,Ba=Date.now()+1e3*60*60*24*2+1e3*30,Xo=function(O){Object(ee.a)(c,O);var d=Object(ce.a)(c);function c(){return Object(D.a)(this,c),d.apply(this,arguments)}return Object(Q.a)(c,[{key:"componentDidMount",value:function(){var T=this.props.dispatch;T({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var T=this.props,j=T.dashboardAndmonitor,I=T.loading,k=j.tags;return Object(pe.jsx)(Le.a,{"data-inspector-line":"34","data-inspector-column":"6","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsxs)(ht.a.Fragment,{children:[Object(pe.jsxs)(z.a,{gutter:24,"data-inspector-line":"36","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(W.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"37","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsxs)(m.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity","data-inspector-line":"40","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),bordered:!1,"data-inspector-line":"38","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsxs)(z.a,{"data-inspector-line":"47","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(W.a,{md:6,sm:12,xs:24,"data-inspector-line":"48","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(je.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today","data-inspector-line":"51","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),suffix:"\u5143",value:ot()(124543233).format("0,0"),"data-inspector-line":"49","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(W.a,{md:6,sm:12,xs:24,"data-inspector-line":"60","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(je.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate","data-inspector-line":"63","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),value:"92%","data-inspector-line":"61","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(W.a,{md:6,sm:12,xs:24,"data-inspector-line":"71","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Ra,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity","data-inspector-line":"74","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),value:Ba,format:"HH:mm:ss:SSS","data-inspector-line":"72","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(W.a,{md:6,sm:12,xs:24,"data-inspector-line":"83","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(je.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second","data-inspector-line":"86","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),suffix:"\u5143",value:ot()(234).format("0,0"),"data-inspector-line":"84","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]}),Object(pe.jsx)("div",{className:An.mapChart,"data-inspector-line":"96","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Zo,{"data-inspector-line":"97","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]})}),Object(pe.jsxs)(W.a,{xl:6,lg:24,md:24,sm:24,xs:24,"data-inspector-line":"101","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast","data-inspector-line":"104","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),style:{marginBottom:24},bordered:!1,"data-inspector-line":"102","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(xi,{"data-inspector-line":"112","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency","data-inspector-line":"116","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1,"data-inspector-line":"114","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(Qt,{title:Object(Ke.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87,"data-inspector-line":"125","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]})]}),Object(pe.jsxs)(z.a,{gutter:24,"data-inspector-line":"136","data-inspector-column":"10","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(W.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"137","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category","data-inspector-line":"140","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),bordered:!1,className:An.pieCard,"data-inspector-line":"138","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsxs)(z.a,{style:{padding:"16px 0"},"data-inspector-line":"148","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:[Object(pe.jsx)(W.a,{span:8,"data-inspector-line":"149","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(gt,{animate:!1,percent:28,title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food","data-inspector-line":"154","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),total:"28%",height:128,lineWidth:2,"data-inspector-line":"150","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(W.a,{span:8,"data-inspector-line":"164","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(gt,{animate:!1,color:"#5DDECF",percent:22,title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food","data-inspector-line":"170","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),total:"22%",height:128,lineWidth:2,"data-inspector-line":"165","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})}),Object(pe.jsx)(W.a,{span:8,"data-inspector-line":"180","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(gt,{animate:!1,color:"#2FC25B",percent:32,title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot","data-inspector-line":"186","data-inspector-column":"24","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),total:"32%",height:128,lineWidth:2,"data-inspector-line":"181","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})]})})}),Object(pe.jsx)(W.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"199","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches","data-inspector-line":"202","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),loading:I,bordered:!1,bodyStyle:{overflow:"hidden"},"data-inspector-line":"200","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(We,{data:k||[],height:161,"data-inspector-line":"211","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})}),Object(pe.jsx)(W.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},"data-inspector-line":"214","data-inspector-column":"12","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(m.a,{title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus","data-inspector-line":"217","data-inspector-column":"18","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1,"data-inspector-line":"215","data-inspector-column":"14","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx",children:Object(pe.jsx)(it,{height:161,title:Object(pe.jsx)(Ke.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus","data-inspector-line":"228","data-inspector-column":"20","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"}),percent:34,"data-inspector-line":"225","data-inspector-column":"16","data-inspector-relative-path":"src/pages/dashboard/monitor/index.tsx"})})})]})]})})}}]),c}(Pe.Component),gu=y.default=Object(Ke.c)(function(O){var d=O.dashboardAndmonitor,c=O.loading;return{dashboardAndmonitor:d,loading:c.models.dashboardAndmonitor}})(Xo)},aF1E:function(Ue,y,o){"use strict";o.d(y,"a",function(){return i});var x=o("lSNA"),m=o.n(x);function Y(W,D){var Q=Object.keys(W);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(W);D&&(ee=ee.filter(function(ce){return Object.getOwnPropertyDescriptor(W,ce).enumerable})),Q.push.apply(Q,ee)}return Q}function z(W){for(var D=1;D<arguments.length;D++){var Q=arguments[D]!=null?arguments[D]:{};D%2?Y(Object(Q),!0).forEach(function(ee){m()(W,ee,Q[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(Q)):Y(Object(Q)).forEach(function(ee){Object.defineProperty(W,ee,Object.getOwnPropertyDescriptor(Q,ee))})}return W}function i(W,D){var Q=D.sourceField,ee=D.targetField,ce=D.data,K={};return ce.forEach(function(je){K[je[Q]]=je}),W.dataArray=W.dataArray.map(function(je){var pe=je[ee];return z(z({},je),K[pe])}),W}},aHsQ:function(Ue,y,o){"use strict";var x=o("cIOH"),m={"ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-value-decimal":"ant-statistic-content-value-decimal","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"},Y=o("cWXX")},aPG5:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.resolve=void 0;var x=o("MON2"),m=o("FV85"),Y=o("qK8v"),z=o("ujMp"),i=o("cSJO"),W=function(ce,K,je){try{return je()}catch(pe){throw Y.isStackOverflowExeption(pe)?new Error(x.CIRCULAR_DEPENDENCY_IN_FACTORY(ce,K.toString())):pe}},D=function ee(ce){return function(K){K.parentContext.setCurrentRequest(K);var je=K.bindings,pe=K.childRequests,Ke=K.target&&K.target.isArray(),Pe=!K.parentRequest||!K.parentRequest.target||!K.target||!K.parentRequest.target.matchesArray(K.target.serviceIdentifier);if(Ke&&Pe)return pe.map(function(Ze){var At=ee(ce);return At(Ze)});var ht=null;if(K.target.isOptional()&&je.length===0)return;var Le=je[0],_t=Le.scope===m.BindingScopeEnum.Singleton,ot=Le.scope===m.BindingScopeEnum.Request;if(_t&&Le.activated)return Le.cache;if(ot&&ce!==null&&ce.has(Le.id))return ce.get(Le.id);if(Le.type===m.BindingTypeEnum.ConstantValue)ht=Le.cache;else if(Le.type===m.BindingTypeEnum.Function)ht=Le.cache;else if(Le.type===m.BindingTypeEnum.Constructor)ht=Le.implementationType;else if(Le.type===m.BindingTypeEnum.DynamicValue&&Le.dynamicValue!==null)ht=W("toDynamicValue",Le.serviceIdentifier,function(){return Le.dynamicValue(K.parentContext)});else if(Le.type===m.BindingTypeEnum.Factory&&Le.factory!==null)ht=W("toFactory",Le.serviceIdentifier,function(){return Le.factory(K.parentContext)});else if(Le.type===m.BindingTypeEnum.Provider&&Le.provider!==null)ht=W("toProvider",Le.serviceIdentifier,function(){return Le.provider(K.parentContext)});else if(Le.type===m.BindingTypeEnum.Instance&&Le.implementationType!==null)ht=i.resolveInstance(Le.implementationType,pe,ee(ce));else{var et=z.getServiceIdentifierAsString(K.serviceIdentifier);throw new Error(x.INVALID_BINDING_TYPE+" "+et)}return typeof Le.onActivation=="function"&&(ht=Le.onActivation(K.parentContext,ht)),_t&&(Le.cache=ht,Le.activated=!0),ot&&ce!==null&&!ce.has(Le.id)&&ce.set(Le.id,ht),ht}};function Q(ee){var ce=D(ee.plan.rootRequest.requestScope);return ce(ee.plan.rootRequest)}y.resolve=Q},asDA:function(Ue,y){function o(x,m,Y,z){var i=-1,W=x==null?0:x.length;for(z&&W&&(Y=x[++i]);++i<W;)Y=m(Y,x[i],i,x);return Y}Ue.exports=o},b2z7:function(Ue,y){var o=/\w*$/;function x(m){var Y=new m.constructor(m.source,o.exec(m));return Y.lastIndex=m.lastIndex,Y}Ue.exports=x},bB6j:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x;(function(m){m.Normal="normal",m.PostProcessing="post-processing"})(x||(x={}))},bTtR:function(Ue,y){},bYl4:function(Ue,y){},bahg:function(Ue,y){function o(x){return x.split("")}Ue.exports=o},bl9R:function(Ue,y,o){"use strict";o.r(y),o.d(y,"create",function(){return m}),o.d(y,"clone",function(){return Y}),o.d(y,"fromValues",function(){return z}),o.d(y,"copy",function(){return i}),o.d(y,"set",function(){return W}),o.d(y,"add",function(){return D}),o.d(y,"subtract",function(){return Q}),o.d(y,"multiply",function(){return ee}),o.d(y,"divide",function(){return ce}),o.d(y,"ceil",function(){return K}),o.d(y,"floor",function(){return je}),o.d(y,"min",function(){return pe}),o.d(y,"max",function(){return Ke}),o.d(y,"round",function(){return Pe}),o.d(y,"scale",function(){return ht}),o.d(y,"scaleAndAdd",function(){return Le}),o.d(y,"distance",function(){return _t}),o.d(y,"squaredDistance",function(){return ot}),o.d(y,"length",function(){return et}),o.d(y,"squaredLength",function(){return Ze}),o.d(y,"negate",function(){return At}),o.d(y,"inverse",function(){return St}),o.d(y,"normalize",function(){return De}),o.d(y,"dot",function(){return Ie}),o.d(y,"cross",function(){return Ge}),o.d(y,"lerp",function(){return dt}),o.d(y,"random",function(){return we}),o.d(y,"transformMat4",function(){return pt}),o.d(y,"transformQuat",function(){return Wt}),o.d(y,"zero",function(){return Qt}),o.d(y,"str",function(){return ur}),o.d(y,"exactEquals",function(){return oe}),o.d(y,"equals",function(){return J}),o.d(y,"sub",function(){return H}),o.d(y,"mul",function(){return Se}),o.d(y,"div",function(){return be}),o.d(y,"dist",function(){return Te}),o.d(y,"sqrDist",function(){return me}),o.d(y,"len",function(){return at}),o.d(y,"sqrLen",function(){return Jt}),o.d(y,"forEach",function(){return Mt});var x=o("yU0y");function m(){var ve=new x.a(4);return x.a!=Float32Array&&(ve[0]=0,ve[1]=0,ve[2]=0,ve[3]=0),ve}function Y(ve){var ge=new x.a(4);return ge[0]=ve[0],ge[1]=ve[1],ge[2]=ve[2],ge[3]=ve[3],ge}function z(ve,ge,He,st){var Oe=new x.a(4);return Oe[0]=ve,Oe[1]=ge,Oe[2]=He,Oe[3]=st,Oe}function i(ve,ge){return ve[0]=ge[0],ve[1]=ge[1],ve[2]=ge[2],ve[3]=ge[3],ve}function W(ve,ge,He,st,Oe){return ve[0]=ge,ve[1]=He,ve[2]=st,ve[3]=Oe,ve}function D(ve,ge,He){return ve[0]=ge[0]+He[0],ve[1]=ge[1]+He[1],ve[2]=ge[2]+He[2],ve[3]=ge[3]+He[3],ve}function Q(ve,ge,He){return ve[0]=ge[0]-He[0],ve[1]=ge[1]-He[1],ve[2]=ge[2]-He[2],ve[3]=ge[3]-He[3],ve}function ee(ve,ge,He){return ve[0]=ge[0]*He[0],ve[1]=ge[1]*He[1],ve[2]=ge[2]*He[2],ve[3]=ge[3]*He[3],ve}function ce(ve,ge,He){return ve[0]=ge[0]/He[0],ve[1]=ge[1]/He[1],ve[2]=ge[2]/He[2],ve[3]=ge[3]/He[3],ve}function K(ve,ge){return ve[0]=Math.ceil(ge[0]),ve[1]=Math.ceil(ge[1]),ve[2]=Math.ceil(ge[2]),ve[3]=Math.ceil(ge[3]),ve}function je(ve,ge){return ve[0]=Math.floor(ge[0]),ve[1]=Math.floor(ge[1]),ve[2]=Math.floor(ge[2]),ve[3]=Math.floor(ge[3]),ve}function pe(ve,ge,He){return ve[0]=Math.min(ge[0],He[0]),ve[1]=Math.min(ge[1],He[1]),ve[2]=Math.min(ge[2],He[2]),ve[3]=Math.min(ge[3],He[3]),ve}function Ke(ve,ge,He){return ve[0]=Math.max(ge[0],He[0]),ve[1]=Math.max(ge[1],He[1]),ve[2]=Math.max(ge[2],He[2]),ve[3]=Math.max(ge[3],He[3]),ve}function Pe(ve,ge){return ve[0]=Math.round(ge[0]),ve[1]=Math.round(ge[1]),ve[2]=Math.round(ge[2]),ve[3]=Math.round(ge[3]),ve}function ht(ve,ge,He){return ve[0]=ge[0]*He,ve[1]=ge[1]*He,ve[2]=ge[2]*He,ve[3]=ge[3]*He,ve}function Le(ve,ge,He,st){return ve[0]=ge[0]+He[0]*st,ve[1]=ge[1]+He[1]*st,ve[2]=ge[2]+He[2]*st,ve[3]=ge[3]+He[3]*st,ve}function _t(ve,ge){var He=ge[0]-ve[0],st=ge[1]-ve[1],Oe=ge[2]-ve[2],gt=ge[3]-ve[3];return Math.hypot(He,st,Oe,gt)}function ot(ve,ge){var He=ge[0]-ve[0],st=ge[1]-ve[1],Oe=ge[2]-ve[2],gt=ge[3]-ve[3];return He*He+st*st+Oe*Oe+gt*gt}function et(ve){var ge=ve[0],He=ve[1],st=ve[2],Oe=ve[3];return Math.hypot(ge,He,st,Oe)}function Ze(ve){var ge=ve[0],He=ve[1],st=ve[2],Oe=ve[3];return ge*ge+He*He+st*st+Oe*Oe}function At(ve,ge){return ve[0]=-ge[0],ve[1]=-ge[1],ve[2]=-ge[2],ve[3]=-ge[3],ve}function St(ve,ge){return ve[0]=1/ge[0],ve[1]=1/ge[1],ve[2]=1/ge[2],ve[3]=1/ge[3],ve}function De(ve,ge){var He=ge[0],st=ge[1],Oe=ge[2],gt=ge[3],C=He*He+st*st+Oe*Oe+gt*gt;return C>0&&(C=1/Math.sqrt(C)),ve[0]=He*C,ve[1]=st*C,ve[2]=Oe*C,ve[3]=gt*C,ve}function Ie(ve,ge){return ve[0]*ge[0]+ve[1]*ge[1]+ve[2]*ge[2]+ve[3]*ge[3]}function Ge(ve,ge,He,st){var Oe=He[0]*st[1]-He[1]*st[0],gt=He[0]*st[2]-He[2]*st[0],C=He[0]*st[3]-He[3]*st[0],R=He[1]*st[2]-He[2]*st[1],q=He[1]*st[3]-He[3]*st[1],fe=He[2]*st[3]-He[3]*st[2],We=ge[0],qe=ge[1],Tt=ge[2],it=ge[3];return ve[0]=qe*fe-Tt*q+it*R,ve[1]=-(We*fe)+Tt*C-it*gt,ve[2]=We*q-qe*C+it*Oe,ve[3]=-(We*R)+qe*gt-Tt*Oe,ve}function dt(ve,ge,He,st){var Oe=ge[0],gt=ge[1],C=ge[2],R=ge[3];return ve[0]=Oe+st*(He[0]-Oe),ve[1]=gt+st*(He[1]-gt),ve[2]=C+st*(He[2]-C),ve[3]=R+st*(He[3]-R),ve}function we(ve,ge){ge=ge||1;var He,st,Oe,gt,C,R;do He=x.c()*2-1,st=x.c()*2-1,C=He*He+st*st;while(C>=1);do Oe=x.c()*2-1,gt=x.c()*2-1,R=Oe*Oe+gt*gt;while(R>=1);var q=Math.sqrt((1-C)/R);return ve[0]=ge*He,ve[1]=ge*st,ve[2]=ge*Oe*q,ve[3]=ge*gt*q,ve}function pt(ve,ge,He){var st=ge[0],Oe=ge[1],gt=ge[2],C=ge[3];return ve[0]=He[0]*st+He[4]*Oe+He[8]*gt+He[12]*C,ve[1]=He[1]*st+He[5]*Oe+He[9]*gt+He[13]*C,ve[2]=He[2]*st+He[6]*Oe+He[10]*gt+He[14]*C,ve[3]=He[3]*st+He[7]*Oe+He[11]*gt+He[15]*C,ve}function Wt(ve,ge,He){var st=ge[0],Oe=ge[1],gt=ge[2],C=He[0],R=He[1],q=He[2],fe=He[3],We=fe*st+R*gt-q*Oe,qe=fe*Oe+q*st-C*gt,Tt=fe*gt+C*Oe-R*st,it=-C*st-R*Oe-q*gt;return ve[0]=We*fe+it*-C+qe*-q-Tt*-R,ve[1]=qe*fe+it*-R+Tt*-C-We*-q,ve[2]=Tt*fe+it*-q+We*-R-qe*-C,ve[3]=ge[3],ve}function Qt(ve){return ve[0]=0,ve[1]=0,ve[2]=0,ve[3]=0,ve}function ur(ve){return"vec4("+ve[0]+", "+ve[1]+", "+ve[2]+", "+ve[3]+")"}function oe(ve,ge){return ve[0]===ge[0]&&ve[1]===ge[1]&&ve[2]===ge[2]&&ve[3]===ge[3]}function J(ve,ge){var He=ve[0],st=ve[1],Oe=ve[2],gt=ve[3],C=ge[0],R=ge[1],q=ge[2],fe=ge[3];return Math.abs(He-C)<=x.b*Math.max(1,Math.abs(He),Math.abs(C))&&Math.abs(st-R)<=x.b*Math.max(1,Math.abs(st),Math.abs(R))&&Math.abs(Oe-q)<=x.b*Math.max(1,Math.abs(Oe),Math.abs(q))&&Math.abs(gt-fe)<=x.b*Math.max(1,Math.abs(gt),Math.abs(fe))}var H=Q,Se=ee,be=ce,Te=_t,me=ot,at=et,Jt=Ze,Mt=function(){var ve=m();return function(ge,He,st,Oe,gt,C){var R,q;for(He||(He=4),st||(st=0),Oe?q=Math.min(Oe*He+st,ge.length):q=ge.length,R=st;R<q;R+=He)ve[0]=ge[R],ve[1]=ge[R+1],ve[2]=ge[R+2],ve[3]=ge[R+3],gt(ve,ve,C),ge[R]=ve[0],ge[R+1]=ve[1],ge[R+2]=ve[2],ge[R+3]=ve[3];return ge}}()},bzyH:function(Ue,y){},cSJO:function(Ue,y,o){"use strict";var x=this&&this.__spreadArrays||function(){for(var ee=0,ce=0,K=arguments.length;ce<K;ce++)ee+=arguments[ce].length;for(var je=Array(ee),pe=0,ce=0;ce<K;ce++)for(var Ke=arguments[ce],Pe=0,ht=Ke.length;Pe<ht;Pe++,pe++)je[pe]=Ke[Pe];return je};Object.defineProperty(y,"__esModule",{value:!0}),y.resolveInstance=void 0;var m=o("MON2"),Y=o("FV85"),z=o("xfSm");function i(ee,ce,K){var je=ce.filter(function(Ke){return Ke.target!==null&&Ke.target.type===Y.TargetTypeEnum.ClassProperty}),pe=je.map(K);return je.forEach(function(Ke,Pe){var ht="";ht=Ke.target.name.value();var Le=pe[Pe];ee[ht]=Le}),ee}function W(ee,ce){return new(ee.bind.apply(ee,x([void 0],ce)))}function D(ee,ce){if(Reflect.hasMetadata(z.POST_CONSTRUCT,ee)){var K=Reflect.getMetadata(z.POST_CONSTRUCT,ee);try{ce[K.value]()}catch(je){throw new Error(m.POST_CONSTRUCT_ERROR(ee.name,je.message))}}}function Q(ee,ce,K){var je=null;if(ce.length>0){var pe=ce.filter(function(Pe){return Pe.target!==null&&Pe.target.type===Y.TargetTypeEnum.ConstructorArgument}),Ke=pe.map(K);je=W(ee,Ke),je=i(je,ce,K)}else je=new ee;return D(ee,je),je}y.resolveInstance=Q},cWXX:function(Ue,y,o){"use strict";var x=o("cIOH"),m={"ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},cWyK:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var x=o("/rf6");function m(ot,et,Ze){if(ot===null)return;for(var At,St,De,Ie,Ge,dt,we,pt=0,Wt=0,Qt,ur=ot.type,oe=ur==="FeatureCollection",J=ur==="Feature",H=oe?ot.features.length:1,Se=0;Se<H;Se++){we=oe?ot.features[Se].geometry:J?ot.geometry:ot,Qt=we?we.type==="GeometryCollection":!1,Ge=Qt?we.geometries.length:1;for(var be=0;be<Ge;be++){var Te=0,me=0;if(Ie=Qt?we.geometries[be]:we,Ie===null)continue;dt=Ie.coordinates;var at=Ie.type;pt=Ze&&(at==="Polygon"||at==="MultiPolygon")?1:0;switch(at){case null:break;case"Point":if(et(dt,Wt,Se,Te,me)===!1)return!1;Wt++,Te++;break;case"LineString":case"MultiPoint":for(At=0;At<dt.length;At++){if(et(dt[At],Wt,Se,Te,me)===!1)return!1;Wt++,at==="MultiPoint"&&Te++}at==="LineString"&&Te++;break;case"Polygon":case"MultiLineString":for(At=0;At<dt.length;At++){for(St=0;St<dt[At].length-pt;St++){if(et(dt[At][St],Wt,Se,Te,me)===!1)return!1;Wt++}at==="MultiLineString"&&Te++,at==="Polygon"&&me++}at==="Polygon"&&Te++;break;case"MultiPolygon":for(At=0;At<dt.length;At++){for(me=0,St=0;St<dt[At].length;St++){for(De=0;De<dt[At][St].length-pt;De++){if(et(dt[At][St][De],Wt,Se,Te,me)===!1)return!1;Wt++}me++}Te++}break;case"GeometryCollection":for(At=0;At<Ie.geometries.length;At++)if(m(Ie.geometries[At],et,Ze)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function Y(ot,et,Ze,At){var St=Ze;return m(ot,function(De,Ie,Ge,dt,we){Ie===0&&Ze===void 0?St=De:St=et(St,De,Ie,Ge,dt,we)},At),St}function z(ot,et){var Ze;switch(ot.type){case"FeatureCollection":for(Ze=0;Ze<ot.features.length&&!(et(ot.features[Ze].properties,Ze)===!1);Ze++);break;case"Feature":et(ot.properties,0);break}}function i(ot,et,Ze){var At=Ze;return z(ot,function(St,De){De===0&&Ze===void 0?At=St:At=et(At,St,De)}),At}function W(ot,et){if(ot.type==="Feature")et(ot,0);else if(ot.type==="FeatureCollection")for(var Ze=0;Ze<ot.features.length&&!(et(ot.features[Ze],Ze)===!1);Ze++);}function D(ot,et,Ze){var At=Ze;return W(ot,function(St,De){De===0&&Ze===void 0?At=St:At=et(At,St,De)}),At}function Q(ot){var et=[];return m(ot,function(Ze){et.push(Ze)}),et}function ee(ot,et){var Ze,At,St,De,Ie,Ge,dt,we,pt,Wt,Qt=0,ur=ot.type==="FeatureCollection",oe=ot.type==="Feature",J=ur?ot.features.length:1;for(Ze=0;Ze<J;Ze++){for(Ge=ur?ot.features[Ze].geometry:oe?ot.geometry:ot,we=ur?ot.features[Ze].properties:oe?ot.properties:{},pt=ur?ot.features[Ze].bbox:oe?ot.bbox:void 0,Wt=ur?ot.features[Ze].id:oe?ot.id:void 0,dt=Ge?Ge.type==="GeometryCollection":!1,Ie=dt?Ge.geometries.length:1,St=0;St<Ie;St++){if(De=dt?Ge.geometries[St]:Ge,De===null){if(et(null,Qt,we,pt,Wt)===!1)return!1;continue}switch(De.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(et(De,Qt,we,pt,Wt)===!1)return!1;break}case"GeometryCollection":{for(At=0;At<De.geometries.length;At++)if(et(De.geometries[At],Qt,we,pt,Wt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Qt++}}function ce(ot,et,Ze){var At=Ze;return ee(ot,function(St,De,Ie,Ge,dt){De===0&&Ze===void 0?At=St:At=et(At,St,De,Ie,Ge,dt)}),At}function K(ot,et){ee(ot,function(Ze,At,St,De,Ie){var Ge=Ze===null?null:Ze.type;switch(Ge){case null:case"Point":case"LineString":case"Polygon":return et(x.feature(Ze,St,{bbox:De,id:Ie}),At,0)===!1?!1:void 0}var dt;switch(Ge){case"MultiPoint":dt="Point";break;case"MultiLineString":dt="LineString";break;case"MultiPolygon":dt="Polygon";break}for(var we=0;we<Ze.coordinates.length;we++){var pt=Ze.coordinates[we],Wt={type:dt,coordinates:pt};if(et(x.feature(Wt,St),At,we)===!1)return!1}})}function je(ot,et,Ze){var At=Ze;return K(ot,function(St,De,Ie){De===0&&Ie===0&&Ze===void 0?At=St:At=et(At,St,De,Ie)}),At}function pe(ot,et){K(ot,function(Ze,At,St){var De=0;if(!Ze.geometry)return;var Ie=Ze.geometry.type;if(Ie==="Point"||Ie==="MultiPoint")return;var Ge,dt=0,we=0,pt=0;if(m(Ze,function(Wt,Qt,ur,oe,J){if(Ge===void 0||At>dt||oe>we||J>pt){Ge=Wt,dt=At,we=oe,pt=J,De=0;return}var H=x.lineString([Ge,Wt],Ze.properties);if(et(H,At,St,J,De)===!1)return!1;De++,Ge=Wt})===!1)return!1})}function Ke(ot,et,Ze){var At=Ze,St=!1;return pe(ot,function(De,Ie,Ge,dt,we){St===!1&&Ze===void 0?At=De:At=et(At,De,Ie,Ge,dt,we),St=!0}),At}function Pe(ot,et){if(!ot)throw new Error("geojson is required");K(ot,function(Ze,At,St){if(Ze.geometry===null)return;var De=Ze.geometry.type,Ie=Ze.geometry.coordinates;switch(De){case"LineString":if(et(Ze,At,St,0,0)===!1)return!1;break;case"Polygon":for(var Ge=0;Ge<Ie.length;Ge++)if(et(x.lineString(Ie[Ge],Ze.properties),At,St,Ge)===!1)return!1;break}})}function ht(ot,et,Ze){var At=Ze;return Pe(ot,function(St,De,Ie,Ge){De===0&&Ze===void 0?At=St:At=et(At,St,De,Ie,Ge)}),At}function Le(ot,et){if(et=et||{},!x.isObject(et))throw new Error("options is invalid");var Ze=et.featureIndex||0,At=et.multiFeatureIndex||0,St=et.geometryIndex||0,De=et.segmentIndex||0,Ie=et.properties,Ge;switch(ot.type){case"FeatureCollection":Ze<0&&(Ze=ot.features.length+Ze),Ie=Ie||ot.features[Ze].properties,Ge=ot.features[Ze].geometry;break;case"Feature":Ie=Ie||ot.properties,Ge=ot.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ge=ot;break;default:throw new Error("geojson is invalid")}if(Ge===null)return null;var dt=Ge.coordinates;switch(Ge.type){case"Point":case"MultiPoint":return null;case"LineString":return De<0&&(De=dt.length+De-1),x.lineString([dt[De],dt[De+1]],Ie,et);case"Polygon":return St<0&&(St=dt.length+St),De<0&&(De=dt[St].length+De-1),x.lineString([dt[St][De],dt[St][De+1]],Ie,et);case"MultiLineString":return At<0&&(At=dt.length+At),De<0&&(De=dt[At].length+De-1),x.lineString([dt[At][De],dt[At][De+1]],Ie,et);case"MultiPolygon":return At<0&&(At=dt.length+At),St<0&&(St=dt[At].length+St),De<0&&(De=dt[At][St].length-De-1),x.lineString([dt[At][St][De],dt[At][St][De+1]],Ie,et)}throw new Error("geojson is invalid")}function _t(ot,et){if(et=et||{},!x.isObject(et))throw new Error("options is invalid");var Ze=et.featureIndex||0,At=et.multiFeatureIndex||0,St=et.geometryIndex||0,De=et.coordIndex||0,Ie=et.properties,Ge;switch(ot.type){case"FeatureCollection":Ze<0&&(Ze=ot.features.length+Ze),Ie=Ie||ot.features[Ze].properties,Ge=ot.features[Ze].geometry;break;case"Feature":Ie=Ie||ot.properties,Ge=ot.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ge=ot;break;default:throw new Error("geojson is invalid")}if(Ge===null)return null;var dt=Ge.coordinates;switch(Ge.type){case"Point":return x.point(dt,Ie,et);case"MultiPoint":return At<0&&(At=dt.length+At),x.point(dt[At],Ie,et);case"LineString":return De<0&&(De=dt.length+De),x.point(dt[De],Ie,et);case"Polygon":return St<0&&(St=dt.length+St),De<0&&(De=dt[St].length+De),x.point(dt[St][De],Ie,et);case"MultiLineString":return At<0&&(At=dt.length+At),De<0&&(De=dt[At].length+De),x.point(dt[At][De],Ie,et);case"MultiPolygon":return At<0&&(At=dt.length+At),St<0&&(St=dt[At].length+St),De<0&&(De=dt[At][St].length-De),x.point(dt[At][St][De],Ie,et)}throw new Error("geojson is invalid")}y.coordEach=m,y.coordReduce=Y,y.propEach=z,y.propReduce=i,y.featureEach=W,y.featureReduce=D,y.coordAll=Q,y.geomEach=ee,y.geomReduce=ce,y.flattenEach=K,y.flattenReduce=je,y.segmentEach=pe,y.segmentReduce=Ke,y.lineEach=Pe,y.lineReduce=ht,y.findSegment=Le,y.findPoint=_t},cZ5Q:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.injectable=void 0;var x=o("MON2"),m=o("xfSm");function Y(){return function(z){if(Reflect.hasOwnMetadata(m.PARAM_TYPES,z))throw new Error(x.DUPLICATED_INJECTABLE_DECORATOR);var i=Reflect.getMetadata(m.DESIGN_PARAM_TYPES,z)||[];return Reflect.defineMetadata(m.PARAM_TYPES,i,z),z}}y.injectable=Y},cZlC:function(Ue,y,o){"use strict";o.d(y,"b",function(){return x}),o.d(y,"c",function(){return m}),o.d(y,"a",function(){return Y});var x;(function(z){z.LINEAR="linear",z.POWER="power",z.LOG="log",z.IDENTITY="identity",z.TIME="time",z.QUANTILE="quantile",z.QUANTIZE="quantize",z.THRESHOLD="threshold",z.CAT="cat"})(x||(x={}));var m;(function(z){z.CONSTANT="constant",z.VARIABLE="variable"})(m||(m={}));var Y;(function(z){z[z.Attribute=0]="Attribute",z[z.InstancedAttribute=1]="InstancedAttribute",z[z.Uniform=2]="Uniform"})(Y||(Y={}))},"cq/+":function(Ue,y,o){var x=o("mc0g"),m=x();Ue.exports=m},cvCv:function(Ue,y){function o(x){return function(){return x}}Ue.exports=o},d9O0:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.id=void 0;var x=0;function m(){return x++}y.id=m},dQpi:function(Ue,y,o){var x=o("yGk4"),m=o("vN+2"),Y=o("rEGp"),z=1/0,i=x&&1/Y(new x([,-0]))[1]==z?function(W){return new x(W)}:m;Ue.exports=i},dTAl:function(Ue,y,o){var x=o("GoyQ"),m=Object.create,Y=function(){function z(){}return function(i){if(!x(i))return{};if(m)return m(i);z.prototype=i;var W=new z;return z.prototype=void 0,W}}();Ue.exports=Y},dVn5:function(Ue,y){var o=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function x(m){return m.match(o)||[]}Ue.exports=x},dX1H:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Target=void 0;var x=o("xfSm"),m=o("d9O0"),Y=o("GXnB"),z=o("zxMA"),i=function(){function W(D,Q,ee,ce){this.id=m.id(),this.type=D,this.serviceIdentifier=ee,this.name=new z.QueryableString(Q||""),this.metadata=new Array;var K=null;typeof ce=="string"?K=new Y.Metadata(x.NAMED_TAG,ce):ce instanceof Y.Metadata&&(K=ce),K!==null&&this.metadata.push(K)}return W.prototype.hasTag=function(D){for(var Q=0,ee=this.metadata;Q<ee.length;Q++){var ce=ee[Q];if(ce.key===D)return!0}return!1},W.prototype.isArray=function(){return this.hasTag(x.MULTI_INJECT_TAG)},W.prototype.matchesArray=function(D){return this.matchesTag(x.MULTI_INJECT_TAG)(D)},W.prototype.isNamed=function(){return this.hasTag(x.NAMED_TAG)},W.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==x.INJECT_TAG&&D.key!==x.MULTI_INJECT_TAG&&D.key!==x.NAME_TAG&&D.key!==x.UNMANAGED_TAG&&D.key!==x.NAMED_TAG})},W.prototype.isOptional=function(){return this.matchesTag(x.OPTIONAL_TAG)(!0)},W.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===x.NAMED_TAG})[0]:null},W.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==x.INJECT_TAG&&D.key!==x.MULTI_INJECT_TAG&&D.key!==x.NAME_TAG&&D.key!==x.UNMANAGED_TAG&&D.key!==x.NAMED_TAG}):null},W.prototype.matchesNamedTag=function(D){return this.matchesTag(x.NAMED_TAG)(D)},W.prototype.matchesTag=function(D){var Q=this;return function(ee){for(var ce=0,K=Q.metadata;ce<K.length;ce++){var je=K[ce];if(je.key===D&&je.value===ee)return!0}return!1}},W}();y.Target=i},doU7:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingCount=void 0;var x={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};y.BindingCount=x},dt0z:function(Ue,y,o){var x=o("zoYe");function m(Y){return Y==null?"":x(Y)}Ue.exports=m},dxzI:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.AsyncContainerModule=y.ContainerModule=void 0;var x=o("d9O0"),m=function(){function z(i){this.id=x.id(),this.registry=i}return z}();y.ContainerModule=m;var Y=function(){function z(i){this.id=x.id(),this.registry=i}return z}();y.AsyncContainerModule=Y},eUgh:function(Ue,y){function o(x,m){for(var Y=-1,z=x==null?0:x.length,i=Array(z);++Y<z;)i[Y]=m(x[Y],Y,x);return i}Ue.exports=o},"eg+a":function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(Ue,y,o){"use strict";o.d(y,"d",function(){return _f}),o.d(y,"b",function(){return Zc}),o.d(y,"a",function(){return ml});var x=o("mNvP"),m=o("uhBA"),Y=o.n(m),z=o("4cb6"),i=o("APxj"),W=o.n(i),D=o("bB6j"),Q=o("lSNA"),ee=o.n(Q),ce=o("lwsE"),K=o.n(ce),je=o("W8MJ"),pe=o.n(je),Ke=o("Hel2"),Pe=o("rxlC"),ht=o.n(Pe);function Le(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function _t(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Le(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Le(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function ot(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=et(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ft=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function et(re,se){if(!re)return;if(typeof re=="string")return Ze(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return Ze(re,se)}function Ze(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}var At=30;function St(re){var se=re.characterSet,N=re.getFontWidth,G=re.fontHeight,Ae=re.buffer,ft=re.maxCanvasWidth,Xt=re.mapping,sr=Xt===void 0?{}:Xt,or=re.xOffset,Ir=or===void 0?0:or,an=re.yOffset,Gn=an===void 0?0:an,ea=0,la=Ir;Array.from(se).forEach(function(Fa,yi){if(!sr[Fa]){var Ja=N(Fa,yi);la+At>ft&&(la=0,ea++),sr[Fa]={x:la,y:Gn+ea*At,width:At,height:At,advance:Ja},la+=At}});var qa=G+Ae*2;return{mapping:sr,xOffset:la,yOffset:Gn+ea*qa,canvasHeight:Ge(Gn+(ea+1)*qa)}}function De(re,se,N){var G=0,Ae=0,ft=0,Xt=[],sr={},or=ot(re),Ir;try{for(or.s();!(Ir=or.n()).done;){var an=Ir.value;if(!sr[an.id]){var Gn=an.height,ea=an.width;G+ea+se>N&&(Ie(sr,Xt,Ae),G=0,Ae=ft+Ae+se,ft=0,Xt=[]),Xt.push({icon:an,xOffset:G}),G=G+ea+se,ft=Math.max(ft,Gn)}}}catch(qa){or.e(qa)}finally{or.f()}Xt.length>0&&Ie(sr,Xt,Ae);var la=Ge(ft+Ae+se);return{mapping:sr,canvasHeight:la}}function Ie(re,se,N){var G=ot(se),Ae;try{for(G.s();!(Ae=G.n()).done;){var ft=Ae.value,Xt=ft.icon,sr=ft.xOffset;re[Xt.id]=_t(_t({},Xt),{},{x:sr,y:N,image:Xt.image})}}catch(or){G.e(or)}finally{G.f()}}function Ge(re){return Math.pow(2,Math.ceil(Math.log2(re)))}var dt,we,pt;function Wt(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=Qt(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ft=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function Qt(re,se){if(!re)return;if(typeof re=="string")return ur(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return ur(re,se)}function ur(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}function oe(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function J(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?oe(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):oe(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var H=Oe(),Se="sans-serif",be="normal",Te=24,me=3,at=.25,Jt=8,Mt=1024,ve=1,ge=1,He=3,st=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Oe(){for(var re=[],se=32;se<128;se++)re.push(String.fromCharCode(se));return re}function gt(re,se,N,G){re.font="".concat(G," ").concat(N,"px ").concat(se),re.fillStyle="black",re.textBaseline="middle"}function C(re,se){for(var N=0;N<re.length;N++)se.data[4*N+3]=re[N]}var R=(dt=Object(z.injectable)(),dt(we=(pt=function(){function re(){K()(this,re),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new Ke.b(He)}return pe()(re,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Se,fontWeight:be,characterSet:H,fontSize:Te,buffer:me,sdf:!0,cutoff:at,radius:Jt},this.key=""}},{key:"addIconGlyphs",value:function(N){var G=this;N.forEach(function(Ae){G.iconFontGlyphs[Ae.name]=Ae.unicode})}},{key:"getGlyph",value:function(N){return this.iconFontGlyphs[N]?String.fromCharCode(parseInt(this.iconFontGlyphs[N],16)):""}},{key:"setFontOptions",value:function(N){this.fontOptions=J(J({},this.fontOptions),N),this.key=this.getKey();var G=this.getNewChars(this.key,this.fontOptions.characterSet),Ae=this.cache.get(this.key);if(Ae&&G.length===0)return;var ft=this.generateFontAtlas(this.key,G,Ae);this.fontAtlas=ft,this.cache.set(this.key,ft)}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(N,G,Ae){var ft=this.fontOptions,Xt=ft.fontFamily,sr=ft.fontWeight,or=ft.fontSize,Ir=ft.buffer,an=ft.sdf,Gn=ft.radius,ea=ft.cutoff,la=Ae&&Ae.data;la||(la=document.createElement("canvas"),la.width=Mt);var qa=la.getContext("2d");gt(qa,Xt,or,sr);var Fa=St(J({getFontWidth:function(hc){return qa.measureText(hc).width},fontHeight:or*ge,buffer:Ir,characterSet:G,maxCanvasWidth:Mt},Ae&&{mapping:Ae.mapping,xOffset:Ae.xOffset,yOffset:Ae.yOffset})),yi=Fa.mapping,Ja=Fa.canvasHeight,Bi=Fa.xOffset,So=Fa.yOffset;if(la.height!==Ja){var yo=qa.getImageData(0,0,la.width,la.height);la.height=Ja,qa.putImageData(yo,0,0)}if(gt(qa,Xt,or,sr),an){var Hi=new ht.a(or,Ir,Gn,ea,Xt,sr),ko=qa.getImageData(0,0,Hi.size,Hi.size),Qa=Wt(G),lo;try{for(Qa.s();!(lo=Qa.n()).done;){var iu=lo.value;C(Hi.draw(iu),ko),qa.putImageData(ko,yi[iu].x,yi[iu].y)}}catch(Ao){Qa.e(Ao)}finally{Qa.f()}}else{var bi=Wt(G),Ni;try{for(bi.s();!(Ni=bi.n()).done;){var xa=Ni.value;qa.fillText(xa,yi[xa].x,yi[xa].y+or*ve)}}catch(Ao){bi.e(Ao)}finally{bi.f()}}return{xOffset:Bi,yOffset:So,mapping:yi,data:la,width:la.width,height:la.height}}},{key:"getKey",value:function(){var N=this.fontOptions,G=N.fontFamily,Ae=N.fontWeight,ft=N.fontSize,Xt=N.buffer,sr=N.sdf,or=N.radius,Ir=N.cutoff;return sr?"".concat(G," ").concat(Ae," ").concat(ft," ").concat(Xt," ").concat(or," ").concat(Ir):"".concat(G," ").concat(Ae," ").concat(ft," ").concat(Xt)}},{key:"getNewChars",value:function(N,G){var Ae=this.cache.get(N);if(!Ae)return G;var ft=[],Xt=Ae.mapping,sr=new Set(Object.keys(Xt)),or=new Set(G);return or.forEach(function(Ir){sr.has(Ir)||ft.push(Ir)}),ft}},{key:"scale",get:function(){return ge}},{key:"canvas",get:function(){var N=this.cache.get(this.key);return N&&N.data}},{key:"mapping",get:function(){var N=this.cache.get(this.key);return N&&N.mapping}}]),re}(),pt))||we),q=o("7W2i"),fe=o.n(q),We=o("a1gu"),qe=o.n(We),Tt=o("Nsbk"),it=o.n(Tt),Ut,$,Qe;function ne(re){var se=tt();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function tt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var kt=3,dr=1024,Ye=64,xt=(Ut=Object(z.injectable)(),Ut($=(Qe=function(re){fe()(N,re);var se=ne(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ft=new Array(Ae),Xt=0;Xt<Ae;Xt++)ft[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ft)),G.canvasHeight=void 0,G.texture=void 0,G.canvas=void 0,G.iconData=void 0,G.iconMap=void 0,G.ctx=void 0,G}return pe()(N,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Ae,ft){var Xt=this,sr=new Image;if(this.hasImage(Ae))throw new Error("Image Id already exists");this.iconData.push({id:Ae,width:Ye,height:Ye}),this.updateIconMap(),this.loadImage(ft).then(function(or){sr=or;var Ir=Xt.iconData.find(function(an){return an.id===Ae});Ir&&(Ir.image=sr),Xt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Ae){return this.iconMap.hasOwnProperty(Ae)}},{key:"removeImage",value:function(Ae){this.hasImage(Ae)&&(this.iconData=this.iconData.filter(function(ft){return ft.id!==Ae}),delete this.iconMap[Ae],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Ae=this;this.canvas.width=dr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(ft){var Xt=Ae.iconMap[ft],sr=Xt.x,or=Xt.y,Ir=Xt.image;Ir&&Ae.ctx.drawImage(Ir,sr,or,Ye,Ye)})}},{key:"updateIconMap",value:function(){var Ae=De(this.iconData,kt,dr),ft=Ae.mapping,Xt=Ae.canvasHeight;this.iconMap=ft,this.canvasHeight=Xt}},{key:"loadImage",value:function(Ae){return new Promise(function(ft,Xt){if(Ae instanceof HTMLImageElement){ft(Ae);return}var sr=new Image;sr.crossOrigin="anonymous",sr.onload=function(){ft(sr)},sr.onerror=function(){Xt(new Error("Could not load image at "+Ae))},sr.src=Ae instanceof File?URL.createObjectURL(Ae):Ae})}}]),N}(m.EventEmitter),Qe))||$),bt=o("J4zp"),Et=o.n(bt),ze=o("IOcx"),vt,yt,Ht,hr=(vt=Object(z.injectable)(),vt(yt=(Ht=function(){function re(){K()(this,re),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return pe()(re,[{key:"init",value:function(){}},{key:"update",value:function(N){this.viewport=N,this.viewMatrixInverse=ze.b.invert(ze.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var N=this.viewport.getCenter(),G=Et()(N,2),Ae=G[0],ft=G[1];return[Ae,ft]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(N,G){return this.viewport.projectFlat(N,G)}},{key:"setViewProjectionMatrix",value:function(N){this.overridedViewProjectionMatrix=N}},{key:"jitterProjectionMatrix",value:function(N,G){var Ae=ze.b.fromTranslation(ze.b.create(),[N,G,0]);this.jitteredProjectionMatrix=ze.b.multiply(ze.b.create(),Ae,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=ze.b.multiply(ze.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),re}(),Ht))||yt),Hr,gr,Bn;function zn(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=oa(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ft=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function oa(re,se){if(!re)return;if(typeof re=="string")return $n(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return $n(re,se)}function $n(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}var Yn=(Hr=Object(z.injectable)(),Hr(gr=(Bn=function(){function re(){K()(this,re),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return pe()(re,[{key:"init",value:function(N,G){this.container=N.container,this.scene=G,this.mapsService=G.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(N,G){var Ae=G.get(D.a.IMapService);Ae.map?(N.addTo(this.scene),this.controls.push(N)):this.unAddControls.push(N)}},{key:"getControlByName",value:function(N){return this.controls.find(function(G){return G.controlOption.name===N})}},{key:"removeControl",value:function(N){var G=this.controls.indexOf(N);return G>-1&&this.controls.splice(G,1),N.remove(),this}},{key:"addControls",value:function(){var N=this;this.unAddControls.forEach(function(G){G.addTo(N.scene),N.controls.push(G)}),this.unAddControls=[]}},{key:"destroy",value:function(){var N=zn(this.controls),G;try{for(N.s();!(G=N.n()).done;){var Ae=G.value;Ae.remove()}}catch(ft){N.e(ft)}finally{N.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var N=this.controlCorners={},G="l7-",Ae=this.controlContainer=Ke.a.create("div",G+"control-container",this.container);function ft(Xt,sr){var or=G+Xt+" "+G+sr;N[Xt+sr]=Ke.a.create("div",or,Ae)}ft("top","left"),ft("top","right"),ft("bottom","left"),ft("bottom","right")}},{key:"clearControlPos",value:function(){for(var N in this.controlCorners)this.controlCorners[N]&&Ke.a.remove(this.controlCorners[N]);this.controlContainer&&Ke.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),re}(),Bn))||gr),On,U,Z,le=(On=Object(z.injectable)(),On(U=(Z=function(){function re(){K()(this,re),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return pe()(re,[{key:"addMarkerLayer",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(N),N.addTo(this.scene)):this.unAddMarkerLayers.push(N)}},{key:"removeMarkerLayer",value:function(N){N.destroy(),this.markerLayers.indexOf(N);var G=this.markerLayers.indexOf(N);G>-1&&this.markerLayers.splice(G,1)}},{key:"addMarker",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(N),N.addTo(this.scene)):this.unAddMarkers.push(N)}},{key:"addMarkers",value:function(){var N=this;this.unAddMarkers.forEach(function(G){G.addTo(N.scene),N.markers.push(G)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var N=this;this.unAddMarkerLayers.forEach(function(G){N.markerLayers.push(G),G.addTo(N.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(N){N.remove(),this.markers.indexOf(N);var G=this.markers.indexOf(N);G>-1&&this.markers.splice(G,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(N){N.remove()}),this.markers=[],this.markerLayers.forEach(function(N){N.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(N){N.destroy()}}]),re}(),Z))||U),xe,ut,wt,Bt=(xe=Object(z.injectable)(),xe(ut=(wt=function(){function re(){K()(this,re),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return pe()(re,[{key:"removePopup",value:function(N){N.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(N){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(N.addTo(this.scene),this.popup=N):this.unAddPopup=N}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}}]),re}(),wt))||ut),Xe=o("QkVN"),Lt=o.n(Xe),lr={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},zr=lr,Vr,cr,Ur;function Mn(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function ln(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Mn(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Mn(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var er={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},tn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},hn=(Vr=Object(z.injectable)(),Vr(cr=(Ur=function(){function re(){K()(this,re),this.sceneConfigCache={},this.layerConfigCache={}}return pe()(re,[{key:"getSceneConfig",value:function(N){return this.sceneConfigCache[N]}},{key:"getSceneWarninfo",value:function(N){return zr[N]}},{key:"setSceneConfig",value:function(N,G){this.sceneConfigCache[N]=ln(ln({},er),G)}},{key:"getLayerConfig",value:function(N){return this.layerConfigCache[N]}},{key:"setLayerConfig",value:function(N,G,Ae){this.layerConfigCache[G]=ln({},Lt()({},this.sceneConfigCache[N],tn,Ae))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),re}(),Ur))||cr),xn=o("yG8O"),yn=o.n(xn),vn=o("U+yc"),Pn=o.n(vn),Va=o("1ABj"),va=Math.PI/180,Ma=512,Ia=4003e4;function Zi(re){var se=re.latitude,N=se===void 0?0:se,G=re.zoom,Ae=G===void 0?0:G,ft=re.scale,Xt=re.highPrecision,sr=Xt===void 0?!1:Xt,or=re.flipY,Ir=or===void 0?!1:or;ft=ft!==void 0?ft:Math.pow(2,Ae);var an={},Gn=Ma*ft,ea=Math.cos(N*va),la=Gn/360,qa=la/ea,Fa=Gn/Ia/ea;if(an.pixelsPerMeter=[Fa,-Fa,Fa],an.metersPerPixel=[1/Fa,-1/Fa,1/Fa],an.pixelsPerDegree=[la,-qa,Fa],an.degreesPerPixel=[1/la,-1/qa,1/Fa],sr){var yi=va*Math.tan(N*va)/ea,Ja=la*yi/2,Bi=Gn/Ia*yi,So=Bi/qa*Fa;an.pixelsPerDegree2=[0,-Ja,Bi],an.pixelsPerMeter2=[So,0,So],Ir&&(an.pixelsPerDegree2[1]=-an.pixelsPerDegree2[1],an.pixelsPerMeter2[1]=-an.pixelsPerMeter2[1])}return Ir&&(an.pixelsPerMeter[1]=-an.pixelsPerMeter[1],an.metersPerPixel[1]=-an.metersPerPixel[1],an.pixelsPerDegree[1]=-an.pixelsPerDegree[1],an.degreesPerPixel[1]=-an.degreesPerPixel[1]),an}var da=o("HthE"),di,ga,ya,fa,Si,ns,Xi=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Vo=(di=Object(z.injectable)(),ga=Object(z.inject)(D.a.ICameraService),di(ya=(fa=(ns=function(){function re(){K()(this,re),this.needRefresh=!0,yn()(this,"cameraService",Si,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return pe()(re,[{key:"refresh",value:function(){var N=this.cameraService.getZoom(),G=this.cameraService.getZoomScale(),Ae=this.cameraService.getCenter(),ft=Zi({latitude:Ae[1],zoom:N}),Xt=ft.pixelsPerMeter,sr=ft.pixelsPerDegree;this.viewportCenter=Ae,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Xt,this.pixelsPerDegree=sr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===da.a.LNGLAT||this.coordinateSystem===da.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===da.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Ae,N):this.coordinateSystem===da.a.P20_OFFSET&&this.calculateLnglatOffset(Ae,N,G,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(N){this.coordinateSystem=N}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(N,G,Ae,ft){var Xt=Zi({latitude:N[1],zoom:G,scale:Ae,flipY:ft,highPrecision:!0}),sr=Xt.pixelsPerMeter,or=Xt.pixelsPerDegree,Ir=Xt.pixelsPerDegree2,an=this.cameraService.getViewMatrix(),Gn=this.cameraService.getProjectionMatrix(),ea=ze.b.multiply([],Gn,an),la=this.cameraService.projectFlat([Math.fround(N[0]),Math.fround(N[1])],Math.pow(2,G));this.viewportCenterProjection=ze.e.transformMat4([],[la[0],la[1],0,1],ea),an=this.cameraService.getViewMatrixUncentered()||an,ea=ze.b.multiply([],Gn,an),ea=ze.b.multiply([],ea,Xi),this.cameraService.setViewProjectionMatrix(ea),this.pixelsPerMeter=sr,this.pixelsPerDegree=or,this.pixelsPerDegree2=Ir}}]),re}(),ns),Si=Pn()(fa.prototype,"cameraService",[ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa))||ya),ju=o("PJYZ"),Ga=o.n(ju),Ai=o("yLV6"),Ko=o.n(Ai),oi=o("V1cb"),Yi,wo,Ha,oo,so,Eu,$o,Kl;function ks(re){var se=ho();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function ho(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Vt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Re=(Yi=Object(z.injectable)(),wo=Object(z.inject)(D.a.IMapService),Ha=Object(z.inject)(D.a.ILogService),Yi(oo=(so=(Kl=function(re){fe()(N,re);var se=ks(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ft=new Array(Ae),Xt=0;Xt<Ae;Xt++)ft[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ft)),yn()(G,"mapService",Eu,Ga()(G)),yn()(G,"logger",$o,Ga()(G)),G.hammertime=void 0,G.lastClickTime=0,G.lastClickXY=[-1,-1],G.clickTimer=void 0,G.$containter=void 0,G.onDrag=function(sr){var or=G.interactionEvent(sr);or.type=Vt[or.type],G.emit(oi.a.Drag,or)},G.onHammer=function(sr){sr.srcEvent.stopPropagation();var or=G.interactionEvent(sr);G.emit(oi.a.Hover,or)},G.onTouch=function(sr){var or=sr.touches[0];G.onHover({x:or.pageX,y:or.pageY,type:"touch"})},G.onHover=function(sr){var or=sr.clientX,Ir=sr.clientY,an=or,Gn=Ir,ea=sr.type,la=G.mapService.getMapContainer();if(la){var qa=la.getBoundingClientRect(),Fa=qa.top,yi=qa.left;an=an-yi-la.clientLeft,Gn=Gn-Fa-la.clientTop}var Ja=G.mapService.containerToLngLat([an,Gn]);if(ea==="click"){if("ontouchstart"in document.documentElement===!0)return;G.isDoubleTap(an,Gn,Ja);return}if(ea==="touch"){G.isDoubleTap(an,Gn,Ja);return}ea!=="click"&&ea!=="dblclick"&&G.emit(oi.a.Hover,{x:an,y:Gn,lngLat:Ja,type:ea,target:sr})},G}return pe()(N,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(oi.a.Hover)}},{key:"triggerHover",value:function(Ae){var ft=Ae.x,Xt=Ae.y;this.emit(oi.a.Hover,{x:ft,y:Xt})}},{key:"triggerSelect",value:function(Ae){this.emit(oi.a.Select,{featureId:Ae})}},{key:"triggerActive",value:function(Ae){this.emit(oi.a.Active,{featureId:Ae})}},{key:"addEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();if(Ae){var ft=new Ko.a.Manager(Ae);ft.add(new Ko.a.Tap({event:"dblclick",taps:2})),ft.add(new Ko.a.Tap({event:"click"})),ft.add(new Ko.a.Pan({threshold:0,pointers:0})),ft.add(new Ko.a.Press({})),ft.on("dblclick click",this.onHammer),ft.on("panstart panmove panend pancancel",this.onDrag),Ae.addEventListener("mousemove",this.onHover),Ae.addEventListener("mousedown",this.onHover),Ae.addEventListener("mouseup",this.onHover),Ae.addEventListener("contextmenu",this.onHover),this.hammertime=ft,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();Ae&&(Ae.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Ae.removeEventListener("mousedown",this.onHover),Ae.removeEventListener("mouseup",this.onHover),Ae.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Ae){var ft=Ae.type,Xt=Ae.pointerType,sr,or;Xt==="touch"?(or=Math.floor(Ae.pointers[0].clientY),sr=Math.floor(Ae.pointers[0].clientX)):(or=Math.floor(Ae.srcEvent.y),sr=Math.floor(Ae.srcEvent.x));var Ir=this.mapService.getMapContainer();if(Ir){var an=Ir.getBoundingClientRect(),Gn=an.top,ea=an.left;sr-=ea,or-=Gn}var la=this.mapService.containerToLngLat([sr,or]);return{x:sr,y:or,lngLat:la,type:ft,target:Ae.srcEvent}}},{key:"isDoubleTap",value:function(Ae,ft,Xt){var sr=this,or=new Date().getTime(),Ir="click";or-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Ae)<10&&Math.abs(this.lastClickXY[1]-ft)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Ir="dblclick",this.emit(oi.a.Hover,{x:Ae,y:ft,lngLat:Xt,type:Ir})):(this.lastClickTime=or,this.lastClickXY=[Ae,ft],this.clickTimer=setTimeout(function(){Ir="click",sr.emit(oi.a.Hover,{x:Ae,y:ft,lngLat:Xt,type:Ir})},400))}}]),N}(Y.a),Kl),Eu=Pn()(so.prototype,"mapService",[wo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=Pn()(so.prototype,"logger",[Ha],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so))||oo),Dt=o("o0o1"),mr=o.n(Dt),Qr=o("yXPU"),En=o.n(Qr),Vn=o("o+pz"),Ci,po,mo,Oo,Fu,Ml,bs,vc,Tu,Mo,zu,Eo;function Fi(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Ys(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Fi(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Fi(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var Ks=(Ci=Object(z.injectable)(),po=Object(z.inject)(D.a.IRendererService),mo=Object(z.inject)(D.a.IGlobalConfigService),Oo=Object(z.inject)(D.a.IInteractionService),Fu=Object(z.inject)(D.a.ILayerService),Ci(Ml=(bs=(Eo=function(){function re(){var se=this;K()(this,re),yn()(this,"rendererService",vc,this),yn()(this,"configService",Tu,this),yn()(this,"interactionService",Mo,this),yn()(this,"layerService",zu,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(N,G){var Ae,ft=G.x,Xt=G.y,sr=G.lngLat,or=G.type,Ir=G.target,an=!1,Gn=se.rendererService,ea=Gn.getViewportSize,la=Gn.readPixels,qa=Gn.getContainer,Fa=qa().getBoundingClientRect(),yi=Fa.width,Ja=Fa.height;yi*=window.devicePixelRatio,Ja*=window.devicePixelRatio;var Bi=N.getLayerConfig(),So=Bi.enableHighlight,yo=Bi.enableSelect,Hi=ft*window.devicePixelRatio,ko=Xt*window.devicePixelRatio;if(Hi>yi-1*window.devicePixelRatio||Hi<0||ko>Ja-1*window.devicePixelRatio||ko<0)return!1;var Qa;if(Qa=la({x:Math.floor(Hi/se.pickBufferScale),y:Math.floor((Ja-(Xt+1)*window.devicePixelRatio)/se.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:se.pickingFBO}),Qa[0]!==0||Qa[1]!==0||Qa[2]!==0){var lo=Object(Ke.k)(Qa),iu=N.getSource().getFeatureById(lo);lo!==N.getCurrentPickId()&&or==="mousemove"&&(or="mouseenter");var bi={x:ft,y:Xt,type:or,lngLat:sr,featureId:lo,feature:iu,target:Ir};iu&&(an=!0,N.setCurrentPickId(lo),se.triggerHoverOnLayer(N,bi))}else{var Ni={x:ft,y:Xt,lngLat:sr,type:N.getCurrentPickId()!==null&&or==="mousemove"?"mouseout":"un"+or,featureId:null,target:Ir,feature:null};se.triggerHoverOnLayer(N,Ys(Ys({},Ni),{},{type:"unpick"})),se.triggerHoverOnLayer(N,Ni),N.setCurrentPickId(null)}if(So&&se.highlightPickedFeature(N,Qa),yo&&or==="click"&&((Ae=Qa)===null||Ae===void 0?void 0:Ae.toString())!==[0,0,0,0].toString()){var xa=Object(Ke.k)(Qa);N.getCurrentSelectedId()===null||xa!==N.getCurrentSelectedId()?(se.selectFeature(N,Qa),N.setCurrentSelectedId(xa)):(se.selectFeature(N,new Uint8Array([0,0,0,0])),N.setCurrentSelectedId(null))}return an}}return pe()(re,[{key:"init",value:function(N){var G=this.rendererService,Ae=G.createTexture2D,ft=G.createFramebuffer,Xt=G.getViewportSize,sr=G.getContainer,or=sr().getBoundingClientRect(),Ir=or.width,an=or.height;Ir*=window.devicePixelRatio,an*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(N).pickBufferScale||1,this.pickingFBO=ft({color:Ae({width:Math.round(Ir/this.pickBufferScale),height:Math.round(an/this.pickBufferScale),wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.interactionService.on(oi.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var se=En()(mr.a.mark(function G(Ae){return mr.a.wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Xt.next=2;break}return Xt.abrupt("return");case 2:return this.alreadyInPicking=!0,Xt.next=5,this.pickingLayers(Ae);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Xt.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"pickingLayers",value:function(){var se=En()(mr.a.mark(function G(Ae){var ft=this,Xt,sr,or,Ir,an,Gn,ea,la;return mr.a.wrap(function(Fa){for(;;)switch(Fa.prev=Fa.next){case 0:Xt=this.rendererService,sr=Xt.getViewportSize,or=Xt.useFramebuffer,Ir=Xt.clear,an=Xt.getContainer,Gn=an().getBoundingClientRect(),ea=Gn.width,la=Gn.height,ea*=window.devicePixelRatio,la*=window.devicePixelRatio,(this.width!==ea||this.height!==la)&&(this.pickingFBO.resize({width:Math.round(ea/this.pickBufferScale),height:Math.round(la/this.pickBufferScale)}),this.width=ea,this.height=la),or(this.pickingFBO,function(){var yi=ft.layerService.getLayers();yi.filter(function(Ja){return Ja.needPick(Ae.type)}).reverse().some(function(Ja){Ir({framebuffer:ft.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ja.hooks.beforePickingEncode.call(),Ja.renderModels(),Ja.hooks.afterPickingEncode.call();var Bi=ft.pickFromPickingFBO(Ja,Ae);return Bi&&!Ja.getLayerConfig().enablePropagation})});case 6:case"end":return Fa.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"triggerHoverOnLayer",value:function(N,G){N.emit(G.type,G)}},{key:"highlightPickedFeature",value:function(N,G){var Ae=Et()(G,3),ft=Ae[0],Xt=Ae[1],sr=Ae[2];N.hooks.beforeHighlight.call([ft,Xt,sr])}},{key:"selectFeature",value:function(N,G){var Ae=Et()(G,3),ft=Ae[0],Xt=Ae[1],sr=Ae[2];N.hooks.beforeSelect.call([ft,Xt,sr])}}]),re}(),Eo),vc=Pn()(bs.prototype,"rendererService",[po],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=Pn()(bs.prototype,"configService",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo=Pn()(bs.prototype,"interactionService",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zu=Pn()(bs.prototype,"layerService",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs))||Ml),js=function(){function re(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;K()(this,re),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=se}return pe()(re,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var N=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var G=(typeof performance=="undefined"?Date:performance).now();N=(G-this.oldTime)/1e3,this.oldTime=G,this.elapsedTime+=N}return N}}]),re}(),Ri,Vi,xs,vl,Qu,Rt,fr,Mr,Zn=(Ri=Object(z.injectable)(),Vi=Object(z.inject)(D.a.IRendererService),xs=Object(z.inject)(D.a.IGlobalConfigService),Ri(vl=(Qu=(Mr=function(){function re(){K()(this,re),this.clock=new js,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,yn()(this,"renderService",Rt,this),yn()(this,"configService",fr,this)}return pe()(re,[{key:"add",value:function(N){this.sceneInited&&N.init(),this.layers.push(N)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(N){N.inited||N.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(N){return this.layers.find(function(G){return G.id===N})}},{key:"getLayerByName",value:function(N){return this.layers.find(function(G){return G.name===N})}},{key:"remove",value:function(N){var G=this.layers.indexOf(N);G>-1&&this.layers.splice(G,1),N.emit("remove",null),N.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){if(this.alreadyInRendering)return;this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(N){return N.inited}).filter(function(N){return N.isVisible()}).forEach(function(N){N.hooks.beforeRenderData.call(),N.hooks.beforeRender.call(),N.render(),N.hooks.afterRender.call()}),this.alreadyInRendering=!1}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(N,G){return N.zIndex-G.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(N){return N.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),re}(),Mr),Rt=Pn()(Qu.prototype,"renderService",[Vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Pn()(Qu.prototype,"configService",[xs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qu))||vl),Xa=o("QILm"),vi=o.n(Xa),Ki=o("RIqP"),Ya=o.n(Ki),Ii=o("J2iB"),Go=o.n(Ii),Cs=function(){function re(se){var N=this;K()(this,re),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(G){if(G.length===0){var Ae;return((Ae=N.scale)===null||Ae===void 0?void 0:Ae.defaultValues)||[]}return G.map(function(ft,Xt){var sr,or=(sr=N.scale)===null||sr===void 0?void 0:sr.scalers[Xt].func,Ir=or(ft);return Ir})},this.setProps(se)}return pe()(re,[{key:"setProps",value:function(N){Object.assign(this,N)}},{key:"mapping",value:function(N){var G;if((G=this.scale)===null||G===void 0?void 0:G.callback){var Ae,ft=(Ae=this.scale)===null||Ae===void 0?void 0:Ae.callback.apply(Ae,Ya()(N));if(!Go()(ft))return[ft]}return this.defaultCallback(N)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),re}(),pi,Pl,$s,Es,gl,cu,_u;function fu(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Uu(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?fu(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):fu(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Js(re){return new Promise(function(se){return setTimeout(se,re)})}var Rc=(pi={},ee()(pi,Vn.a.FLOAT,4),ee()(pi,Vn.a.UNSIGNED_BYTE,1),ee()(pi,Vn.a.UNSIGNED_SHORT,2),pi),pf=(Pl=Object(z.injectable)(),$s=Object(z.inject)(D.a.IRendererService),Pl(Es=(gl=(_u=function(){function re(){K()(this,re),this.attributesAndIndices=void 0,yn()(this,"rendererService",cu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return pe()(re,[{key:"registerStyleAttribute",value:function(N){var G=this.getLayerStyleAttribute(N.name||"");return G?G.setProps(N):(G=new Cs(N),this.attributes.push(G)),G}},{key:"updateStyleAttribute",value:function(N,G,Ae){var ft=this.getLayerStyleAttribute(N);ft||(ft=this.registerStyleAttribute(Uu(Uu({},G),{},{name:N})));var Xt=G.scale;Xt&&ft&&(ft.scale=Xt,ft.needRescale=!0,ft.needRemapping=!0,ft.needRegenerateVertices=!0,Ae&&Ae.featureRange&&(ft.featureRange=Ae.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(N){return this.attributes.find(function(G){return G.name===N})}},{key:"getLayerAttributeScale",value:function(N){var G,Ae=this.getLayerStyleAttribute(N),ft=Ae==null||((G=Ae.scale)===null||G===void 0)?void 0:G.scalers;return ft&&ft[0]?ft[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ft=arguments.length>3?arguments[3]:void 0,Xt=this.attributes.find(function(yo){return yo.name===N});if(Xt&&Xt.descriptor){var sr=Xt.descriptor,or=sr.update,Ir=sr.buffer,an=sr.size,Gn=an===void 0?0:an,ea=Rc[Ir.type||Vn.a.FLOAT];if(or){var la=this.featureLayout,qa=la.elements,Fa=la.sizePerElement,yi=qa.slice(Ae,ft);if(!yi.length)return;var Ja=yi[0].offset,Bi=Ja*Gn*ea,So=yi.map(function(yo,Hi){for(var ko=yo.featureIdx,Qa=yo.vertices,lo=yo.normals,iu=Qa.length/Fa,bi=[],Ni=0;Ni<iu;Ni++){var xa=lo?lo.slice(Ni*3,Ni*3+3):[];bi.push.apply(bi,Ya()(or(G[ko],ko,Qa.slice(Ni*Fa,Ni*Fa+Fa),Hi,xa)))}return bi}).reduce(function(yo,Hi){return yo.push.apply(yo,Ya()(Hi)),yo},[]);Xt.vertexAttribute.updateBuffer({data:So,offset:Bi})}}}},{key:"createAttributesAndIndices",value:function(N,G){var Ae=this;this.featureLayout={sizePerElement:0,elements:[]},G&&(this.triangulation=G);var ft=this.attributes.map(function(Ja){return Ja.resetDescriptor(),Ja.descriptor}),Xt=0,sr=[],or=[],Ir=[],an=3;N.forEach(function(Ja,Bi){var So=Ae.triangulation(Ja),yo=So.indices,Hi=So.vertices,ko=So.normals,Qa=So.size;yo.forEach(function(Ni){or.push(Ni+Xt)}),an=Qa;var lo=Hi.length/Qa;Ae.featureLayout.sizePerElement=an,Ae.featureLayout.elements.push({featureIdx:Bi,vertices:Hi,normals:ko,offset:Xt}),Xt+=lo;for(var iu=function(xa){var Ao=(ko==null?void 0:ko.slice(xa*3,xa*3+3))||[],hc=Hi.slice(xa*Qa,xa*Qa+Qa);ft.forEach(function(kf,uh){if(kf&&kf.update){var jf;(jf=kf.buffer.data).push.apply(jf,Ya()(kf.update(Ja,Bi,hc,xa,Ao)))}})},bi=0;bi<lo;bi++)iu(bi)});var Gn=this.rendererService,ea=Gn.createAttribute,la=Gn.createBuffer,qa=Gn.createElements,Fa={};ft.forEach(function(Ja,Bi){if(Ja){var So=Ja.buffer,yo=Ja.update,Hi=Ja.name,ko=vi()(Ja,["buffer","update","name"]),Qa=ea(Uu({buffer:la(So)},ko));Fa[Ja.name||""]=Qa,Ae.attributes[Bi].vertexAttribute=Qa}});var yi=qa({data:or,type:Vn.a.UNSIGNED_INT,count:or.length});return this.attributesAndIndices={attributes:Fa,elements:yi},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var N;this.attributes.forEach(function(G){G.vertexAttribute&&G.vertexAttribute.destroy()}),(N=this.attributesAndIndices)===null||N===void 0||N.elements.destroy(),this.attributes=[]}}]),re}(),_u),cu=Pn()(gl.prototype,"rendererService",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl))||Es),ci=o("U8pU"),Ic=o("KQm4"),gc=o("rePB"),Qc=o("1OyB"),yl=o("vuIU"),qc=o("5ku3"),$i=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Su=Object(qc.a)();function bl(re){try{var se=window[re],N="__storage_test__";return se.setItem(N,N),se.removeItem(N),se}catch(G){return null}}var as=function(){function re(se,N){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(Qc.a)(this,re),this.storage=bl(G),this.id=se,this.config={},Object.assign(this.config,N),this._loadConfiguration()}return Object(yl.a)(re,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(N){return this.config={},this.updateConfiguration(N)}},{key:"updateConfiguration",value:function(N){if(Object.assign(this.config,N),this.storage){var G=JSON.stringify(this.config);this.storage.setItem(this.id,G)}return this}},{key:"_loadConfiguration",value:function(){var N={};if(this.storage){var G=this.storage.getItem(this.id);N=G?JSON.parse(G):{}}return Object.assign(this.config,N),this}}]),re}();function Dc(re){var se;return re<10?se="".concat(re.toFixed(2),"ms"):re<100?se="".concat(re.toFixed(1),"ms"):re<1e3?se="".concat(re.toFixed(0),"ms"):se="".concat((re/1e3).toFixed(2),"s"),se}function yc(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-re.length,0);return"".concat(" ".repeat(N)).concat(re)}function Ll(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-re.length,0);return"".concat(re).concat(" ".repeat(N))}function qu(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=1e-16,G=se.isInteger,Ae=G===void 0?!1:G;if(Array.isArray(re)||ArrayBuffer.isView(re))return Nc(re,se);if(!Number.isFinite(re))return String(re);if(Math.abs(re)<N)return Ae?"0":"0.";if(Ae)return re.toFixed(0);if(Math.abs(re)>100&&Math.abs(re)<1e4)return re.toFixed(0);var ft=re.toPrecision(2),Xt=ft.indexOf(".0");return Xt===ft.length-2?ft.slice(0,-1):ft}function Nc(re,se){for(var N=se.maxElts,G=N===void 0?16:N,Ae=se.size,ft=Ae===void 0?1:Ae,Xt="[",sr=0;sr<re.length&&sr<G;++sr)sr>0&&(Xt+=",".concat(sr%ft===0?" ":"")),Xt+=qu(re[sr],se);var or=re.length>G?"...":"]";return"".concat(Xt).concat(or)}function hu(re,se,N){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Ae=re.src.replace(/\(/g,"%28").replace(/\)/g,"%29");re.width>G&&(N=Math.min(N,G/re.width));var ft=re.width*N,Xt=re.height*N,sr=["font-size:1px;","padding:".concat(Math.floor(Xt/2),"px ").concat(Math.floor(ft/2),"px;"),"line-height:".concat(Xt,"px;"),"background:url(".concat(Ae,");"),"background-size:".concat(ft,"px ").concat(Xt,"px;"),"color:transparent;"].join("");return["".concat(se," %c+"),sr]}var Au={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function ef(re){return typeof re=="string"?Au[re.toUpperCase()]||Au.WHITE:re}function $l(re,se,N){return!Su&&typeof re=="string"&&(se&&(se=ef(se),re="[".concat(se,"m").concat(re,"[39m")),N&&(se=ef(N),re="[".concat(N+10,"m").concat(re,"[49m"))),re}function Ti(re){if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(re=tf(re))){var se=0,N=function(){};return{s:N,n:function(){return se>=re.length?{done:!0}:{done:!1,value:re[se++]}},e:function(or){throw or},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G,Ae=!0,ft=!1,Xt;return{s:function(){G=re[Symbol.iterator]()},n:function(){var or=G.next();return Ae=or.done,or},e:function(or){ft=!0,Xt=or},f:function(){try{!Ae&&G.return!=null&&G.return()}finally{if(ft)throw Xt}}}}function tf(re,se){if(!re)return;if(typeof re=="string")return mf(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(N);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return mf(re,se)}function mf(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}function Jl(re){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],N=Object.getPrototypeOf(re),G=Object.getOwnPropertyNames(N),Ae=Ti(G),ft;try{var Xt=function(){var or=ft.value;typeof re[or]=="function"&&(se.find(function(Ir){return or===Ir})||(re[or]=re[or].bind(re)))};for(Ae.s();!(ft=Ae.n()).done;)Xt()}catch(sr){Ae.e(sr)}finally{Ae.f()}}function kc(re,se){if(!re)throw new Error(se||"Assertion failed")}var Ql=o("K9nA");function el(){var re;if(Su&&Ql.b.performance)re=Ql.b.performance.now();else if(Ql.a.hrtime){var se=Ql.a.hrtime();re=se[0]*1e3+se[1]/1e6}else re=Date.now();return re}var Bu={debug:Su&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},xl={enabled:!0,level:0};function Po(){}var ql={},Rl={once:!0};function Il(re){for(var se in re)for(var N in re[se])return N||"untitled";return"empty"}var jc=function(){function re(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=se.id;Object(Qc.a)(this,re),this.id=N,this.VERSION=$i,this._startTs=el(),this._deltaTs=el(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new as("__probe-".concat(this.id,"__"),xl),this.userData={},this.timeStamp("".concat(this.id," started")),Jl(this),Object.seal(this)}return Object(yl.a)(re,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((el()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((el()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:N}),this}},{key:"setLevel",value:function(N){return this._storage.updateConfiguration({level:N}),this}},{key:"assert",value:function(N,G){kc(N,G)}},{key:"warn",value:function(N){return this._getLogFunction(0,N,Bu.warn,arguments,Rl)}},{key:"error",value:function(N){return this._getLogFunction(0,N,Bu.error,arguments)}},{key:"deprecated",value:function(N,G){return this.warn("`".concat(N,"` is deprecated and will be removed in a later version. Use `").concat(G,"` instead"))}},{key:"removed",value:function(N,G){return this.error("`".concat(N,"` has been removed. Use `").concat(G,"` instead"))}},{key:"probe",value:function(N,G){return this._getLogFunction(N,G,Bu.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(N,G){return this._getLogFunction(N,G,Bu.debug,arguments)}},{key:"info",value:function(N,G){return this._getLogFunction(N,G,console.info,arguments)}},{key:"once",value:function(N,G){return this._getLogFunction(N,G,Bu.debug||Bu.info,arguments,Rl)}},{key:"table",value:function(N,G,Ae){return G?this._getLogFunction(N,G,console.table||Po,Ae&&[Ae],{tag:Il(G)}):Po}},{key:"image",value:function(N){var G=N.logLevel,Ae=N.priority,ft=N.image,Xt=N.message,sr=Xt===void 0?"":Xt,or=N.scale,Ir=or===void 0?1:or;return this._shouldLog(G||Ae)?Su?gf({image:ft,message:sr,scale:Ir}):vf({image:ft,message:sr,scale:Ir}):Po}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(N){return this._storage.config[N]}},{key:"set",value:function(N,G){this._storage.updateConfiguration(Object(gc.a)({},N,G))}},{key:"time",value:function(N,G){return this._getLogFunction(N,G,console.time?console.time:console.info)}},{key:"timeEnd",value:function(N,G){return this._getLogFunction(N,G,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(N,G){return this._getLogFunction(N,G,console.timeStamp||Po)}},{key:"group",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Ae=Qs({logLevel:N,message:G,opts:Ae});var ft=Ae,Xt=ft.collapsed;return Ae.method=(Xt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Ae)}},{key:"groupCollapsed",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(N,G,Object.assign({},Ae,{collapsed:!0}))}},{key:"groupEnd",value:function(N){return this._getLogFunction(N,"",console.groupEnd||Po)}},{key:"withGroup",value:function(N,G,Ae){this.group(N,G)();try{Ae()}finally{this.groupEnd(N)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(N){return this.isEnabled()&&this.getLevel()>=El(N)}},{key:"_getLogFunction",value:function(N,G,Ae){var ft=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Xt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(N)){var sr;Xt=Qs({logLevel:N,message:G,args:ft,opts:Xt}),Ae=Ae||Xt.method,kc(Ae),Xt.total=this.getTotal(),Xt.delta=this.getDelta(),this._deltaTs=el();var or=Xt.tag||Xt.message;if(Xt.once)if(!ql[or])ql[or]=el();else return Po;return G=eo(this.id,Xt.message,Xt),(sr=Ae).bind.apply(sr,[console,G].concat(Object(Ic.a)(Xt.args)))}return Po}},{key:"level",set:function(N){this.setLevel(N)},get:function(){return this.getLevel()}},{key:"priority",set:function(N){this.level=N},get:function(){return this.level}}]),re}();jc.VERSION=$i;function El(re){if(!re)return 0;var se;switch(Object(ci.a)(re)){case"number":se=re;break;case"object":se=re.logLevel||re.priority||0;break;default:return 0}return kc(Number.isFinite(se)&&se>=0),se}function Qs(re){var se=re.logLevel,N=re.message;re.logLevel=El(se);for(var G=re.args?Array.from(re.args):[];G.length&&G.shift()!==N;);re.args=G;switch(Object(ci.a)(se)){case"string":case"function":N!==void 0&&G.unshift(N),re.message=se;break;case"object":Object.assign(re,se);break;default:}typeof re.message=="function"&&(re.message=re.message());var Ae=Object(ci.a)(re.message);return kc(Ae==="string"||Ae==="object"),Object.assign(re,re.opts)}function eo(re,se,N){if(typeof se=="string"){var G=N.time?yc(Dc(N.total)):"";se=N.time?"".concat(re,": ").concat(G,"  ").concat(se):"".concat(re,": ").concat(se),se=$l(se,N.color,N.background)}return se}function vf(re){var se=re.image,N=re.message,G=N===void 0?"":N,Ae=re.scale,ft=Ae===void 0?1:Ae,Xt=null;try{Xt=o(2)}catch(sr){}return Xt?function(){return Xt(se,{fit:"box",width:"".concat(Math.round(80*ft),"%")}).then(function(sr){return console.log(sr)})}:Po}function gf(re){var se=re.image,N=re.message,G=N===void 0?"":N,Ae=re.scale,ft=Ae===void 0?1:Ae;if(typeof se=="string"){var Xt=new Image;return Xt.onload=function(){var an,Gn=hu(Xt,G,ft);(an=console).log.apply(an,Object(Ic.a)(Gn))},Xt.src=se,Po}var sr=se.nodeName||"";if(sr.toLowerCase()==="img"){var or;return(or=console).log.apply(or,Object(Ic.a)(hu(se,G,ft))),Po}if(sr.toLowerCase()==="canvas"){var Ir=new Image;return Ir.onload=function(){var an;return(an=console).log.apply(an,Object(Ic.a)(hu(Ir,G,ft)))},Ir.src=se.toDataURL(),Po}return Po}var Tl,ec,tl=new jc({id:"L7"}).enable(!1);tl.priority=5;var Dl=(Tl=Object(z.injectable)(),Tl(ec=function(){function re(){K()(this,re)}return pe()(re,[{key:"error",value:function(N){tl.error(N)()}},{key:"warn",value:function(N){tl.probe(1,N)()}},{key:"info",value:function(N){tl.info(3,N)()}},{key:"debug",value:function(N){tl.probe(4,N)()}}]),re}())||ec),bc=o("xp6e"),xc=o("iegG"),rl=o.n(xc),rf=window.document.documentElement.style,nl=0;function qs(re){var se=re;if(typeof re=="string"&&(se=document.getElementById(re)),se){var N=document.createElement("div");return N.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,N.id="l7-scene-".concat(nl++),N.classList.add("l7-scene"),se.appendChild(N),N}return null}var _l,tc,Fc,nf,Fs,yf,al,wi,il,Vu,ui,kn,Oi,ws,Nl,Gu,ol,bf,is,Sl,sl,ul,zi,Ts,kl,to,In,zs,ti,jl,du,Us,ll,qr,Ec,os;function ro(re){var se=Jo();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Jo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Os=(_l=Object(z.injectable)(),tc=Object(z.inject)(D.a.SceneID),Fc=Object(z.inject)(D.a.IIconService),nf=Object(z.inject)(D.a.IFontService),Fs=Object(z.inject)(D.a.IControlService),yf=Object(z.inject)(D.a.ILogService),al=Object(z.inject)(D.a.IGlobalConfigService),wi=Object(z.inject)(D.a.IMapService),il=Object(z.inject)(D.a.ICoordinateSystemService),Vu=Object(z.inject)(D.a.IRendererService),ui=Object(z.inject)(D.a.ILayerService),kn=Object(z.inject)(D.a.ICameraService),Oi=Object(z.inject)(D.a.IInteractionService),ws=Object(z.inject)(D.a.IPickingService),Nl=Object(z.inject)(D.a.IShaderModuleService),Gu=Object(z.inject)(D.a.IMarkerService),ol=Object(z.inject)(D.a.IPopupService),_l(bf=(is=(os=function(re){fe()(N,re);var se=ro(N);function N(){var G;return K()(this,N),G=se.call(this),G.destroyed=!1,G.loaded=!1,yn()(G,"id",Sl,Ga()(G)),yn()(G,"iconService",sl,Ga()(G)),yn()(G,"fontService",ul,Ga()(G)),yn()(G,"controlService",zi,Ga()(G)),yn()(G,"logger",Ts,Ga()(G)),yn()(G,"configService",kl,Ga()(G)),yn()(G,"map",to,Ga()(G)),yn()(G,"coordinateSystemService",In,Ga()(G)),yn()(G,"rendererService",zs,Ga()(G)),yn()(G,"layerService",ti,Ga()(G)),yn()(G,"cameraService",jl,Ga()(G)),yn()(G,"interactionService",du,Ga()(G)),yn()(G,"pickingService",Us,Ga()(G)),yn()(G,"shaderModuleService",ll,Ga()(G)),yn()(G,"markerService",qr,Ga()(G)),yn()(G,"popupService",Ec,Ga()(G)),G.inited=!1,G.initPromise=void 0,G.rendering=!1,G.$container=void 0,G.canvas=void 0,G.markerContainer=void 0,G.hooks=void 0,G.handleWindowResized=function(){G.emit("resize"),G.$container&&(G.initContainer(),Ke.a.triggerResize(),G.coordinateSystemService.needRefresh=!0,G.render())},G.handleMapCameraChanged=function(Ae){G.cameraService.update(Ae),G.render()},G.hooks={init:new bc.a},G}return pe()(N,[{key:"init",value:function(Ae){var ft=this;this.configService.setSceneConfig(this.id,Ae),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",En()(mr.a.mark(function Xt(){return mr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:return or.next=2,new Promise(function(Ir){ft.map.onCameraChanged(function(an){ft.cameraService.init(),ft.cameraService.update(an),Ir()}),ft.map.init()});case 2:ft.map.onCameraChanged(ft.handleMapCameraChanged),ft.map.addMarkerContainer(),ft.markerService.addMarkers(),ft.markerService.addMarkerLayers(),ft.popupService.initPopup(),ft.interactionService.init(),ft.interactionService.on(oi.a.Drag,ft.addSceneEvent.bind(ft)),ft.logger.debug("map ".concat(ft.id," loaded"));case 10:case"end":return or.stop()}},Xt)}))),this.hooks.init.tapPromise("initRenderer",En()(mr.a.mark(function Xt(){var sr;return mr.a.wrap(function(Ir){for(;;)switch(Ir.prev=Ir.next){case 0:if(sr=qs(ft.configService.getSceneConfig(ft.id).id||""),ft.$container=sr,!sr){Ir.next=11;break}return ft.canvas=Ke.a.create("canvas","",sr),ft.setCanvas(),Ir.next=7,ft.rendererService.init(ft.canvas,ft.configService.getSceneConfig(ft.id));case 7:rl()(ft.$container,ft.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(ft.handleWindowResized),Ir.next=12;break;case 11:ft.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:ft.pickingService.init(ft.id),ft.logger.debug("scene ".concat(ft.id," renderer loaded"));case 14:case"end":return Ir.stop()}},Xt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Ae){this.logger.debug("add layer ".concat(Ae.name," to scene ").concat(this.id)),this.layerService.add(Ae),this.render()}},{key:"render",value:function(){var G=En()(mr.a.mark(function ft(){return mr.a.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(!(this.rendering||this.destroyed)){sr.next=2;break}return sr.abrupt("return");case 2:if(this.rendering=!0,this.inited){sr.next=13;break}return sr.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return sr.stop()}},ft,this)}));function Ae(){return G.apply(this,arguments)}return Ae}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Ae){var ft,Xt=(ft=this.$container)===null||ft===void 0?void 0:ft.getElementsByTagName("canvas")[0];this.render();var sr=Ae==="jpg"?Xt==null?void 0:Xt.toDataURL("image/jpeg"):Xt==null?void 0:Xt.toDataURL("image/png");return sr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Ae=this.$container.parentElement;Ae!==null&&(this.markerContainer=Ke.a.create("div","l7-marker-container",Ae))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(xc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Ae,ft,Xt=window.devicePixelRatio,sr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,or=((ft=this.$container)===null||ft===void 0?void 0:ft.clientHeight)||300,Ir=this.canvas;Ir&&(Ir.width=sr*Xt,Ir.height=or*Xt,Ir.style.width="".concat(sr,"px"),Ir.style.height="".concat(or,"px")),this.rendererService.viewport({x:0,y:0,width:Xt*sr,height:Xt*or})}},{key:"setCanvas",value:function(){var Ae,ft,Xt=window.devicePixelRatio,sr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,or=((ft=this.$container)===null||ft===void 0?void 0:ft.clientHeight)||300,Ir=this.canvas;Ir.width=sr*Xt,Ir.height=or*Xt,Ir.style.width="".concat(sr,"px"),Ir.style.height="".concat(or,"px")}},{key:"addSceneEvent",value:function(Ae){this.emit(Ae.type,Ae)}}]),N}(m.EventEmitter),os),Sl=Pn()(is.prototype,"id",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sl=Pn()(is.prototype,"iconService",[Fc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ul=Pn()(is.prototype,"fontService",[nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zi=Pn()(is.prototype,"controlService",[Fs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ts=Pn()(is.prototype,"logger",[yf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=Pn()(is.prototype,"configService",[al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Pn()(is.prototype,"map",[wi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Pn()(is.prototype,"coordinateSystemService",[il],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs=Pn()(is.prototype,"rendererService",[Vu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ti=Pn()(is.prototype,"layerService",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jl=Pn()(is.prototype,"cameraService",[kn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=Pn()(is.prototype,"interactionService",[Oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Pn()(is.prototype,"pickingService",[ws],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ll=Pn()(is.prototype,"shaderModuleService",[Nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qr=Pn()(is.prototype,"markerService",[Gu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=Pn()(is.prototype,"popupService",[ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is))||bf),Fl=o("7tbW"),zc=o.n(Fl);function Bs(re){var se=0;switch(re){case"vec2":case"ivec2":se=2;break;case"vec3":case"ivec3":se=3;break;case"vec4":case"ivec4":case"mat2":se=4;break;case"mat3":se=9;break;case"mat4":se=16;break;default:}return se}var Cu=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function zl(re){var se={};return re=re.replace(Cu,function(N,G,Ae){var ft=Ae.split(":"),Xt=ft[0].trim(),sr="";ft.length>1&&(sr=ft[1].trim());switch(G){case"bool":sr=sr==="true";break;case"float":case"int":sr=Number(sr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":sr?sr=sr.replace("[","").replace("]","").split(",").reduce(function(or,Ir){return or.push(Number(Ir.trim())),or},[]):sr=new Array(Bs(G)).fill(0);break;default:}return se[Xt]=sr,"uniform ".concat(G," ").concat(Xt,`;
`)}),{content:re,uniforms:se}}var Ul,af,Uc;function Lo(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function ss(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Lo(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Lo(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}var Pa="#define PI 3.14159265359",eu=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Ro=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,To=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Al=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,cl=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,pu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,_s=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,Tc=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Jn=/precision\s+(high|low|medium)p\s+float/,jn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,_c=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,us=(Ul=Object(z.injectable)(),Ul(af=(Uc=function(){function re(){K()(this,re),this.moduleCache={},this.rawContentCache={}}return pe()(re,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Pa,fs:Pa}),this.registerModule("decode",{vs:eu,fs:""}),this.registerModule("projection",{vs:_s,fs:""}),this.registerModule("project",{vs:pu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Tc}),this.registerModule("lighting",{vs:To,fs:""}),this.registerModule("light",{vs:Ro,fs:""}),this.registerModule("picking",{vs:cl,fs:Al})}},{key:"registerModule",value:function(N,G){if(this.rawContentCache[N])return;var Ae=G.vs,ft=G.fs,Xt=G.uniforms,sr=zl(Ae),or=sr.content,Ir=sr.uniforms,an=zl(ft),Gn=an.content,ea=an.uniforms;this.rawContentCache[N]={fs:Gn,uniforms:ss(ss(ss({},Ir),ea),Xt),vs:or}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(N){var G=this;if(this.moduleCache[N])return this.moduleCache[N];var Ae=this.rawContentCache[N].vs,ft=this.rawContentCache[N].fs,Xt=this.processModule(Ae,[],"vs"),sr=Xt.content,or=Xt.includeList,Ir=this.processModule(ft,[],"fs"),an=Ir.content,Gn=Ir.includeList,ea=an,la=zc()(or.concat(Gn).concat(N)).reduce(function(qa,Fa){return ss(ss({},qa),G.rawContentCache[Fa].uniforms)},{});return Jn.test(an)||(ea=jn+an),this.moduleCache[N]={fs:ea.trim(),uniforms:la,vs:sr.trim()},this.moduleCache[N]}},{key:"processModule",value:function(N,G,Ae){var ft=this,Xt=N.replace(_c,function(sr,or){var Ir=or.split(" "),an=Ir[0].replace(/"/g,"");if(G.indexOf(an)>-1)return"";var Gn=ft.rawContentCache[an][Ae];G.push(an);var ea=ft.processModule(Gn,G,Ae),la=ea.content;return la});return{content:Xt,includeList:G}}}]),re}(),Uc))||af),Io=o("iWIM"),vo=o.n(Io),Ss=o("bPkA"),wu,rc,Ka,no,fl,mu,hl=(wu=Object(z.injectable)(),rc=Object(z.inject)(D.a.IShaderModuleService),wu(Ka=(no=(mu=function(){function re(){K()(this,re),yn()(this,"shaderModuleService",fl,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return pe()(re,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Ss.a.Normal}},{key:"init",value:function(N,G){this.config=G,this.rendererService=N.getContainer().get(D.a.IRendererService),this.cameraService=N.getContainer().get(D.a.ICameraService),this.mapService=N.getContainer().get(D.a.IMapService),this.interactionService=N.getContainer().get(D.a.IInteractionService),this.layerService=N.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(N){}}]),re}(),mu),fl=Pn()(no.prototype,"shaderModuleService",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no))||Ka),Ou,Ms;function Bc(re){var se=Vs();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Vs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var xf=(Ou=Object(z.injectable)(),Ou(Ms=function(re){fe()(N,re);var se=Bc(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Ae,ft){vo()(it()(N.prototype),"init",this).call(this,Ae,ft)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),N}(hl))||Ms),Bl,Vl,Sc,ls,Hu,Vc;function Cl(re,se){var N;if(typeof Symbol=="undefined"||re[Symbol.iterator]==null){if(Array.isArray(re)||(N=Wu(re))||se&&re&&typeof re.length=="number"){N&&(re=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=re.length?{done:!0}:{done:!1,value:re[G++]}},e:function(Ir){throw Ir},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Xt=!1,sr;return{s:function(){N=re[Symbol.iterator]()},n:function(){var Ir=N.next();return ft=Ir.done,Ir},e:function(Ir){Xt=!0,sr=Ir},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Xt)throw sr}}}}function Wu(re,se){if(!re)return;if(typeof re=="string")return nc(re,se);var N=Object.prototype.toString.call(re).slice(8,-1);if(N==="Object"&&re.constructor&&(N=re.constructor.name),N==="Map"||N==="Set")return Array.from(re);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return nc(re,se)}function nc(re,se){(se==null||se>re.length)&&(se=re.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=re[N];return G}var Zu=(Bl=Object(z.injectable)(),Vl=Object(z.inject)(D.a.IPostProcessor),Bl(Sc=(ls=(Vc=function(){function re(){K()(this,re),this.passes=[],yn()(this,"postProcessor",Hu,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return pe()(re,[{key:"setLayer",value:function(N){this.layer=N}},{key:"setRenderFlag",value:function(N){this.renderFlag=N}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var se=En()(mr.a.mark(function G(){var Ae,ft,Xt;return mr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:Ae=Cl(this.passes),or.prev=1,Ae.s();case 3:if((ft=Ae.n()).done){or.next=9;break}return Xt=ft.value,or.next=7,Xt.render(this.layer);case 7:or.next=3;break;case 9:or.next=14;break;case 11:or.prev=11,or.t0=or.catch(1),Ae.e(or.t0);case 14:return or.prev=14,Ae.f(),or.finish(14);case 17:this.layer.renderModels();case 18:case"end":return or.stop()}},G,this,[[1,11,14,17]])}));function N(){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){(this.width!==N||this.height!==G)&&(this.width=N,this.height=G)}},{key:"add",value:function(N,G){N.getType()===Ss.a.PostProcessing?this.postProcessor.add(N,this.layer,G):(N.init(this.layer,G),this.passes.push(N))}},{key:"insert",value:function(N,G,Ae){N.init(this.layer,G),this.passes.splice(Ae,0,N)}},{key:"destroy",value:function(){this.passes.length=0}}]),re}(),Vc),Hu=Pn()(ls.prototype,"postProcessor",[Vl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ls))||Sc),Ps,of,ac,ic,oc,s;function a(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function n(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?a(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):a(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function l(re){var se=g();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function g(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var w=(Ps=Object(z.injectable)(),of=Object(z.inject)(D.a.ILogService),Ps(ac=(ic=(s=function(re){fe()(N,re);var se=l(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ft=new Array(Ae),Xt=0;Xt<Ae;Xt++)ft[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ft)),yn()(G,"logger",oc,Ga()(G)),G.pickingFBO=void 0,G.layer=void 0,G.width=0,G.height=0,G.alreadyInRendering=!1,G.pickFromPickingFBO=function(sr){var or=sr.x,Ir=sr.y,an=sr.lngLat,Gn=sr.type;if(!G.layer.isVisible()||!G.layer.needPick(Gn))return;var ea=G.rendererService,la=ea.getViewportSize,qa=ea.readPixels,Fa=ea.useFramebuffer,yi=la(),Ja=yi.width,Bi=yi.height,So=G.layer.getLayerConfig(),yo=So.enableHighlight,Hi=So.enableSelect,ko=or*window.devicePixelRatio,Qa=Ir*window.devicePixelRatio;if(ko>Ja||ko<0||Qa>Bi||Qa<0)return;var lo;Fa(G.pickingFBO,function(){var iu;if(lo=qa({x:Math.round(ko),y:Math.round(Bi-(Ir+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:G.pickingFBO}),lo[0]!==0||lo[1]!==0||lo[2]!==0){G.logger.debug("picked");var bi=Object(Ke.k)(lo),Ni=G.layer.getSource().getFeatureById(bi),xa={x:or,y:Ir,type:Gn,lngLat:an,featureId:bi,feature:Ni};Ni&&(G.layer.setCurrentPickId(bi),G.triggerHoverOnLayer(xa))}else{var Ao={x:or,y:Ir,lngLat:an,type:G.layer.getCurrentPickId()===null?"un"+Gn:"mouseout",featureId:null,feature:null};G.triggerHoverOnLayer(n(n({},Ao),{},{type:"unpick"})),G.triggerHoverOnLayer(Ao),G.layer.setCurrentPickId(null)}yo&&G.highlightPickedFeature(lo),Hi&&Gn==="click"&&((iu=lo)===null||iu===void 0?void 0:iu.toString())!==[0,0,0,0].toString()&&G.selectFeature(lo)})},G}return pe()(N,[{key:"getType",value:function(){return Ss.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Ae,ft){vo()(it()(N.prototype),"init",this).call(this,Ae,ft),this.layer=Ae;var Xt=this.rendererService,sr=Xt.createTexture2D,or=Xt.createFramebuffer,Ir=Xt.getViewportSize,an=Ir(),Gn=an.width,ea=an.height;this.pickingFBO=or({color:sr({width:Gn,height:ea,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.interactionService.on(oi.a.Hover,this.pickFromPickingFBO),this.interactionService.on(oi.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(oi.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Ae){var ft=this;if(this.alreadyInRendering)return;var Xt=this.rendererService,sr=Xt.getViewportSize,or=Xt.useFramebuffer,Ir=Xt.clear,an=sr(),Gn=an.width,ea=an.height;this.alreadyInRendering=!0,(this.width!==Gn||this.height!==ea)&&(this.pickingFBO.resize({width:Gn,height:ea}),this.width=Gn,this.height=ea),or(this.pickingFBO,function(){Ir({framebuffer:ft.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var la=ft.layer.multiPassRenderer.getRenderFlag();ft.layer.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforePickingEncode.call(),Ae.render(),Ae.hooks.afterPickingEncode.call(),ft.layer.multiPassRenderer.setRenderFlag(la),ft.alreadyInRendering=!1})}},{key:"triggerHoverOnLayer",value:function(Ae){this.layer.emit(Ae.type,Ae)}},{key:"highlightPickedFeature",value:function(Ae){var ft=Et()(Ae,3),Xt=ft[0],sr=ft[1],or=ft[2];this.layer.hooks.beforeHighlight.call([Xt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Ae){var ft=Et()(Ae,3),Xt=ft[0],sr=ft[1],or=ft[2];this.layer.hooks.beforeSelect.call([Xt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Ae){var ft=Ae.featureId,Xt=Object(Ke.l)(ft);this.selectFeature(new Uint8Array(Xt))}},{key:"highlightFeatureHandle",value:function(Ae){var ft=Ae.featureId,Xt=Object(Ke.l)(ft);this.highlightPickedFeature(new Uint8Array(Xt))}}]),N}(hl),s),oc=Pn()(ic.prototype,"logger",[of],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ic))||ac),L=o("+em5"),F,ue;function Ee(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function $e(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ee(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Ee(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function rt(re){var se=nt();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function nt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Ft=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Nt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Kt=(F=Object(z.injectable)(),F(ue=function(re){fe()(N,re);var se=rt(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Nt,fs:Ft});var Ae=this.shaderModuleService.getModule("blur-pass"),ft=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ft,fs:Xt,uniforms:$e($e({},sr),{},{u_ViewportSize:[Ir,an]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ft={};return Go()(Ae.blurRadius)||(ft.u_BlurDir=[Ae.blurRadius,0]),ft}}]),N}(L.a))||ue),jt,Gt;function nr(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function rr(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?nr(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):nr(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Lr(re){var se=vr();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function vr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Sr=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Ar=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,rn=(jt=Object(z.injectable)(),jt(Gt=function(re){fe()(N,re);var se=Lr(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Ar,fs:Sr});var Ae=this.shaderModuleService.getModule("blur-pass"),ft=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ft,fs:Xt,uniforms:rr(rr({},sr),{},{u_ViewportSize:[Ir,an]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ft={};return Go()(Ae.blurRadius)||(ft.u_BlurDir=[0,Ae.blurRadius]),ft}}]),N}(L.a))||Gt),Xr,mn;function Ln(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function qn(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ln(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):Ln(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function sa(re){var se=Sa();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Sa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Wa=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,Sn=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ua=(Xr=Object(z.injectable)(),Xr(mn=function(re){fe()(N,re);var se=sa(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Sn,fs:Wa});var Ae=this.shaderModuleService.getModule("colorhalftone-pass"),ft=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ft,fs:Xt,uniforms:qn(qn({},sr),{},{u_ViewportSize:[Ir,an]})}}}]),N}(L.a))||mn),ba,Wn;function Aa(re){var se=na();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function na(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var La=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,za=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Gi=(ba=Object(z.injectable)(),ba(Wn=function(re){fe()(N,re);var se=Aa(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:za,fs:La}),this.shaderModuleService.getModule("copy-pass")}}]),N}(L.a))||Wn),_i,Di;function gi(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function Ui(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?gi(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):gi(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Qo(re){var se=qo();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var vu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Mu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,cs=(_i=Object(z.injectable)(),_i(Di=function(re){fe()(N,re);var se=Qo(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Mu,fs:vu});var Ae=this.shaderModuleService.getModule("hexagonalpixelate-pass"),ft=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ft,fs:Xt,uniforms:Ui(Ui({},sr),{},{u_ViewportSize:[Ir,an]})}}}]),N}(L.a))||Di),Gs,Pu;function sc(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function tu(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?sc(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):sc(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Xu(re){var se=uc();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function uc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var ru=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Lu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,fs=(Gs=Object(z.injectable)(),Gs(Pu=function(re){fe()(N,re);var se=Xu(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:Lu,fs:ru});var Ae=this.shaderModuleService.getModule("ink-pass"),ft=Ae.vs,Xt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Ir=or.width,an=or.height;return{vs:ft,fs:Xt,uniforms:tu(tu({},sr),{},{u_ViewportSize:[Ir,an]})}}}]),N}(L.a))||Pu),ao,Yu;function Gl(re){var se=hs();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function hs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Do=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,No=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ho=(ao=Object(z.injectable)(),ao(Yu=function(re){fe()(N,re);var se=Gl(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:No,fs:Do}),this.shaderModuleService.getModule("noise-pass")}}]),N}(L.a))||Yu),_o,uo;function Ls(re){var se=nu();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function nu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Hl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Gc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,dl=(_o=Object(z.injectable)(),_o(uo=function(re){fe()(N,re);var se=Ls(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Hl,fs:Gc}),this.shaderModuleService.getModule("sepia-pass")}}]),N}(L.a))||uo),lc,pl,Rs,go,Ac,ds,sf,Cf=(lc=Object(z.injectable)(),pl=Object(z.inject)(D.a.IRendererService),Rs=Object(z.postConstruct)(),lc(go=(Ac=(sf=function(){function re(){K()(this,re),yn()(this,"rendererService",ds,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return pe()(re,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var se=En()(mr.a.mark(function G(Ae){var ft,Xt;return mr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:ft=0;case 1:if(!(ft<this.passes.length)){or.next=10;break}return Xt=this.passes[ft],Xt.setRenderToScreen(this.isLastEnabledPass(ft)),or.next=6,Xt.render(Ae);case 6:ft!==this.passes.length-1&&this.swap();case 7:ft++,or.next=1;break;case 10:case"end":return or.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){this.readFBO.resize({width:N,height:G}),this.writeFBO.resize({width:N,height:G})}},{key:"add",value:function(N,G,Ae){N.init(G,Ae),this.passes.push(N)}},{key:"insert",value:function(N,G,Ae,ft){N.init(Ae,ft),this.passes.splice(G,0,N)}},{key:"getPostProcessingPassByName",value:function(N){return this.passes.find(function(G){return G.getName()===N})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(N){for(var G=N+1;G<this.passes.length;G++)if(this.passes[G].isEnabled())return!1;return!0}},{key:"swap",value:function(){var N=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=N}}]),re}(),sf),ds=Pn()(Ac.prototype,"rendererService",[pl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pn()(Ac.prototype,"init",[Rs],Object.getOwnPropertyDescriptor(Ac.prototype,"init"),Ac.prototype),Ac))||go),wf,Cc;function Ku(re){var se=Ef();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Ef(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var uf=(wf=Object(z.injectable)(),wf(Cc=function(re){fe()(N,re);var se=Ku(N);function N(){return K()(this,N),se.apply(this,arguments)}return pe()(N,[{key:"getType",value:function(){return Ss.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Ae,ft){vo()(it()(N.prototype),"init",this).call(this,Ae,ft)}},{key:"render",value:function(Ae){var ft=this.rendererService,Xt=ft.useFramebuffer,sr=ft.clear;Xt(null,function(){sr({color:[0,0,0,0],depth:1,stencil:0}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)})}}]),N}(hl))||Cc),Of,Ru,cc,Df,Hc,wc,Qf,qf;function eh(re,se){var N=Object.keys(re);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(re);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(re,Ae).enumerable})),N.push.apply(N,G)}return N}function th(re){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?eh(Object(N),!0).forEach(function(G){ee()(re,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(N)):eh(Object(N)).forEach(function(G){Object.defineProperty(re,G,Object.getOwnPropertyDescriptor(N,G))})}return re}function Mf(re){var se=rh();return function(){var G=it()(re),Ae;if(se){var ft=it()(this).constructor;Ae=Reflect.construct(G,arguments,ft)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function rh(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(re){return!1}}var Wl=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,lf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,io=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function fc(re,se){for(var N=0,G=1/se,Ae=re;Ae>0;)N=N+G*(Ae%se),Ae=Math.floor(Ae/se),G=G/se;return N}var Tf=1,Oc=(Of=Object(z.injectable)(),Ru=Object(z.inject)(D.a.IShaderModuleService),cc=Object(z.inject)(D.a.ILogService),Of(Df=(Hc=(qf=function(re){fe()(N,re);var se=Mf(N);function N(){var G;K()(this,N);for(var Ae=arguments.length,ft=new Array(Ae),Xt=0;Xt<Ae;Xt++)ft[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ft)),yn()(G,"shaderModuleService",wc,Ga()(G)),yn()(G,"logger",Qf,Ga()(G)),G.haltonSequence=[],G.accumulatingId=0,G.frame=0,G.timer=void 0,G.sampleRenderTarget=void 0,G.prevRenderTarget=void 0,G.outputRenderTarget=void 0,G.copyRenderTarget=void 0,G.blendModel=void 0,G.outputModel=void 0,G.copyModel=void 0,G}return pe()(N,[{key:"getType",value:function(){return Ss.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Ae,ft){vo()(it()(N.prototype),"init",this).call(this,Ae,ft);var Xt=this.rendererService,sr=Xt.createFramebuffer,or=Xt.createTexture2D;this.sampleRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=sr({color:or({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})});for(var Ir=0;Ir<30;Ir++)this.haltonSequence.push([fc(Ir,2),fc(Ir,3)]);this.blendModel=this.createTriangleModel("blend-pass",Wl),this.outputModel=this.createTriangleModel("copy-pass",lf,{blend:{enable:!0,func:{srcRGB:Vn.a.ONE,dstRGB:Vn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Vn.a.ONE,dstAlpha:Vn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Vn.a.FUNC_ADD,alpha:Vn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",lf)}},{key:"render",value:function(Ae){var ft=this,Xt=this.rendererService,sr=Xt.clear,or=Xt.getViewportSize,Ir=Xt.useFramebuffer,an=or(),Gn=an.width,ea=an.height;this.sampleRenderTarget.resize({width:Gn,height:ea}),this.prevRenderTarget.resize({width:Gn,height:ea}),this.outputRenderTarget.resize({width:Gn,height:ea}),this.copyRenderTarget.resize({width:Gn,height:ea}),this.resetFrame(),this.stopAccumulating();var la=Ae.multiPassRenderer.getPostProcessor().getReadFBO();Ir(la,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:la}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)});var qa=function Fa(yi){if(!ft.accumulatingId||yi!==ft.accumulatingId)return;ft.isFinished()||(ft.doRender(Ae),requestAnimationFrame(function(){Fa(yi)}))};this.accumulatingId=Tf++,this.timer=window.setTimeout(function(){qa(ft.accumulatingId)},50)}},{key:"doRender",value:function(Ae){var ft=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Xt=this.rendererService,sr=Xt.clear,or=Xt.getViewportSize,Ir=Xt.useFramebuffer,an=or(),Gn=an.width,ea=an.height,la=Ae.getLayerConfig(),qa=la.jitterScale,Fa=qa===void 0?1:qa,yi=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((yi[0]*2-1)/Gn*Fa,(yi[1]*2-1)/ea*Fa),Ae.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforeRender.call(),Ir(this.sampleRenderTarget,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ft.sampleRenderTarget}),Ae.render()}),Ae.hooks.afterRender.call(),Ae.multiPassRenderer.setRenderFlag(!0);var Ja=Ae.getLayerConfig();Ir(this.outputRenderTarget,function(){ft.blendModel.draw({uniforms:{u_opacity:Ja.opacity||1,u_MixRatio:ft.frame===0?1:.9,u_Diffuse1:ft.sampleRenderTarget,u_Diffuse2:ft.frame===0?Ae.multiPassRenderer.getPostProcessor().getReadFBO():ft.prevRenderTarget}})}),this.frame===0&&sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Ir(this.copyRenderTarget,function(){ft.outputModel.draw({uniforms:{u_Texture:ft.outputRenderTarget}})}),Ir(Ae.multiPassRenderer.getPostProcessor().getReadFBO(),function(){ft.copyModel.draw({uniforms:{u_Texture:ft.copyRenderTarget}})}),Ae.multiPassRenderer.getPostProcessor().render(Ae));var Bi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Bi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Ae,ft,Xt){this.shaderModuleService.registerModule(Ae,{vs:io,fs:ft});var sr=this.shaderModuleService.getModule(Ae),or=sr.vs,Ir=sr.fs,an=sr.uniforms,Gn=this.rendererService,ea=Gn.createAttribute,la=Gn.createBuffer,qa=Gn.createModel;return qa(th({vs:or,fs:Ir,attributes:{a_Position:ea({buffer:la({data:[-4,-4,4,-4,0,4],type:Vn.a.FLOAT}),size:2})},uniforms:th({},an),depth:{enable:!1},count:3},Xt))}}]),N}(hl),qf),wc=Pn()(Hc.prototype,"shaderModuleService",[Ru],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qf=Pn()(Hc.prototype,"logger",[cc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hc))||Df),au=new z.Container;au.bind(D.a.IGlobalConfigService).to(hn).inSingletonScope(),au.bind(D.a.IShaderModuleService).to(us).inSingletonScope(),au.bind(D.a.ILogService).to(Dl).inSingletonScope(),Object(z.decorate)(Object(z.injectable)(),m.EventEmitter),au.bind(D.a.IEventEmitter).to(m.EventEmitter);var wl=W()(au,!1),_f=function(se){var N=wl.lazyInject(se);return function(G,Ae,ft){N.call(this,G,Ae),ft&&(ft.initializer=function(){return G[Ae]})}},Nf=function(se){var N=wl.lazyMultiInject(se);return function(G,Ae,ft){N.call(this,G,Ae),ft&&(ft.initializer=function(){return G[Ae]})}},Wc=y.c=au,cf=0;function Zc(){var re=new z.Container;return re.parent=au,re.bind(D.a.SceneID).toConstantValue("".concat(cf++)),re.bind(D.a.ILayerService).to(Zn).inSingletonScope(),re.bind(D.a.ISceneService).to(Os).inSingletonScope(),re.bind(D.a.ICameraService).to(hr).inSingletonScope(),re.bind(D.a.ICoordinateSystemService).to(Vo).inSingletonScope(),re.bind(D.a.IInteractionService).to(Re).inSingletonScope(),re.bind(D.a.IPickingService).to(Ks).inSingletonScope(),re.bind(D.a.IControlService).to(Yn).inSingletonScope(),re.bind(D.a.IMarkerService).to(le).inSingletonScope(),re.bind(D.a.IIconService).to(xt).inSingletonScope(),re.bind(D.a.IFontService).to(R).inSingletonScope(),re.bind(D.a.IPopupService).to(Bt).inSingletonScope(),re.bind(D.a.INormalPass).to(xf).whenTargetNamed("clear"),re.bind(D.a.INormalPass).to(w).whenTargetNamed("pixelPicking"),re.bind(D.a.INormalPass).to(uf).whenTargetNamed("render"),re.bind(D.a.INormalPass).to(Oc).whenTargetNamed("taa"),re.bind(D.a.IFactoryNormalPass).toFactory(function(se){return function(N){return se.container.getNamed(D.a.INormalPass,N)}}),re.bind(D.a.IPostProcessingPass).to(Gi).whenTargetNamed("copy"),re.bind(D.a.IPostProcessingPass).to(Kt).whenTargetNamed("blurH"),re.bind(D.a.IPostProcessingPass).to(rn).whenTargetNamed("blurV"),re.bind(D.a.IPostProcessingPass).to(Ho).whenTargetNamed("noise"),re.bind(D.a.IPostProcessingPass).to(dl).whenTargetNamed("sepia"),re.bind(D.a.IPostProcessingPass).to(ua).whenTargetNamed("colorHalftone"),re.bind(D.a.IPostProcessingPass).to(cs).whenTargetNamed("hexagonalPixelate"),re.bind(D.a.IPostProcessingPass).to(fs).whenTargetNamed("ink"),re.bind(D.a.IFactoryPostProcessingPass).toFactory(function(se){return function(N){var G=se.container.getNamed(D.a.IPostProcessingPass,N);return G.setName(N),G}}),re}function ml(re){var se=new z.Container;return se.parent=re,se.bind(D.a.IStyleAttributeService).to(pf).inSingletonScope(),se.bind(D.a.IMultiPassRenderer).to(Zu).inSingletonScope(),se.bind(D.a.IPostProcessor).to(Cf).inSingletonScope(),se}},fbrv:function(Ue,y,o){"use strict";var x=this&&this.__spreadArrays||function(){for(var Pe=0,ht=0,Le=arguments.length;ht<Le;ht++)Pe+=arguments[ht].length;for(var _t=Array(Pe),ot=0,ht=0;ht<Le;ht++)for(var et=arguments[ht],Ze=0,At=et.length;Ze<At;Ze++,ot++)_t[ot]=et[Ze];return _t};Object.defineProperty(y,"__esModule",{value:!0}),y.getFunctionName=y.getBaseClassDependencyCount=y.getDependencies=void 0;var m=o("Yk9n"),Y=o("MON2"),z=o("FV85"),i=o("xfSm"),W=o("ujMp");Object.defineProperty(y,"getFunctionName",{enumerable:!0,get:function(){return W.getFunctionName}});var D=o("dX1H");function Q(Pe,ht){var Le=W.getFunctionName(ht),_t=ee(Pe,Le,ht,!1);return _t}y.getDependencies=Q;function ee(Pe,ht,Le,_t){var ot=Pe.getConstructorMetadata(Le),et=ot.compilerGeneratedMetadata;if(et===void 0){var Ze=Y.MISSING_INJECTABLE_ANNOTATION+" "+ht+".";throw new Error(Ze)}var At=ot.userGeneratedMetadata,St=Object.keys(At),De=Le.length===0&&St.length>0,Ie=De?St.length:Le.length,Ge=K(_t,ht,et,At,Ie),dt=je(Pe,Le),we=x(Ge,dt);return we}function ce(Pe,ht,Le,_t,ot){var et=ot[Pe.toString()]||[],Ze=Ke(et),At=Ze.unmanaged!==!0,St=_t[Pe],De=Ze.inject||Ze.multiInject;if(St=De||St,St instanceof m.LazyServiceIdentifer&&(St=St.unwrap()),At){var Ie=St===Object,Ge=St===Function,dt=St===void 0,we=Ie||Ge||dt;if(!ht&&we){var pt=Y.MISSING_INJECT_ANNOTATION+" argument "+Pe+" in class "+Le+".";throw new Error(pt)}var Wt=new D.Target(z.TargetTypeEnum.ConstructorArgument,Ze.targetName,St);return Wt.metadata=et,Wt}return null}function K(Pe,ht,Le,_t,ot){for(var et=[],Ze=0;Ze<ot;Ze++){var At=Ze,St=ce(At,Pe,ht,Le,_t);St!==null&&et.push(St)}return et}function je(Pe,ht){for(var Le=Pe.getPropertiesMetadata(ht),_t=[],ot=Object.keys(Le),et=0,Ze=ot;et<Ze.length;et++){var At=Ze[et],St=Le[At],De=Ke(Le[At]),Ie=De.targetName||At,Ge=De.inject||De.multiInject,dt=new D.Target(z.TargetTypeEnum.ClassProperty,Ie,Ge);dt.metadata=St,_t.push(dt)}var we=Object.getPrototypeOf(ht.prototype).constructor;if(we!==Object){var pt=je(Pe,we);_t=x(_t,pt)}return _t}function pe(Pe,ht){var Le=Object.getPrototypeOf(ht.prototype).constructor;if(Le!==Object){var _t=W.getFunctionName(Le),ot=ee(Pe,_t,Le,!0),et=ot.map(function(St){return St.metadata.filter(function(De){return De.key===i.UNMANAGED_TAG})}),Ze=[].concat.apply([],et).length,At=ot.length-Ze;return At>0?At:pe(Pe,Le)}else return 0}y.getBaseClassDependencyCount=pe;function Ke(Pe){var ht={};return Pe.forEach(function(Le){ht[Le.key.toString()]=Le.value}),{inject:ht[i.INJECT_TAG],multiInject:ht[i.MULTI_INJECT_TAG],targetName:ht[i.NAME_TAG],unmanaged:ht[i.UNMANAGED_TAG]}}},fbvF:function(Ue,y,o){(function(x,m){Ue.exports=m()})(this,function(){"use strict";var x=function(Fe){return Fe instanceof Uint8Array||Fe instanceof Uint16Array||Fe instanceof Uint32Array||Fe instanceof Int8Array||Fe instanceof Int16Array||Fe instanceof Int32Array||Fe instanceof Float32Array||Fe instanceof Float64Array||Fe instanceof Uint8ClampedArray},m=function(Fe,Ot){for(var xr=Object.keys(Ot),Pr=0;Pr<xr.length;++Pr)Fe[xr[Pr]]=Ot[xr[Pr]];return Fe},Y=`
`;function z(ye){return typeof atob!="undefined"?atob(ye):"base64:"+ye}function i(ye){var Fe=new Error("(regl) "+ye);throw console.error(Fe),Fe}function W(ye,Fe){ye||i(Fe)}function D(ye){return ye?": "+ye:""}function Q(ye,Fe,Ot){ye in Fe||i("unknown parameter ("+ye+")"+D(Ot)+". possible values: "+Object.keys(Fe).join())}function ee(ye,Fe){x(ye)||i("invalid parameter type"+D(Fe)+". must be a typed array")}function ce(ye,Fe){switch(Fe){case"number":return typeof ye=="number";case"object":return typeof ye=="object";case"string":return typeof ye=="string";case"boolean":return typeof ye=="boolean";case"function":return typeof ye=="function";case"undefined":return typeof ye=="undefined";case"symbol":return typeof ye=="symbol"}}function K(ye,Fe,Ot){ce(ye,Fe)||i("invalid parameter type"+D(Ot)+". expected "+Fe+", got "+typeof ye)}function je(ye,Fe){ye>=0&&(ye|0)===ye||i("invalid parameter type, ("+ye+")"+D(Fe)+". must be a nonnegative integer")}function pe(ye,Fe,Ot){Fe.indexOf(ye)<0&&i("invalid value"+D(Ot)+". must be one of: "+Fe)}var Ke=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Pe(ye){Object.keys(ye).forEach(function(Fe){Ke.indexOf(Fe)<0&&i('invalid regl constructor argument "'+Fe+'". must be one of '+Ke)})}function ht(ye,Fe){for(ye=ye+"";ye.length<Fe;)ye=" "+ye;return ye}function Le(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function _t(ye,Fe){this.number=ye,this.line=Fe,this.errors=[]}function ot(ye,Fe,Ot){this.file=ye,this.line=Fe,this.message=Ot}function et(){var ye=new Error,Fe=(ye.stack||ye).toString(),Ot=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Fe);if(Ot)return Ot[1];var xr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Fe);return xr?xr[1]:"unknown"}function Ze(){var ye=new Error,Fe=(ye.stack||ye).toString(),Ot=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Fe);if(Ot)return Ot[1];var xr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Fe);return xr?xr[1]:"unknown"}function At(ye,Fe){var Ot=ye.split(`
`),xr=1,Pr=0,Cr={unknown:new Le,0:new Le};Cr.unknown.name=Cr[0].name=Fe||et(),Cr.unknown.lines.push(new _t(0,""));for(var Er=0;Er<Ot.length;++Er){var Wr=Ot[Er],on=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Wr);if(on)switch(on[1]){case"line":var en=/(\d+)(\s+\d+)?/.exec(on[2]);en&&(xr=en[1]|0,en[2]&&(Pr=en[2]|0,Pr in Cr||(Cr[Pr]=new Le)));break;case"define":var Yr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(on[2]);Yr&&(Cr[Pr].name=Yr[1]?z(Yr[2]):Yr[2]);break}Cr[Pr].lines.push(new _t(xr++,Wr))}return Object.keys(Cr).forEach(function(cn){var Tn=Cr[cn];Tn.lines.forEach(function(dn){Tn.index[dn.number]=dn})}),Cr}function St(ye){var Fe=[];return ye.split(`
`).forEach(function(Ot){if(Ot.length<5)return;var xr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Ot);xr?Fe.push(new ot(xr[1]|0,xr[2]|0,xr[3].trim())):Ot.length>0&&Fe.push(new ot("unknown",0,Ot))}),Fe}function De(ye,Fe){Fe.forEach(function(Ot){var xr=ye[Ot.file];if(xr){var Pr=xr.index[Ot.line];if(Pr){Pr.errors.push(Ot),xr.hasErrors=!0;return}}ye.unknown.hasErrors=!0,ye.unknown.lines[0].errors.push(Ot)})}function Ie(ye,Fe,Ot,xr,Pr){if(!ye.getShaderParameter(Fe,ye.COMPILE_STATUS)){var Cr=ye.getShaderInfoLog(Fe),Er=xr===ye.FRAGMENT_SHADER?"fragment":"vertex";ur(Ot,"string",Er+" shader source must be a string",Pr);var Wr=At(Ot,Pr),on=St(Cr);De(Wr,on),Object.keys(Wr).forEach(function(en){var Yr=Wr[en];if(!Yr.hasErrors)return;var cn=[""],Tn=[""];function dn(nn,Tr){cn.push(nn),Tn.push(Tr||"")}dn("file number "+en+": "+Yr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Yr.lines.forEach(function(nn){if(nn.errors.length>0){dn(ht(nn.number,4)+"|  ","background-color:yellow; font-weight:bold"),dn(nn.line+Y,"color:red; background-color:yellow; font-weight:bold");var Tr=0;nn.errors.forEach(function(br){var Zr=br.message,wn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Zr);if(wn){var Rr=wn[1];Zr=wn[2];switch(Rr){case"assign":Rr="=";break}Tr=Math.max(nn.line.indexOf(Rr,Tr),0)}else Tr=0;dn(ht("| ",6)),dn(ht("^^^",Tr+3)+Y,"font-weight:bold"),dn(ht("| ",6)),dn(Zr+Y,"font-weight:bold")}),dn(ht("| ",6)+Y)}else dn(ht(nn.number,4)+"|  "),dn(nn.line+Y,"color:red")}),typeof document!="undefined"&&!window.chrome?(Tn[0]=cn.join("%c"),console.log.apply(console,Tn)):console.log(cn.join(""))}),W.raise("Error compiling "+Er+" shader, "+Wr[0].name)}}function Ge(ye,Fe,Ot,xr,Pr){if(!ye.getProgramParameter(Fe,ye.LINK_STATUS)){var Cr=ye.getProgramInfoLog(Fe),Er=At(Ot,Pr),Wr=At(xr,Pr),on='Error linking program with vertex shader, "'+Wr[0].name+'", and fragment shader "'+Er[0].name+'"';typeof document!="undefined"?console.log("%c"+on+Y+"%c"+Cr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(on+Y+Cr),W.raise(on)}}function dt(ye){ye._commandRef=et()}function we(ye,Fe,Ot,xr){dt(ye);function Pr(on){return on?xr.id(on):0}ye._fragId=Pr(ye.static.frag),ye._vertId=Pr(ye.static.vert);function Cr(on,en){Object.keys(en).forEach(function(Yr){on[xr.id(Yr)]=!0})}var Er=ye._uniformSet={};Cr(Er,Fe.static),Cr(Er,Fe.dynamic);var Wr=ye._attributeSet={};Cr(Wr,Ot.static),Cr(Wr,Ot.dynamic),ye._hasCount="count"in ye.static||"count"in ye.dynamic||"elements"in ye.static||"elements"in ye.dynamic}function pt(ye,Fe){var Ot=Ze();i(ye+" in command "+(Fe||et())+(Ot==="unknown"?"":" called from "+Ot))}function Wt(ye,Fe,Ot){ye||pt(Fe,Ot||et())}function Qt(ye,Fe,Ot,xr){ye in Fe||pt("unknown parameter ("+ye+")"+D(Ot)+". possible values: "+Object.keys(Fe).join(),xr||et())}function ur(ye,Fe,Ot,xr){ce(ye,Fe)||pt("invalid parameter type"+D(Ot)+". expected "+Fe+", got "+typeof ye,xr||et())}function oe(ye){ye()}function J(ye,Fe,Ot){ye.texture?pe(ye.texture._texture.internalformat,Fe,"unsupported texture format for attachment"):pe(ye.renderbuffer._renderbuffer.format,Ot,"unsupported renderbuffer format for attachment")}var H=33071,Se=9728,be=9984,Te=9985,me=9986,at=9987,Jt=5120,Mt=5121,ve=5122,ge=5123,He=5124,st=5125,Oe=5126,gt=32819,C=32820,R=33635,q=34042,fe=36193,We={};We[Jt]=We[Mt]=1,We[ve]=We[ge]=We[fe]=We[R]=We[gt]=We[C]=2,We[He]=We[st]=We[Oe]=We[q]=4;function qe(ye,Fe){return ye===C||ye===gt||ye===R?2:ye===q?4:We[ye]*Fe}function Tt(ye){return!(ye&ye-1)&&!!ye}function it(ye,Fe,Ot){var xr,Pr=Fe.width,Cr=Fe.height,Er=Fe.channels;W(Pr>0&&Pr<=Ot.maxTextureSize&&Cr>0&&Cr<=Ot.maxTextureSize,"invalid texture shape"),(ye.wrapS!==H||ye.wrapT!==H)&&W(Tt(Pr)&&Tt(Cr),"incompatible wrap mode for texture, both width and height must be power of 2"),Fe.mipmask===1?Pr!==1&&Cr!==1&&W(ye.minFilter!==be&&ye.minFilter!==me&&ye.minFilter!==Te&&ye.minFilter!==at,"min filter requires mipmap"):(W(Tt(Pr)&&Tt(Cr),"texture must be a square power of 2 to support mipmapping"),W(Fe.mipmask===(Pr<<1)-1,"missing or incomplete mipmap data")),Fe.type===Oe&&(Ot.extensions.indexOf("oes_texture_float_linear")<0&&W(ye.minFilter===Se&&ye.magFilter===Se,"filter not supported, must enable oes_texture_float_linear"),W(!ye.genMipmaps,"mipmap generation not supported with float textures"));var Wr=Fe.images;for(xr=0;xr<16;++xr)if(Wr[xr]){var on=Pr>>xr,en=Cr>>xr;W(Fe.mipmask&1<<xr,"missing mipmap data");var Yr=Wr[xr];if(W(Yr.width===on&&Yr.height===en,"invalid shape for mip images"),W(Yr.format===Fe.format&&Yr.internalformat===Fe.internalformat&&Yr.type===Fe.type,"incompatible type for mip image"),!Yr.compressed)if(Yr.data){var cn=Math.ceil(qe(Yr.type,Er)*on/Yr.unpackAlignment)*Yr.unpackAlignment;W(Yr.data.byteLength===cn*en,"invalid data for image, buffer size is inconsistent with image format")}else Yr.element||Yr.copy}else ye.genMipmaps||W((Fe.mipmask&1<<xr)===0,"extra mipmap data");Fe.compressed&&W(!ye.genMipmaps,"mipmap generation for compressed images not supported")}function Ut(ye,Fe,Ot,xr){var Pr=ye.width,Cr=ye.height,Er=ye.channels;W(Pr>0&&Pr<=xr.maxTextureSize&&Cr>0&&Cr<=xr.maxTextureSize,"invalid texture shape"),W(Pr===Cr,"cube map must be square"),W(Fe.wrapS===H&&Fe.wrapT===H,"wrap mode not supported by cube map");for(var Wr=0;Wr<Ot.length;++Wr){var on=Ot[Wr];W(on.width===Pr&&on.height===Cr,"inconsistent cube map face shape"),Fe.genMipmaps&&(W(!on.compressed,"can not generate mipmap for compressed textures"),W(on.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var en=on.images,Yr=0;Yr<16;++Yr){var cn=en[Yr];if(cn){var Tn=Pr>>Yr,dn=Cr>>Yr;W(on.mipmask&1<<Yr,"missing mipmap data"),W(cn.width===Tn&&cn.height===dn,"invalid shape for mip images"),W(cn.format===ye.format&&cn.internalformat===ye.internalformat&&cn.type===ye.type,"incompatible type for mip image"),cn.compressed||(cn.data?W(cn.data.byteLength===Tn*dn*Math.max(qe(cn.type,Er),cn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):cn.element||cn.copy)}}}}var $=m(W,{optional:oe,raise:i,commandRaise:pt,command:Wt,parameter:Q,commandParameter:Qt,constructor:Pe,type:K,commandType:ur,isTypedArray:ee,nni:je,oneOf:pe,shaderError:Ie,linkError:Ge,callSite:Ze,saveCommandRef:dt,saveDrawInfo:we,framebufferFormat:J,guessCommand:et,texture2D:it,textureCube:Ut}),Qe=0,ne=0,tt=5,kt=6;function dr(ye,Fe){this.id=Qe++,this.type=ye,this.data=Fe}function Ye(ye){return ye.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function xt(ye){if(ye.length===0)return[];var Fe=ye.charAt(0),Ot=ye.charAt(ye.length-1);if(ye.length>1&&Fe===Ot&&(Fe==='"'||Fe==="'"))return['"'+Ye(ye.substr(1,ye.length-2))+'"'];var xr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ye);if(xr)return xt(ye.substr(0,xr.index)).concat(xt(xr[1])).concat(xt(ye.substr(xr.index+xr[0].length)));var Pr=ye.split(".");if(Pr.length===1)return['"'+Ye(ye)+'"'];for(var Cr=[],Er=0;Er<Pr.length;++Er)Cr=Cr.concat(xt(Pr[Er]));return Cr}function bt(ye){return"["+xt(ye).join("][")+"]"}function Et(ye,Fe){return new dr(ye,bt(Fe+""))}function ze(ye){return typeof ye=="function"&&!ye._reglType||ye instanceof dr}function vt(ye,Fe){if(typeof ye=="function")return new dr(ne,ye);if(typeof ye=="number"||typeof ye=="boolean")return new dr(tt,ye);if(Array.isArray(ye))return new dr(kt,ye.map(function(Ot,xr){return vt(Ot,Fe+"["+xr+"]")}));if(ye instanceof dr)return ye;$(!1,"invalid option type in uniform "+Fe)}var yt={DynamicVariable:dr,define:Et,isDynamic:ze,unbox:vt,accessor:bt},Ht={next:typeof requestAnimationFrame=="function"?function(ye){return requestAnimationFrame(ye)}:function(ye){return setTimeout(ye,16)},cancel:typeof cancelAnimationFrame=="function"?function(ye){return cancelAnimationFrame(ye)}:clearTimeout},hr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Hr(){var ye={"":0},Fe=[""];return{id:function(xr){var Pr=ye[xr];return Pr||(Pr=ye[xr]=Fe.length,Fe.push(xr),Pr)},str:function(xr){return Fe[xr]}}}function gr(ye,Fe,Ot){var xr=document.createElement("canvas");m(xr.style,{border:0,margin:0,padding:0,top:0,left:0}),ye.appendChild(xr),ye===document.body&&(xr.style.position="absolute",m(ye.style,{margin:0,padding:0}));function Pr(){var Wr=window.innerWidth,on=window.innerHeight;if(ye!==document.body){var en=ye.getBoundingClientRect();Wr=en.right-en.left,on=en.bottom-en.top}xr.width=Ot*Wr,xr.height=Ot*on,m(xr.style,{width:Wr+"px",height:on+"px"})}var Cr;ye!==document.body&&typeof ResizeObserver=="function"?(Cr=new ResizeObserver(function(){setTimeout(Pr)}),Cr.observe(ye)):window.addEventListener("resize",Pr,!1);function Er(){Cr?Cr.disconnect():window.removeEventListener("resize",Pr),ye.removeChild(xr)}return Pr(),{canvas:xr,onDestroy:Er}}function Bn(ye,Fe){function Ot(xr){try{return ye.getContext(xr,Fe)}catch(Pr){return null}}return Ot("webgl")||Ot("experimental-webgl")||Ot("webgl-experimental")}function zn(ye){return typeof ye.nodeName=="string"&&typeof ye.appendChild=="function"&&typeof ye.getBoundingClientRect=="function"}function oa(ye){return typeof ye.drawArrays=="function"||typeof ye.drawElements=="function"}function $n(ye){return typeof ye=="string"?ye.split():($(Array.isArray(ye),"invalid extension array"),ye)}function Yn(ye){return typeof ye=="string"?($(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ye)):ye}function On(ye){var Fe=ye||{},Ot,xr,Pr,Cr,Er={},Wr=[],on=[],en=typeof window=="undefined"?1:window.devicePixelRatio,Yr=!1,cn=function(Tr){Tr&&$.raise(Tr)},Tn=function(){};if(typeof Fe=="string"?($(typeof document!="undefined","selector queries only supported in DOM enviroments"),Ot=document.querySelector(Fe),$(Ot,"invalid query string for element")):typeof Fe=="object"?zn(Fe)?Ot=Fe:oa(Fe)?(Cr=Fe,Pr=Cr.canvas):($.constructor(Fe),"gl"in Fe?Cr=Fe.gl:"canvas"in Fe?Pr=Yn(Fe.canvas):"container"in Fe&&(xr=Yn(Fe.container)),"attributes"in Fe&&(Er=Fe.attributes,$.type(Er,"object","invalid context attributes")),"extensions"in Fe&&(Wr=$n(Fe.extensions)),"optionalExtensions"in Fe&&(on=$n(Fe.optionalExtensions)),"onDone"in Fe&&($.type(Fe.onDone,"function","invalid or missing onDone callback"),cn=Fe.onDone),"profile"in Fe&&(Yr=!!Fe.profile),"pixelRatio"in Fe&&(en=+Fe.pixelRatio,$(en>0,"invalid pixel ratio"))):$.raise("invalid arguments to regl"),Ot&&(Ot.nodeName.toLowerCase()==="canvas"?Pr=Ot:xr=Ot),!Cr){if(!Pr){$(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var dn=gr(xr||document.body,cn,en);if(!dn)return null;Pr=dn.canvas,Tn=dn.onDestroy}Er.premultipliedAlpha===void 0&&(Er.premultipliedAlpha=!0),Cr=Bn(Pr,Er)}return Cr?{gl:Cr,canvas:Pr,container:xr,extensions:Wr,optionalExtensions:on,pixelRatio:en,profile:Yr,onDone:cn,onDestroy:Tn}:(Tn(),cn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function U(ye,Fe){var Ot={};function xr(Er){$.type(Er,"string","extension name must be string");var Wr=Er.toLowerCase(),on;try{on=Ot[Wr]=ye.getExtension(Wr)}catch(en){}return!!on}for(var Pr=0;Pr<Fe.extensions.length;++Pr){var Cr=Fe.extensions[Pr];if(!xr(Cr))return Fe.onDestroy(),Fe.onDone('"'+Cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Fe.optionalExtensions.forEach(xr),{extensions:Ot,restore:function(){Object.keys(Ot).forEach(function(Wr){if(Ot[Wr]&&!xr(Wr))throw new Error("(regl): error restoring extension "+Wr)})}}}function Z(ye,Fe){for(var Ot=Array(ye),xr=0;xr<ye;++xr)Ot[xr]=Fe(xr);return Ot}var le=5120,xe=5121,ut=5122,wt=5123,Bt=5124,Xe=5125,Lt=5126;function lr(ye){for(var Fe=16;Fe<=1<<28;Fe*=16)if(ye<=Fe)return Fe;return 0}function zr(ye){var Fe,Ot;return Fe=(ye>65535)<<4,ye>>>=Fe,Ot=(ye>255)<<3,ye>>>=Ot,Fe|=Ot,Ot=(ye>15)<<2,ye>>>=Ot,Fe|=Ot,Ot=(ye>3)<<1,ye>>>=Ot,Fe|=Ot,Fe|ye>>1}function Vr(){var ye=Z(8,function(){return[]});function Fe(Cr){var Er=lr(Cr),Wr=ye[zr(Er)>>2];return Wr.length>0?Wr.pop():new ArrayBuffer(Er)}function Ot(Cr){ye[zr(Cr.byteLength)>>2].push(Cr)}function xr(Cr,Er){var Wr=null;switch(Cr){case le:Wr=new Int8Array(Fe(Er),0,Er);break;case xe:Wr=new Uint8Array(Fe(Er),0,Er);break;case ut:Wr=new Int16Array(Fe(2*Er),0,Er);break;case wt:Wr=new Uint16Array(Fe(2*Er),0,Er);break;case Bt:Wr=new Int32Array(Fe(4*Er),0,Er);break;case Xe:Wr=new Uint32Array(Fe(4*Er),0,Er);break;case Lt:Wr=new Float32Array(Fe(4*Er),0,Er);break;default:return null}return Wr.length!==Er?Wr.subarray(0,Er):Wr}function Pr(Cr){Ot(Cr.buffer)}return{alloc:Fe,free:Ot,allocType:xr,freeType:Pr}}var cr=Vr();cr.zero=Vr();var Ur=3408,Mn=3410,ln=3411,er=3412,tn=3413,hn=3414,xn=3415,yn=33901,vn=33902,Pn=3379,Va=3386,va=34921,Ma=36347,Ia=36348,Zi=35661,da=35660,di=34930,ga=36349,ya=34076,fa=34024,Si=7936,ns=7937,Xi=7938,Vo=35724,ju=34047,Ga=36063,Ai=34852,Ko=3553,oi=34067,Yi=34069,wo=33984,Ha=6408,oo=5126,so=5121,Eu=36160,$o=36053,Kl=36064,ks=16384,ho=function(Fe,Ot){var xr=1;Ot.ext_texture_filter_anisotropic&&(xr=Fe.getParameter(ju));var Pr=1,Cr=1;Ot.webgl_draw_buffers&&(Pr=Fe.getParameter(Ai),Cr=Fe.getParameter(Ga));var Er=!!Ot.oes_texture_float;if(Er){var Wr=Fe.createTexture();Fe.bindTexture(Ko,Wr),Fe.texImage2D(Ko,0,Ha,1,1,0,Ha,oo,null);var on=Fe.createFramebuffer();if(Fe.bindFramebuffer(Eu,on),Fe.framebufferTexture2D(Eu,Kl,Ko,Wr,0),Fe.bindTexture(Ko,null),Fe.checkFramebufferStatus(Eu)!==$o)Er=!1;else{Fe.viewport(0,0,1,1),Fe.clearColor(1,0,0,1),Fe.clear(ks);var en=cr.allocType(oo,4);Fe.readPixels(0,0,1,1,Ha,oo,en),Fe.getError()?Er=!1:(Fe.deleteFramebuffer(on),Fe.deleteTexture(Wr),Er=en[0]===1),cr.freeType(en)}}var Yr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),cn=!0;if(!Yr){var Tn=Fe.createTexture(),dn=cr.allocType(so,36);Fe.activeTexture(wo),Fe.bindTexture(oi,Tn),Fe.texImage2D(Yi,0,Ha,3,3,0,Ha,so,dn),cr.freeType(dn),Fe.bindTexture(oi,null),Fe.deleteTexture(Tn),cn=!Fe.getError()}return{colorBits:[Fe.getParameter(Mn),Fe.getParameter(ln),Fe.getParameter(er),Fe.getParameter(tn)],depthBits:Fe.getParameter(hn),stencilBits:Fe.getParameter(xn),subpixelBits:Fe.getParameter(Ur),extensions:Object.keys(Ot).filter(function(nn){return!!Ot[nn]}),maxAnisotropic:xr,maxDrawbuffers:Pr,maxColorAttachments:Cr,pointSizeDims:Fe.getParameter(yn),lineWidthDims:Fe.getParameter(vn),maxViewportDims:Fe.getParameter(Va),maxCombinedTextureUnits:Fe.getParameter(Zi),maxCubeMapSize:Fe.getParameter(ya),maxRenderbufferSize:Fe.getParameter(fa),maxTextureUnits:Fe.getParameter(di),maxTextureSize:Fe.getParameter(Pn),maxAttributes:Fe.getParameter(va),maxVertexUniforms:Fe.getParameter(Ma),maxVertexTextureUnits:Fe.getParameter(da),maxVaryingVectors:Fe.getParameter(Ia),maxFragmentUniforms:Fe.getParameter(ga),glsl:Fe.getParameter(Vo),renderer:Fe.getParameter(ns),vendor:Fe.getParameter(Si),version:Fe.getParameter(Xi),readFloat:Er,npotTextureCube:cn}};function Vt(ye){return!!ye&&typeof ye=="object"&&Array.isArray(ye.shape)&&Array.isArray(ye.stride)&&typeof ye.offset=="number"&&ye.shape.length===ye.stride.length&&(Array.isArray(ye.data)||x(ye.data))}var Re=function(Fe){return Object.keys(Fe).map(function(Ot){return Fe[Ot]})},Dt={shape:po,flatten:Ci};function mr(ye,Fe,Ot){for(var xr=0;xr<Fe;++xr)Ot[xr]=ye[xr]}function Qr(ye,Fe,Ot,xr){for(var Pr=0,Cr=0;Cr<Fe;++Cr)for(var Er=ye[Cr],Wr=0;Wr<Ot;++Wr)xr[Pr++]=Er[Wr]}function En(ye,Fe,Ot,xr,Pr,Cr){for(var Er=Cr,Wr=0;Wr<Fe;++Wr)for(var on=ye[Wr],en=0;en<Ot;++en)for(var Yr=on[en],cn=0;cn<xr;++cn)Pr[Er++]=Yr[cn]}function Vn(ye,Fe,Ot,xr,Pr){for(var Cr=1,Er=Ot+1;Er<Fe.length;++Er)Cr*=Fe[Er];var Wr=Fe[Ot];if(Fe.length-Ot===4){var on=Fe[Ot+1],en=Fe[Ot+2],Yr=Fe[Ot+3];for(Er=0;Er<Wr;++Er)En(ye[Er],on,en,Yr,xr,Pr),Pr+=Cr}else for(Er=0;Er<Wr;++Er)Vn(ye[Er],Fe,Ot+1,xr,Pr),Pr+=Cr}function Ci(ye,Fe,Ot,xr){var Pr=1;if(Fe.length)for(var Cr=0;Cr<Fe.length;++Cr)Pr*=Fe[Cr];else Pr=0;var Er=xr||cr.allocType(Ot,Pr);switch(Fe.length){case 0:break;case 1:mr(ye,Fe[0],Er);break;case 2:Qr(ye,Fe[0],Fe[1],Er);break;case 3:En(ye,Fe[0],Fe[1],Fe[2],Er,0);break;default:Vn(ye,Fe,0,Er,0)}return Er}function po(ye){for(var Fe=[],Ot=ye;Ot.length;Ot=Ot[0])Fe.push(Ot.length);return Fe}var mo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Oo=5120,Fu=5122,Ml=5124,bs=5121,vc=5123,Tu=5125,Mo=5126,zu=5126,Eo={int8:Oo,int16:Fu,int32:Ml,uint8:bs,uint16:vc,uint32:Tu,float:Mo,float32:zu},Fi=35048,Ys=35040,Ks={dynamic:Fi,stream:Ys,static:35044},js=Dt.flatten,Ri=Dt.shape,Vi=35044,xs=35040,vl=5121,Qu=5126,Rt=[];Rt[5120]=1,Rt[5122]=2,Rt[5124]=4,Rt[5121]=1,Rt[5123]=2,Rt[5125]=4,Rt[5126]=4;function fr(ye){return mo[Object.prototype.toString.call(ye)]|0}function Mr(ye,Fe){for(var Ot=0;Ot<Fe.length;++Ot)ye[Ot]=Fe[Ot]}function Zn(ye,Fe,Ot,xr,Pr,Cr,Er){for(var Wr=0,on=0;on<Ot;++on)for(var en=0;en<xr;++en)ye[Wr++]=Fe[Pr*on+Cr*en+Er]}function Xa(ye,Fe,Ot,xr){var Pr=0,Cr={};function Er(Tr){this.id=Pr++,this.buffer=ye.createBuffer(),this.type=Tr,this.usage=Vi,this.byteLength=0,this.dimension=1,this.dtype=vl,this.persistentData=null,Ot.profile&&(this.stats={size:0})}Er.prototype.bind=function(){ye.bindBuffer(this.type,this.buffer)},Er.prototype.destroy=function(){Tn(this)};var Wr=[];function on(Tr,br){var Zr=Wr.pop();return Zr||(Zr=new Er(Tr)),Zr.bind(),cn(Zr,br,xs,0,1,!1),Zr}function en(Tr){Wr.push(Tr)}function Yr(Tr,br,Zr){Tr.byteLength=br.byteLength,ye.bufferData(Tr.type,br,Zr)}function cn(Tr,br,Zr,wn,Rr,ta){var Jr;if(Tr.usage=Zr,Array.isArray(br)){if(Tr.dtype=wn||Qu,br.length>0){var Br;if(Array.isArray(br[0])){Jr=Ri(br);for(var Fr=1,Kr=1;Kr<Jr.length;++Kr)Fr*=Jr[Kr];Tr.dimension=Fr,Br=js(br,Jr,Tr.dtype),Yr(Tr,Br,Zr),ta?Tr.persistentData=Br:cr.freeType(Br)}else if(typeof br[0]=="number"){Tr.dimension=Rr;var Hn=cr.allocType(Tr.dtype,br.length);Mr(Hn,br),Yr(Tr,Hn,Zr),ta?Tr.persistentData=Hn:cr.freeType(Hn)}else x(br[0])?(Tr.dimension=br[0].length,Tr.dtype=wn||fr(br[0])||Qu,Br=js(br,[br.length,br[0].length],Tr.dtype),Yr(Tr,Br,Zr),ta?Tr.persistentData=Br:cr.freeType(Br)):$.raise("invalid buffer data")}}else if(x(br))Tr.dtype=wn||fr(br),Tr.dimension=Rr,Yr(Tr,br,Zr),ta&&(Tr.persistentData=new Uint8Array(new Uint8Array(br.buffer)));else if(Vt(br)){Jr=br.shape;var aa=br.stride,sn=br.offset,Gr=0,jr=0,ha=0,pa=0;Jr.length===1?(Gr=Jr[0],jr=1,ha=aa[0],pa=0):Jr.length===2?(Gr=Jr[0],jr=Jr[1],ha=aa[0],pa=aa[1]):$.raise("invalid shape"),Tr.dtype=wn||fr(br.data)||Qu,Tr.dimension=jr;var Un=cr.allocType(Tr.dtype,Gr*jr);Zn(Un,br.data,Gr,jr,ha,pa,sn),Yr(Tr,Un,Zr),ta?Tr.persistentData=Un:cr.freeType(Un)}else br instanceof ArrayBuffer?(Tr.dtype=vl,Tr.dimension=Rr,Yr(Tr,br,Zr),ta&&(Tr.persistentData=new Uint8Array(new Uint8Array(br)))):$.raise("invalid buffer data")}function Tn(Tr){Fe.bufferCount--,xr(Tr);var br=Tr.buffer;$(br,"buffer must not be deleted already"),ye.deleteBuffer(br),Tr.buffer=null,delete Cr[Tr.id]}function dn(Tr,br,Zr,wn){Fe.bufferCount++;var Rr=new Er(br);Cr[Rr.id]=Rr;function ta(Fr){var Kr=Vi,Hn=null,aa=0,sn=0,Gr=1;return Array.isArray(Fr)||x(Fr)||Vt(Fr)||Fr instanceof ArrayBuffer?Hn=Fr:typeof Fr=="number"?aa=Fr|0:Fr&&($.type(Fr,"object","buffer arguments must be an object, a number or an array"),"data"in Fr&&($(Hn===null||Array.isArray(Hn)||x(Hn)||Vt(Hn),"invalid data for buffer"),Hn=Fr.data),"usage"in Fr&&($.parameter(Fr.usage,Ks,"invalid buffer usage"),Kr=Ks[Fr.usage]),"type"in Fr&&($.parameter(Fr.type,Eo,"invalid buffer type"),sn=Eo[Fr.type]),"dimension"in Fr&&($.type(Fr.dimension,"number","invalid dimension"),Gr=Fr.dimension|0),"length"in Fr&&($.nni(aa,"buffer length must be a nonnegative integer"),aa=Fr.length|0)),Rr.bind(),Hn?cn(Rr,Hn,Kr,sn,Gr,wn):(aa&&ye.bufferData(Rr.type,aa,Kr),Rr.dtype=sn||vl,Rr.usage=Kr,Rr.dimension=Gr,Rr.byteLength=aa),Ot.profile&&(Rr.stats.size=Rr.byteLength*Rt[Rr.dtype]),ta}function Jr(Fr,Kr){$(Kr+Fr.byteLength<=Rr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Fr.byteLength+" starting from offset "+Kr+" to a buffer of size "+Rr.byteLength),ye.bufferSubData(Rr.type,Kr,Fr)}function Br(Fr,Kr){var Hn=(Kr||0)|0,aa;if(Rr.bind(),x(Fr)||Fr instanceof ArrayBuffer)Jr(Fr,Hn);else if(Array.isArray(Fr)){if(Fr.length>0)if(typeof Fr[0]=="number"){var sn=cr.allocType(Rr.dtype,Fr.length);Mr(sn,Fr),Jr(sn,Hn),cr.freeType(sn)}else if(Array.isArray(Fr[0])||x(Fr[0])){aa=Ri(Fr);var Gr=js(Fr,aa,Rr.dtype);Jr(Gr,Hn),cr.freeType(Gr)}else $.raise("invalid buffer data")}else if(Vt(Fr)){aa=Fr.shape;var jr=Fr.stride,ha=0,pa=0,Un=0,Ua=0;aa.length===1?(ha=aa[0],pa=1,Un=jr[0],Ua=0):aa.length===2?(ha=aa[0],pa=aa[1],Un=jr[0],Ua=jr[1]):$.raise("invalid shape");var Oa=Array.isArray(Fr.data)?Rr.dtype:fr(Fr.data),Da=cr.allocType(Oa,ha*pa);Zn(Da,Fr.data,ha,pa,Un,Ua,Fr.offset),Jr(Da,Hn),cr.freeType(Da)}else $.raise("invalid data for buffer subdata");return ta}return Zr||ta(Tr),ta._reglType="buffer",ta._buffer=Rr,ta.subdata=Br,Ot.profile&&(ta.stats=Rr.stats),ta.destroy=function(){Tn(Rr)},ta}function nn(){Re(Cr).forEach(function(Tr){Tr.buffer=ye.createBuffer(),ye.bindBuffer(Tr.type,Tr.buffer),ye.bufferData(Tr.type,Tr.persistentData||Tr.byteLength,Tr.usage)})}return Ot.profile&&(Fe.getTotalBufferSize=function(){var Tr=0;return Object.keys(Cr).forEach(function(br){Tr+=Cr[br].stats.size}),Tr}),{create:dn,createStream:on,destroyStream:en,clear:function(){Re(Cr).forEach(Tn),Wr.forEach(Tn)},getBuffer:function(br){return br&&br._buffer instanceof Er?br._buffer:null},restore:nn,_initBuffer:cn}}var vi=0,Ki=0,Ya=1,Ii=1,Go=4,Cs=4,pi={points:vi,point:Ki,lines:Ya,line:Ii,triangles:Go,triangle:Cs,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Pl=0,$s=1,Es=4,gl=5120,cu=5121,_u=5122,fu=5123,Uu=5124,Js=5125,Rc=34963,pf=35040,ci=35044;function Ic(ye,Fe,Ot,xr){var Pr={},Cr=0,Er={uint8:cu,uint16:fu};Fe.oes_element_index_uint&&(Er.uint32=Js);function Wr(nn){this.id=Cr++,Pr[this.id]=this,this.buffer=nn,this.primType=Es,this.vertCount=0,this.type=0}Wr.prototype.bind=function(){this.buffer.bind()};var on=[];function en(nn){var Tr=on.pop();return Tr||(Tr=new Wr(Ot.create(null,Rc,!0,!1)._buffer)),cn(Tr,nn,pf,-1,-1,0,0),Tr}function Yr(nn){on.push(nn)}function cn(nn,Tr,br,Zr,wn,Rr,ta){nn.buffer.bind();var Jr;if(Tr){var Br=ta;!ta&&(!x(Tr)||Vt(Tr)&&!x(Tr.data))&&(Br=Fe.oes_element_index_uint?Js:fu),Ot._initBuffer(nn.buffer,Tr,br,Br,3)}else ye.bufferData(Rc,Rr,br),nn.buffer.dtype=Jr||cu,nn.buffer.usage=br,nn.buffer.dimension=3,nn.buffer.byteLength=Rr;if(Jr=ta,!ta){switch(nn.buffer.dtype){case cu:case gl:Jr=cu;break;case fu:case _u:Jr=fu;break;case Js:case Uu:Jr=Js;break;default:$.raise("unsupported type for element array")}nn.buffer.dtype=Jr}nn.type=Jr,$(Jr!==Js||!!Fe.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Fr=wn;Fr<0&&(Fr=nn.buffer.byteLength,Jr===fu?Fr>>=1:Jr===Js&&(Fr>>=2)),nn.vertCount=Fr;var Kr=Zr;if(Zr<0){Kr=Es;var Hn=nn.buffer.dimension;Hn===1&&(Kr=Pl),Hn===2&&(Kr=$s),Hn===3&&(Kr=Es)}nn.primType=Kr}function Tn(nn){xr.elementsCount--,$(nn.buffer!==null,"must not double destroy elements"),delete Pr[nn.id],nn.buffer.destroy(),nn.buffer=null}function dn(nn,Tr){var br=Ot.create(null,Rc,!0),Zr=new Wr(br._buffer);xr.elementsCount++;function wn(Rr){if(!Rr)br(),Zr.primType=Es,Zr.vertCount=0,Zr.type=cu;else if(typeof Rr=="number")br(Rr),Zr.primType=Es,Zr.vertCount=Rr|0,Zr.type=cu;else{var ta=null,Jr=ci,Br=-1,Fr=-1,Kr=0,Hn=0;Array.isArray(Rr)||x(Rr)||Vt(Rr)?ta=Rr:($.type(Rr,"object","invalid arguments for elements"),"data"in Rr&&(ta=Rr.data,$(Array.isArray(ta)||x(ta)||Vt(ta),"invalid data for element buffer")),"usage"in Rr&&($.parameter(Rr.usage,Ks,"invalid element buffer usage"),Jr=Ks[Rr.usage]),"primitive"in Rr&&($.parameter(Rr.primitive,pi,"invalid element buffer primitive"),Br=pi[Rr.primitive]),"count"in Rr&&($(typeof Rr.count=="number"&&Rr.count>=0,"invalid vertex count for elements"),Fr=Rr.count|0),"type"in Rr&&($.parameter(Rr.type,Er,"invalid buffer type"),Hn=Er[Rr.type]),"length"in Rr?Kr=Rr.length|0:(Kr=Fr,Hn===fu||Hn===_u?Kr*=2:(Hn===Js||Hn===Uu)&&(Kr*=4))),cn(Zr,ta,Jr,Br,Fr,Kr,Hn)}return wn}return wn(nn),wn._reglType="elements",wn._elements=Zr,wn.subdata=function(Rr,ta){return br.subdata(Rr,ta),wn},wn.destroy=function(){Tn(Zr)},wn}return{create:dn,createStream:en,destroyStream:Yr,getElements:function(Tr){return typeof Tr=="function"&&Tr._elements instanceof Wr?Tr._elements:null},clear:function(){Re(Pr).forEach(Tn)}}}var gc=new Float32Array(1),Qc=new Uint32Array(gc.buffer),yl=5123;function qc(ye){for(var Fe=cr.allocType(yl,ye.length),Ot=0;Ot<ye.length;++Ot)if(isNaN(ye[Ot]))Fe[Ot]=65535;else if(ye[Ot]===Infinity)Fe[Ot]=31744;else if(ye[Ot]===-Infinity)Fe[Ot]=64512;else{gc[0]=ye[Ot];var xr=Qc[0],Pr=xr>>>31<<15,Cr=(xr<<1>>>24)-127,Er=xr>>13&(1<<10)-1;if(Cr<-24)Fe[Ot]=Pr;else if(Cr<-14){var Wr=-14-Cr;Fe[Ot]=Pr+(Er+(1<<10)>>Wr)}else Cr>15?Fe[Ot]=Pr+31744:Fe[Ot]=Pr+(Cr+15<<10)+Er}return Fe}function $i(ye){return Array.isArray(ye)||x(ye)}var Su=function(Fe){return!(Fe&Fe-1)&&!!Fe},bl=34467,as=3553,Dc=34067,yc=34069,Ll=6408,qu=6406,Nc=6407,hu=6409,Au=6410,ef=32854,$l=32855,Ti=36194,tf=32819,mf=32820,Jl=33635,kc=34042,Ql=6402,el=34041,Bu=35904,xl=35906,Po=36193,ql=33776,Rl=33777,Il=33778,jc=33779,El=35986,Qs=35987,eo=34798,vf=35840,gf=35841,Tl=35842,ec=35843,tl=36196,Dl=5121,bc=5123,xc=5125,rl=5126,rf=10242,nl=10243,qs=10497,_l=33071,tc=33648,Fc=10240,nf=10241,Fs=9728,yf=9729,al=9984,wi=9985,il=9986,Vu=9987,ui=33170,kn=4352,Oi=4353,ws=4354,Nl=34046,Gu=3317,ol=37440,bf=37441,is=37443,Sl=37444,sl=33984,ul=[al,il,wi,Vu],zi=[0,hu,Au,Nc,Ll],Ts={};Ts[hu]=Ts[qu]=Ts[Ql]=1,Ts[el]=Ts[Au]=2,Ts[Nc]=Ts[Bu]=3,Ts[Ll]=Ts[xl]=4;function kl(ye){return"[object "+ye+"]"}var to=kl("HTMLCanvasElement"),In=kl("OffscreenCanvas"),zs=kl("CanvasRenderingContext2D"),ti=kl("ImageBitmap"),jl=kl("HTMLImageElement"),du=kl("HTMLVideoElement"),Us=Object.keys(mo).concat([to,In,zs,ti,jl,du]),ll=[];ll[Dl]=1,ll[rl]=4,ll[Po]=2,ll[bc]=2,ll[xc]=4;var qr=[];qr[ef]=2,qr[$l]=2,qr[Ti]=2,qr[el]=4,qr[ql]=.5,qr[Rl]=.5,qr[Il]=1,qr[jc]=1,qr[El]=.5,qr[Qs]=1,qr[eo]=1,qr[vf]=.5,qr[gf]=.25,qr[Tl]=.5,qr[ec]=.25,qr[tl]=.5;function Ec(ye){return Array.isArray(ye)&&(ye.length===0||typeof ye[0]=="number")}function os(ye){if(!Array.isArray(ye))return!1;var Fe=ye.length;return!(Fe===0||!$i(ye[0]))}function ro(ye){return Object.prototype.toString.call(ye)}function Jo(ye){return ro(ye)===to}function Os(ye){return ro(ye)===In}function Fl(ye){return ro(ye)===zs}function zc(ye){return ro(ye)===ti}function Bs(ye){return ro(ye)===jl}function Cu(ye){return ro(ye)===du}function zl(ye){if(!ye)return!1;var Fe=ro(ye);return Us.indexOf(Fe)>=0?!0:Ec(ye)||os(ye)||Vt(ye)}function Ul(ye){return mo[Object.prototype.toString.call(ye)]|0}function af(ye,Fe){var Ot=Fe.length;switch(ye.type){case Dl:case bc:case xc:case rl:var xr=cr.allocType(ye.type,Ot);xr.set(Fe),ye.data=xr;break;case Po:ye.data=qc(Fe);break;default:$.raise("unsupported texture type, must specify a typed array")}}function Uc(ye,Fe){return cr.allocType(ye.type===Po?rl:ye.type,Fe)}function Lo(ye,Fe){ye.type===Po?(ye.data=qc(Fe),cr.freeType(Fe)):ye.data=Fe}function ss(ye,Fe,Ot,xr,Pr,Cr){for(var Er=ye.width,Wr=ye.height,on=ye.channels,en=Er*Wr*on,Yr=Uc(ye,en),cn=0,Tn=0;Tn<Wr;++Tn)for(var dn=0;dn<Er;++dn)for(var nn=0;nn<on;++nn)Yr[cn++]=Fe[Ot*dn+xr*Tn+Pr*nn+Cr];Lo(ye,Yr)}function Pa(ye,Fe,Ot,xr,Pr,Cr){var Er;if(typeof qr[ye]!="undefined"?Er=qr[ye]:Er=Ts[ye]*ll[Fe],Cr&&(Er*=6),Pr){for(var Wr=0,on=Ot;on>=1;)Wr+=Er*on*on,on/=2;return Wr}else return Er*Ot*xr}function eu(ye,Fe,Ot,xr,Pr,Cr,Er){var Wr={"don't care":kn,"dont care":kn,nice:ws,fast:Oi},on={repeat:qs,clamp:_l,mirror:tc},en={nearest:Fs,linear:yf},Yr=m({mipmap:Vu,"nearest mipmap nearest":al,"linear mipmap nearest":wi,"nearest mipmap linear":il,"linear mipmap linear":Vu},en),cn={none:0,browser:Sl},Tn={uint8:Dl,rgba4:tf,rgb565:Jl,"rgb5 a1":mf},dn={alpha:qu,luminance:hu,"luminance alpha":Au,rgb:Nc,rgba:Ll,rgba4:ef,"rgb5 a1":$l,rgb565:Ti},nn={};Fe.ext_srgb&&(dn.srgb=Bu,dn.srgba=xl),Fe.oes_texture_float&&(Tn.float32=Tn.float=rl),Fe.oes_texture_half_float&&(Tn.float16=Tn["half float"]=Po),Fe.webgl_depth_texture&&(m(dn,{depth:Ql,"depth stencil":el}),m(Tn,{uint16:bc,uint32:xc,"depth stencil":kc})),Fe.webgl_compressed_texture_s3tc&&m(nn,{"rgb s3tc dxt1":ql,"rgba s3tc dxt1":Rl,"rgba s3tc dxt3":Il,"rgba s3tc dxt5":jc}),Fe.webgl_compressed_texture_atc&&m(nn,{"rgb atc":El,"rgba atc explicit alpha":Qs,"rgba atc interpolated alpha":eo}),Fe.webgl_compressed_texture_pvrtc&&m(nn,{"rgb pvrtc 4bppv1":vf,"rgb pvrtc 2bppv1":gf,"rgba pvrtc 4bppv1":Tl,"rgba pvrtc 2bppv1":ec}),Fe.webgl_compressed_texture_etc1&&(nn["rgb etc1"]=tl);var Tr=Array.prototype.slice.call(ye.getParameter(bl));Object.keys(nn).forEach(function(d){var c=nn[d];Tr.indexOf(c)>=0&&(dn[d]=c)});var br=Object.keys(dn);Ot.textureFormats=br;var Zr=[];Object.keys(dn).forEach(function(d){var c=dn[d];Zr[c]=d});var wn=[];Object.keys(Tn).forEach(function(d){var c=Tn[d];wn[c]=d});var Rr=[];Object.keys(en).forEach(function(d){var c=en[d];Rr[c]=d});var ta=[];Object.keys(Yr).forEach(function(d){var c=Yr[d];ta[c]=d});var Jr=[];Object.keys(on).forEach(function(d){var c=on[d];Jr[c]=d});var Br=br.reduce(function(d,c){var p=dn[c];return p===hu||p===qu||p===hu||p===Au||p===Ql||p===el||Fe.ext_srgb&&(p===Bu||p===xl)?d[p]=p:p===$l||c.indexOf("rgba")>=0?d[p]=Ll:d[p]=Nc,d},{});function Fr(){this.internalformat=Ll,this.format=Ll,this.type=Dl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Sl,this.width=0,this.height=0,this.channels=0}function Kr(d,c){d.internalformat=c.internalformat,d.format=c.format,d.type=c.type,d.compressed=c.compressed,d.premultiplyAlpha=c.premultiplyAlpha,d.flipY=c.flipY,d.unpackAlignment=c.unpackAlignment,d.colorSpace=c.colorSpace,d.width=c.width,d.height=c.height,d.channels=c.channels}function Hn(d,c){if(typeof c!="object"||!c)return;if("premultiplyAlpha"in c&&($.type(c.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),d.premultiplyAlpha=c.premultiplyAlpha),"flipY"in c&&($.type(c.flipY,"boolean","invalid texture flip"),d.flipY=c.flipY),"alignment"in c&&($.oneOf(c.alignment,[1,2,4,8],"invalid texture unpack alignment"),d.unpackAlignment=c.alignment),"colorSpace"in c&&($.parameter(c.colorSpace,cn,"invalid colorSpace"),d.colorSpace=cn[c.colorSpace]),"type"in c){var p=c.type;$(Fe.oes_texture_float||!(p==="float"||p==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),$(Fe.oes_texture_half_float||!(p==="half float"||p==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),$(Fe.webgl_depth_texture||!(p==="uint16"||p==="uint32"||p==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(p,Tn,"invalid texture type"),d.type=Tn[p]}var T=d.width,j=d.height,I=d.channels,k=!1;"shape"in c?($(Array.isArray(c.shape)&&c.shape.length>=2,"shape must be an array"),T=c.shape[0],j=c.shape[1],c.shape.length===3&&(I=c.shape[2],$(I>0&&I<=4,"invalid number of channels"),k=!0),$(T>=0&&T<=Ot.maxTextureSize,"invalid width"),$(j>=0&&j<=Ot.maxTextureSize,"invalid height")):("radius"in c&&(T=j=c.radius,$(T>=0&&T<=Ot.maxTextureSize,"invalid radius")),"width"in c&&(T=c.width,$(T>=0&&T<=Ot.maxTextureSize,"invalid width")),"height"in c&&(j=c.height,$(j>=0&&j<=Ot.maxTextureSize,"invalid height")),"channels"in c&&(I=c.channels,$(I>0&&I<=4,"invalid number of channels"),k=!0)),d.width=T|0,d.height=j|0,d.channels=I|0;var X=!1;if("format"in c){var ae=c.format;$(Fe.webgl_depth_texture||!(ae==="depth"||ae==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(ae,dn,"invalid texture format");var Je=d.internalformat=dn[ae];d.format=Br[Je],ae in Tn&&("type"in c||(d.type=Tn[ae])),ae in nn&&(d.compressed=!0),X=!0}!k&&X?d.channels=Ts[d.format]:k&&!X?d.channels!==zi[d.format]&&(d.format=d.internalformat=zi[d.channels]):X&&k&&$(d.channels===Ts[d.format],"number of channels inconsistent with specified format")}function aa(d){ye.pixelStorei(ol,d.flipY),ye.pixelStorei(bf,d.premultiplyAlpha),ye.pixelStorei(is,d.colorSpace),ye.pixelStorei(Gu,d.unpackAlignment)}function sn(){Fr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Gr(d,c){var p=null;if(zl(c)?p=c:c&&($.type(c,"object","invalid pixel data type"),Hn(d,c),"x"in c&&(d.xOffset=c.x|0),"y"in c&&(d.yOffset=c.y|0),zl(c.data)&&(p=c.data)),$(!d.compressed||p instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),c.copy){$(!p,"can not specify copy and data field for the same texture");var T=Pr.viewportWidth,j=Pr.viewportHeight;d.width=d.width||T-d.xOffset,d.height=d.height||j-d.yOffset,d.needsCopy=!0,$(d.xOffset>=0&&d.xOffset<T&&d.yOffset>=0&&d.yOffset<j&&d.width>0&&d.width<=T&&d.height>0&&d.height<=j,"copy texture read out of bounds")}else if(!p)d.width=d.width||1,d.height=d.height||1,d.channels=d.channels||4;else if(x(p))d.channels=d.channels||4,d.data=p,!("type"in c)&&d.type===Dl&&(d.type=Ul(p));else if(Ec(p))d.channels=d.channels||4,af(d,p),d.alignment=1,d.needsFree=!0;else if(Vt(p)){var I=p.data;!Array.isArray(I)&&d.type===Dl&&(d.type=Ul(I));var k=p.shape,X=p.stride,ae,Je,Ne,Me,mt,ke;k.length===3?(Ne=k[2],ke=X[2]):($(k.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Ne=1,ke=1),ae=k[0],Je=k[1],Me=X[0],mt=X[1],d.alignment=1,d.width=ae,d.height=Je,d.channels=Ne,d.format=d.internalformat=zi[Ne],d.needsFree=!0,ss(d,I,Me,mt,ke,p.offset)}else if(Jo(p)||Os(p)||Fl(p))Jo(p)||Os(p)?d.element=p:d.element=p.canvas,d.width=d.element.width,d.height=d.element.height,d.channels=4;else if(zc(p))d.element=p,d.width=p.width,d.height=p.height,d.channels=4;else if(Bs(p))d.element=p,d.width=p.naturalWidth,d.height=p.naturalHeight,d.channels=4;else if(Cu(p))d.element=p,d.width=p.videoWidth,d.height=p.videoHeight,d.channels=4;else if(os(p)){var ct=d.width||p[0].length,Be=d.height||p.length,It=d.channels;$i(p[0][0])?It=It||p[0][0].length:It=It||1;for(var $t=Dt.shape(p),ar=1,tr=0;tr<$t.length;++tr)ar*=$t[tr];var pr=Uc(d,ar);Dt.flatten(p,$t,"",pr),Lo(d,pr),d.alignment=1,d.width=ct,d.height=Be,d.channels=It,d.format=d.internalformat=zi[It],d.needsFree=!0}d.type===rl?$(Ot.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):d.type===Po&&$(Ot.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function jr(d,c,p){var T=d.element,j=d.data,I=d.internalformat,k=d.format,X=d.type,ae=d.width,Je=d.height;aa(d),T?ye.texImage2D(c,p,k,k,X,T):d.compressed?ye.compressedTexImage2D(c,p,I,ae,Je,0,j):d.needsCopy?(xr(),ye.copyTexImage2D(c,p,k,d.xOffset,d.yOffset,ae,Je,0)):ye.texImage2D(c,p,k,ae,Je,0,k,X,j||null)}function ha(d,c,p,T,j){var I=d.element,k=d.data,X=d.internalformat,ae=d.format,Je=d.type,Ne=d.width,Me=d.height;aa(d),I?ye.texSubImage2D(c,j,p,T,ae,Je,I):d.compressed?ye.compressedTexSubImage2D(c,j,p,T,X,Ne,Me,k):d.needsCopy?(xr(),ye.copyTexSubImage2D(c,j,p,T,d.xOffset,d.yOffset,Ne,Me)):ye.texSubImage2D(c,j,p,T,Ne,Me,ae,Je,k)}var pa=[];function Un(){return pa.pop()||new sn}function Ua(d){d.needsFree&&cr.freeType(d.data),sn.call(d),pa.push(d)}function Oa(){Fr.call(this),this.genMipmaps=!1,this.mipmapHint=kn,this.mipmask=0,this.images=Array(16)}function Da(d,c,p){var T=d.images[0]=Un();d.mipmask=1,T.width=d.width=c,T.height=d.height=p,T.channels=d.channels=4}function fi(d,c){var p=null;if(zl(c))p=d.images[0]=Un(),Kr(p,d),Gr(p,c),d.mipmask=1;else if(Hn(d,c),Array.isArray(c.mipmap))for(var T=c.mipmap,j=0;j<T.length;++j)p=d.images[j]=Un(),Kr(p,d),p.width>>=j,p.height>>=j,Gr(p,T[j]),d.mipmask|=1<<j;else p=d.images[0]=Un(),Kr(p,d),Gr(p,c),d.mipmask=1;Kr(d,d.images[0]),d.compressed&&(d.internalformat===ql||d.internalformat===Rl||d.internalformat===Il||d.internalformat===jc)&&$(d.width%4===0&&d.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function jo(d,c){for(var p=d.images,T=0;T<p.length;++T){if(!p[T])return;jr(p[T],c,T)}}var ps=[];function ei(){var d=ps.pop()||new Oa;Fr.call(d),d.mipmask=0;for(var c=0;c<16;++c)d.images[c]=null;return d}function co(d){for(var c=d.images,p=0;p<c.length;++p)c[p]&&Ua(c[p]),c[p]=null;ps.push(d)}function Mi(){this.minFilter=Fs,this.magFilter=Fs,this.wrapS=_l,this.wrapT=_l,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=kn}function ms(d,c){if("min"in c){var p=c.min;$.parameter(p,Yr),d.minFilter=Yr[p],ul.indexOf(d.minFilter)>=0&&!("faces"in c)&&(d.genMipmaps=!0)}if("mag"in c){var T=c.mag;$.parameter(T,en),d.magFilter=en[T]}var j=d.wrapS,I=d.wrapT;if("wrap"in c){var k=c.wrap;typeof k=="string"?($.parameter(k,on),j=I=on[k]):Array.isArray(k)&&($.parameter(k[0],on),$.parameter(k[1],on),j=on[k[0]],I=on[k[1]])}else{if("wrapS"in c){var X=c.wrapS;$.parameter(X,on),j=on[X]}if("wrapT"in c){var ae=c.wrapT;$.parameter(ae,on),I=on[ae]}}if(d.wrapS=j,d.wrapT=I,"anisotropic"in c){var Je=c.anisotropic;$(typeof Je=="number"&&Je>=1&&Je<=Ot.maxAnisotropic,"aniso samples must be between 1 and "),d.anisotropic=c.anisotropic}if("mipmap"in c){var Ne=!1;switch(typeof c.mipmap){case"string":$.parameter(c.mipmap,Wr,"invalid mipmap hint"),d.mipmapHint=Wr[c.mipmap],d.genMipmaps=!0,Ne=!0;break;case"boolean":Ne=d.genMipmaps=c.mipmap;break;case"object":$(Array.isArray(c.mipmap),"invalid mipmap type"),d.genMipmaps=!1,Ne=!0;break;default:$.raise("invalid mipmap type")}Ne&&!("min"in c)&&(d.minFilter=al)}}function Wo(d,c){ye.texParameteri(c,nf,d.minFilter),ye.texParameteri(c,Fc,d.magFilter),ye.texParameteri(c,rf,d.wrapS),ye.texParameteri(c,nl,d.wrapT),Fe.ext_texture_filter_anisotropic&&ye.texParameteri(c,Nl,d.anisotropic),d.genMipmaps&&(ye.hint(ui,d.mipmapHint),ye.generateMipmap(c))}var Zo=0,es={},Is=Ot.maxTextureUnits,Wi=Array(Is).map(function(){return null});function ia(d){Fr.call(this),this.mipmask=0,this.internalformat=Ll,this.id=Zo++,this.refCount=1,this.target=d,this.texture=ye.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Mi,Er.profile&&(this.stats={size:0})}function Hs(d){ye.activeTexture(sl),ye.bindTexture(d.target,d.texture)}function xi(){var d=Wi[0];d?ye.bindTexture(d.target,d.texture):ye.bindTexture(as,null)}function An(d){var c=d.texture;$(c,"must not double destroy texture");var p=d.unit,T=d.target;p>=0&&(ye.activeTexture(sl+p),ye.bindTexture(T,null),Wi[p]=null),ye.deleteTexture(c),d.texture=null,d.params=null,d.pixels=null,d.refCount=0,delete es[d.id],Cr.textureCount--}m(ia.prototype,{bind:function(){var c=this;c.bindCount+=1;var p=c.unit;if(p<0){for(var T=0;T<Is;++T){var j=Wi[T];if(j){if(j.bindCount>0)continue;j.unit=-1}Wi[T]=c,p=T;break}p>=Is&&$.raise("insufficient number of texture units"),Er.profile&&Cr.maxTextureUnits<p+1&&(Cr.maxTextureUnits=p+1),c.unit=p,ye.activeTexture(sl+p),ye.bindTexture(c.target,c.texture)}return p},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&An(this)}});function Ra(d,c){var p=new ia(as);es[p.id]=p,Cr.textureCount++;function T(k,X){var ae=p.texInfo;Mi.call(ae);var Je=ei();return typeof k=="number"?typeof X=="number"?Da(Je,k|0,X|0):Da(Je,k|0,k|0):k?($.type(k,"object","invalid arguments to regl.texture"),ms(ae,k),fi(Je,k)):Da(Je,1,1),ae.genMipmaps&&(Je.mipmask=(Je.width<<1)-1),p.mipmask=Je.mipmask,Kr(p,Je),$.texture2D(ae,Je,Ot),p.internalformat=Je.internalformat,T.width=Je.width,T.height=Je.height,Hs(p),jo(Je,as),Wo(ae,as),xi(),co(Je),Er.profile&&(p.stats.size=Pa(p.internalformat,p.type,Je.width,Je.height,ae.genMipmaps,!1)),T.format=Zr[p.internalformat],T.type=wn[p.type],T.mag=Rr[ae.magFilter],T.min=ta[ae.minFilter],T.wrapS=Jr[ae.wrapS],T.wrapT=Jr[ae.wrapT],T}function j(k,X,ae,Je){$(!!k,"must specify image data");var Ne=X|0,Me=ae|0,mt=Je|0,ke=Un();return Kr(ke,p),ke.width=0,ke.height=0,Gr(ke,k),ke.width=ke.width||(p.width>>mt)-Ne,ke.height=ke.height||(p.height>>mt)-Me,$(p.type===ke.type&&p.format===ke.format&&p.internalformat===ke.internalformat,"incompatible format for texture.subimage"),$(Ne>=0&&Me>=0&&Ne+ke.width<=p.width&&Me+ke.height<=p.height,"texture.subimage write out of bounds"),$(p.mipmask&1<<mt,"missing mipmap data"),$(ke.data||ke.element||ke.needsCopy,"missing image data"),Hs(p),ha(ke,as,Ne,Me,mt),xi(),Ua(ke),T}function I(k,X){var ae=k|0,Je=X|0||ae;if(ae===p.width&&Je===p.height)return T;T.width=p.width=ae,T.height=p.height=Je,Hs(p);for(var Ne=0;p.mipmask>>Ne;++Ne){var Me=ae>>Ne,mt=Je>>Ne;if(!Me||!mt)break;ye.texImage2D(as,Ne,p.format,Me,mt,0,p.format,p.type,null)}return xi(),Er.profile&&(p.stats.size=Pa(p.internalformat,p.type,ae,Je,!1,!1)),T}return T(d,c),T.subimage=j,T.resize=I,T._reglType="texture2d",T._texture=p,Er.profile&&(T.stats=p.stats),T.destroy=function(){p.decRef()},T}function Ba(d,c,p,T,j,I){var k=new ia(Dc);es[k.id]=k,Cr.cubeCount++;var X=new Array(6);function ae(Me,mt,ke,ct,Be,It){var $t,ar=k.texInfo;for(Mi.call(ar),$t=0;$t<6;++$t)X[$t]=ei();if(typeof Me=="number"||!Me){var tr=Me|0||1;for($t=0;$t<6;++$t)Da(X[$t],tr,tr)}else if(typeof Me=="object")if(mt)fi(X[0],Me),fi(X[1],mt),fi(X[2],ke),fi(X[3],ct),fi(X[4],Be),fi(X[5],It);else if(ms(ar,Me),Hn(k,Me),"faces"in Me){var pr=Me.faces;for($(Array.isArray(pr)&&pr.length===6,"cube faces must be a length 6 array"),$t=0;$t<6;++$t)$(typeof pr[$t]=="object"&&!!pr[$t],"invalid input for cube map face"),Kr(X[$t],k),fi(X[$t],pr[$t])}else for($t=0;$t<6;++$t)fi(X[$t],Me);else $.raise("invalid arguments to cube map");for(Kr(k,X[0]),Ot.npotTextureCube||$(Su(k.width)&&Su(k.height),"your browser does not support non power or two texture dimensions"),ar.genMipmaps?k.mipmask=(X[0].width<<1)-1:k.mipmask=X[0].mipmask,$.textureCube(k,ar,X,Ot),k.internalformat=X[0].internalformat,ae.width=X[0].width,ae.height=X[0].height,Hs(k),$t=0;$t<6;++$t)jo(X[$t],yc+$t);for(Wo(ar,Dc),xi(),Er.profile&&(k.stats.size=Pa(k.internalformat,k.type,ae.width,ae.height,ar.genMipmaps,!0)),ae.format=Zr[k.internalformat],ae.type=wn[k.type],ae.mag=Rr[ar.magFilter],ae.min=ta[ar.minFilter],ae.wrapS=Jr[ar.wrapS],ae.wrapT=Jr[ar.wrapT],$t=0;$t<6;++$t)co(X[$t]);return ae}function Je(Me,mt,ke,ct,Be){$(!!mt,"must specify image data"),$(typeof Me=="number"&&Me===(Me|0)&&Me>=0&&Me<6,"invalid face");var It=ke|0,$t=ct|0,ar=Be|0,tr=Un();return Kr(tr,k),tr.width=0,tr.height=0,Gr(tr,mt),tr.width=tr.width||(k.width>>ar)-It,tr.height=tr.height||(k.height>>ar)-$t,$(k.type===tr.type&&k.format===tr.format&&k.internalformat===tr.internalformat,"incompatible format for texture.subimage"),$(It>=0&&$t>=0&&It+tr.width<=k.width&&$t+tr.height<=k.height,"texture.subimage write out of bounds"),$(k.mipmask&1<<ar,"missing mipmap data"),$(tr.data||tr.element||tr.needsCopy,"missing image data"),Hs(k),ha(tr,yc+Me,It,$t,ar),xi(),Ua(tr),ae}function Ne(Me){var mt=Me|0;if(mt===k.width)return;ae.width=k.width=mt,ae.height=k.height=mt,Hs(k);for(var ke=0;ke<6;++ke)for(var ct=0;k.mipmask>>ct;++ct)ye.texImage2D(yc+ke,ct,k.format,mt>>ct,mt>>ct,0,k.format,k.type,null);return xi(),Er.profile&&(k.stats.size=Pa(k.internalformat,k.type,ae.width,ae.height,!1,!0)),ae}return ae(d,c,p,T,j,I),ae.subimage=Je,ae.resize=Ne,ae._reglType="textureCube",ae._texture=k,Er.profile&&(ae.stats=k.stats),ae.destroy=function(){k.decRef()},ae}function Xo(){for(var d=0;d<Is;++d)ye.activeTexture(sl+d),ye.bindTexture(as,null),Wi[d]=null;Re(es).forEach(An),Cr.cubeCount=0,Cr.textureCount=0}Er.profile&&(Cr.getTotalTextureSize=function(){var d=0;return Object.keys(es).forEach(function(c){d+=es[c].stats.size}),d});function gu(){for(var d=0;d<Is;++d){var c=Wi[d];c&&(c.bindCount=0,c.unit=-1,Wi[d]=null)}Re(es).forEach(function(p){p.texture=ye.createTexture(),ye.bindTexture(p.target,p.texture);for(var T=0;T<32;++T){if((p.mipmask&1<<T)===0)continue;if(p.target===as)ye.texImage2D(as,T,p.internalformat,p.width>>T,p.height>>T,0,p.internalformat,p.type,null);else for(var j=0;j<6;++j)ye.texImage2D(yc+j,T,p.internalformat,p.width>>T,p.height>>T,0,p.internalformat,p.type,null)}Wo(p.texInfo,p.target)})}function O(){for(var d=0;d<Is;++d){var c=Wi[d];c&&(c.bindCount=0,c.unit=-1,Wi[d]=null),ye.activeTexture(sl+d),ye.bindTexture(as,null),ye.bindTexture(Dc,null)}}return{create2D:Ra,createCube:Ba,clear:Xo,getTexture:function(c){return null},restore:gu,refresh:O}}var Ro=36161,To=32854,Al=32855,cl=36194,pu=33189,_s=36168,Tc=34041,Jn=35907,jn=34836,_c=34842,us=34843,Io=[];Io[To]=2,Io[Al]=2,Io[cl]=2,Io[pu]=2,Io[_s]=1,Io[Tc]=4,Io[Jn]=4,Io[jn]=16,Io[_c]=8,Io[us]=6;function vo(ye,Fe,Ot){return Io[ye]*Fe*Ot}var Ss=function(Fe,Ot,xr,Pr,Cr){var Er={rgba4:To,rgb565:cl,"rgb5 a1":Al,depth:pu,stencil:_s,"depth stencil":Tc};Ot.ext_srgb&&(Er.srgba=Jn),Ot.ext_color_buffer_half_float&&(Er.rgba16f=_c,Er.rgb16f=us),Ot.webgl_color_buffer_float&&(Er.rgba32f=jn);var Wr=[];Object.keys(Er).forEach(function(nn){var Tr=Er[nn];Wr[Tr]=nn});var on=0,en={};function Yr(nn){this.id=on++,this.refCount=1,this.renderbuffer=nn,this.format=To,this.width=0,this.height=0,Cr.profile&&(this.stats={size:0})}Yr.prototype.decRef=function(){--this.refCount<=0&&cn(this)};function cn(nn){var Tr=nn.renderbuffer;$(Tr,"must not double destroy renderbuffer"),Fe.bindRenderbuffer(Ro,null),Fe.deleteRenderbuffer(Tr),nn.renderbuffer=null,nn.refCount=0,delete en[nn.id],Pr.renderbufferCount--}function Tn(nn,Tr){var br=new Yr(Fe.createRenderbuffer());en[br.id]=br,Pr.renderbufferCount++;function Zr(Rr,ta){var Jr=0,Br=0,Fr=To;if(typeof Rr=="object"&&Rr){var Kr=Rr;if("shape"in Kr){var Hn=Kr.shape;$(Array.isArray(Hn)&&Hn.length>=2,"invalid renderbuffer shape"),Jr=Hn[0]|0,Br=Hn[1]|0}else"radius"in Kr&&(Jr=Br=Kr.radius|0),"width"in Kr&&(Jr=Kr.width|0),"height"in Kr&&(Br=Kr.height|0);"format"in Kr&&($.parameter(Kr.format,Er,"invalid renderbuffer format"),Fr=Er[Kr.format])}else typeof Rr=="number"?(Jr=Rr|0,typeof ta=="number"?Br=ta|0:Br=Jr):Rr?$.raise("invalid arguments to renderbuffer constructor"):Jr=Br=1;return $(Jr>0&&Br>0&&Jr<=xr.maxRenderbufferSize&&Br<=xr.maxRenderbufferSize,"invalid renderbuffer size"),Jr===br.width&&Br===br.height&&Fr===br.format?void 0:(Zr.width=br.width=Jr,Zr.height=br.height=Br,br.format=Fr,Fe.bindRenderbuffer(Ro,br.renderbuffer),Fe.renderbufferStorage(Ro,Fr,Jr,Br),$(Fe.getError()===0,"invalid render buffer format"),Cr.profile&&(br.stats.size=vo(br.format,br.width,br.height)),Zr.format=Wr[br.format],Zr)}function wn(Rr,ta){var Jr=Rr|0,Br=ta|0||Jr;return Jr===br.width&&Br===br.height||($(Jr>0&&Br>0&&Jr<=xr.maxRenderbufferSize&&Br<=xr.maxRenderbufferSize,"invalid renderbuffer size"),Zr.width=br.width=Jr,Zr.height=br.height=Br,Fe.bindRenderbuffer(Ro,br.renderbuffer),Fe.renderbufferStorage(Ro,br.format,Jr,Br),$(Fe.getError()===0,"invalid render buffer format"),Cr.profile&&(br.stats.size=vo(br.format,br.width,br.height))),Zr}return Zr(nn,Tr),Zr.resize=wn,Zr._reglType="renderbuffer",Zr._renderbuffer=br,Cr.profile&&(Zr.stats=br.stats),Zr.destroy=function(){br.decRef()},Zr}Cr.profile&&(Pr.getTotalRenderbufferSize=function(){var nn=0;return Object.keys(en).forEach(function(Tr){nn+=en[Tr].stats.size}),nn});function dn(){Re(en).forEach(function(nn){nn.renderbuffer=Fe.createRenderbuffer(),Fe.bindRenderbuffer(Ro,nn.renderbuffer),Fe.renderbufferStorage(Ro,nn.format,nn.width,nn.height)}),Fe.bindRenderbuffer(Ro,null)}return{create:Tn,clear:function(){Re(en).forEach(cn)},restore:dn}},wu=36160,rc=36161,Ka=3553,no=34069,fl=36064,mu=36096,hl=36128,Ou=33306,Ms=36053,Bc=36054,Vs=36055,xf=36057,Bl=36061,Vl=36193,Sc=5121,ls=5126,Hu=6407,Vc=6408,Cl=6402,Wu=[Hu,Vc],nc=[];nc[Vc]=4,nc[Hu]=3;var Zu=[];Zu[Sc]=1,Zu[ls]=4,Zu[Vl]=2;var Ps=32854,of=32855,ac=36194,ic=33189,oc=36168,s=34041,a=35907,n=34836,l=34842,g=34843,w=[Ps,of,ac,a,l,g,n],L={};L[Ms]="complete",L[Bc]="incomplete attachment",L[xf]="incomplete dimensions",L[Vs]="incomplete, missing attachment",L[Bl]="unsupported";function F(ye,Fe,Ot,xr,Pr,Cr){var Er={cur:null,next:null,dirty:!1,setFBO:null},Wr=["rgba"],on=["rgba4","rgb565","rgb5 a1"];Fe.ext_srgb&&on.push("srgba"),Fe.ext_color_buffer_half_float&&on.push("rgba16f","rgb16f"),Fe.webgl_color_buffer_float&&on.push("rgba32f");var en=["uint8"];Fe.oes_texture_half_float&&en.push("half float","float16"),Fe.oes_texture_float&&en.push("float","float32");function Yr(sn,Gr,jr){this.target=sn,this.texture=Gr,this.renderbuffer=jr;var ha=0,pa=0;Gr?(ha=Gr.width,pa=Gr.height):jr&&(ha=jr.width,pa=jr.height),this.width=ha,this.height=pa}function cn(sn){sn&&(sn.texture&&sn.texture._texture.decRef(),sn.renderbuffer&&sn.renderbuffer._renderbuffer.decRef())}function Tn(sn,Gr,jr){if(!sn)return;if(sn.texture){var ha=sn.texture._texture,pa=Math.max(1,ha.width),Un=Math.max(1,ha.height);$(pa===Gr&&Un===jr,"inconsistent width/height for supplied texture"),ha.refCount+=1}else{var Ua=sn.renderbuffer._renderbuffer;$(Ua.width===Gr&&Ua.height===jr,"inconsistent width/height for renderbuffer"),Ua.refCount+=1}}function dn(sn,Gr){Gr&&(Gr.texture?ye.framebufferTexture2D(wu,sn,Gr.target,Gr.texture._texture.texture,0):ye.framebufferRenderbuffer(wu,sn,rc,Gr.renderbuffer._renderbuffer.renderbuffer))}function nn(sn){var Gr=Ka,jr=null,ha=null,pa=sn;typeof sn=="object"&&(pa=sn.data,"target"in sn&&(Gr=sn.target|0)),$.type(pa,"function","invalid attachment data");var Un=pa._reglType;return Un==="texture2d"?(jr=pa,$(Gr===Ka)):Un==="textureCube"?(jr=pa,$(Gr>=no&&Gr<no+6,"invalid cube map target")):Un==="renderbuffer"?(ha=pa,Gr=rc):$.raise("invalid regl object for attachment"),new Yr(Gr,jr,ha)}function Tr(sn,Gr,jr,ha,pa){if(jr){var Un=xr.create2D({width:sn,height:Gr,format:ha,type:pa});return Un._texture.refCount=0,new Yr(Ka,Un,null)}else{var Ua=Pr.create({width:sn,height:Gr,format:ha});return Ua._renderbuffer.refCount=0,new Yr(rc,null,Ua)}}function br(sn){return sn&&(sn.texture||sn.renderbuffer)}function Zr(sn,Gr,jr){sn&&(sn.texture?sn.texture.resize(Gr,jr):sn.renderbuffer&&sn.renderbuffer.resize(Gr,jr),sn.width=Gr,sn.height=jr)}var wn=0,Rr={};function ta(){this.id=wn++,Rr[this.id]=this,this.framebuffer=ye.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Jr(sn){sn.colorAttachments.forEach(cn),cn(sn.depthAttachment),cn(sn.stencilAttachment),cn(sn.depthStencilAttachment)}function Br(sn){var Gr=sn.framebuffer;$(Gr,"must not double destroy framebuffer"),ye.deleteFramebuffer(Gr),sn.framebuffer=null,Cr.framebufferCount--,delete Rr[sn.id]}function Fr(sn){var Gr;ye.bindFramebuffer(wu,sn.framebuffer);var jr=sn.colorAttachments;for(Gr=0;Gr<jr.length;++Gr)dn(fl+Gr,jr[Gr]);for(Gr=jr.length;Gr<Ot.maxColorAttachments;++Gr)ye.framebufferTexture2D(wu,fl+Gr,Ka,null,0);ye.framebufferTexture2D(wu,Ou,Ka,null,0),ye.framebufferTexture2D(wu,mu,Ka,null,0),ye.framebufferTexture2D(wu,hl,Ka,null,0),dn(mu,sn.depthAttachment),dn(hl,sn.stencilAttachment),dn(Ou,sn.depthStencilAttachment);var ha=ye.checkFramebufferStatus(wu);!ye.isContextLost()&&ha!==Ms&&$.raise("framebuffer configuration not supported, status = "+L[ha]),ye.bindFramebuffer(wu,Er.next?Er.next.framebuffer:null),Er.cur=Er.next,ye.getError()}function Kr(sn,Gr){var jr=new ta;Cr.framebufferCount++;function ha(Un,Ua){var Oa;$(Er.next!==jr,"can not update framebuffer which is currently in use");var Da=0,fi=0,jo=!0,ps=!0,ei=null,co=!0,Mi="rgba",ms="uint8",Wo=1,Zo=null,es=null,Is=null,Wi=!1;if(typeof Un=="number")Da=Un|0,fi=Ua|0||Da;else if(!Un)Da=fi=1;else{$.type(Un,"object","invalid arguments for framebuffer");var ia=Un;if("shape"in ia){var Hs=ia.shape;$(Array.isArray(Hs)&&Hs.length>=2,"invalid shape for framebuffer"),Da=Hs[0],fi=Hs[1]}else"radius"in ia&&(Da=fi=ia.radius),"width"in ia&&(Da=ia.width),"height"in ia&&(fi=ia.height);("color"in ia||"colors"in ia)&&(ei=ia.color||ia.colors,Array.isArray(ei)&&$(ei.length===1||Fe.webgl_draw_buffers,"multiple render targets not supported")),ei||("colorCount"in ia&&(Wo=ia.colorCount|0,$(Wo>0,"invalid color buffer count")),"colorTexture"in ia&&(co=!!ia.colorTexture,Mi="rgba4"),"colorType"in ia&&(ms=ia.colorType,co?($(Fe.oes_texture_float||!(ms==="float"||ms==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),$(Fe.oes_texture_half_float||!(ms==="half float"||ms==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):ms==="half float"||ms==="float16"?($(Fe.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Mi="rgba16f"):(ms==="float"||ms==="float32")&&($(Fe.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Mi="rgba32f"),$.oneOf(ms,en,"invalid color type")),"colorFormat"in ia&&(Mi=ia.colorFormat,Wr.indexOf(Mi)>=0?co=!0:on.indexOf(Mi)>=0?co=!1:co?$.oneOf(ia.colorFormat,Wr,"invalid color format for texture"):$.oneOf(ia.colorFormat,on,"invalid color format for renderbuffer"))),("depthTexture"in ia||"depthStencilTexture"in ia)&&(Wi=!!(ia.depthTexture||ia.depthStencilTexture),$(!Wi||Fe.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ia&&(typeof ia.depth=="boolean"?jo=ia.depth:(Zo=ia.depth,ps=!1)),"stencil"in ia&&(typeof ia.stencil=="boolean"?ps=ia.stencil:(es=ia.stencil,jo=!1)),"depthStencil"in ia&&(typeof ia.depthStencil=="boolean"?jo=ps=ia.depthStencil:(Is=ia.depthStencil,jo=!1,ps=!1))}var xi=null,An=null,Ra=null,Ba=null;if(Array.isArray(ei))xi=ei.map(nn);else if(ei)xi=[nn(ei)];else for(xi=new Array(Wo),Oa=0;Oa<Wo;++Oa)xi[Oa]=Tr(Da,fi,co,Mi,ms);$(Fe.webgl_draw_buffers||xi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),$(xi.length<=Ot.maxColorAttachments,"too many color attachments, not supported"),Da=Da||xi[0].width,fi=fi||xi[0].height,Zo?An=nn(Zo):jo&&!ps&&(An=Tr(Da,fi,Wi,"depth","uint32")),es?Ra=nn(es):ps&&!jo&&(Ra=Tr(Da,fi,!1,"stencil","uint8")),Is?Ba=nn(Is):!Zo&&!es&&ps&&jo&&(Ba=Tr(Da,fi,Wi,"depth stencil","depth stencil")),$(!!Zo+!!es+!!Is<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Xo=null;for(Oa=0;Oa<xi.length;++Oa)if(Tn(xi[Oa],Da,fi),$(!xi[Oa]||xi[Oa].texture&&Wu.indexOf(xi[Oa].texture._texture.format)>=0||xi[Oa].renderbuffer&&w.indexOf(xi[Oa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Oa+" is invalid"),xi[Oa]&&xi[Oa].texture){var gu=nc[xi[Oa].texture._texture.format]*Zu[xi[Oa].texture._texture.type];Xo===null?Xo=gu:$(Xo===gu,"all color attachments much have the same number of bits per pixel.")}return Tn(An,Da,fi),$(!An||An.texture&&An.texture._texture.format===Cl||An.renderbuffer&&An.renderbuffer._renderbuffer.format===ic,"invalid depth attachment for framebuffer object"),Tn(Ra,Da,fi),$(!Ra||Ra.renderbuffer&&Ra.renderbuffer._renderbuffer.format===oc,"invalid stencil attachment for framebuffer object"),Tn(Ba,Da,fi),$(!Ba||Ba.texture&&Ba.texture._texture.format===s||Ba.renderbuffer&&Ba.renderbuffer._renderbuffer.format===s,"invalid depth-stencil attachment for framebuffer object"),Jr(jr),jr.width=Da,jr.height=fi,jr.colorAttachments=xi,jr.depthAttachment=An,jr.stencilAttachment=Ra,jr.depthStencilAttachment=Ba,ha.color=xi.map(br),ha.depth=br(An),ha.stencil=br(Ra),ha.depthStencil=br(Ba),ha.width=jr.width,ha.height=jr.height,Fr(jr),ha}function pa(Un,Ua){$(Er.next!==jr,"can not resize a framebuffer which is currently in use");var Oa=Math.max(Un|0,1),Da=Math.max(Ua|0||Oa,1);if(Oa===jr.width&&Da===jr.height)return ha;for(var fi=jr.colorAttachments,jo=0;jo<fi.length;++jo)Zr(fi[jo],Oa,Da);return Zr(jr.depthAttachment,Oa,Da),Zr(jr.stencilAttachment,Oa,Da),Zr(jr.depthStencilAttachment,Oa,Da),jr.width=ha.width=Oa,jr.height=ha.height=Da,Fr(jr),ha}return ha(sn,Gr),m(ha,{resize:pa,_reglType:"framebuffer",_framebuffer:jr,destroy:function(){Br(jr),Jr(jr)},use:function(Ua){Er.setFBO({framebuffer:ha},Ua)}})}function Hn(sn){var Gr=Array(6);function jr(pa){var Un;$(Gr.indexOf(Er.next)<0,"can not update framebuffer which is currently in use");var Ua={color:null},Oa=0,Da=null,fi="rgba",jo="uint8",ps=1;if(typeof pa=="number")Oa=pa|0;else if(!pa)Oa=1;else{$.type(pa,"object","invalid arguments for framebuffer");var ei=pa;if("shape"in ei){var co=ei.shape;$(Array.isArray(co)&&co.length>=2,"invalid shape for framebuffer"),$(co[0]===co[1],"cube framebuffer must be square"),Oa=co[0]}else"radius"in ei&&(Oa=ei.radius|0),"width"in ei?(Oa=ei.width|0,"height"in ei&&$(ei.height===Oa,"must be square")):"height"in ei&&(Oa=ei.height|0);("color"in ei||"colors"in ei)&&(Da=ei.color||ei.colors,Array.isArray(Da)&&$(Da.length===1||Fe.webgl_draw_buffers,"multiple render targets not supported")),Da||("colorCount"in ei&&(ps=ei.colorCount|0,$(ps>0,"invalid color buffer count")),"colorType"in ei&&($.oneOf(ei.colorType,en,"invalid color type"),jo=ei.colorType),"colorFormat"in ei&&(fi=ei.colorFormat,$.oneOf(ei.colorFormat,Wr,"invalid color format for texture"))),"depth"in ei&&(Ua.depth=ei.depth),"stencil"in ei&&(Ua.stencil=ei.stencil),"depthStencil"in ei&&(Ua.depthStencil=ei.depthStencil)}var Mi;if(Da)if(Array.isArray(Da))for(Mi=[],Un=0;Un<Da.length;++Un)Mi[Un]=Da[Un];else Mi=[Da];else{Mi=Array(ps);var ms={radius:Oa,format:fi,type:jo};for(Un=0;Un<ps;++Un)Mi[Un]=xr.createCube(ms)}for(Ua.color=Array(Mi.length),Un=0;Un<Mi.length;++Un){var Wo=Mi[Un];$(typeof Wo=="function"&&Wo._reglType==="textureCube","invalid cube map"),Oa=Oa||Wo.width,$(Wo.width===Oa&&Wo.height===Oa,"invalid cube map shape"),Ua.color[Un]={target:no,data:Mi[Un]}}for(Un=0;Un<6;++Un){for(var Zo=0;Zo<Mi.length;++Zo)Ua.color[Zo].target=no+Un;Un>0&&(Ua.depth=Gr[0].depth,Ua.stencil=Gr[0].stencil,Ua.depthStencil=Gr[0].depthStencil),Gr[Un]?Gr[Un](Ua):Gr[Un]=Kr(Ua)}return m(jr,{width:Oa,height:Oa,color:Mi})}function ha(pa){var Un,Ua=pa|0;if($(Ua>0&&Ua<=Ot.maxCubeMapSize,"invalid radius for cube fbo"),Ua===jr.width)return jr;var Oa=jr.color;for(Un=0;Un<Oa.length;++Un)Oa[Un].resize(Ua);for(Un=0;Un<6;++Un)Gr[Un].resize(Ua);return jr.width=jr.height=Ua,jr}return jr(sn),m(jr,{faces:Gr,resize:ha,_reglType:"framebufferCube",destroy:function(){Gr.forEach(function(Un){Un.destroy()})}})}function aa(){Er.cur=null,Er.next=null,Er.dirty=!0,Re(Rr).forEach(function(sn){sn.framebuffer=ye.createFramebuffer(),Fr(sn)})}return m(Er,{getFramebuffer:function(Gr){if(typeof Gr=="function"&&Gr._reglType==="framebuffer"){var jr=Gr._framebuffer;if(jr instanceof ta)return jr}return null},create:Kr,createCube:Hn,clear:function(){Re(Rr).forEach(Br)},restore:aa})}var ue=5126,Ee=34962;function $e(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ue,this.offset=0,this.stride=0,this.divisor=0}function rt(ye,Fe,Ot,xr,Pr){for(var Cr=Ot.maxAttributes,Er=new Array(Cr),Wr=0;Wr<Cr;++Wr)Er[Wr]=new $e;var on=0,en={},Yr={Record:$e,scope:{},state:Er,currentVAO:null,targetVAO:null,restore:Tn()?Rr:function(){},createVAO:ta,getVAO:nn,destroyBuffer:cn,setVAO:Tn()?Tr:br,clear:Tn()?Zr:function(){}};function cn(Jr){for(var Br=0;Br<Er.length;++Br){var Fr=Er[Br];Fr.buffer===Jr&&(ye.disableVertexAttribArray(Br),Fr.buffer=null)}}function Tn(){return Fe.oes_vertex_array_object}function dn(){return Fe.angle_instanced_arrays}function nn(Jr){return typeof Jr=="function"&&Jr._vao?Jr._vao:null}function Tr(Jr){if(Jr===Yr.currentVAO)return;var Br=Tn();Jr?Br.bindVertexArrayOES(Jr.vao):Br.bindVertexArrayOES(null),Yr.currentVAO=Jr}function br(Jr){if(Jr===Yr.currentVAO)return;if(Jr)Jr.bindAttrs();else for(var Br=dn(),Fr=0;Fr<Er.length;++Fr){var Kr=Er[Fr];Kr.buffer?(ye.enableVertexAttribArray(Fr),ye.vertexAttribPointer(Fr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offfset),Br&&Kr.divisor&&Br.vertexAttribDivisorANGLE(Fr,Kr.divisor)):(ye.disableVertexAttribArray(Fr),ye.vertexAttrib4f(Fr,Kr.x,Kr.y,Kr.z,Kr.w))}Yr.currentVAO=Jr}function Zr(){Re(en).forEach(function(Jr){Jr.destroy()})}function wn(){this.id=++on,this.attributes=[];var Jr=Tn();Jr?this.vao=Jr.createVertexArrayOES():this.vao=null,en[this.id]=this,this.buffers=[]}wn.prototype.bindAttrs=function(){for(var Jr=dn(),Br=this.attributes,Fr=0;Fr<Br.length;++Fr){var Kr=Br[Fr];Kr.buffer?(ye.enableVertexAttribArray(Fr),ye.bindBuffer(Ee,Kr.buffer.buffer),ye.vertexAttribPointer(Fr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offset),Jr&&Kr.divisor&&Jr.vertexAttribDivisorANGLE(Fr,Kr.divisor)):(ye.disableVertexAttribArray(Fr),ye.vertexAttrib4f(Fr,Kr.x,Kr.y,Kr.z,Kr.w))}for(var Hn=Br.length;Hn<Cr;++Hn)ye.disableVertexAttribArray(Hn)},wn.prototype.refresh=function(){var Jr=Tn();Jr&&(Jr.bindVertexArrayOES(this.vao),this.bindAttrs(),Yr.currentVAO=this)},wn.prototype.destroy=function(){if(this.vao){var Jr=Tn();this===Yr.currentVAO&&(Yr.currentVAO=null,Jr.bindVertexArrayOES(null)),Jr.deleteVertexArrayOES(this.vao),this.vao=null}en[this.id]&&(delete en[this.id],xr.vaoCount-=1)};function Rr(){var Jr=Tn();Jr&&Re(en).forEach(function(Br){Br.refresh()})}function ta(Jr){var Br=new wn;xr.vaoCount+=1;function Fr(Kr){$(Array.isArray(Kr),"arguments to vertex array constructor must be an array"),$(Kr.length<Cr,"too many attributes"),$(Kr.length>0,"must specify at least one attribute");var Hn={},aa=Br.attributes;aa.length=Kr.length;for(var sn=0;sn<Kr.length;++sn){var Gr=Kr[sn],jr=aa[sn]=new $e,ha=Gr.data||Gr;if(Array.isArray(ha)||x(ha)||Vt(ha)){var pa;Br.buffers[sn]&&(pa=Br.buffers[sn],x(ha)&&pa._buffer.byteLength>=ha.byteLength?pa.subdata(ha):(pa.destroy(),Br.buffers[sn]=null)),Br.buffers[sn]||(pa=Br.buffers[sn]=Pr.create(Gr,Ee,!1,!0)),jr.buffer=Pr.getBuffer(pa),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1,Hn[sn]=1}else Pr.getBuffer(Gr)?(jr.buffer=Pr.getBuffer(Gr),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1):Pr.getBuffer(Gr.buffer)?(jr.buffer=Pr.getBuffer(Gr.buffer),jr.size=(+Gr.size||jr.buffer.dimension)|0,jr.normalized=!!Gr.normalized||!1,"type"in Gr?($.parameter(Gr.type,Eo,"invalid buffer type"),jr.type=Eo[Gr.type]):jr.type=jr.buffer.dtype,jr.offset=(Gr.offset||0)|0,jr.stride=(Gr.stride||0)|0,jr.divisor=(Gr.divisor||0)|0,jr.state=1,$(jr.size>=1&&jr.size<=4,"size must be between 1 and 4"),$(jr.offset>=0,"invalid offset"),$(jr.stride>=0&&jr.stride<=255,"stride must be between 0 and 255"),$(jr.divisor>=0,"divisor must be positive"),$(!jr.divisor||!!Fe.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Gr?($(sn>0,"first attribute must not be a constant"),jr.x=+Gr.x||0,jr.y=+Gr.y||0,jr.z=+Gr.z||0,jr.w=+Gr.w||0,jr.state=2):$(!1,"invalid attribute spec for location "+sn)}for(var Un=0;Un<Br.buffers.length;++Un)!Hn[Un]&&Br.buffers[Un]&&(Br.buffers[Un].destroy(),Br.buffers[Un]=null);return Br.refresh(),Fr}return Fr.destroy=function(){for(var Kr=0;Kr<Br.buffers.length;++Kr)Br.buffers[Kr]&&Br.buffers[Kr].destroy();Br.buffers.length=0,Br.destroy()},Fr._vao=Br,Fr._reglType="vao",Fr(Jr)}return Yr}var nt=35632,Ft=35633,Nt=35718,Kt=35721;function jt(ye,Fe,Ot,xr){var Pr={},Cr={};function Er(Tr,br,Zr,wn){this.name=Tr,this.id=br,this.location=Zr,this.info=wn}function Wr(Tr,br){for(var Zr=0;Zr<Tr.length;++Zr)if(Tr[Zr].id===br.id){Tr[Zr].location=br.location;return}Tr.push(br)}function on(Tr,br,Zr){var wn=Tr===nt?Pr:Cr,Rr=wn[br];if(!Rr){var ta=Fe.str(br);Rr=ye.createShader(Tr),ye.shaderSource(Rr,ta),ye.compileShader(Rr),$.shaderError(ye,Rr,ta,Tr,Zr),wn[br]=Rr}return Rr}var en={},Yr=[],cn=0;function Tn(Tr,br){this.id=cn++,this.fragId=Tr,this.vertId=br,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,xr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function dn(Tr,br,Zr){var wn,Rr,ta=on(nt,Tr.fragId),Jr=on(Ft,Tr.vertId),Br=Tr.program=ye.createProgram();if(ye.attachShader(Br,ta),ye.attachShader(Br,Jr),Zr)for(wn=0;wn<Zr.length;++wn){var Fr=Zr[wn];ye.bindAttribLocation(Br,Fr[0],Fr[1])}ye.linkProgram(Br),$.linkError(ye,Br,Fe.str(Tr.fragId),Fe.str(Tr.vertId),br);var Kr=ye.getProgramParameter(Br,Nt);xr.profile&&(Tr.stats.uniformsCount=Kr);var Hn=Tr.uniforms;for(wn=0;wn<Kr;++wn)if(Rr=ye.getActiveUniform(Br,wn),Rr)if(Rr.size>1)for(var aa=0;aa<Rr.size;++aa){var sn=Rr.name.replace("[0]","["+aa+"]");Wr(Hn,new Er(sn,Fe.id(sn),ye.getUniformLocation(Br,sn),Rr))}else Wr(Hn,new Er(Rr.name,Fe.id(Rr.name),ye.getUniformLocation(Br,Rr.name),Rr));var Gr=ye.getProgramParameter(Br,Kt);xr.profile&&(Tr.stats.attributesCount=Gr);var jr=Tr.attributes;for(wn=0;wn<Gr;++wn)Rr=ye.getActiveAttrib(Br,wn),Rr&&Wr(jr,new Er(Rr.name,Fe.id(Rr.name),ye.getAttribLocation(Br,Rr.name),Rr))}xr.profile&&(Ot.getMaxUniformsCount=function(){var Tr=0;return Yr.forEach(function(br){br.stats.uniformsCount>Tr&&(Tr=br.stats.uniformsCount)}),Tr},Ot.getMaxAttributesCount=function(){var Tr=0;return Yr.forEach(function(br){br.stats.attributesCount>Tr&&(Tr=br.stats.attributesCount)}),Tr});function nn(){Pr={},Cr={};for(var Tr=0;Tr<Yr.length;++Tr)dn(Yr[Tr],null,Yr[Tr].attributes.map(function(br){return[br.location,br.name]}))}return{clear:function(){var br=ye.deleteShader.bind(ye);Re(Pr).forEach(br),Pr={},Re(Cr).forEach(br),Cr={},Yr.forEach(function(Zr){ye.deleteProgram(Zr.program)}),Yr.length=0,en={},Ot.shaderCount=0},program:function(br,Zr,wn,Rr){$.command(br>=0,"missing vertex shader",wn),$.command(Zr>=0,"missing fragment shader",wn);var ta=en[Zr];ta||(ta=en[Zr]={});var Jr=ta[br];if(Jr&&(Jr.refCount++,!Rr))return Jr;var Br=new Tn(Zr,br);return Ot.shaderCount++,dn(Br,wn,Rr),Jr||(ta[br]=Br),Yr.push(Br),m(Br,{destroy:function(){if(Br.refCount--,Br.refCount<=0){ye.deleteProgram(Br.program);var Kr=Yr.indexOf(Br);Yr.splice(Kr,1),Ot.shaderCount--}ta[Br.vertId].refCount<=0&&(ye.deleteShader(Cr[Br.vertId]),delete Cr[Br.vertId],delete en[Br.fragId][Br.vertId]),Object.keys(en[Br.fragId]).length||(ye.deleteShader(Pr[Br.fragId]),delete Pr[Br.fragId],delete en[Br.fragId])}})},restore:nn,shader:on,frag:-1,vert:-1}}var Gt=6408,nr=5121,rr=3333,Lr=5126;function vr(ye,Fe,Ot,xr,Pr,Cr,Er){function Wr(Yr){var cn;Fe.next===null?($(Pr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),cn=nr):($(Fe.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),cn=Fe.next.colorAttachments[0].texture._texture.type,Cr.oes_texture_float?($(cn===nr||cn===Lr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),cn===Lr&&$(Er.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):$(cn===nr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Tn=0,dn=0,nn=xr.framebufferWidth,Tr=xr.framebufferHeight,br=null;x(Yr)?br=Yr:Yr&&($.type(Yr,"object","invalid arguments to regl.read()"),Tn=Yr.x|0,dn=Yr.y|0,$(Tn>=0&&Tn<xr.framebufferWidth,"invalid x offset for regl.read"),$(dn>=0&&dn<xr.framebufferHeight,"invalid y offset for regl.read"),nn=(Yr.width||xr.framebufferWidth-Tn)|0,Tr=(Yr.height||xr.framebufferHeight-dn)|0,br=Yr.data||null),br&&(cn===nr?$(br instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):cn===Lr&&$(br instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),$(nn>0&&nn+Tn<=xr.framebufferWidth,"invalid width for read pixels"),$(Tr>0&&Tr+dn<=xr.framebufferHeight,"invalid height for read pixels"),Ot();var Zr=nn*Tr*4;return br||(cn===nr?br=new Uint8Array(Zr):cn===Lr&&(br=br||new Float32Array(Zr))),$.isTypedArray(br,"data buffer for regl.read() must be a typedarray"),$(br.byteLength>=Zr,"data buffer for regl.read() too small"),ye.pixelStorei(rr,4),ye.readPixels(Tn,dn,nn,Tr,Gt,cn,br),br}function on(Yr){var cn;return Fe.setFBO({framebuffer:Yr.framebuffer},function(){cn=Wr(Yr)}),cn}function en(Yr){return!Yr||!("framebuffer"in Yr)?Wr(Yr):on(Yr)}return en}function Sr(ye){return Array.prototype.slice.call(ye)}function Ar(ye){return Sr(ye).join("")}function rn(){var ye=0,Fe=[],Ot=[];function xr(cn){for(var Tn=0;Tn<Ot.length;++Tn)if(Ot[Tn]===cn)return Fe[Tn];var dn="g"+ye++;return Fe.push(dn),Ot.push(cn),dn}function Pr(){var cn=[];function Tn(){cn.push.apply(cn,Sr(arguments))}var dn=[];function nn(){var Tr="v"+ye++;return dn.push(Tr),arguments.length>0&&(cn.push(Tr,"="),cn.push.apply(cn,Sr(arguments)),cn.push(";")),Tr}return m(Tn,{def:nn,toString:function(){return Ar([dn.length>0?"var "+dn.join(",")+";":"",Ar(cn)])}})}function Cr(){var cn=Pr(),Tn=Pr(),dn=cn.toString,nn=Tn.toString;function Tr(br,Zr){Tn(br,Zr,"=",cn.def(br,Zr),";")}return m(function(){cn.apply(cn,Sr(arguments))},{def:cn.def,entry:cn,exit:Tn,save:Tr,set:function(Zr,wn,Rr){Tr(Zr,wn),cn(Zr,wn,"=",Rr,";")},toString:function(){return dn()+nn()}})}function Er(){var cn=Ar(arguments),Tn=Cr(),dn=Cr(),nn=Tn.toString,Tr=dn.toString;return m(Tn,{then:function(){return Tn.apply(Tn,Sr(arguments)),this},else:function(){return dn.apply(dn,Sr(arguments)),this},toString:function(){var Zr=Tr();return Zr&&(Zr="else{"+Zr+"}"),Ar(["if(",cn,"){",nn(),"}",Zr])}})}var Wr=Pr(),on={};function en(cn,Tn){var dn=[];function nn(){var Rr="a"+dn.length;return dn.push(Rr),Rr}Tn=Tn||0;for(var Tr=0;Tr<Tn;++Tr)nn();var br=Cr(),Zr=br.toString,wn=on[cn]=m(br,{arg:nn,toString:function(){return Ar(["function(",dn.join(),"){",Zr(),"}"])}});return wn}function Yr(){var cn=['"use strict";',Wr,"return {"];Object.keys(on).forEach(function(nn){cn.push('"',nn,'":',on[nn].toString(),",")}),cn.push("}");var Tn=Ar(cn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),dn=Function.apply(null,Fe.concat(Tn));return dn.apply(null,Ot)}return{global:Wr,link:xr,block:Pr,proc:en,scope:Cr,cond:Er,compile:Yr}}var Xr="xyzw".split(""),mn=5121,Ln=1,qn=2,sa=0,Sa=1,Wa=2,Sn=3,ua=4,ba=5,Wn=6,Aa="dither",na="blend.enable",La="blend.color",za="blend.equation",Gi="blend.func",_i="depth.enable",Di="depth.func",gi="depth.range",Ui="depth.mask",Qo="colorMask",qo="cull.enable",vu="cull.face",Mu="frontFace",cs="lineWidth",Gs="polygonOffset.enable",Pu="polygonOffset.offset",sc="sample.alpha",tu="sample.enable",Xu="sample.coverage",uc="stencil.enable",ru="stencil.mask",Lu="stencil.func",fs="stencil.opFront",ao="stencil.opBack",Yu="scissor.enable",Gl="scissor.box",hs="viewport",Do="profile",No="framebuffer",Ho="vert",_o="frag",uo="elements",Ls="primitive",nu="count",Hl="offset",Gc="instances",dl="vao",lc="Width",pl="Height",Rs=No+lc,go=No+pl,Ac=hs+lc,ds=hs+pl,sf="drawingBuffer",Cf=sf+lc,wf=sf+pl,Cc=[Gi,za,Lu,fs,ao,Xu,hs,Gl,Pu],Ku=34962,Ef=34963,uf=35632,Of=35633,Ru=3553,cc=34067,Df=2884,Hc=3042,wc=3024,Qf=2960,qf=2929,eh=3089,th=32823,Mf=32926,rh=32928,Wl=5126,lf=35664,io=35665,fc=35666,Tf=5124,Oc=35667,au=35668,wl=35669,_f=35670,Nf=35671,Wc=35672,cf=35673,Zc=35674,ml=35675,re=35676,se=35678,N=35680,G=4,Ae=1028,ft=1029,Xt=2304,sr=2305,or=32775,Ir=32776,an=519,Gn=7680,ea=0,la=1,qa=32774,Fa=513,yi=36160,Ja=36064,Bi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},So=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],yo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Hi={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ko={frag:uf,vert:Of},Qa={cw:Xt,ccw:sr};function lo(ye){return Array.isArray(ye)||x(ye)||Vt(ye)}function iu(ye){return ye.sort(function(Fe,Ot){return Fe===hs?-1:Ot===hs?1:Fe<Ot?-1:1})}function bi(ye,Fe,Ot,xr){this.thisDep=ye,this.contextDep=Fe,this.propDep=Ot,this.append=xr}function Ni(ye){return ye&&!(ye.thisDep||ye.contextDep||ye.propDep)}function xa(ye){return new bi(!1,!1,!1,ye)}function Ao(ye,Fe){var Ot=ye.type;if(Ot===sa){var xr=ye.data.length;return new bi(!0,xr>=1,xr>=2,Fe)}else if(Ot===ua){var Pr=ye.data;return new bi(Pr.thisDep,Pr.contextDep,Pr.propDep,Fe)}else{if(Ot===ba)return new bi(!1,!1,!1,Fe);if(Ot===Wn){for(var Cr=!1,Er=!1,Wr=!1,on=0;on<ye.data.length;++on){var en=ye.data[on];if(en.type===Sa)Wr=!0;else if(en.type===Wa)Er=!0;else if(en.type===Sn)Cr=!0;else if(en.type===sa){Cr=!0;var Yr=en.data;Yr>=1&&(Er=!0),Yr>=2&&(Wr=!0)}else en.type===ua&&(Cr=Cr||en.data.thisDep,Er=Er||en.data.contextDep,Wr=Wr||en.data.propDep)}return new bi(Cr,Er,Wr,Fe)}else return new bi(Ot===Sn,Ot===Wa,Ot===Sa,Fe)}}var hc=new bi(!1,!1,!1,function(){});function kf(ye,Fe,Ot,xr,Pr,Cr,Er,Wr,on,en,Yr,cn,Tn,dn,nn){var Tr=en.Record,br={add:32774,subtract:32778,"reverse subtract":32779};Ot.ext_blend_minmax&&(br.min=or,br.max=Ir);var Zr=Ot.angle_instanced_arrays,wn=Ot.webgl_draw_buffers,Rr={dirty:!0,profile:nn.profile},ta={},Jr=[],Br={},Fr={};function Kr(I){return I.replace(".","_")}function Hn(I,k,X){var ae=Kr(I);Jr.push(I),ta[ae]=Rr[ae]=!!X,Br[ae]=k}function aa(I,k,X){var ae=Kr(I);Jr.push(I),Array.isArray(X)?(Rr[ae]=X.slice(),ta[ae]=X.slice()):Rr[ae]=ta[ae]=X,Fr[ae]=k}Hn(Aa,wc),Hn(na,Hc),aa(La,"blendColor",[0,0,0,0]),aa(za,"blendEquationSeparate",[qa,qa]),aa(Gi,"blendFuncSeparate",[la,ea,la,ea]),Hn(_i,qf,!0),aa(Di,"depthFunc",Fa),aa(gi,"depthRange",[0,1]),aa(Ui,"depthMask",!0),aa(Qo,Qo,[!0,!0,!0,!0]),Hn(qo,Df),aa(vu,"cullFace",ft),aa(Mu,Mu,sr),aa(cs,cs,1),Hn(Gs,th),aa(Pu,"polygonOffset",[0,0]),Hn(sc,Mf),Hn(tu,rh),aa(Xu,"sampleCoverage",[1,!1]),Hn(uc,Qf),aa(ru,"stencilMask",-1),aa(Lu,"stencilFunc",[an,0,-1]),aa(fs,"stencilOpSeparate",[Ae,Gn,Gn,Gn]),aa(ao,"stencilOpSeparate",[ft,Gn,Gn,Gn]),Hn(Yu,eh),aa(Gl,"scissor",[0,0,ye.drawingBufferWidth,ye.drawingBufferHeight]),aa(hs,hs,[0,0,ye.drawingBufferWidth,ye.drawingBufferHeight]);var sn={gl:ye,context:Tn,strings:Fe,next:ta,current:Rr,draw:cn,elements:Cr,buffer:Pr,shader:Yr,attributes:en.state,vao:en,uniforms:on,framebuffer:Wr,extensions:Ot,timer:dn,isBufferArgs:lo},Gr={primTypes:pi,compareFuncs:yo,blendFuncs:Bi,blendEquations:br,stencilOps:Hi,glTypes:Eo,orientationType:Qa};$.optional(function(){sn.isArrayLike=$i}),wn&&(Gr.backBuffer=[ft],Gr.drawBuffer=Z(xr.maxDrawbuffers,function(I){return I===0?[0]:Z(I,function(k){return Ja+k})}));var jr=0;function ha(){var I=rn(),k=I.link,X=I.global;I.id=jr++,I.batchId="0";var ae=k(sn),Je=I.shared={props:"a0"};Object.keys(sn).forEach(function(ct){Je[ct]=X.def(ae,".",ct)}),$.optional(function(){I.CHECK=k($),I.commandStr=$.guessCommand(),I.command=k(I.commandStr),I.assert=function(ct,Be,It){ct("if(!(",Be,"))",this.CHECK,".commandRaise(",k(It),",",this.command,");")},Gr.invalidBlendCombinations=So});var Ne=I.next={},Me=I.current={};Object.keys(Fr).forEach(function(ct){Array.isArray(Rr[ct])&&(Ne[ct]=X.def(Je.next,".",ct),Me[ct]=X.def(Je.current,".",ct))});var mt=I.constants={};Object.keys(Gr).forEach(function(ct){mt[ct]=X.def(JSON.stringify(Gr[ct]))}),I.invoke=function(ct,Be){switch(Be.type){case sa:var It=["this",Je.context,Je.props,I.batchId];return ct.def(k(Be.data),".call(",It.slice(0,Math.max(Be.data.length+1,4)),")");case Sa:return ct.def(Je.props,Be.data);case Wa:return ct.def(Je.context,Be.data);case Sn:return ct.def("this",Be.data);case ua:return Be.data.append(I,ct),Be.data.ref;case ba:return Be.data.toString();case Wn:return Be.data.map(function($t){return I.invoke(ct,$t)})}},I.attribCache={};var ke={};return I.scopeAttrib=function(ct){var Be=Fe.id(ct);if(Be in ke)return ke[Be];var It=en.scope[Be];It||(It=en.scope[Be]=new Tr);var $t=ke[Be]=k(It);return $t},I}function pa(I){var k=I.static,X=I.dynamic,ae;if(Do in k){var Je=!!k[Do];ae=xa(function(Me,mt){return Je}),ae.enable=Je}else if(Do in X){var Ne=X[Do];ae=Ao(Ne,function(Me,mt){return Me.invoke(mt,Ne)})}return ae}function Un(I,k){var X=I.static,ae=I.dynamic;if(No in X){var Je=X[No];return Je?(Je=Wr.getFramebuffer(Je),$.command(Je,"invalid framebuffer object"),xa(function(Me,mt){var ke=Me.link(Je),ct=Me.shared;mt.set(ct.framebuffer,".next",ke);var Be=ct.context;return mt.set(Be,"."+Rs,ke+".width"),mt.set(Be,"."+go,ke+".height"),ke})):xa(function(Me,mt){var ke=Me.shared;mt.set(ke.framebuffer,".next","null");var ct=ke.context;return mt.set(ct,"."+Rs,ct+"."+Cf),mt.set(ct,"."+go,ct+"."+wf),"null"})}else if(No in ae){var Ne=ae[No];return Ao(Ne,function(Me,mt){var ke=Me.invoke(mt,Ne),ct=Me.shared,Be=ct.framebuffer,It=mt.def(Be,".getFramebuffer(",ke,")");$.optional(function(){Me.assert(mt,"!"+ke+"||"+It,"invalid framebuffer object")}),mt.set(Be,".next",It);var $t=ct.context;return mt.set($t,"."+Rs,It+"?"+It+".width:"+$t+"."+Cf),mt.set($t,"."+go,It+"?"+It+".height:"+$t+"."+wf),It})}else return null}function Ua(I,k,X){var ae=I.static,Je=I.dynamic;function Ne(ke){if(ke in ae){var ct=ae[ke];$.commandType(ct,"object","invalid "+ke,X.commandStr);var Be=!0,It=ct.x|0,$t=ct.y|0,ar,tr;return"width"in ct?(ar=ct.width|0,$.command(ar>=0,"invalid "+ke,X.commandStr)):Be=!1,"height"in ct?(tr=ct.height|0,$.command(tr>=0,"invalid "+ke,X.commandStr)):Be=!1,new bi(!Be&&k&&k.thisDep,!Be&&k&&k.contextDep,!Be&&k&&k.propDep,function($r,Cn){var un=$r.shared.context,_n=ar;"width"in ct||(_n=Cn.def(un,".",Rs,"-",It));var Kn=tr;return"height"in ct||(Kn=Cn.def(un,".",go,"-",$t)),[It,$t,_n,Kn]})}else if(ke in Je){var pr=Je[ke],wr=Ao(pr,function($r,Cn){var un=$r.invoke(Cn,pr);$.optional(function(){$r.assert(Cn,un+"&&typeof "+un+'==="object"',"invalid "+ke)});var _n=$r.shared.context,Kn=Cn.def(un,".x|0"),ka=Cn.def(un,".y|0"),Ei=Cn.def('"width" in ',un,"?",un,".width|0:","(",_n,".",Rs,"-",Kn,")"),Pi=Cn.def('"height" in ',un,"?",un,".height|0:","(",_n,".",go,"-",ka,")");return $.optional(function(){$r.assert(Cn,Ei+">=0&&"+Pi+">=0","invalid "+ke)}),[Kn,ka,Ei,Pi]});return k&&(wr.thisDep=wr.thisDep||k.thisDep,wr.contextDep=wr.contextDep||k.contextDep,wr.propDep=wr.propDep||k.propDep),wr}else return k?new bi(k.thisDep,k.contextDep,k.propDep,function($r,Cn){var un=$r.shared.context;return[0,0,Cn.def(un,".",Rs),Cn.def(un,".",go)]}):null}var Me=Ne(hs);if(Me){var mt=Me;Me=new bi(Me.thisDep,Me.contextDep,Me.propDep,function(ke,ct){var Be=mt.append(ke,ct),It=ke.shared.context;return ct.set(It,"."+Ac,Be[2]),ct.set(It,"."+ds,Be[3]),Be})}return{viewport:Me,scissor_box:Ne(Gl)}}function Oa(I,k){var X=I.static,ae=typeof X[_o]=="string"&&typeof X[Ho]=="string";if(ae){if(Object.keys(k.dynamic).length>0)return null;var Je=k.static,Ne=Object.keys(Je);if(Ne.length>0&&typeof Je[Ne[0]]=="number"){for(var Me=[],mt=0;mt<Ne.length;++mt)$(typeof Je[Ne[mt]]=="number","must specify all vertex attribute locations when using vaos"),Me.push([Je[Ne[mt]]|0,Ne[mt]]);return Me}}return null}function Da(I,k,X){var ae=I.static,Je=I.dynamic;function Ne(Be){if(Be in ae){var It=Fe.id(ae[Be]);$.optional(function(){Yr.shader(ko[Be],It,$.guessCommand())});var $t=xa(function(){return It});return $t.id=It,$t}else if(Be in Je){var ar=Je[Be];return Ao(ar,function(tr,pr){var wr=tr.invoke(pr,ar),$r=pr.def(tr.shared.strings,".id(",wr,")");return $.optional(function(){pr(tr.shared.shader,".shader(",ko[Be],",",$r,",",tr.command,");")}),$r})}return null}var Me=Ne(_o),mt=Ne(Ho),ke=null,ct;return Ni(Me)&&Ni(mt)?(ke=Yr.program(mt.id,Me.id,null,X),ct=xa(function(Be,It){return Be.link(ke)})):ct=new bi(Me&&Me.thisDep||mt&&mt.thisDep,Me&&Me.contextDep||mt&&mt.contextDep,Me&&Me.propDep||mt&&mt.propDep,function(Be,It){var $t=Be.shared.shader,ar;Me?ar=Me.append(Be,It):ar=It.def($t,".",_o);var tr;mt?tr=mt.append(Be,It):tr=It.def($t,".",Ho);var pr=$t+".program("+tr+","+ar;return $.optional(function(){pr+=","+Be.command}),It.def(pr+")")}),{frag:Me,vert:mt,progVar:ct,program:ke}}function fi(I,k){var X=I.static,ae=I.dynamic;function Je(){if(uo in X){var Be=X[uo];lo(Be)?Be=Cr.getElements(Cr.create(Be,!0)):Be&&(Be=Cr.getElements(Be),$.command(Be,"invalid elements",k.commandStr));var It=xa(function(ar,tr){if(Be){var pr=ar.link(Be);return ar.ELEMENTS=pr,pr}return ar.ELEMENTS=null,null});return It.value=Be,It}else if(uo in ae){var $t=ae[uo];return Ao($t,function(ar,tr){var pr=ar.shared,wr=pr.isBufferArgs,$r=pr.elements,Cn=ar.invoke(tr,$t),un=tr.def("null"),_n=tr.def(wr,"(",Cn,")"),Kn=ar.cond(_n).then(un,"=",$r,".createStream(",Cn,");").else(un,"=",$r,".getElements(",Cn,");");return $.optional(function(){ar.assert(Kn.else,"!"+Cn+"||"+un,"invalid elements")}),tr.entry(Kn),tr.exit(ar.cond(_n).then($r,".destroyStream(",un,");")),ar.ELEMENTS=un,un})}return null}var Ne=Je();function Me(){if(Ls in X){var Be=X[Ls];return $.commandParameter(Be,pi,"invalid primitve",k.commandStr),xa(function($t,ar){return pi[Be]})}else if(Ls in ae){var It=ae[Ls];return Ao(It,function($t,ar){var tr=$t.constants.primTypes,pr=$t.invoke(ar,It);return $.optional(function(){$t.assert(ar,pr+" in "+tr,"invalid primitive, must be one of "+Object.keys(pi))}),ar.def(tr,"[",pr,"]")})}else if(Ne)return Ni(Ne)?Ne.value?xa(function($t,ar){return ar.def($t.ELEMENTS,".primType")}):xa(function(){return G}):new bi(Ne.thisDep,Ne.contextDep,Ne.propDep,function($t,ar){var tr=$t.ELEMENTS;return ar.def(tr,"?",tr,".primType:",G)});return null}function mt(Be,It){if(Be in X){var $t=X[Be]|0;return $.command(!It||$t>=0,"invalid "+Be,k.commandStr),xa(function(tr,pr){return It&&(tr.OFFSET=$t),$t})}else if(Be in ae){var ar=ae[Be];return Ao(ar,function(tr,pr){var wr=tr.invoke(pr,ar);return It&&(tr.OFFSET=wr,$.optional(function(){tr.assert(pr,wr+">=0","invalid "+Be)})),wr})}else if(It&&Ne)return xa(function(tr,pr){return tr.OFFSET="0",0});return null}var ke=mt(Hl,!0);function ct(){if(nu in X){var Be=X[nu]|0;return $.command(typeof Be=="number"&&Be>=0,"invalid vertex count",k.commandStr),xa(function(){return Be})}else if(nu in ae){var It=ae[nu];return Ao(It,function(tr,pr){var wr=tr.invoke(pr,It);return $.optional(function(){tr.assert(pr,"typeof "+wr+'==="number"&&'+wr+">=0&&"+wr+"===("+wr+"|0)","invalid vertex count")}),wr})}else if(Ne)if(Ni(Ne)){if(Ne)return ke?new bi(ke.thisDep,ke.contextDep,ke.propDep,function(tr,pr){var wr=pr.def(tr.ELEMENTS,".vertCount-",tr.OFFSET);return $.optional(function(){tr.assert(pr,wr+">=0","invalid vertex offset/element buffer too small")}),wr}):xa(function(tr,pr){return pr.def(tr.ELEMENTS,".vertCount")});var $t=xa(function(){return-1});return $.optional(function(){$t.MISSING=!0}),$t}else{var ar=new bi(Ne.thisDep||ke.thisDep,Ne.contextDep||ke.contextDep,Ne.propDep||ke.propDep,function(tr,pr){var wr=tr.ELEMENTS;return tr.OFFSET?pr.def(wr,"?",wr,".vertCount-",tr.OFFSET,":-1"):pr.def(wr,"?",wr,".vertCount:-1")});return $.optional(function(){ar.DYNAMIC=!0}),ar}return null}return{elements:Ne,primitive:Me(),count:ct(),instances:mt(Gc,!1),offset:ke}}function jo(I,k){var X=I.static,ae=I.dynamic,Je={};return Jr.forEach(function(Ne){var Me=Kr(Ne);function mt(ke,ct){if(Ne in X){var Be=ke(X[Ne]);Je[Me]=xa(function(){return Be})}else if(Ne in ae){var It=ae[Ne];Je[Me]=Ao(It,function($t,ar){return ct($t,ar,$t.invoke(ar,It))})}}switch(Ne){case qo:case na:case Aa:case uc:case _i:case Yu:case Gs:case sc:case tu:case Ui:return mt(function(ke){return $.commandType(ke,"boolean",Ne,k.commandStr),ke},function(ke,ct,Be){return $.optional(function(){ke.assert(ct,"typeof "+Be+'==="boolean"',"invalid flag "+Ne,ke.commandStr)}),Be});case Di:return mt(function(ke){return $.commandParameter(ke,yo,"invalid "+Ne,k.commandStr),yo[ke]},function(ke,ct,Be){var It=ke.constants.compareFuncs;return $.optional(function(){ke.assert(ct,Be+" in "+It,"invalid "+Ne+", must be one of "+Object.keys(yo))}),ct.def(It,"[",Be,"]")});case gi:return mt(function(ke){return $.command($i(ke)&&ke.length===2&&typeof ke[0]=="number"&&typeof ke[1]=="number"&&ke[0]<=ke[1],"depth range is 2d array",k.commandStr),ke},function(ke,ct,Be){$.optional(function(){ke.assert(ct,ke.shared.isArrayLike+"("+Be+")&&"+Be+".length===2&&typeof "+Be+'[0]==="number"&&typeof '+Be+'[1]==="number"&&'+Be+"[0]<="+Be+"[1]","depth range must be a 2d array")});var It=ct.def("+",Be,"[0]"),$t=ct.def("+",Be,"[1]");return[It,$t]});case Gi:return mt(function(ke){$.commandType(ke,"object","blend.func",k.commandStr);var ct="srcRGB"in ke?ke.srcRGB:ke.src,Be="srcAlpha"in ke?ke.srcAlpha:ke.src,It="dstRGB"in ke?ke.dstRGB:ke.dst,$t="dstAlpha"in ke?ke.dstAlpha:ke.dst;return $.commandParameter(ct,Bi,Me+".srcRGB",k.commandStr),$.commandParameter(Be,Bi,Me+".srcAlpha",k.commandStr),$.commandParameter(It,Bi,Me+".dstRGB",k.commandStr),$.commandParameter($t,Bi,Me+".dstAlpha",k.commandStr),$.command(So.indexOf(ct+", "+It)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+ct+", "+It+")",k.commandStr),[Bi[ct],Bi[It],Bi[Be],Bi[$t]]},function(ke,ct,Be){var It=ke.constants.blendFuncs;$.optional(function(){ke.assert(ct,Be+"&&typeof "+Be+'==="object"',"invalid blend func, must be an object")});function $t(un,_n){var Kn=ct.def('"',un,_n,'" in ',Be,"?",Be,".",un,_n,":",Be,".",un);return $.optional(function(){ke.assert(ct,Kn+" in "+It,"invalid "+Ne+"."+un+_n+", must be one of "+Object.keys(Bi))}),Kn}var ar=$t("src","RGB"),tr=$t("dst","RGB");$.optional(function(){var un=ke.constants.invalidBlendCombinations;ke.assert(ct,un+".indexOf("+ar+'+", "+'+tr+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var pr=ct.def(It,"[",ar,"]"),wr=ct.def(It,"[",$t("src","Alpha"),"]"),$r=ct.def(It,"[",tr,"]"),Cn=ct.def(It,"[",$t("dst","Alpha"),"]");return[pr,$r,wr,Cn]});case za:return mt(function(ke){if(typeof ke=="string")return $.commandParameter(ke,br,"invalid "+Ne,k.commandStr),[br[ke],br[ke]];if(typeof ke=="object")return $.commandParameter(ke.rgb,br,Ne+".rgb",k.commandStr),$.commandParameter(ke.alpha,br,Ne+".alpha",k.commandStr),[br[ke.rgb],br[ke.alpha]];$.commandRaise("invalid blend.equation",k.commandStr)},function(ke,ct,Be){var It=ke.constants.blendEquations,$t=ct.def(),ar=ct.def(),tr=ke.cond("typeof ",Be,'==="string"');return $.optional(function(){function pr(wr,$r,Cn){ke.assert(wr,Cn+" in "+It,"invalid "+$r+", must be one of "+Object.keys(br))}pr(tr.then,Ne,Be),ke.assert(tr.else,Be+"&&typeof "+Be+'==="object"',"invalid "+Ne),pr(tr.else,Ne+".rgb",Be+".rgb"),pr(tr.else,Ne+".alpha",Be+".alpha")}),tr.then($t,"=",ar,"=",It,"[",Be,"];"),tr.else($t,"=",It,"[",Be,".rgb];",ar,"=",It,"[",Be,".alpha];"),ct(tr),[$t,ar]});case La:return mt(function(ke){return $.command($i(ke)&&ke.length===4,"blend.color must be a 4d array",k.commandStr),Z(4,function(ct){return+ke[ct]})},function(ke,ct,Be){return $.optional(function(){ke.assert(ct,ke.shared.isArrayLike+"("+Be+")&&"+Be+".length===4","blend.color must be a 4d array")}),Z(4,function(It){return ct.def("+",Be,"[",It,"]")})});case ru:return mt(function(ke){return $.commandType(ke,"number",Me,k.commandStr),ke|0},function(ke,ct,Be){return $.optional(function(){ke.assert(ct,"typeof "+Be+'==="number"',"invalid stencil.mask")}),ct.def(Be,"|0")});case Lu:return mt(function(ke){$.commandType(ke,"object",Me,k.commandStr);var ct=ke.cmp||"keep",Be=ke.ref||0,It="mask"in ke?ke.mask:-1;return $.commandParameter(ct,yo,Ne+".cmp",k.commandStr),$.commandType(Be,"number",Ne+".ref",k.commandStr),$.commandType(It,"number",Ne+".mask",k.commandStr),[yo[ct],Be,It]},function(ke,ct,Be){var It=ke.constants.compareFuncs;$.optional(function(){function pr(){ke.assert(ct,Array.prototype.join.call(arguments,""),"invalid stencil.func")}pr(Be+"&&typeof ",Be,'==="object"'),pr('!("cmp" in ',Be,")||(",Be,".cmp in ",It,")")});var $t=ct.def('"cmp" in ',Be,"?",It,"[",Be,".cmp]",":",Gn),ar=ct.def(Be,".ref|0"),tr=ct.def('"mask" in ',Be,"?",Be,".mask|0:-1");return[$t,ar,tr]});case fs:case ao:return mt(function(ke){$.commandType(ke,"object",Me,k.commandStr);var ct=ke.fail||"keep",Be=ke.zfail||"keep",It=ke.zpass||"keep";return $.commandParameter(ct,Hi,Ne+".fail",k.commandStr),$.commandParameter(Be,Hi,Ne+".zfail",k.commandStr),$.commandParameter(It,Hi,Ne+".zpass",k.commandStr),[Ne===ao?ft:Ae,Hi[ct],Hi[Be],Hi[It]]},function(ke,ct,Be){var It=ke.constants.stencilOps;$.optional(function(){ke.assert(ct,Be+"&&typeof "+Be+'==="object"',"invalid "+Ne)});function $t(ar){return $.optional(function(){ke.assert(ct,'!("'+ar+'" in '+Be+")||("+Be+"."+ar+" in "+It+")","invalid "+Ne+"."+ar+", must be one of "+Object.keys(Hi))}),ct.def('"',ar,'" in ',Be,"?",It,"[",Be,".",ar,"]:",Gn)}return[Ne===ao?ft:Ae,$t("fail"),$t("zfail"),$t("zpass")]});case Pu:return mt(function(ke){$.commandType(ke,"object",Me,k.commandStr);var ct=ke.factor|0,Be=ke.units|0;return $.commandType(ct,"number",Me+".factor",k.commandStr),$.commandType(Be,"number",Me+".units",k.commandStr),[ct,Be]},function(ke,ct,Be){$.optional(function(){ke.assert(ct,Be+"&&typeof "+Be+'==="object"',"invalid "+Ne)});var It=ct.def(Be,".factor|0"),$t=ct.def(Be,".units|0");return[It,$t]});case vu:return mt(function(ke){var ct=0;return ke==="front"?ct=Ae:ke==="back"&&(ct=ft),$.command(!!ct,Me,k.commandStr),ct},function(ke,ct,Be){return $.optional(function(){ke.assert(ct,Be+'==="front"||'+Be+'==="back"',"invalid cull.face")}),ct.def(Be,'==="front"?',Ae,":",ft)});case cs:return mt(function(ke){return $.command(typeof ke=="number"&&ke>=xr.lineWidthDims[0]&&ke<=xr.lineWidthDims[1],"invalid line width, must be a positive number between "+xr.lineWidthDims[0]+" and "+xr.lineWidthDims[1],k.commandStr),ke},function(ke,ct,Be){return $.optional(function(){ke.assert(ct,"typeof "+Be+'==="number"&&'+Be+">="+xr.lineWidthDims[0]+"&&"+Be+"<="+xr.lineWidthDims[1],"invalid line width")}),Be});case Mu:return mt(function(ke){return $.commandParameter(ke,Qa,Me,k.commandStr),Qa[ke]},function(ke,ct,Be){return $.optional(function(){ke.assert(ct,Be+'==="cw"||'+Be+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ct.def(Be+'==="cw"?'+Xt+":"+sr)});case Qo:return mt(function(ke){return $.command($i(ke)&&ke.length===4,"color.mask must be length 4 array",k.commandStr),ke.map(function(ct){return!!ct})},function(ke,ct,Be){return $.optional(function(){ke.assert(ct,ke.shared.isArrayLike+"("+Be+")&&"+Be+".length===4","invalid color.mask")}),Z(4,function(It){return"!!"+Be+"["+It+"]"})});case Xu:return mt(function(ke){$.command(typeof ke=="object"&&ke,Me,k.commandStr);var ct="value"in ke?ke.value:1,Be=!!ke.invert;return $.command(typeof ct=="number"&&ct>=0&&ct<=1,"sample.coverage.value must be a number between 0 and 1",k.commandStr),[ct,Be]},function(ke,ct,Be){$.optional(function(){ke.assert(ct,Be+"&&typeof "+Be+'==="object"',"invalid sample.coverage")});var It=ct.def('"value" in ',Be,"?+",Be,".value:1"),$t=ct.def("!!",Be,".invert");return[It,$t]})}}),Je}function ps(I,k){var X=I.static,ae=I.dynamic,Je={};return Object.keys(X).forEach(function(Ne){var Me=X[Ne],mt;if(typeof Me=="number"||typeof Me=="boolean")mt=xa(function(){return Me});else if(typeof Me=="function"){var ke=Me._reglType;ke==="texture2d"||ke==="textureCube"?mt=xa(function(ct){return ct.link(Me)}):ke==="framebuffer"||ke==="framebufferCube"?($.command(Me.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ne+'"',k.commandStr),mt=xa(function(ct){return ct.link(Me.color[0])})):$.commandRaise('invalid data for uniform "'+Ne+'"',k.commandStr)}else $i(Me)?mt=xa(function(ct){var Be=ct.global.def("[",Z(Me.length,function(It){return $.command(typeof Me[It]=="number"||typeof Me[It]=="boolean","invalid uniform "+Ne,ct.commandStr),Me[It]}),"]");return Be}):$.commandRaise('invalid or missing data for uniform "'+Ne+'"',k.commandStr);mt.value=Me,Je[Ne]=mt}),Object.keys(ae).forEach(function(Ne){var Me=ae[Ne];Je[Ne]=Ao(Me,function(mt,ke){return mt.invoke(ke,Me)})}),Je}function ei(I,k){var X=I.static,ae=I.dynamic,Je={};return Object.keys(X).forEach(function(Ne){var Me=X[Ne],mt=Fe.id(Ne),ke=new Tr;if(lo(Me))ke.state=Ln,ke.buffer=Pr.getBuffer(Pr.create(Me,Ku,!1,!0)),ke.type=0;else{var ct=Pr.getBuffer(Me);if(ct)ke.state=Ln,ke.buffer=ct,ke.type=0;else if($.command(typeof Me=="object"&&Me,"invalid data for attribute "+Ne,k.commandStr),"constant"in Me){var Be=Me.constant;ke.buffer="null",ke.state=qn,typeof Be=="number"?ke.x=Be:($.command($i(Be)&&Be.length>0&&Be.length<=4,"invalid constant for attribute "+Ne,k.commandStr),Xr.forEach(function($r,Cn){Cn<Be.length&&(ke[$r]=Be[Cn])}))}else{lo(Me.buffer)?ct=Pr.getBuffer(Pr.create(Me.buffer,Ku,!1,!0)):ct=Pr.getBuffer(Me.buffer),$.command(!!ct,'missing buffer for attribute "'+Ne+'"',k.commandStr);var It=Me.offset|0;$.command(It>=0,'invalid offset for attribute "'+Ne+'"',k.commandStr);var $t=Me.stride|0;$.command($t>=0&&$t<256,'invalid stride for attribute "'+Ne+'", must be integer betweeen [0, 255]',k.commandStr);var ar=Me.size|0;$.command(!("size"in Me)||ar>0&&ar<=4,'invalid size for attribute "'+Ne+'", must be 1,2,3,4',k.commandStr);var tr=!!Me.normalized,pr=0;"type"in Me&&($.commandParameter(Me.type,Eo,"invalid type for attribute "+Ne,k.commandStr),pr=Eo[Me.type]);var wr=Me.divisor|0;"divisor"in Me&&($.command(wr===0||Zr,'cannot specify divisor for attribute "'+Ne+'", instancing not supported',k.commandStr),$.command(wr>=0,'invalid divisor for attribute "'+Ne+'"',k.commandStr)),$.optional(function(){var $r=k.commandStr,Cn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Me).forEach(function(un){$.command(Cn.indexOf(un)>=0,'unknown parameter "'+un+'" for attribute pointer "'+Ne+'" (valid parameters are '+Cn+")",$r)})}),ke.buffer=ct,ke.state=Ln,ke.size=ar,ke.normalized=tr,ke.type=pr||ct.dtype,ke.offset=It,ke.stride=$t,ke.divisor=wr}}Je[Ne]=xa(function($r,Cn){var un=$r.attribCache;if(mt in un)return un[mt];var _n={isStream:!1};return Object.keys(ke).forEach(function(Kn){_n[Kn]=ke[Kn]}),ke.buffer&&(_n.buffer=$r.link(ke.buffer),_n.type=_n.type||_n.buffer+".dtype"),un[mt]=_n,_n})}),Object.keys(ae).forEach(function(Ne){var Me=ae[Ne];function mt(ke,ct){var Be=ke.invoke(ct,Me),It=ke.shared,$t=ke.constants,ar=It.isBufferArgs,tr=It.buffer;$.optional(function(){ke.assert(ct,Be+"&&(typeof "+Be+'==="object"||typeof '+Be+'==="function")&&('+ar+"("+Be+")||"+tr+".getBuffer("+Be+")||"+tr+".getBuffer("+Be+".buffer)||"+ar+"("+Be+'.buffer)||("constant" in '+Be+"&&(typeof "+Be+'.constant==="number"||'+It.isArrayLike+"("+Be+".constant))))",'invalid dynamic attribute "'+Ne+'"')});var pr={isStream:ct.def(!1)},wr=new Tr;wr.state=Ln,Object.keys(wr).forEach(function(_n){pr[_n]=ct.def(""+wr[_n])});var $r=pr.buffer,Cn=pr.type;ct("if(",ar,"(",Be,")){",pr.isStream,"=true;",$r,"=",tr,".createStream(",Ku,",",Be,");",Cn,"=",$r,".dtype;","}else{",$r,"=",tr,".getBuffer(",Be,");","if(",$r,"){",Cn,"=",$r,".dtype;",'}else if("constant" in ',Be,"){",pr.state,"=",qn,";","if(typeof "+Be+'.constant === "number"){',pr[Xr[0]],"=",Be,".constant;",Xr.slice(1).map(function(_n){return pr[_n]}).join("="),"=0;","}else{",Xr.map(function(_n,Kn){return pr[_n]+"="+Be+".constant.length>"+Kn+"?"+Be+".constant["+Kn+"]:0;"}).join(""),"}}else{","if(",ar,"(",Be,".buffer)){",$r,"=",tr,".createStream(",Ku,",",Be,".buffer);","}else{",$r,"=",tr,".getBuffer(",Be,".buffer);","}",Cn,'="type" in ',Be,"?",$t.glTypes,"[",Be,".type]:",$r,".dtype;",pr.normalized,"=!!",Be,".normalized;");function un(_n){ct(pr[_n],"=",Be,".",_n,"|0;")}return un("size"),un("offset"),un("stride"),un("divisor"),ct("}}"),ct.exit("if(",pr.isStream,"){",tr,".destroyStream(",$r,");","}"),pr}Je[Ne]=Ao(Me,mt)}),Je}function co(I,k){var X=I.static,ae=I.dynamic;if(dl in X){var Je=X[dl];return Je!==null&&en.getVAO(Je)===null&&(Je=en.createVAO(Je)),xa(function(Me){return Me.link(en.getVAO(Je))})}else if(dl in ae){var Ne=ae[dl];return Ao(Ne,function(Me,mt){var ke=Me.invoke(mt,Ne);return mt.def(Me.shared.vao+".getVAO("+ke+")")})}return null}function Mi(I){var k=I.static,X=I.dynamic,ae={};return Object.keys(k).forEach(function(Je){var Ne=k[Je];ae[Je]=xa(function(Me,mt){return typeof Ne=="number"||typeof Ne=="boolean"?""+Ne:Me.link(Ne)})}),Object.keys(X).forEach(function(Je){var Ne=X[Je];ae[Je]=Ao(Ne,function(Me,mt){return Me.invoke(mt,Ne)})}),ae}function ms(I,k,X,ae,Je){var Ne=I.static,Me=I.dynamic;$.optional(function(){var un=[No,Ho,_o,uo,Ls,Hl,nu,Gc,Do,dl].concat(Jr);function _n(Kn){Object.keys(Kn).forEach(function(ka){$.command(un.indexOf(ka)>=0,'unknown parameter "'+ka+'"',Je.commandStr)})}_n(Ne),_n(Me)});var mt=Oa(I,k),ke=Un(I,Je),ct=Ua(I,ke,Je),Be=fi(I,Je),It=jo(I,Je),$t=Da(I,Je,mt);function ar(un){var _n=ct[un];_n&&(It[un]=_n)}ar(hs),ar(Kr(Gl));var tr=Object.keys(It).length>0,pr={framebuffer:ke,draw:Be,shader:$t,state:It,dirty:tr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(pr.profile=pa(I,Je),pr.uniforms=ps(X,Je),pr.drawVAO=pr.scopeVAO=co(I,Je),!pr.drawVAO&&$t.program&&!mt&&Ot.angle_instanced_arrays){var wr=!0,$r=$t.program.attributes.map(function(un){var _n=k.static[un];return wr=wr&&!!_n,_n});if(wr&&$r.length>0){var Cn=en.getVAO(en.createVAO($r));pr.drawVAO=new bi(null,null,null,function(un,_n){return un.link(Cn)}),pr.useVAO=!0}}return mt?pr.useVAO=!0:pr.attributes=ei(k,Je),pr.context=Mi(ae,Je),pr}function Wo(I,k,X){var ae=I.shared,Je=ae.context,Ne=I.scope();Object.keys(X).forEach(function(Me){k.save(Je,"."+Me);var mt=X[Me],ke=mt.append(I,k);Array.isArray(ke)?Ne(Je,".",Me,"=[",ke.join(),"];"):Ne(Je,".",Me,"=",ke,";")}),k(Ne)}function Zo(I,k,X,ae){var Je=I.shared,Ne=Je.gl,Me=Je.framebuffer,mt;wn&&(mt=k.def(Je.extensions,".webgl_draw_buffers"));var ke=I.constants,ct=ke.drawBuffer,Be=ke.backBuffer,It;X?It=X.append(I,k):It=k.def(Me,".next"),ae||k("if(",It,"!==",Me,".cur){"),k("if(",It,"){",Ne,".bindFramebuffer(",yi,",",It,".framebuffer);"),wn&&k(mt,".drawBuffersWEBGL(",ct,"[",It,".colorAttachments.length]);"),k("}else{",Ne,".bindFramebuffer(",yi,",null);"),wn&&k(mt,".drawBuffersWEBGL(",Be,");"),k("}",Me,".cur=",It,";"),ae||k("}")}function es(I,k,X){var ae=I.shared,Je=ae.gl,Ne=I.current,Me=I.next,mt=ae.current,ke=ae.next,ct=I.cond(mt,".dirty");Jr.forEach(function(Be){var It=Kr(Be);if(It in X.state)return;var $t,ar;if(It in Me){$t=Me[It],ar=Ne[It];var tr=Z(Rr[It].length,function(wr){return ct.def($t,"[",wr,"]")});ct(I.cond(tr.map(function(wr,$r){return wr+"!=="+ar+"["+$r+"]"}).join("||")).then(Je,".",Fr[It],"(",tr,");",tr.map(function(wr,$r){return ar+"["+$r+"]="+wr}).join(";"),";"))}else{$t=ct.def(ke,".",It);var pr=I.cond($t,"!==",mt,".",It);ct(pr),It in Br?pr(I.cond($t).then(Je,".enable(",Br[It],");").else(Je,".disable(",Br[It],");"),mt,".",It,"=",$t,";"):pr(Je,".",Fr[It],"(",$t,");",mt,".",It,"=",$t,";")}}),Object.keys(X.state).length===0&&ct(mt,".dirty=false;"),k(ct)}function Is(I,k,X,ae){var Je=I.shared,Ne=I.current,Me=Je.current,mt=Je.gl;iu(Object.keys(X)).forEach(function(ke){var ct=X[ke];if(ae&&!ae(ct))return;var Be=ct.append(I,k);if(Br[ke]){var It=Br[ke];Ni(ct)?Be?k(mt,".enable(",It,");"):k(mt,".disable(",It,");"):k(I.cond(Be).then(mt,".enable(",It,");").else(mt,".disable(",It,");")),k(Me,".",ke,"=",Be,";")}else if($i(Be)){var $t=Ne[ke];k(mt,".",Fr[ke],"(",Be,");",Be.map(function(ar,tr){return $t+"["+tr+"]="+ar}).join(";"),";")}else k(mt,".",Fr[ke],"(",Be,");",Me,".",ke,"=",Be,";")})}function Wi(I,k){Zr&&(I.instancing=k.def(I.shared.extensions,".angle_instanced_arrays"))}function ia(I,k,X,ae,Je){var Ne=I.shared,Me=I.stats,mt=Ne.current,ke=Ne.timer,ct=X.profile;function Be(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var It,$t;function ar(un){It=k.def(),un(It,"=",Be(),";"),typeof Je=="string"?un(Me,".count+=",Je,";"):un(Me,".count++;"),dn&&(ae?($t=k.def(),un($t,"=",ke,".getNumPendingQueries();")):un(ke,".beginQuery(",Me,");"))}function tr(un){un(Me,".cpuTime+=",Be(),"-",It,";"),dn&&(ae?un(ke,".pushScopeStats(",$t,",",ke,".getNumPendingQueries(),",Me,");"):un(ke,".endQuery();"))}function pr(un){var _n=k.def(mt,".profile");k(mt,".profile=",un,";"),k.exit(mt,".profile=",_n,";")}var wr;if(ct){if(Ni(ct)){ct.enable?(ar(k),tr(k.exit),pr("true")):pr("false");return}wr=ct.append(I,k),pr(wr)}else wr=k.def(mt,".profile");var $r=I.block();ar($r),k("if(",wr,"){",$r,"}");var Cn=I.block();tr(Cn),k.exit("if(",wr,"){",Cn,"}")}function Hs(I,k,X,ae,Je){var Ne=I.shared;function Me(ke){switch(ke){case lf:case Oc:case Nf:return 2;case io:case au:case Wc:return 3;case fc:case wl:case cf:return 4;default:return 1}}function mt(ke,ct,Be){var It=Ne.gl,$t=k.def(ke,".location"),ar=k.def(Ne.attributes,"[",$t,"]"),tr=Be.state,pr=Be.buffer,wr=[Be.x,Be.y,Be.z,Be.w],$r=["buffer","normalized","offset","stride"];function Cn(){k("if(!",ar,".buffer){",It,".enableVertexAttribArray(",$t,");}");var _n=Be.type,Kn;if(Be.size?Kn=k.def(Be.size,"||",ct):Kn=ct,k("if(",ar,".type!==",_n,"||",ar,".size!==",Kn,"||",$r.map(function(Ei){return ar+"."+Ei+"!=="+Be[Ei]}).join("||"),"){",It,".bindBuffer(",Ku,",",pr,".buffer);",It,".vertexAttribPointer(",[$t,Kn,_n,Be.normalized,Be.stride,Be.offset],");",ar,".type=",_n,";",ar,".size=",Kn,";",$r.map(function(Ei){return ar+"."+Ei+"="+Be[Ei]+";"}).join(""),"}"),Zr){var ka=Be.divisor;k("if(",ar,".divisor!==",ka,"){",I.instancing,".vertexAttribDivisorANGLE(",[$t,ka],");",ar,".divisor=",ka,";}")}}function un(){k("if(",ar,".buffer){",It,".disableVertexAttribArray(",$t,");",ar,".buffer=null;","}if(",Xr.map(function(_n,Kn){return ar+"."+_n+"!=="+wr[Kn]}).join("||"),"){",It,".vertexAttrib4f(",$t,",",wr,");",Xr.map(function(_n,Kn){return ar+"."+_n+"="+wr[Kn]+";"}).join(""),"}")}tr===Ln?Cn():tr===qn?un():(k("if(",tr,"===",Ln,"){"),Cn(),k("}else{"),un(),k("}"))}ae.forEach(function(ke){var ct=ke.name,Be=X.attributes[ct],It;if(Be){if(!Je(Be))return;It=Be.append(I,k)}else{if(!Je(hc))return;var $t=I.scopeAttrib(ct);$.optional(function(){I.assert(k,$t+".state","missing attribute "+ct)}),It={},Object.keys(new Tr).forEach(function(ar){It[ar]=k.def($t,".",ar)})}mt(I.link(ke),Me(ke.info.type),It)})}function xi(I,k,X,ae,Je){for(var Ne=I.shared,Me=Ne.gl,mt,ke=0;ke<ae.length;++ke){var ct=ae[ke],Be=ct.name,It=ct.info.type,$t=X.uniforms[Be],ar=I.link(ct),tr=ar+".location",pr;if($t){if(!Je($t))continue;if(Ni($t)){var wr=$t.value;if($.command(wr!==null&&typeof wr!="undefined",'missing uniform "'+Be+'"',I.commandStr),It===se||It===N){$.command(typeof wr=="function"&&(It===se&&(wr._reglType==="texture2d"||wr._reglType==="framebuffer")||It===N&&(wr._reglType==="textureCube"||wr._reglType==="framebufferCube")),"invalid texture for uniform "+Be,I.commandStr);var $r=I.link(wr._texture||wr.color[0]._texture);k(Me,".uniform1i(",tr,",",$r+".bind());"),k.exit($r,".unbind();")}else if(It===Zc||It===ml||It===re){$.optional(function(){$.command($i(wr),"invalid matrix for uniform "+Be,I.commandStr),$.command(It===Zc&&wr.length===4||It===ml&&wr.length===9||It===re&&wr.length===16,"invalid length for matrix uniform "+Be,I.commandStr)});var Cn=I.global.def("new Float32Array(["+Array.prototype.slice.call(wr)+"])"),un=2;It===ml?un=3:It===re&&(un=4),k(Me,".uniformMatrix",un,"fv(",tr,",false,",Cn,");")}else{switch(It){case Wl:$.commandType(wr,"number","uniform "+Be,I.commandStr),mt="1f";break;case lf:$.command($i(wr)&&wr.length===2,"uniform "+Be,I.commandStr),mt="2f";break;case io:$.command($i(wr)&&wr.length===3,"uniform "+Be,I.commandStr),mt="3f";break;case fc:$.command($i(wr)&&wr.length===4,"uniform "+Be,I.commandStr),mt="4f";break;case _f:$.commandType(wr,"boolean","uniform "+Be,I.commandStr),mt="1i";break;case Tf:$.commandType(wr,"number","uniform "+Be,I.commandStr),mt="1i";break;case Nf:$.command($i(wr)&&wr.length===2,"uniform "+Be,I.commandStr),mt="2i";break;case Oc:$.command($i(wr)&&wr.length===2,"uniform "+Be,I.commandStr),mt="2i";break;case Wc:$.command($i(wr)&&wr.length===3,"uniform "+Be,I.commandStr),mt="3i";break;case au:$.command($i(wr)&&wr.length===3,"uniform "+Be,I.commandStr),mt="3i";break;case cf:$.command($i(wr)&&wr.length===4,"uniform "+Be,I.commandStr),mt="4i";break;case wl:$.command($i(wr)&&wr.length===4,"uniform "+Be,I.commandStr),mt="4i";break}k(Me,".uniform",mt,"(",tr,",",$i(wr)?Array.prototype.slice.call(wr):wr,");")}continue}else pr=$t.append(I,k)}else{if(!Je(hc))continue;pr=k.def(Ne.uniforms,"[",Fe.id(Be),"]")}It===se?($(!Array.isArray(pr),"must specify a scalar prop for textures"),k("if(",pr,"&&",pr,'._reglType==="framebuffer"){',pr,"=",pr,".color[0];","}")):It===N&&($(!Array.isArray(pr),"must specify a scalar prop for cube maps"),k("if(",pr,"&&",pr,'._reglType==="framebufferCube"){',pr,"=",pr,".color[0];","}")),$.optional(function(){function Pi(Ds,Ns){I.assert(k,Ds,'bad data or missing for uniform "'+Be+'".  '+Ns)}function Du(Ds){$(!Array.isArray(pr),"must not specify an array type for uniform"),Pi("typeof "+pr+'==="'+Ds+'"',"invalid type, expected "+Ds)}function ou(Ds,Ns){Array.isArray(pr)?$(pr.length===Ds,"must have length "+Ds):Pi(Ne.isArrayLike+"("+pr+")&&"+pr+".length==="+Ds,"invalid vector, should have length "+Ds,I.commandStr)}function Xl(Ds){$(!Array.isArray(pr),"must not specify a value type"),Pi("typeof "+pr+'==="function"&&'+pr+'._reglType==="texture'+(Ds===Ru?"2d":"Cube")+'"',"invalid texture type",I.commandStr)}switch(It){case Tf:Du("number");break;case Oc:ou(2,"number");break;case au:ou(3,"number");break;case wl:ou(4,"number");break;case Wl:Du("number");break;case lf:ou(2,"number");break;case io:ou(3,"number");break;case fc:ou(4,"number");break;case _f:Du("boolean");break;case Nf:ou(2,"boolean");break;case Wc:ou(3,"boolean");break;case cf:ou(4,"boolean");break;case Zc:ou(4,"number");break;case ml:ou(9,"number");break;case re:ou(16,"number");break;case se:Xl(Ru);break;case N:Xl(cc);break}});var _n=1;switch(It){case se:case N:var Kn=k.def(pr,"._texture");k(Me,".uniform1i(",tr,",",Kn,".bind());"),k.exit(Kn,".unbind();");continue;case Tf:case _f:mt="1i";break;case Oc:case Nf:mt="2i",_n=2;break;case au:case Wc:mt="3i",_n=3;break;case wl:case cf:mt="4i",_n=4;break;case Wl:mt="1f";break;case lf:mt="2f",_n=2;break;case io:mt="3f",_n=3;break;case fc:mt="4f",_n=4;break;case Zc:mt="Matrix2fv";break;case ml:mt="Matrix3fv";break;case re:mt="Matrix4fv";break}if(k(Me,".uniform",mt,"(",tr,","),mt.charAt(0)==="M"){var ka=Math.pow(It-Zc+2,2),Ei=I.global.def("new Float32Array(",ka,")");Array.isArray(pr)?k("false,(",Z(ka,function(Pi){return Ei+"["+Pi+"]="+pr[Pi]}),",",Ei,")"):k("false,(Array.isArray(",pr,")||",pr," instanceof Float32Array)?",pr,":(",Z(ka,function(Pi){return Ei+"["+Pi+"]="+pr+"["+Pi+"]"}),",",Ei,")")}else _n>1?k(Z(_n,function(Pi){return Array.isArray(pr)?pr[Pi]:pr+"["+Pi+"]"})):($(!Array.isArray(pr),"uniform value must not be an array"),k(pr));k(");")}}function An(I,k,X,ae){var Je=I.shared,Ne=Je.gl,Me=Je.draw,mt=ae.draw;function ke(){var Kn=mt.elements,ka,Ei=k;return Kn?((Kn.contextDep&&ae.contextDynamic||Kn.propDep)&&(Ei=X),ka=Kn.append(I,Ei)):ka=Ei.def(Me,".",uo),ka&&Ei("if("+ka+")"+Ne+".bindBuffer("+Ef+","+ka+".buffer.buffer);"),ka}function ct(){var Kn=mt.count,ka,Ei=k;return Kn?((Kn.contextDep&&ae.contextDynamic||Kn.propDep)&&(Ei=X),ka=Kn.append(I,Ei),$.optional(function(){Kn.MISSING&&I.assert(k,"false","missing vertex count"),Kn.DYNAMIC&&I.assert(Ei,ka+">=0","missing vertex count")})):(ka=Ei.def(Me,".",nu),$.optional(function(){I.assert(Ei,ka+">=0","missing vertex count")})),ka}var Be=ke();function It(Kn){var ka=mt[Kn];return ka?ka.contextDep&&ae.contextDynamic||ka.propDep?ka.append(I,X):ka.append(I,k):k.def(Me,".",Kn)}var $t=It(Ls),ar=It(Hl),tr=ct();if(typeof tr=="number"){if(tr===0)return}else X("if(",tr,"){"),X.exit("}");var pr,wr;Zr&&(pr=It(Gc),wr=I.instancing);var $r=Be+".type",Cn=mt.elements&&Ni(mt.elements);function un(){function Kn(){X(wr,".drawElementsInstancedANGLE(",[$t,tr,$r,ar+"<<(("+$r+"-"+mn+")>>1)",pr],");")}function ka(){X(wr,".drawArraysInstancedANGLE(",[$t,ar,tr,pr],");")}Be?Cn?Kn():(X("if(",Be,"){"),Kn(),X("}else{"),ka(),X("}")):ka()}function _n(){function Kn(){X(Ne+".drawElements("+[$t,tr,$r,ar+"<<(("+$r+"-"+mn+")>>1)"]+");")}function ka(){X(Ne+".drawArrays("+[$t,ar,tr]+");")}Be?Cn?Kn():(X("if(",Be,"){"),Kn(),X("}else{"),ka(),X("}")):ka()}Zr&&(typeof pr!="number"||pr>=0)?typeof pr=="string"?(X("if(",pr,">0){"),un(),X("}else if(",pr,"<0){"),_n(),X("}")):un():_n()}function Ra(I,k,X,ae,Je){var Ne=ha(),Me=Ne.proc("body",Je);return $.optional(function(){Ne.commandStr=k.commandStr,Ne.command=Ne.link(k.commandStr)}),Zr&&(Ne.instancing=Me.def(Ne.shared.extensions,".angle_instanced_arrays")),I(Ne,Me,X,ae),Ne.compile().body}function Ba(I,k,X,ae){Wi(I,k),X.useVAO?X.drawVAO?k(I.shared.vao,".setVAO(",X.drawVAO.append(I,k),");"):k(I.shared.vao,".setVAO(",I.shared.vao,".targetVAO);"):(k(I.shared.vao,".setVAO(null);"),Hs(I,k,X,ae.attributes,function(){return!0})),xi(I,k,X,ae.uniforms,function(){return!0}),An(I,k,k,X)}function Xo(I,k){var X=I.proc("draw",1);Wi(I,X),Wo(I,X,k.context),Zo(I,X,k.framebuffer),es(I,X,k),Is(I,X,k.state),ia(I,X,k,!1,!0);var ae=k.shader.progVar.append(I,X);if(X(I.shared.gl,".useProgram(",ae,".program);"),k.shader.program)Ba(I,X,k,k.shader.program);else{X(I.shared.vao,".setVAO(null);");var Je=I.global.def("{}"),Ne=X.def(ae,".id"),Me=X.def(Je,"[",Ne,"]");X(I.cond(Me).then(Me,".call(this,a0);").else(Me,"=",Je,"[",Ne,"]=",I.link(function(mt){return Ra(Ba,I,k,mt,1)}),"(",ae,");",Me,".call(this,a0);"))}Object.keys(k.state).length>0&&X(I.shared.current,".dirty=true;")}function gu(I,k,X,ae){I.batchId="a1",Wi(I,k);function Je(){return!0}Hs(I,k,X,ae.attributes,Je),xi(I,k,X,ae.uniforms,Je),An(I,k,k,X)}function O(I,k,X,ae){Wi(I,k);var Je=X.contextDep,Ne=k.def(),Me="a0",mt="a1",ke=k.def();I.shared.props=ke,I.batchId=Ne;var ct=I.scope(),Be=I.scope();k(ct.entry,"for(",Ne,"=0;",Ne,"<",mt,";++",Ne,"){",ke,"=",Me,"[",Ne,"];",Be,"}",ct.exit);function It($r){return $r.contextDep&&Je||$r.propDep}function $t($r){return!It($r)}if(X.needsContext&&Wo(I,Be,X.context),X.needsFramebuffer&&Zo(I,Be,X.framebuffer),Is(I,Be,X.state,It),X.profile&&It(X.profile)&&ia(I,Be,X,!1,!0),ae)X.useVAO?X.drawVAO?It(X.drawVAO)?Be(I.shared.vao,".setVAO(",X.drawVAO.append(I,Be),");"):ct(I.shared.vao,".setVAO(",X.drawVAO.append(I,ct),");"):ct(I.shared.vao,".setVAO(",I.shared.vao,".targetVAO);"):(ct(I.shared.vao,".setVAO(null);"),Hs(I,ct,X,ae.attributes,$t),Hs(I,Be,X,ae.attributes,It)),xi(I,ct,X,ae.uniforms,$t),xi(I,Be,X,ae.uniforms,It),An(I,ct,Be,X);else{var ar=I.global.def("{}"),tr=X.shader.progVar.append(I,Be),pr=Be.def(tr,".id"),wr=Be.def(ar,"[",pr,"]");Be(I.shared.gl,".useProgram(",tr,".program);","if(!",wr,"){",wr,"=",ar,"[",pr,"]=",I.link(function($r){return Ra(gu,I,X,$r,2)}),"(",tr,");}",wr,".call(this,a0[",Ne,"],",Ne,");")}}function d(I,k){var X=I.proc("batch",2);I.batchId="0",Wi(I,X);var ae=!1,Je=!0;Object.keys(k.context).forEach(function(ar){ae=ae||k.context[ar].propDep}),ae||(Wo(I,X,k.context),Je=!1);var Ne=k.framebuffer,Me=!1;Ne?(Ne.propDep?ae=Me=!0:Ne.contextDep&&ae&&(Me=!0),Me||Zo(I,X,Ne)):Zo(I,X,null),k.state.viewport&&k.state.viewport.propDep&&(ae=!0);function mt(ar){return ar.contextDep&&ae||ar.propDep}es(I,X,k),Is(I,X,k.state,function(ar){return!mt(ar)}),(!k.profile||!mt(k.profile))&&ia(I,X,k,!1,"a1"),k.contextDep=ae,k.needsContext=Je,k.needsFramebuffer=Me;var ke=k.shader.progVar;if(ke.contextDep&&ae||ke.propDep)O(I,X,k,null);else{var ct=ke.append(I,X);if(X(I.shared.gl,".useProgram(",ct,".program);"),k.shader.program)O(I,X,k,k.shader.program);else{X(I.shared.vao,".setVAO(null);");var Be=I.global.def("{}"),It=X.def(ct,".id"),$t=X.def(Be,"[",It,"]");X(I.cond($t).then($t,".call(this,a0,a1);").else($t,"=",Be,"[",It,"]=",I.link(function(ar){return Ra(O,I,k,ar,2)}),"(",ct,");",$t,".call(this,a0,a1);"))}}Object.keys(k.state).length>0&&X(I.shared.current,".dirty=true;")}function c(I,k){var X=I.proc("scope",3);I.batchId="a2";var ae=I.shared,Je=ae.current;Wo(I,X,k.context),k.framebuffer&&k.framebuffer.append(I,X),iu(Object.keys(k.state)).forEach(function(Me){var mt=k.state[Me],ke=mt.append(I,X);$i(ke)?ke.forEach(function(ct,Be){X.set(I.next[Me],"["+Be+"]",ct)}):X.set(ae.next,"."+Me,ke)}),ia(I,X,k,!0,!0),[uo,Hl,nu,Gc,Ls].forEach(function(Me){var mt=k.draw[Me];if(!mt)return;X.set(ae.draw,"."+Me,""+mt.append(I,X))}),Object.keys(k.uniforms).forEach(function(Me){var mt=k.uniforms[Me].append(I,X);Array.isArray(mt)&&(mt="["+mt.join()+"]"),X.set(ae.uniforms,"["+Fe.id(Me)+"]",mt)}),Object.keys(k.attributes).forEach(function(Me){var mt=k.attributes[Me].append(I,X),ke=I.scopeAttrib(Me);Object.keys(new Tr).forEach(function(ct){X.set(ke,"."+ct,mt[ct])})}),k.scopeVAO&&X.set(ae.vao,".targetVAO",k.scopeVAO.append(I,X));function Ne(Me){var mt=k.shader[Me];mt&&X.set(ae.shader,"."+Me,mt.append(I,X))}Ne(Ho),Ne(_o),Object.keys(k.state).length>0&&(X(Je,".dirty=true;"),X.exit(Je,".dirty=true;")),X("a1(",I.shared.context,",a0,",I.batchId,");")}function p(I){if(typeof I!="object"||$i(I))return;for(var k=Object.keys(I),X=0;X<k.length;++X)if(yt.isDynamic(I[k[X]]))return!0;return!1}function T(I,k,X){var ae=k.static[X];if(!ae||!p(ae))return;var Je=I.global,Ne=Object.keys(ae),Me=!1,mt=!1,ke=!1,ct=I.global.def("{}");Ne.forEach(function(It){var $t=ae[It];if(yt.isDynamic($t)){typeof $t=="function"&&($t=ae[It]=yt.unbox($t));var ar=Ao($t,null);Me=Me||ar.thisDep,ke=ke||ar.propDep,mt=mt||ar.contextDep}else{Je(ct,".",It,"=");switch(typeof $t){case"number":Je($t);break;case"string":Je('"',$t,'"');break;case"object":Array.isArray($t)&&Je("[",$t.join(),"]");break;default:Je(I.link($t));break}Je(";")}});function Be(It,$t){Ne.forEach(function(ar){var tr=ae[ar];if(!yt.isDynamic(tr))return;var pr=It.invoke($t,tr);$t(ct,".",ar,"=",pr,";")})}k.dynamic[X]=new yt.DynamicVariable(ua,{thisDep:Me,contextDep:mt,propDep:ke,ref:ct,append:Be}),delete k.static[X]}function j(I,k,X,ae,Je){var Ne=ha();Ne.stats=Ne.link(Je),Object.keys(k.static).forEach(function(mt){T(Ne,k,mt)}),Cc.forEach(function(mt){T(Ne,I,mt)});var Me=ms(I,k,X,ae,Ne);return Xo(Ne,Me),c(Ne,Me),d(Ne,Me),m(Ne.compile(),{destroy:function(){Me.shader.program.destroy()}})}return{next:ta,current:Rr,procs:function(){var I=ha(),k=I.proc("poll"),X=I.proc("refresh"),ae=I.block();k(ae),X(ae);var Je=I.shared,Ne=Je.gl,Me=Je.next,mt=Je.current;ae(mt,".dirty=false;"),Zo(I,k),Zo(I,X,null,!0);var ke;Zr&&(ke=I.link(Zr)),Ot.oes_vertex_array_object&&X(I.link(Ot.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ct=0;ct<xr.maxAttributes;++ct){var Be=X.def(Je.attributes,"[",ct,"]"),It=I.cond(Be,".buffer");It.then(Ne,".enableVertexAttribArray(",ct,");",Ne,".bindBuffer(",Ku,",",Be,".buffer.buffer);",Ne,".vertexAttribPointer(",ct,",",Be,".size,",Be,".type,",Be,".normalized,",Be,".stride,",Be,".offset);").else(Ne,".disableVertexAttribArray(",ct,");",Ne,".vertexAttrib4f(",ct,",",Be,".x,",Be,".y,",Be,".z,",Be,".w);",Be,".buffer=null;"),X(It),Zr&&X(ke,".vertexAttribDivisorANGLE(",ct,",",Be,".divisor);")}return X(I.shared.vao,".currentVAO=null;",I.shared.vao,".setVAO(",I.shared.vao,".targetVAO);"),Object.keys(Br).forEach(function($t){var ar=Br[$t],tr=ae.def(Me,".",$t),pr=I.block();pr("if(",tr,"){",Ne,".enable(",ar,")}else{",Ne,".disable(",ar,")}",mt,".",$t,"=",tr,";"),X(pr),k("if(",tr,"!==",mt,".",$t,"){",pr,"}")}),Object.keys(Fr).forEach(function($t){var ar=Fr[$t],tr=Rr[$t],pr,wr,$r=I.block();if($r(Ne,".",ar,"("),$i(tr)){var Cn=tr.length;pr=I.global.def(Me,".",$t),wr=I.global.def(mt,".",$t),$r(Z(Cn,function(un){return pr+"["+un+"]"}),");",Z(Cn,function(un){return wr+"["+un+"]="+pr+"["+un+"];"}).join("")),k("if(",Z(Cn,function(un){return pr+"["+un+"]!=="+wr+"["+un+"]"}).join("||"),"){",$r,"}")}else pr=ae.def(Me,".",$t),wr=ae.def(mt,".",$t),$r(pr,");",mt,".",$t,"=",pr,";"),k("if(",pr,"!==",wr,"){",$r,"}");X($r)}),I.compile()}(),compile:j}}function uh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var jf=34918,Iu=34919,Ff=35007,ff=function(Fe,Ot){if(!Ot.ext_disjoint_timer_query)return null;var xr=[];function Pr(){return xr.pop()||Ot.ext_disjoint_timer_query.createQueryEXT()}function Cr(wn){xr.push(wn)}var Er=[];function Wr(wn){var Rr=Pr();Ot.ext_disjoint_timer_query.beginQueryEXT(Ff,Rr),Er.push(Rr),nn(Er.length-1,Er.length,wn)}function on(){Ot.ext_disjoint_timer_query.endQueryEXT(Ff)}function en(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Yr=[];function cn(){return Yr.pop()||new en}function Tn(wn){Yr.push(wn)}var dn=[];function nn(wn,Rr,ta){var Jr=cn();Jr.startQueryIndex=wn,Jr.endQueryIndex=Rr,Jr.sum=0,Jr.stats=ta,dn.push(Jr)}var Tr=[],br=[];function Zr(){var wn,Rr,ta=Er.length;if(ta===0)return;br.length=Math.max(br.length,ta+1),Tr.length=Math.max(Tr.length,ta+1),Tr[0]=0,br[0]=0;var Jr=0;for(wn=0,Rr=0;Rr<Er.length;++Rr){var Br=Er[Rr];Ot.ext_disjoint_timer_query.getQueryObjectEXT(Br,Iu)?(Jr+=Ot.ext_disjoint_timer_query.getQueryObjectEXT(Br,jf),Cr(Br)):Er[wn++]=Br,Tr[Rr+1]=Jr,br[Rr+1]=wn}for(Er.length=wn,wn=0,Rr=0;Rr<dn.length;++Rr){var Fr=dn[Rr],Kr=Fr.startQueryIndex,Hn=Fr.endQueryIndex;Fr.sum+=Tr[Hn]-Tr[Kr];var aa=br[Kr],sn=br[Hn];sn===aa?(Fr.stats.gpuTime+=Fr.sum/1e6,Tn(Fr)):(Fr.startQueryIndex=aa,Fr.endQueryIndex=sn,dn[wn++]=Fr)}dn.length=wn}return{beginQuery:Wr,endQuery:on,pushScopeStats:nn,update:Zr,getNumPendingQueries:function(){return Er.length},clear:function(){xr.push.apply(xr,Er);for(var Rr=0;Rr<xr.length;Rr++)Ot.ext_disjoint_timer_query.deleteQueryEXT(xr[Rr]);Er.length=0,xr.length=0},restore:function(){Er.length=0,xr.length=0}}},zf=16384,Th=256,lh=1024,Sf=34962,Uf="webglcontextlost",Bf="webglcontextrestored",ch=1,Vf=2,Pf=3;function Zl(ye,Fe){for(var Ot=0;Ot<ye.length;++Ot)if(ye[Ot]===Fe)return Ot;return-1}function Dh(ye){var Fe=On(ye);if(!Fe)return null;var Ot=Fe.gl,xr=Ot.getContextAttributes(),Pr=Ot.isContextLost(),Cr=U(Ot,Fe);if(!Cr)return null;var Er=Hr(),Wr=uh(),on=Cr.extensions,en=ff(Ot,on),Yr=hr(),cn=Ot.drawingBufferWidth,Tn=Ot.drawingBufferHeight,dn={tick:0,time:0,viewportWidth:cn,viewportHeight:Tn,framebufferWidth:cn,framebufferHeight:Tn,drawingBufferWidth:cn,drawingBufferHeight:Tn,pixelRatio:Fe.pixelRatio},nn={},Tr={elements:null,primitive:4,count:-1,offset:0,instances:-1},br=ho(Ot,on),Zr=Xa(Ot,Wr,Fe,Rr),wn=rt(Ot,on,br,Wr,Zr);function Rr(An){return wn.destroyBuffer(An)}var ta=Ic(Ot,on,Zr,Wr),Jr=jt(Ot,Er,Wr,Fe),Br=eu(Ot,on,br,function(){Hn.procs.poll()},dn,Wr,Fe),Fr=Ss(Ot,on,br,Wr,Fe),Kr=F(Ot,on,br,Br,Fr,Wr),Hn=kf(Ot,Er,on,br,Zr,ta,Br,Kr,nn,wn,Jr,Tr,dn,en,Fe),aa=vr(Ot,Kr,Hn.procs.poll,dn,xr,on,br),sn=Hn.next,Gr=Ot.canvas,jr=[],ha=[],pa=[],Un=[Fe.onDestroy],Ua=null;function Oa(){if(jr.length===0){en&&en.update(),Ua=null;return}Ua=Ht.next(Oa),Is();for(var An=jr.length-1;An>=0;--An){var Ra=jr[An];Ra&&Ra(dn,null,0)}Ot.flush(),en&&en.update()}function Da(){!Ua&&jr.length>0&&(Ua=Ht.next(Oa))}function fi(){Ua&&(Ht.cancel(Oa),Ua=null)}function jo(An){An.preventDefault(),Pr=!0,fi(),ha.forEach(function(Ra){Ra()})}function ps(An){Ot.getError(),Pr=!1,Cr.restore(),Jr.restore(),Zr.restore(),Br.restore(),Fr.restore(),Kr.restore(),wn.restore(),en&&en.restore(),Hn.procs.refresh(),Da(),pa.forEach(function(Ra){Ra()})}Gr&&(Gr.addEventListener(Uf,jo,!1),Gr.addEventListener(Bf,ps,!1));function ei(){jr.length=0,fi(),Gr&&(Gr.removeEventListener(Uf,jo),Gr.removeEventListener(Bf,ps)),Jr.clear(),Kr.clear(),Fr.clear(),Br.clear(),ta.clear(),Zr.clear(),wn.clear(),en&&en.clear(),Un.forEach(function(An){An()})}function co(An){$(!!An,"invalid args to regl({...})"),$.type(An,"object","invalid args to regl({...})");function Ra(Je){var Ne=m({},Je);delete Ne.uniforms,delete Ne.attributes,delete Ne.context,delete Ne.vao,"stencil"in Ne&&Ne.stencil.op&&(Ne.stencil.opBack=Ne.stencil.opFront=Ne.stencil.op,delete Ne.stencil.op);function Me(mt){if(mt in Ne){var ke=Ne[mt];delete Ne[mt],Object.keys(ke).forEach(function(ct){Ne[mt+"."+ct]=ke[ct]})}}return Me("blend"),Me("depth"),Me("cull"),Me("stencil"),Me("polygonOffset"),Me("scissor"),Me("sample"),"vao"in Je&&(Ne.vao=Je.vao),Ne}function Ba(Je,Ne){var Me={},mt={};return Object.keys(Je).forEach(function(ke){var ct=Je[ke];if(yt.isDynamic(ct)){mt[ke]=yt.unbox(ct,ke);return}else if(Ne&&Array.isArray(ct)){for(var Be=0;Be<ct.length;++Be)if(yt.isDynamic(ct[Be])){mt[ke]=yt.unbox(ct,ke);return}}Me[ke]=ct}),{dynamic:mt,static:Me}}var Xo=Ba(An.context||{},!0),gu=Ba(An.uniforms||{},!0),O=Ba(An.attributes||{},!1),d=Ba(Ra(An),!1),c={gpuTime:0,cpuTime:0,count:0},p=Hn.compile(d,O,gu,Xo,c),T=p.draw,j=p.batch,I=p.scope,k=[];function X(Je){for(;k.length<Je;)k.push(null);return k}function ae(Je,Ne){var Me;if(Pr&&$.raise("context lost"),typeof Je=="function")return I.call(this,null,Je,0);if(typeof Ne=="function")if(typeof Je=="number")for(Me=0;Me<Je;++Me)I.call(this,null,Ne,Me);else if(Array.isArray(Je))for(Me=0;Me<Je.length;++Me)I.call(this,Je[Me],Ne,Me);else return I.call(this,Je,Ne,0);else if(typeof Je=="number"){if(Je>0)return j.call(this,X(Je|0),Je|0)}else if(Array.isArray(Je)){if(Je.length)return j.call(this,Je,Je.length)}else return T.call(this,Je)}return m(ae,{stats:c,destroy:function(){p.destroy()}})}var Mi=Kr.setFBO=co({framebuffer:yt.define.call(null,ch,"framebuffer")});function ms(An,Ra){var Ba=0;Hn.procs.poll();var Xo=Ra.color;Xo&&(Ot.clearColor(+Xo[0]||0,+Xo[1]||0,+Xo[2]||0,+Xo[3]||0),Ba|=zf),"depth"in Ra&&(Ot.clearDepth(+Ra.depth),Ba|=Th),"stencil"in Ra&&(Ot.clearStencil(Ra.stencil|0),Ba|=lh),$(!!Ba,"called regl.clear with no buffer specified"),Ot.clear(Ba)}function Wo(An){if($(typeof An=="object"&&An,"regl.clear() takes an object as input"),"framebuffer"in An)if(An.framebuffer&&An.framebuffer_reglType==="framebufferCube")for(var Ra=0;Ra<6;++Ra)Mi(m({framebuffer:An.framebuffer.faces[Ra]},An),ms);else Mi(An,ms);else ms(null,An)}function Zo(An){$.type(An,"function","regl.frame() callback must be a function"),jr.push(An);function Ra(){var Ba=Zl(jr,An);$(Ba>=0,"cannot cancel a frame twice");function Xo(){var gu=Zl(jr,Xo);jr[gu]=jr[jr.length-1],jr.length-=1,jr.length<=0&&fi()}jr[Ba]=Xo}return Da(),{cancel:Ra}}function es(){var An=sn.viewport,Ra=sn.scissor_box;An[0]=An[1]=Ra[0]=Ra[1]=0,dn.viewportWidth=dn.framebufferWidth=dn.drawingBufferWidth=An[2]=Ra[2]=Ot.drawingBufferWidth,dn.viewportHeight=dn.framebufferHeight=dn.drawingBufferHeight=An[3]=Ra[3]=Ot.drawingBufferHeight}function Is(){dn.tick+=1,dn.time=ia(),es(),Hn.procs.poll()}function Wi(){Br.refresh(),es(),Hn.procs.refresh(),en&&en.update()}function ia(){return(hr()-Yr)/1e3}Wi();function Hs(An,Ra){$.type(Ra,"function","listener callback must be a function");var Ba;switch(An){case"frame":return Zo(Ra);case"lost":Ba=ha;break;case"restore":Ba=pa;break;case"destroy":Ba=Un;break;default:$.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ba.push(Ra),{cancel:function(){for(var gu=0;gu<Ba.length;++gu)if(Ba[gu]===Ra){Ba[gu]=Ba[Ba.length-1],Ba.pop();return}}}}var xi=m(co,{clear:Wo,prop:yt.define.bind(null,ch),context:yt.define.bind(null,Vf),this:yt.define.bind(null,Pf),draw:co({}),buffer:function(Ra){return Zr.create(Ra,Sf,!1,!1)},elements:function(Ra){return ta.create(Ra,!1)},texture:Br.create2D,cube:Br.createCube,renderbuffer:Fr.create,framebuffer:Kr.create,framebufferCube:Kr.createCube,vao:wn.createVAO,attributes:xr,frame:Zo,on:Hs,limits:br,hasExtension:function(Ra){return br.extensions.indexOf(Ra.toLowerCase())>=0},read:aa,destroy:ei,_gl:Ot,_refresh:Wi,poll:function(){Is(),en&&en.update()},now:ia,stats:Wr});return Fe.onDone(null,xi),xi}return Dh})},fdMe:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});function x(m,Y){var z=Y.callback;return z&&(m.dataArray=m.dataArray.map(z)),m}},fo6e:function(Ue,y){var o=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function x(m){return o.test(m)}Ue.exports=x},g4R6:function(Ue,y){function o(x,m,Y){return x===x&&(Y!==void 0&&(x=x<=Y?x:Y),m!==void 0&&(x=x>=m?x:m)),x}Ue.exports=o},gFfm:function(Ue,y){function o(x,m){for(var Y=-1,z=x==null?0:x.length;++Y<z&&!(m(x[Y],Y,x)===!1););return x}Ue.exports=o},gMG2:function(Ue,y,o){"use strict";o.d(y,"a",function(){return At});var x={},m={},Y=34,z=10,i=13;function W(St){return new Function("d","return {"+St.map(function(De,Ie){return JSON.stringify(De)+": d["+Ie+'] || ""'}).join(",")+"}")}function D(St,De){var Ie=W(St);return function(Ge,dt){return De(Ie(Ge),dt,St)}}function Q(St){var De=Object.create(null),Ie=[];return St.forEach(function(Ge){for(var dt in Ge)dt in De||Ie.push(De[dt]=dt)}),Ie}function ee(St,De){var Ie=St+"",Ge=Ie.length;return Ge<De?new Array(De-Ge+1).join(0)+Ie:Ie}function ce(St){return St<0?"-"+ee(-St,6):St>9999?"+"+ee(St,6):ee(St,4)}function K(St){var De=St.getUTCHours(),Ie=St.getUTCMinutes(),Ge=St.getUTCSeconds(),dt=St.getUTCMilliseconds();return isNaN(St)?"Invalid Date":ce(St.getUTCFullYear(),4)+"-"+ee(St.getUTCMonth()+1,2)+"-"+ee(St.getUTCDate(),2)+(dt?"T"+ee(De,2)+":"+ee(Ie,2)+":"+ee(Ge,2)+"."+ee(dt,3)+"Z":Ge?"T"+ee(De,2)+":"+ee(Ie,2)+":"+ee(Ge,2)+"Z":Ie||De?"T"+ee(De,2)+":"+ee(Ie,2)+"Z":"")}var je=function(St){var De=new RegExp('["'+St+`
\r]`),Ie=St.charCodeAt(0);function Ge(J,H){var Se,be,Te=dt(J,function(me,at){if(Se)return Se(me,at-1);be=me,Se=H?D(me,H):W(me)});return Te.columns=be||[],Te}function dt(J,H){var Se=[],be=J.length,Te=0,me=0,at,Jt=be<=0,Mt=!1;J.charCodeAt(be-1)===z&&--be,J.charCodeAt(be-1)===i&&--be;function ve(){if(Jt)return m;if(Mt)return Mt=!1,x;var He,st=Te,Oe;if(J.charCodeAt(st)===Y){for(;Te++<be&&J.charCodeAt(Te)!==Y||J.charCodeAt(++Te)===Y;);return(He=Te)>=be?Jt=!0:(Oe=J.charCodeAt(Te++))===z?Mt=!0:Oe===i&&(Mt=!0,J.charCodeAt(Te)===z&&++Te),J.slice(st+1,He-1).replace(/""/g,'"')}for(;Te<be;){if((Oe=J.charCodeAt(He=Te++))===z)Mt=!0;else if(Oe===i)Mt=!0,J.charCodeAt(Te)===z&&++Te;else if(Oe!==Ie)continue;return J.slice(st,He)}return Jt=!0,J.slice(st,be)}for(;(at=ve())!==m;){for(var ge=[];at!==x&&at!==m;)ge.push(at),at=ve();if(H&&(ge=H(ge,me++))==null)continue;Se.push(ge)}return Se}function we(J,H){return J.map(function(Se){return H.map(function(be){return oe(Se[be])}).join(St)})}function pt(J,H){return H==null&&(H=Q(J)),[H.map(oe).join(St)].concat(we(J,H)).join(`
`)}function Wt(J,H){return H==null&&(H=Q(J)),we(J,H).join(`
`)}function Qt(J){return J.map(ur).join(`
`)}function ur(J){return J.map(oe).join(St)}function oe(J){return J==null?"":J instanceof Date?K(J):De.test(J+="")?'"'+J.replace(/"/g,'""')+'"':J}return{parse:Ge,parseRows:dt,format:pt,formatBody:Wt,formatRows:Qt,formatRow:ur,formatValue:oe}},pe=je(","),Ke=pe.parse,Pe=pe.parseRows,ht=pe.format,Le=pe.formatBody,_t=pe.formatRows,ot=pe.formatRow,et=pe.formatValue,Ze=o("5zYK");function At(St,De){var Ie=Ke(St);return Object(Ze.a)(Ie,De)}},gQMU:function(Ue,y,o){var x=o("0ZTe"),m=x("toUpperCase");Ue.exports=m},gzZq:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingToSyntax=void 0;var x=o("MON2"),m=o("FV85"),Y=o("D9lx"),z=o("LKzl"),i=function(){function W(D){this._binding=D}return W.prototype.to=function(D){return this._binding.type=m.BindingTypeEnum.Instance,this._binding.implementationType=D,new Y.BindingInWhenOnSyntax(this._binding)},W.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+x.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},W.prototype.toConstantValue=function(D){return this._binding.type=m.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toDynamicValue=function(D){return this._binding.type=m.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new Y.BindingInWhenOnSyntax(this._binding)},W.prototype.toConstructor=function(D){return this._binding.type=m.BindingTypeEnum.Constructor,this._binding.implementationType=D,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=D,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(x.INVALID_FUNCTION_BINDING);var Q=this.toConstantValue(D);return this._binding.type=m.BindingTypeEnum.Function,Q},W.prototype.toAutoFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=function(Q){var ee=function(){return Q.container.get(D)};return ee},new z.BindingWhenOnSyntax(this._binding)},W.prototype.toProvider=function(D){return this._binding.type=m.BindingTypeEnum.Provider,this._binding.provider=D,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toService=function(D){this.toDynamicValue(function(Q){return Q.container.get(D)})},W}();y.BindingToSyntax=i},h1nZ:function(Ue,y,o){"use strict";var x=o("fX6N");o.d(y,"container",function(){return x.c}),o.d(y,"createSceneContainer",function(){return x.b}),o.d(y,"createLayerContainer",function(){return x.a}),o.d(y,"lazyInject",function(){return x.d});var m=o("+em5"),Y=o("bB6j");o.d(y,"TYPES",function(){return Y.a});var z=o("8/Fi"),i=o("PUg6");o.d(y,"BlendType",function(){return i.a});var W=o("cZlC");o.d(y,"AttributeType",function(){return W.a}),o.d(y,"ScaleTypes",function(){return W.b}),o.d(y,"StyleScaleType",function(){return W.c});var D=o("O1je"),Q=o.n(D);o.o(D,"CameraUniform")&&o.d(y,"CameraUniform",function(){return D.CameraUniform}),o.o(D,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return D.CityBuildingLayer}),o.o(D,"Control")&&o.d(y,"Control",function(){return D.Control}),o.o(D,"CoordinateSystem")&&o.d(y,"CoordinateSystem",function(){return D.CoordinateSystem}),o.o(D,"CoordinateUniform")&&o.d(y,"CoordinateUniform",function(){return D.CoordinateUniform}),o.o(D,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return D.HeatmapLayer}),o.o(D,"ImageLayer")&&o.d(y,"ImageLayer",function(){return D.ImageLayer}),o.o(D,"LineLayer")&&o.d(y,"LineLayer",function(){return D.LineLayer}),o.o(D,"Logo")&&o.d(y,"Logo",function(){return D.Logo}),o.o(D,"MapServiceEvent")&&o.d(y,"MapServiceEvent",function(){return D.MapServiceEvent}),o.o(D,"Marker")&&o.d(y,"Marker",function(){return D.Marker}),o.o(D,"PointLayer")&&o.d(y,"PointLayer",function(){return D.PointLayer}),o.o(D,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return D.PolygonLayer}),o.o(D,"Popup")&&o.d(y,"Popup",function(){return D.Popup}),o.o(D,"PositionType")&&o.d(y,"PositionType",function(){return D.PositionType}),o.o(D,"RasterLayer")&&o.d(y,"RasterLayer",function(){return D.RasterLayer}),o.o(D,"Scale")&&o.d(y,"Scale",function(){return D.Scale}),o.o(D,"Scene")&&o.d(y,"Scene",function(){return D.Scene}),o.o(D,"SceneEventList")&&o.d(y,"SceneEventList",function(){return D.SceneEventList}),o.o(D,"Zoom")&&o.d(y,"Zoom",function(){return D.Zoom}),o.o(D,"gl")&&o.d(y,"gl",function(){return D.gl});var ee=o("L56e");o.d(y,"MapServiceEvent",function(){return ee.a});var ce=o("HthE");o.d(y,"CoordinateSystem",function(){return ce.a}),o.d(y,"CoordinateUniform",function(){return ce.b});var K=o("/33/"),je=o.n(K);o.o(K,"CameraUniform")&&o.d(y,"CameraUniform",function(){return K.CameraUniform}),o.o(K,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return K.CityBuildingLayer}),o.o(K,"Control")&&o.d(y,"Control",function(){return K.Control}),o.o(K,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return K.HeatmapLayer}),o.o(K,"ImageLayer")&&o.d(y,"ImageLayer",function(){return K.ImageLayer}),o.o(K,"LineLayer")&&o.d(y,"LineLayer",function(){return K.LineLayer}),o.o(K,"Logo")&&o.d(y,"Logo",function(){return K.Logo}),o.o(K,"Marker")&&o.d(y,"Marker",function(){return K.Marker}),o.o(K,"PointLayer")&&o.d(y,"PointLayer",function(){return K.PointLayer}),o.o(K,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return K.PolygonLayer}),o.o(K,"Popup")&&o.d(y,"Popup",function(){return K.Popup}),o.o(K,"PositionType")&&o.d(y,"PositionType",function(){return K.PositionType}),o.o(K,"RasterLayer")&&o.d(y,"RasterLayer",function(){return K.RasterLayer}),o.o(K,"Scale")&&o.d(y,"Scale",function(){return K.Scale}),o.o(K,"Scene")&&o.d(y,"Scene",function(){return K.Scene}),o.o(K,"SceneEventList")&&o.d(y,"SceneEventList",function(){return K.SceneEventList}),o.o(K,"Zoom")&&o.d(y,"Zoom",function(){return K.Zoom}),o.o(K,"gl")&&o.d(y,"gl",function(){return K.gl});var pe=o("EfZ0");o.d(y,"CameraUniform",function(){return pe.a});var Ke=o("riiI"),Pe=o.n(Ke);o.o(Ke,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Ke.CityBuildingLayer}),o.o(Ke,"Control")&&o.d(y,"Control",function(){return Ke.Control}),o.o(Ke,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Ke.HeatmapLayer}),o.o(Ke,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Ke.ImageLayer}),o.o(Ke,"LineLayer")&&o.d(y,"LineLayer",function(){return Ke.LineLayer}),o.o(Ke,"Logo")&&o.d(y,"Logo",function(){return Ke.Logo}),o.o(Ke,"Marker")&&o.d(y,"Marker",function(){return Ke.Marker}),o.o(Ke,"PointLayer")&&o.d(y,"PointLayer",function(){return Ke.PointLayer}),o.o(Ke,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Ke.PolygonLayer}),o.o(Ke,"Popup")&&o.d(y,"Popup",function(){return Ke.Popup}),o.o(Ke,"PositionType")&&o.d(y,"PositionType",function(){return Ke.PositionType}),o.o(Ke,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Ke.RasterLayer}),o.o(Ke,"Scale")&&o.d(y,"Scale",function(){return Ke.Scale}),o.o(Ke,"Scene")&&o.d(y,"Scene",function(){return Ke.Scene}),o.o(Ke,"SceneEventList")&&o.d(y,"SceneEventList",function(){return Ke.SceneEventList}),o.o(Ke,"Zoom")&&o.d(y,"Zoom",function(){return Ke.Zoom}),o.o(Ke,"gl")&&o.d(y,"gl",function(){return Ke.gl});var ht=o("eg+a");o.d(y,"SceneEventList",function(){return ht.a});var Le=o("bYl4"),_t=o.n(Le);o.o(Le,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Le.CityBuildingLayer}),o.o(Le,"Control")&&o.d(y,"Control",function(){return Le.Control}),o.o(Le,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Le.HeatmapLayer}),o.o(Le,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Le.ImageLayer}),o.o(Le,"LineLayer")&&o.d(y,"LineLayer",function(){return Le.LineLayer}),o.o(Le,"Logo")&&o.d(y,"Logo",function(){return Le.Logo}),o.o(Le,"Marker")&&o.d(y,"Marker",function(){return Le.Marker}),o.o(Le,"PointLayer")&&o.d(y,"PointLayer",function(){return Le.PointLayer}),o.o(Le,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Le.PolygonLayer}),o.o(Le,"Popup")&&o.d(y,"Popup",function(){return Le.Popup}),o.o(Le,"PositionType")&&o.d(y,"PositionType",function(){return Le.PositionType}),o.o(Le,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Le.RasterLayer}),o.o(Le,"Scale")&&o.d(y,"Scale",function(){return Le.Scale}),o.o(Le,"Scene")&&o.d(y,"Scene",function(){return Le.Scene}),o.o(Le,"Zoom")&&o.d(y,"Zoom",function(){return Le.Zoom}),o.o(Le,"gl")&&o.d(y,"gl",function(){return Le.gl});var ot=o("FI6e"),et=o.n(ot);o.o(ot,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return ot.CityBuildingLayer}),o.o(ot,"Control")&&o.d(y,"Control",function(){return ot.Control}),o.o(ot,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return ot.HeatmapLayer}),o.o(ot,"ImageLayer")&&o.d(y,"ImageLayer",function(){return ot.ImageLayer}),o.o(ot,"LineLayer")&&o.d(y,"LineLayer",function(){return ot.LineLayer}),o.o(ot,"Logo")&&o.d(y,"Logo",function(){return ot.Logo}),o.o(ot,"Marker")&&o.d(y,"Marker",function(){return ot.Marker}),o.o(ot,"PointLayer")&&o.d(y,"PointLayer",function(){return ot.PointLayer}),o.o(ot,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return ot.PolygonLayer}),o.o(ot,"Popup")&&o.d(y,"Popup",function(){return ot.Popup}),o.o(ot,"PositionType")&&o.d(y,"PositionType",function(){return ot.PositionType}),o.o(ot,"RasterLayer")&&o.d(y,"RasterLayer",function(){return ot.RasterLayer}),o.o(ot,"Scale")&&o.d(y,"Scale",function(){return ot.Scale}),o.o(ot,"Scene")&&o.d(y,"Scene",function(){return ot.Scene}),o.o(ot,"Zoom")&&o.d(y,"Zoom",function(){return ot.Zoom}),o.o(ot,"gl")&&o.d(y,"gl",function(){return ot.gl});var Ze=o("D+ow"),At=o.n(Ze);o.o(Ze,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Ze.CityBuildingLayer}),o.o(Ze,"Control")&&o.d(y,"Control",function(){return Ze.Control}),o.o(Ze,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Ze.HeatmapLayer}),o.o(Ze,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Ze.ImageLayer}),o.o(Ze,"LineLayer")&&o.d(y,"LineLayer",function(){return Ze.LineLayer}),o.o(Ze,"Logo")&&o.d(y,"Logo",function(){return Ze.Logo}),o.o(Ze,"Marker")&&o.d(y,"Marker",function(){return Ze.Marker}),o.o(Ze,"PointLayer")&&o.d(y,"PointLayer",function(){return Ze.PointLayer}),o.o(Ze,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Ze.PolygonLayer}),o.o(Ze,"Popup")&&o.d(y,"Popup",function(){return Ze.Popup}),o.o(Ze,"PositionType")&&o.d(y,"PositionType",function(){return Ze.PositionType}),o.o(Ze,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Ze.RasterLayer}),o.o(Ze,"Scale")&&o.d(y,"Scale",function(){return Ze.Scale}),o.o(Ze,"Scene")&&o.d(y,"Scene",function(){return Ze.Scene}),o.o(Ze,"Zoom")&&o.d(y,"Zoom",function(){return Ze.Zoom}),o.o(Ze,"gl")&&o.d(y,"gl",function(){return Ze.gl});var St=o("AFH1");o.d(y,"PositionType",function(){return St.a});var De=o("8uyu"),Ie=o.n(De);o.o(De,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return De.CityBuildingLayer}),o.o(De,"Control")&&o.d(y,"Control",function(){return De.Control}),o.o(De,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return De.HeatmapLayer}),o.o(De,"ImageLayer")&&o.d(y,"ImageLayer",function(){return De.ImageLayer}),o.o(De,"LineLayer")&&o.d(y,"LineLayer",function(){return De.LineLayer}),o.o(De,"Logo")&&o.d(y,"Logo",function(){return De.Logo}),o.o(De,"Marker")&&o.d(y,"Marker",function(){return De.Marker}),o.o(De,"PointLayer")&&o.d(y,"PointLayer",function(){return De.PointLayer}),o.o(De,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return De.PolygonLayer}),o.o(De,"Popup")&&o.d(y,"Popup",function(){return De.Popup}),o.o(De,"RasterLayer")&&o.d(y,"RasterLayer",function(){return De.RasterLayer}),o.o(De,"Scale")&&o.d(y,"Scale",function(){return De.Scale}),o.o(De,"Scene")&&o.d(y,"Scene",function(){return De.Scene}),o.o(De,"Zoom")&&o.d(y,"Zoom",function(){return De.Zoom}),o.o(De,"gl")&&o.d(y,"gl",function(){return De.gl});var Ge=o("J7lC"),dt=o.n(Ge);o.o(Ge,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Ge.CityBuildingLayer}),o.o(Ge,"Control")&&o.d(y,"Control",function(){return Ge.Control}),o.o(Ge,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Ge.HeatmapLayer}),o.o(Ge,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Ge.ImageLayer}),o.o(Ge,"LineLayer")&&o.d(y,"LineLayer",function(){return Ge.LineLayer}),o.o(Ge,"Logo")&&o.d(y,"Logo",function(){return Ge.Logo}),o.o(Ge,"Marker")&&o.d(y,"Marker",function(){return Ge.Marker}),o.o(Ge,"PointLayer")&&o.d(y,"PointLayer",function(){return Ge.PointLayer}),o.o(Ge,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Ge.PolygonLayer}),o.o(Ge,"Popup")&&o.d(y,"Popup",function(){return Ge.Popup}),o.o(Ge,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Ge.RasterLayer}),o.o(Ge,"Scale")&&o.d(y,"Scale",function(){return Ge.Scale}),o.o(Ge,"Scene")&&o.d(y,"Scene",function(){return Ge.Scene}),o.o(Ge,"Zoom")&&o.d(y,"Zoom",function(){return Ge.Zoom}),o.o(Ge,"gl")&&o.d(y,"gl",function(){return Ge.gl});var we=o("QGbF"),pt=o.n(we);o.o(we,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return we.CityBuildingLayer}),o.o(we,"Control")&&o.d(y,"Control",function(){return we.Control}),o.o(we,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return we.HeatmapLayer}),o.o(we,"ImageLayer")&&o.d(y,"ImageLayer",function(){return we.ImageLayer}),o.o(we,"LineLayer")&&o.d(y,"LineLayer",function(){return we.LineLayer}),o.o(we,"Logo")&&o.d(y,"Logo",function(){return we.Logo}),o.o(we,"Marker")&&o.d(y,"Marker",function(){return we.Marker}),o.o(we,"PointLayer")&&o.d(y,"PointLayer",function(){return we.PointLayer}),o.o(we,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return we.PolygonLayer}),o.o(we,"Popup")&&o.d(y,"Popup",function(){return we.Popup}),o.o(we,"RasterLayer")&&o.d(y,"RasterLayer",function(){return we.RasterLayer}),o.o(we,"Scale")&&o.d(y,"Scale",function(){return we.Scale}),o.o(we,"Scene")&&o.d(y,"Scene",function(){return we.Scene}),o.o(we,"Zoom")&&o.d(y,"Zoom",function(){return we.Zoom}),o.o(we,"gl")&&o.d(y,"gl",function(){return we.gl});var Wt=o("V1cb"),Qt=o("bzyH"),ur=o.n(Qt);o.o(Qt,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Qt.CityBuildingLayer}),o.o(Qt,"Control")&&o.d(y,"Control",function(){return Qt.Control}),o.o(Qt,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Qt.HeatmapLayer}),o.o(Qt,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Qt.ImageLayer}),o.o(Qt,"LineLayer")&&o.d(y,"LineLayer",function(){return Qt.LineLayer}),o.o(Qt,"Logo")&&o.d(y,"Logo",function(){return Qt.Logo}),o.o(Qt,"Marker")&&o.d(y,"Marker",function(){return Qt.Marker}),o.o(Qt,"PointLayer")&&o.d(y,"PointLayer",function(){return Qt.PointLayer}),o.o(Qt,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Qt.PolygonLayer}),o.o(Qt,"Popup")&&o.d(y,"Popup",function(){return Qt.Popup}),o.o(Qt,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Qt.RasterLayer}),o.o(Qt,"Scale")&&o.d(y,"Scale",function(){return Qt.Scale}),o.o(Qt,"Scene")&&o.d(y,"Scene",function(){return Qt.Scene}),o.o(Qt,"Zoom")&&o.d(y,"Zoom",function(){return Qt.Zoom}),o.o(Qt,"gl")&&o.d(y,"gl",function(){return Qt.gl});var oe=o("0eqD"),J=o.n(oe);o.o(oe,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return oe.CityBuildingLayer}),o.o(oe,"Control")&&o.d(y,"Control",function(){return oe.Control}),o.o(oe,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return oe.HeatmapLayer}),o.o(oe,"ImageLayer")&&o.d(y,"ImageLayer",function(){return oe.ImageLayer}),o.o(oe,"LineLayer")&&o.d(y,"LineLayer",function(){return oe.LineLayer}),o.o(oe,"Logo")&&o.d(y,"Logo",function(){return oe.Logo}),o.o(oe,"Marker")&&o.d(y,"Marker",function(){return oe.Marker}),o.o(oe,"PointLayer")&&o.d(y,"PointLayer",function(){return oe.PointLayer}),o.o(oe,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return oe.PolygonLayer}),o.o(oe,"Popup")&&o.d(y,"Popup",function(){return oe.Popup}),o.o(oe,"RasterLayer")&&o.d(y,"RasterLayer",function(){return oe.RasterLayer}),o.o(oe,"Scale")&&o.d(y,"Scale",function(){return oe.Scale}),o.o(oe,"Scene")&&o.d(y,"Scene",function(){return oe.Scene}),o.o(oe,"Zoom")&&o.d(y,"Zoom",function(){return oe.Zoom}),o.o(oe,"gl")&&o.d(y,"gl",function(){return oe.gl});var H=o("/Uc5"),Se=o.n(H);o.o(H,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return H.CityBuildingLayer}),o.o(H,"Control")&&o.d(y,"Control",function(){return H.Control}),o.o(H,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return H.HeatmapLayer}),o.o(H,"ImageLayer")&&o.d(y,"ImageLayer",function(){return H.ImageLayer}),o.o(H,"LineLayer")&&o.d(y,"LineLayer",function(){return H.LineLayer}),o.o(H,"Logo")&&o.d(y,"Logo",function(){return H.Logo}),o.o(H,"Marker")&&o.d(y,"Marker",function(){return H.Marker}),o.o(H,"PointLayer")&&o.d(y,"PointLayer",function(){return H.PointLayer}),o.o(H,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return H.PolygonLayer}),o.o(H,"Popup")&&o.d(y,"Popup",function(){return H.Popup}),o.o(H,"RasterLayer")&&o.d(y,"RasterLayer",function(){return H.RasterLayer}),o.o(H,"Scale")&&o.d(y,"Scale",function(){return H.Scale}),o.o(H,"Scene")&&o.d(y,"Scene",function(){return H.Scene}),o.o(H,"Zoom")&&o.d(y,"Zoom",function(){return H.Zoom}),o.o(H,"gl")&&o.d(y,"gl",function(){return H.gl});var be=o("RMtq"),Te=o.n(be);o.o(be,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return be.CityBuildingLayer}),o.o(be,"Control")&&o.d(y,"Control",function(){return be.Control}),o.o(be,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return be.HeatmapLayer}),o.o(be,"ImageLayer")&&o.d(y,"ImageLayer",function(){return be.ImageLayer}),o.o(be,"LineLayer")&&o.d(y,"LineLayer",function(){return be.LineLayer}),o.o(be,"Logo")&&o.d(y,"Logo",function(){return be.Logo}),o.o(be,"Marker")&&o.d(y,"Marker",function(){return be.Marker}),o.o(be,"PointLayer")&&o.d(y,"PointLayer",function(){return be.PointLayer}),o.o(be,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return be.PolygonLayer}),o.o(be,"Popup")&&o.d(y,"Popup",function(){return be.Popup}),o.o(be,"RasterLayer")&&o.d(y,"RasterLayer",function(){return be.RasterLayer}),o.o(be,"Scale")&&o.d(y,"Scale",function(){return be.Scale}),o.o(be,"Scene")&&o.d(y,"Scene",function(){return be.Scene}),o.o(be,"Zoom")&&o.d(y,"Zoom",function(){return be.Zoom}),o.o(be,"gl")&&o.d(y,"gl",function(){return be.gl});var me=o("1jvM"),at=o.n(me);o.o(me,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return me.CityBuildingLayer}),o.o(me,"Control")&&o.d(y,"Control",function(){return me.Control}),o.o(me,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return me.HeatmapLayer}),o.o(me,"ImageLayer")&&o.d(y,"ImageLayer",function(){return me.ImageLayer}),o.o(me,"LineLayer")&&o.d(y,"LineLayer",function(){return me.LineLayer}),o.o(me,"Logo")&&o.d(y,"Logo",function(){return me.Logo}),o.o(me,"Marker")&&o.d(y,"Marker",function(){return me.Marker}),o.o(me,"PointLayer")&&o.d(y,"PointLayer",function(){return me.PointLayer}),o.o(me,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return me.PolygonLayer}),o.o(me,"Popup")&&o.d(y,"Popup",function(){return me.Popup}),o.o(me,"RasterLayer")&&o.d(y,"RasterLayer",function(){return me.RasterLayer}),o.o(me,"Scale")&&o.d(y,"Scale",function(){return me.Scale}),o.o(me,"Scene")&&o.d(y,"Scene",function(){return me.Scene}),o.o(me,"Zoom")&&o.d(y,"Zoom",function(){return me.Zoom}),o.o(me,"gl")&&o.d(y,"gl",function(){return me.gl});var Jt=o("bPkA"),Mt=o("PSsN"),ve=o.n(Mt);o.o(Mt,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return Mt.CityBuildingLayer}),o.o(Mt,"Control")&&o.d(y,"Control",function(){return Mt.Control}),o.o(Mt,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return Mt.HeatmapLayer}),o.o(Mt,"ImageLayer")&&o.d(y,"ImageLayer",function(){return Mt.ImageLayer}),o.o(Mt,"LineLayer")&&o.d(y,"LineLayer",function(){return Mt.LineLayer}),o.o(Mt,"Logo")&&o.d(y,"Logo",function(){return Mt.Logo}),o.o(Mt,"Marker")&&o.d(y,"Marker",function(){return Mt.Marker}),o.o(Mt,"PointLayer")&&o.d(y,"PointLayer",function(){return Mt.PointLayer}),o.o(Mt,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return Mt.PolygonLayer}),o.o(Mt,"Popup")&&o.d(y,"Popup",function(){return Mt.Popup}),o.o(Mt,"RasterLayer")&&o.d(y,"RasterLayer",function(){return Mt.RasterLayer}),o.o(Mt,"Scale")&&o.d(y,"Scale",function(){return Mt.Scale}),o.o(Mt,"Scene")&&o.d(y,"Scene",function(){return Mt.Scene}),o.o(Mt,"Zoom")&&o.d(y,"Zoom",function(){return Mt.Zoom}),o.o(Mt,"gl")&&o.d(y,"gl",function(){return Mt.gl});var ge=o("6NqC"),He=o.n(ge);o.o(ge,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return ge.CityBuildingLayer}),o.o(ge,"Control")&&o.d(y,"Control",function(){return ge.Control}),o.o(ge,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return ge.HeatmapLayer}),o.o(ge,"ImageLayer")&&o.d(y,"ImageLayer",function(){return ge.ImageLayer}),o.o(ge,"LineLayer")&&o.d(y,"LineLayer",function(){return ge.LineLayer}),o.o(ge,"Logo")&&o.d(y,"Logo",function(){return ge.Logo}),o.o(ge,"Marker")&&o.d(y,"Marker",function(){return ge.Marker}),o.o(ge,"PointLayer")&&o.d(y,"PointLayer",function(){return ge.PointLayer}),o.o(ge,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return ge.PolygonLayer}),o.o(ge,"Popup")&&o.d(y,"Popup",function(){return ge.Popup}),o.o(ge,"RasterLayer")&&o.d(y,"RasterLayer",function(){return ge.RasterLayer}),o.o(ge,"Scale")&&o.d(y,"Scale",function(){return ge.Scale}),o.o(ge,"Scene")&&o.d(y,"Scene",function(){return ge.Scene}),o.o(ge,"Zoom")&&o.d(y,"Zoom",function(){return ge.Zoom}),o.o(ge,"gl")&&o.d(y,"gl",function(){return ge.gl});var st=o("bTtR"),Oe=o.n(st);o.o(st,"CityBuildingLayer")&&o.d(y,"CityBuildingLayer",function(){return st.CityBuildingLayer}),o.o(st,"Control")&&o.d(y,"Control",function(){return st.Control}),o.o(st,"HeatmapLayer")&&o.d(y,"HeatmapLayer",function(){return st.HeatmapLayer}),o.o(st,"ImageLayer")&&o.d(y,"ImageLayer",function(){return st.ImageLayer}),o.o(st,"LineLayer")&&o.d(y,"LineLayer",function(){return st.LineLayer}),o.o(st,"Logo")&&o.d(y,"Logo",function(){return st.Logo}),o.o(st,"Marker")&&o.d(y,"Marker",function(){return st.Marker}),o.o(st,"PointLayer")&&o.d(y,"PointLayer",function(){return st.PointLayer}),o.o(st,"PolygonLayer")&&o.d(y,"PolygonLayer",function(){return st.PolygonLayer}),o.o(st,"Popup")&&o.d(y,"Popup",function(){return st.Popup}),o.o(st,"RasterLayer")&&o.d(y,"RasterLayer",function(){return st.RasterLayer}),o.o(st,"Scale")&&o.d(y,"Scale",function(){return st.Scale}),o.o(st,"Scene")&&o.d(y,"Scene",function(){return st.Scene}),o.o(st,"Zoom")&&o.d(y,"Zoom",function(){return st.Zoom}),o.o(st,"gl")&&o.d(y,"gl",function(){return st.gl});var gt=o("o+pz");o.d(y,"gl",function(){return gt.a})},h7MG:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.getBindingDictionary=y.createMockRequest=y.plan=void 0;var x=o("doU7"),m=o("MON2"),Y=o("FV85"),z=o("xfSm"),i=o("qK8v"),W=o("ujMp"),D=o("oy+k"),Q=o("GXnB"),ee=o("yMAV"),ce=o("fbrv"),K=o("xiII"),je=o("dX1H");function pe(Ze){return Ze._bindingDictionary}y.getBindingDictionary=pe;function Ke(Ze,At,St,De,Ie,Ge){var dt=Ze?z.MULTI_INJECT_TAG:z.INJECT_TAG,we=new Q.Metadata(dt,St),pt=new je.Target(At,De,St,we);if(Ie!==void 0){var Wt=new Q.Metadata(Ie,Ge);pt.metadata.push(Wt)}return pt}function Pe(Ze,At,St,De,Ie){var Ge=_t(St.container,Ie.serviceIdentifier),dt=[];return Ge.length===x.BindingCount.NoBindingsAvailable&&St.container.options.autoBindInjectable&&typeof Ie.serviceIdentifier=="function"&&Ze.getConstructorMetadata(Ie.serviceIdentifier).compilerGeneratedMetadata&&(St.container.bind(Ie.serviceIdentifier).toSelf(),Ge=_t(St.container,Ie.serviceIdentifier)),At?dt=Ge:dt=Ge.filter(function(we){var pt=new K.Request(we.serviceIdentifier,St,De,we,Ie);return we.constraint(pt)}),ht(Ie.serviceIdentifier,dt,Ie,St.container),dt}function ht(Ze,At,St,De){switch(At.length){case x.BindingCount.NoBindingsAvailable:if(St.isOptional())return At;var Ie=W.getServiceIdentifierAsString(Ze),Ge=m.NOT_REGISTERED;throw Ge+=W.listMetadataForTarget(Ie,St),Ge+=W.listRegisteredBindingsForServiceIdentifier(De,Ie,_t),new Error(Ge);case x.BindingCount.OnlyOneBindingAvailable:if(!St.isArray())return At;case x.BindingCount.MultipleBindingsAvailable:default:if(St.isArray())return At;var Ie=W.getServiceIdentifierAsString(Ze),Ge=m.AMBIGUOUS_MATCH+" "+Ie;throw Ge+=W.listRegisteredBindingsForServiceIdentifier(De,Ie,_t),new Error(Ge)}}function Le(Ze,At,St,De,Ie,Ge){var dt,we;if(Ie===null){dt=Pe(Ze,At,De,null,Ge),we=new K.Request(St,De,null,dt,Ge);var pt=new ee.Plan(De,we);De.addPlan(pt)}else dt=Pe(Ze,At,De,Ie,Ge),we=Ie.addChildRequest(Ge.serviceIdentifier,dt,Ge);dt.forEach(function(Wt){var Qt=null;if(Ge.isArray())Qt=we.addChildRequest(Wt.serviceIdentifier,Wt,Ge);else{if(Wt.cache)return;Qt=we}if(Wt.type===Y.BindingTypeEnum.Instance&&Wt.implementationType!==null){var ur=ce.getDependencies(Ze,Wt.implementationType);if(!De.container.options.skipBaseClassChecks){var oe=ce.getBaseClassDependencyCount(Ze,Wt.implementationType);if(ur.length<oe){var J=m.ARGUMENTS_LENGTH_MISMATCH(ce.getFunctionName(Wt.implementationType));throw new Error(J)}}ur.forEach(function(H){Le(Ze,!1,H.serviceIdentifier,De,Qt,H)})}})}function _t(Ze,At){var St=[],De=pe(Ze);return De.hasKey(At)?St=De.get(At):Ze.parent!==null&&(St=_t(Ze.parent,At)),St}function ot(Ze,At,St,De,Ie,Ge,dt,we){we===void 0&&(we=!1);var pt=new D.Context(At),Wt=Ke(St,De,Ie,"",Ge,dt);try{return Le(Ze,we,Ie,pt,null,Wt),pt}catch(Qt){throw i.isStackOverflowExeption(Qt)&&(pt.plan&&W.circularDependencyToException(pt.plan.rootRequest)),Qt}}y.plan=ot;function et(Ze,At,St,De){var Ie=new je.Target(Y.TargetTypeEnum.Variable,"",At,new Q.Metadata(St,De)),Ge=new D.Context(Ze),dt=new K.Request(At,Ge,null,[],Ie);return dt}y.createMockRequest=et},heNW:function(Ue,y){function o(x,m,Y){switch(Y.length){case 0:return x.call(m);case 1:return x.call(m,Y[0]);case 2:return x.call(m,Y[0],Y[1]);case 3:return x.call(m,Y[0],Y[1],Y[2])}return x.apply(m,Y)}Ue.exports=o},hi0z:function(Ue,y,o){"use strict";(function(x,m){Ue.exports=m()})(this,function(){function x(ce){var K=[];return ce.AMapUI&&K.push(m(ce.AMapUI)),ce.Loca&&K.push(Y(ce.Loca)),Promise.all(K)}function m(ce){return new Promise(function(K,je){var pe=[];if(ce.plugins)for(var Ke=0;Ke<ce.plugins.length;Ke+=1)i.AMapUI.plugins.indexOf(ce.plugins[Ke])==-1&&pe.push(ce.plugins[Ke]);if(W.AMapUI===z.failed)je("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(W.AMapUI===z.notload){W.AMapUI=z.loading,i.AMapUI.version=ce.version||i.AMapUI.version,Ke=i.AMapUI.version;var Pe=document.body||document.head,ht=document.createElement("script");ht.type="text/javascript",ht.src="https://webapi.amap.com/ui/"+Ke+"/main.js",ht.onerror=function(Le){W.AMapUI=z.failed,je("\u8BF7\u6C42 AMapUI \u5931\u8D25")},ht.onload=function(){if(W.AMapUI=z.loaded,pe.length)window.AMapUI.loadUI(pe,function(){for(var Le=0,_t=pe.length;Le<_t;Le++){var ot=pe[Le].split("/").slice(-1)[0];window.AMapUI[ot]=arguments[Le]}for(K();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(K();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},Pe.appendChild(ht)}else W.AMapUI===z.loaded?ce.version&&ce.version!==i.AMapUI.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):pe.length?window.AMapUI.loadUI(pe,function(){for(var Le=0,_t=pe.length;Le<_t;Le++){var ot=pe[Le].split("/").slice(-1)[0];window.AMapUI[ot]=arguments[Le]}K()}):K():ce.version&&ce.version!==i.AMapUI.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(Le){Le?je(Le):pe.length?window.AMapUI.loadUI(pe,function(){for(var _t=0,ot=pe.length;_t<ot;_t++){var et=pe[_t].split("/").slice(-1)[0];window.AMapUI[et]=arguments[_t]}K()}):K()})})}function Y(ce){return new Promise(function(K,je){if(i.AMap.version.startsWith("2.0"))je("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(W.Loca===z.failed)je("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(W.Loca===z.notload){W.Loca=z.loading,i.Loca.version=ce.version||i.Loca.version;var pe=i.Loca.version,Ke=i.key,Pe=document.body||document.head,ht=document.createElement("script");ht.type="text/javascript",ht.src="https://webapi.amap.com/loca?v="+pe+"&key="+Ke,ht.onerror=function(Le){W.Loca=z.failed,je("\u8BF7\u6C42 AMapUI \u5931\u8D25")},ht.onload=function(){for(W.Loca=z.loaded,K();D.Loca.length;)D.Loca.splice(0,1)[0]()},Pe.appendChild(ht)}else W.Loca===z.loaded?ce.version&&ce.version!==i.Loca.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):K():ce.version&&ce.version!==i.Loca.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(Le){Le?je(Le):je()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var z;(function(ce){ce.notload="notload",ce.loading="loading",ce.loaded="loaded",ce.failed="failed"})(z||(z={}));var i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},W={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]},Q=[],ee=function(K){typeof K=="function"&&(W.AMap===z.loaded?K(window.AMap):Q.push(K))};return{load:function(K){return new Promise(function(je,pe){if(W.AMap==z.failed)pe("");else if(W.AMap==z.notload){var Ke=K.key,Pe=K.version,ht=K.plugins;Ke?(window.AMap&&location.host!=="lbs.amap.com"&&pe("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),i.key=Ke,i.AMap.version=Pe||i.AMap.version,i.AMap.plugins=ht||i.AMap.plugins,W.AMap=z.loading,Pe=document.body||document.head,window.___onAPILoaded=function(_t){if(delete window.___onAPILoaded,_t)W.AMap=z.failed,pe(_t);else for(W.AMap=z.loaded,x(K).then(function(){je(window.AMap)}).catch(pe);Q.length;)Q.splice(0,1)[0]()},ht=document.createElement("script"),ht.type="text/javascript",ht.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+i.AMap.version+"&key="+Ke+"&plugin="+i.AMap.plugins.join(","),ht.onerror=function(_t){W.AMap=z.failed,pe(_t)},Pe.appendChild(ht)):pe("\u8BF7\u586B\u5199key")}else if(W.AMap==z.loaded)if(K.key&&K.key!==i.key)pe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(K.version&&K.version!==i.AMap.version)pe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(Ke=[],K.plugins)for(Pe=0;Pe<K.plugins.length;Pe+=1)i.AMap.plugins.indexOf(K.plugins[Pe])==-1&&Ke.push(K.plugins[Pe]);Ke.length?window.AMap.plugin(Ke,function(){x(K).then(function(){je(window.AMap)}).catch(pe)}):x(K).then(function(){je(window.AMap)}).catch(pe)}else if(K.key&&K.key!==i.key)pe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(K.version&&K.version!==i.AMap.version)pe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Le=[];if(K.plugins)for(Pe=0;Pe<K.plugins.length;Pe+=1)i.AMap.plugins.indexOf(K.plugins[Pe])==-1&&Le.push(K.plugins[Pe]);ee(function(){Le.length?window.AMap.plugin(Le,function(){x(K).then(function(){je(window.AMap)}).catch(pe)}):x(K).then(function(){je(window.AMap)}).catch(pe)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},W={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(Ue,y,o){var x=o("O0oS");function m(Y,z,i){z=="__proto__"&&x?x(Y,z,{configurable:!0,enumerable:!0,value:i,writable:!0}):Y[z]=i}Ue.exports=m},iWIM:function(Ue,y,o){var x=o("n3AX");function m(Y,z,i){return typeof Reflect!="undefined"&&Reflect.get?Ue.exports=m=Reflect.get:Ue.exports=m=function(D,Q,ee){var ce=x(D,Q);if(!ce)return;var K=Object.getOwnPropertyDescriptor(ce,Q);return K.get?K.get.call(ee):K.value},m(Y,z,i||Y)}Ue.exports=m},iegG:function(Ue,y){function o(x){var m=x.target||x.srcElement;m.__resizeRAF__&&cancelAnimationFrame(m.__resizeRAF__),m.__resizeRAF__=requestAnimationFrame(function(){var Y=m.__resizeTrigger__,z=Y&&Y.__resizeListeners__;z&&z.forEach(function(i){i.call(Y,x)})})}var y=function(m,Y){var z=this,i=z.document,W,D=i.attachEvent;typeof navigator!="undefined"&&(W=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function Q(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",o)}if(!m.__resizeListeners__)if(m.__resizeListeners__=[],D)m.__resizeTrigger__=m,m.attachEvent("onresize",o);else{getComputedStyle(m).position==="static"&&(m.style.position="relative");var ee=m.__resizeTrigger__=i.createElement("object");ee.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),ee.setAttribute("class","resize-sensor"),ee.setAttribute("tabindex","-1"),ee.__resizeElement__=m,ee.onload=Q,ee.type="text/html",W&&m.appendChild(ee),ee.data="about:blank",W||m.appendChild(ee)}m.__resizeListeners__.push(Y)};Ue.exports=typeof window=="undefined"?y:y.bind(window),Ue.exports.unbind=function(x,m){var Y=document.attachEvent,z=x.__resizeListeners__||[];if(m){var i=z.indexOf(m);i!==-1&&z.splice(i,1)}else z=x.__resizeListeners__=[];if(!z.length){if(Y)x.detachEvent("onresize",o);else if(x.__resizeTrigger__){var W=x.__resizeTrigger__.contentDocument,D=W&&W.defaultView;D&&(D.removeEventListener("resize",o),delete D.__resizeTrigger__),x.__resizeTrigger__=!x.removeChild(x.__resizeTrigger__)}delete x.__resizeListeners__}}},itsj:function(Ue,y){function o(x,m){return m==="constructor"&&typeof x[m]=="function"||m=="__proto__"?void 0:x[m]}Ue.exports=o},jCWc:function(Ue,y,o){"use strict";var x=o("cIOH"),m=o("1GLa")},"jIg/":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.multiInject=void 0;var x=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function z(i){return function(W,D,Q){var ee=new m.Metadata(x.MULTI_INJECT_TAG,i);typeof Q=="number"?Y.tagParameter(W,D,Q,ee):Y.tagProperty(W,D,ee)}}y.multiInject=z},jYQm:function(Ue,y,o){"use strict";var x=o("q1tI"),m=o.n(x),Y=Object(x.createContext)({});y.a=Y},jYx5:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.optional=void 0;var x=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function z(){return function(i,W,D){var Q=new m.Metadata(x.OPTIONAL_TAG,!0);typeof D=="number"?Y.tagParameter(i,W,D,Q):Y.tagProperty(i,W,Q)}}y.optional=z},"jbM+":function(Ue,y,o){var x=o("R/W3");function m(Y,z){var i=Y==null?0:Y.length;return!!i&&x(Y,z,0)>-1}Ue.exports=m},jeLo:function(Ue,y,o){var x=o("juv8"),m=o("mTTR");function Y(z){return x(z,m(z))}Ue.exports=Y},juv8:function(Ue,y,o){var x=o("MrPd"),m=o("hypo");function Y(z,i,W,D){var Q=!W;W||(W={});for(var ee=-1,ce=i.length;++ee<ce;){var K=i[ee],je=D?D(W[K],z[K],K,W,z):void 0;je===void 0&&(je=z[K]),Q?m(W,K,je):x(W,K,je)}return W}Ue.exports=Y},"k5/I":function(Ue,y,o){"use strict";o.d(y,"a",function(){return At}),o.d(y,"b",function(){return Wt}),o.d(y,"e",function(){return oe}),o.d(y,"f",function(){return Se}),o.d(y,"c",function(){return Jt}),o.d(y,"d",function(){return Tt});var x=o("lSNA"),m=o.n(x),Y=o("lwsE"),z=o.n(Y),i=o("W8MJ"),W=o.n(i),D=o("7W2i"),Q=o.n(D),ee=o("a1gu"),ce=o.n(ee),K=o("Nsbk"),je=o.n(K),pe=o("h1nZ"),Ke=o("Hel2"),Pe=o("uhBA");function ht(it,Ut){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(it);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(it,ne).enumerable})),$.push.apply($,Qe)}return $}function Le(it){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?ht(Object($),!0).forEach(function(Qe){m()(it,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):ht(Object($)).forEach(function(Qe){Object.defineProperty(it,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return it}function _t(it){var Ut=ot();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function ot(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var et;(function(it){it.TOPRIGHT="topright",it.TOPLEFT="topleft",it.BOTTOMRIGHT="bottomright",it.BOTTOMLEFT="bottomleft"})(et||(et={}));var Ze=0,At=function(it){Q()($,it);var Ut=_t($);function $(Qe){var ne;return z()(this,$),ne=Ut.call(this),ne.controlOption=void 0,ne.container=void 0,ne.sceneContainer=void 0,ne.mapsService=void 0,ne.renderService=void 0,ne.layerService=void 0,ne.controlService=void 0,ne.isShow=void 0,ne.controlOption=Le(Le({},ne.getDefault()),Qe||{}),ne}return W()($,[{key:"getDefault",value:function(){return{position:et.TOPRIGHT,name:"".concat(Ze++)}}},{key:"setPosition",value:function(ne){var tt=this.controlService;return tt&&tt.removeControl(this),this.controlOption.position=ne,tt&&tt.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ne){this.mapsService=ne.get(pe.TYPES.IMapService),this.renderService=ne.get(pe.TYPES.IRendererService),this.layerService=ne.get(pe.TYPES.ILayerService),this.controlService=ne.get(pe.TYPES.IControlService),this.sceneContainer=ne,this.isShow=!0,this.container=this.onAdd();var tt=this.container,kt=this.controlOption.position,dr=this.controlService.controlCorners[kt];return Ke.a.addClass(tt,"l7-control"),kt.indexOf("bottom")!==-1?dr.insertBefore(tt,dr.firstChild):dr.appendChild(tt),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ne=this.container;Ke.a.addClass(ne,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ne=this.container;Ke.a.removeClass(ne,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;Ke.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ne){if(this.mapsService&&ne&&ne.screenX>0&&ne.screenY>0){var tt=this.mapsService.getContainer();tt!==null&&tt.focus()}}}]),$}(Pe.EventEmitter),St=o("PJYZ"),De=o.n(St);function Ie(it){var Ut=Ge();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function Ge(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var dt=function(it){Q()($,it);var Ut=Ie($);function $(Qe){var ne;return z()(this,$),ne=Ut.call(this,Qe),ne.layerControlInputs=void 0,ne.layers=void 0,ne.lastZIndex=void 0,ne.handlingClick=void 0,ne.layersLink=void 0,ne.baseLayersList=void 0,ne.separator=void 0,ne.overlaysList=void 0,ne.form=void 0,ne.layerControlInputs=[],ne.layers=[],ne.lastZIndex=0,ne.handlingClick=!1,ne.initLayers(),Object(Ke.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],De()(ne)),ne}return W()($,[{key:"getDefault",value:function(){return{collapsed:!0,position:pe.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ne=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(tt){tt.layer.on("remove",ne.onLayerChange),tt.layer.on("add",ne.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ne,tt){return this.addLayer(ne,tt,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ne=this.renderService.getViewportSize(),tt=ne.height;Ke.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var kt=tt-(this.container.offsetTop+50);return kt<this.form.clientHeight?(Ke.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=kt+"px"):Ke.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return Ke.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ne=this;if(!this.mapsService)return;this.mapsService.off("click",this.collapse),this.layers.forEach(function(tt){tt.layer.off("remove",ne.onLayerChange),tt.layer.off("add",ne.onLayerChange)})}},{key:"initLayout",value:function(){var ne="l7-control-layers",tt=this.container=Ke.a.create("div",ne),kt=this.controlOption.collapsed;tt.setAttribute("aria-haspopup","true");var dr=this.form=Ke.a.create("form",ne+"-list");kt&&(this.mapsService.on("click",this.collapse),tt.addEventListener("mouseenter",this.expand),tt.addEventListener("mouseleave",this.collapse)),this.layersLink=Ke.a.create("a",ne+"-toggle",tt);var Ye=this.layersLink;Ye.title="Layers",kt||this.expand(),this.baseLayersList=Ke.a.create("div",ne+"-base",dr),this.separator=Ke.a.create("div",ne+"-separator",dr),this.overlaysList=Ke.a.create("div",ne+"-overlays",dr),tt.appendChild(dr)}},{key:"initLayers",value:function(){var ne=this,tt=this.controlOption,kt=tt.baseLayers,dr=kt===void 0?{}:kt,Ye=tt.overlayers,xt=Ye===void 0?{}:Ye;Object.keys(dr).forEach(function(bt,Et){ne.addLayer(dr[bt],bt,!1)}),Object.keys(xt).forEach(function(bt,Et){ne.addLayer(xt[bt],bt,!0)})}},{key:"update",value:function(){if(!this.container)return this;Ke.a.empty(this.baseLayersList),Ke.a.empty(this.overlaysList),this.layerControlInputs=[];var ne,tt,kt,dr,Ye=0;for(kt=0;kt<this.layers.length;kt++)dr=this.layers[kt],this.addItem(dr),tt=tt||dr.overlay,ne=ne||!dr.overlay,Ye+=dr.overlay?0:1;return this.controlOption.hideSingleBase&&(ne=ne&&Ye>1,this.baseLayersList.style.display=ne?"":"none"),this.separator.style.display=tt&&ne?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ne=this.layerControlInputs,tt,kt,dr=this.mapsService.getZoom(),Ye=ne.length-1;Ye>=0;Ye--)if(tt=ne[Ye],kt=this.layerService.getLayer(tt.layerId),kt&&kt.inited){var xt=kt.getMinZoom(),bt=kt.getMaxZoom();tt.disabled=dr<xt||dr>bt}}},{key:"addLayer",value:function(ne,tt,kt){this.mapsService&&(ne.on("add",this.onLayerChange),ne.on("remove",this.onLayerChange)),this.layers.push({layer:ne,name:tt,overlay:kt});var dr=this.controlOption,Ye=dr.sortLayers,xt=dr.sortFunction,bt=dr.autoZIndex;Ye&&this.layers.sort(function(Et,ze){return xt(Et.layer,ze.layer,Et.name,ze.name)}),bt&&ne.setZIndex&&(this.lastZIndex++,ne.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ne){this.handlingClick||this.update();var tt=this.layerService.getLayer(ne.target.layerId),kt=(tt==null?void 0:tt.overlay)?ne.type==="add"?"overlayadd":"overlayremove":ne.type==="add"?"baselayerchange":null;kt&&this.emit(kt,tt)}},{key:"createRadioElement",value:function(ne,tt){var kt='<input type="radio" class="l7-control-layers-selector" name="'+ne+'"'+(tt?' checked="checked"':"")+"/>",dr=document.createElement("div");return dr.innerHTML=kt,dr.firstChild}},{key:"addItem",value:function(ne){var tt=document.createElement("label"),kt=this.layerService.getLayer(ne.layer.id),dr=kt&&kt.inited&&ne.layer.isVisible(),Ye;ne.overlay?(Ye=document.createElement("input"),Ye.type="checkbox",Ye.className="l7-control-layers-selector",Ye.defaultChecked=dr):Ye=this.createRadioElement("l7-base-layers",dr),this.layerControlInputs.push(Ye),Ye.layerId=ne.layer.id,Ye.addEventListener("click",this.onInputClick);var xt=document.createElement("span");xt.innerHTML=" "+ne.name;var bt=document.createElement("div");tt.appendChild(bt),bt.appendChild(Ye),bt.appendChild(xt);var Et=ne.overlay?this.overlaysList:this.baseLayersList;return Et.appendChild(tt),this.checkDisabledLayers(),tt}},{key:"onInputClick",value:function(){var ne=this.layerControlInputs,tt,kt,dr=[],Ye=[];this.handlingClick=!0;for(var xt=ne.length-1;xt>=0;xt--)tt=ne[xt],kt=this.layerService.getLayer(tt.layerId),tt.checked?dr.push(kt):tt.checked||Ye.push(kt);Ye.forEach(function(bt){bt.hide()}),dr.forEach(function(bt){bt.show()}),this.handlingClick=!1}}]),$}(At);function we(it){var Ut=pt();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function pt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Wt=function(it){Q()($,it);var Ut=we($);function $(){return z()(this,$),Ut.apply(this,arguments)}return W()($,[{key:"getDefault",value:function(){return{position:et.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ne="l7-control-logo",tt=Ke.a.create("div",ne),kt=Ke.a.create("a","l7-ctrl-logo");return kt.target="_blank",kt.rel="noopener nofollow",kt.href="https://antv.alipay.com/l7",kt.setAttribute("aria-label","AntV logo"),kt.setAttribute("rel","noopener nofollow"),tt.appendChild(kt),tt}},{key:"onRemove",value:function(){return null}}]),$}(At);function Qt(it){var Ut=ur();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function ur(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var oe=function(it){Q()($,it);var Ut=Qt($);function $(Qe){var ne;return z()(this,$),ne=Ut.call(this,Qe),ne.mScale=void 0,ne.iScale=void 0,Object(Ke.i)(["update"],De()(ne)),ne}return W()($,[{key:"getDefault",value:function(){return{position:et.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ne="l7-control-scale",tt=Ke.a.create("div",ne);this.addScales(ne+"-line",tt);var kt=this.controlOption.updateWhenIdle;return this.mapsService.on(kt?"moveend":"mapmove",this.update),this.mapsService.on(kt?"zoomend":"zoomchange",this.update),this.update(),tt}},{key:"onRemove",value:function(){var ne=this.controlOption.updateWhenIdle;this.mapsService.off(ne?"zoomend":"zoomchange",this.update),this.mapsService.off(ne?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ne=this.mapsService,tt=this.controlOption.maxWidth,kt=ne.getSize()[1]/2,dr=ne.containerToLngLat([0,kt]),Ye=ne.containerToLngLat([tt,kt]),xt=Object(Ke.q)([dr.lng,dr.lat],[Ye.lng,Ye.lat]);this.updateScales(xt)}},{key:"updateScales",value:function(ne){var tt=this.controlOption,kt=tt.metric,dr=tt.imperial;kt&&ne&&this.updateMetric(ne),dr&&ne&&this.updateImperial(ne)}},{key:"updateMetric",value:function(ne){var tt=this.getRoundNum(ne),kt=tt<1e3?tt+" m":tt/1e3+" km";this.updateScale(this.mScale,kt,tt/ne)}},{key:"updateImperial",value:function(ne){var tt=ne*3.2808399,kt,dr,Ye;tt>5280?(kt=tt/5280,dr=this.getRoundNum(kt),this.updateScale(this.iScale,dr+" mi",dr/kt)):(Ye=this.getRoundNum(tt),this.updateScale(this.iScale,Ye+" ft",Ye/tt))}},{key:"updateScale",value:function(ne,tt,kt){var dr=this.controlOption.maxWidth;ne.style.width=Math.round(dr*kt)+"px",ne.innerHTML=tt}},{key:"getRoundNum",value:function(ne){var tt=Math.pow(10,(Math.floor(ne)+"").length-1),kt=ne/tt;return kt=kt>=10?10:kt>=5?5:kt>=3?3:kt>=2?2:1,tt*kt}},{key:"addScales",value:function(ne,tt){var kt=this.controlOption,dr=kt.metric,Ye=kt.imperial;dr&&(this.mScale=Ke.a.create("div",ne,tt)),Ye&&(this.iScale=Ke.a.create("div",ne,tt))}}]),$}(At);function J(it){var Ut=H();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Se=function(it){Q()($,it);var Ut=J($);function $(Qe){var ne;return z()(this,$),ne=Ut.call(this,Qe),ne.disabled=void 0,ne.zoomInButton=void 0,ne.zoomOutButton=void 0,Object(Ke.i)(["updateDisabled","zoomIn","zoomOut"],De()(ne)),ne}return W()($,[{key:"getDefault",value:function(){return{position:et.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ne="l7-control-zoom",tt=Ke.a.create("div",ne+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ne+"-in",tt,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ne+"-out",tt,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),tt}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ne,tt,kt,dr,Ye){var xt=Ke.a.create("a",kt,dr);return xt.innerHTML=ne,xt.title=tt,xt.href="javascript:void(0)",xt.addEventListener("click",Ye),xt}},{key:"updateDisabled",value:function(){var ne=this.mapsService,tt="l7-disabled";Ke.a.removeClass(this.zoomInButton,tt),Ke.a.removeClass(this.zoomOutButton,tt),(this.disabled||ne.getZoom()<=ne.getMinZoom())&&Ke.a.addClass(this.zoomOutButton,tt),(this.disabled||ne.getZoom()>=ne.getMaxZoom())&&Ke.a.addClass(this.zoomInButton,tt)}}]),$}(At);function be(it,Ut){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(it);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(it,ne).enumerable})),$.push.apply($,Qe)}return $}function Te(it){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?be(Object($),!0).forEach(function(Qe){m()(it,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):be(Object($)).forEach(function(Qe){Object.defineProperty(it,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return it}function me(it){var Ut=at();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function at(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Jt=function(it){Q()($,it);var Ut=me($);function $(Qe){var ne;return z()(this,$),ne=Ut.call(this),ne.markerOption=void 0,ne.defaultMarker=void 0,ne.popup=void 0,ne.mapsService=void 0,ne.sceneSerive=void 0,ne.lngLat=void 0,ne.scene=void 0,ne.added=!1,ne.eventHandle=function(tt){ne.emit(tt.type,{target:tt,data:ne.markerOption.extData,lngLat:ne.lngLat})},ne.markerOption=Te(Te({},ne.getDefault()),Qe),Object(Ke.i)(["update","onMove","onUp","addDragHandler","onMapClick"],De()(ne)),ne.init(),ne}return W()($,[{key:"getDefault",value:function(){return{element:void 0,anchor:Ke.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ne){this.scene=ne,this.mapsService=ne.get(pe.TYPES.IMapService),this.sceneSerive=ne.get(pe.TYPES.ISceneService);var tt=this.markerOption,kt=tt.element,dr=tt.draggable;return this.mapsService.getMarkerContainer().appendChild(kt),this.registerMarkerEvent(kt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ne=this.markerOption.element;return ne&&Ke.a.remove(ne),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ne){return this.lngLat=ne,Array.isArray(ne)&&(this.lngLat={lng:ne[0],lat:ne[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ne){var tt=this;if(!this.added)return this.once("added",function(){tt.setElement(ne)}),this;var kt=this.markerOption.element;return kt&&Ke.a.remove(kt),this.markerOption.element=ne,this.init(),this.mapsService.getMarkerContainer().appendChild(ne),this.registerMarkerEvent(ne),this.update(),this}},{key:"openPopup",value:function(){var ne=this;if(!this.added)return this.once("added",function(){ne.openPopup()}),this;var tt=this.popup;return tt?(tt.isOpen()||tt.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ne=this;this.added||this.once("added",function(){ne.closePopup()});var tt=this.popup;return tt&&tt.remove(),this}},{key:"setPopup",value:function(ne){return this.popup=ne,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ne=this.popup;if(ne)ne.isOpen()?ne.remove():ne.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ne){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ne){this.markerOption.extData=ne}},{key:"update",value:function(){if(!this.mapsService)return;var ne=this.markerOption,tt=ne.element,kt=ne.anchor;this.updatePosition(),Ke.a.setTransform(tt,"".concat(Ke.e[kt]))}},{key:"onMapClick",value:function(ne){var tt=this.markerOption.element;this.popup&&tt&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ne=this.markerOption,tt=ne.element,kt=ne.offsets,dr=this.lngLat,Ye=dr.lng,xt=dr.lat,bt=this.mapsService.getBounds(),Et=this.mapsService.getZoom();if((Ye<bt[0][0]||Ye>bt[1][0]||xt<bt[0][1]||xt>bt[1][1])&&Et>3){tt&&(tt.style.display="none");return}var ze=this.mapsService.lngLatToContainer([Ye,xt]);tt&&(tt.style.display="block",tt.style.left=ze.x+kt[0]+"px",tt.style.top=ze.y-kt[1]+"px")}},{key:"init",value:function(){var ne=this,tt=this.markerOption.element,kt=this.markerOption,dr=kt.color,Ye=kt.anchor;if(!tt){this.defaultMarker=!0,tt=Ke.a.create("div"),this.markerOption.element=tt;var xt=document.createElementNS("http://www.w3.org/2000/svg","svg");xt.setAttributeNS(null,"display","block"),xt.setAttributeNS(null,"height","48px"),xt.setAttributeNS(null,"width","48px"),xt.setAttributeNS(null,"viewBox","0 0 1024 1024");var bt=document.createElementNS("http://www.w3.org/2000/svg","path");bt.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),bt.setAttributeNS(null,"fill",dr),xt.appendChild(bt),tt.appendChild(xt)}Ke.a.addClass(tt,"l7-marker"),tt.addEventListener("click",function(Et){ne.onMapClick(Et)}),tt.addEventListener("click",this.eventHandle),Object(Ke.g)(tt,Ye,"marker")}},{key:"registerMarkerEvent",value:function(ne){ne.addEventListener("mousemove",this.eventHandle),ne.addEventListener("click",this.eventHandle),ne.addEventListener("mousedown",this.eventHandle),ne.addEventListener("mouseup",this.eventHandle),ne.addEventListener("dblclick",this.eventHandle),ne.addEventListener("contextmenu",this.eventHandle),ne.addEventListener("mouseover",this.eventHandle),ne.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ne=this.getElement();ne.removeEventListener("mousemove",this.eventHandle),ne.removeEventListener("click",this.eventHandle),ne.removeEventListener("mousedown",this.eventHandle),ne.removeEventListener("mouseup",this.eventHandle),ne.removeEventListener("dblclick",this.eventHandle),ne.removeEventListener("contextmenu",this.eventHandle),ne.removeEventListener("mouseover",this.eventHandle),ne.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ne){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ne){throw new Error("Method not implemented.")}}]),$}(Pe.EventEmitter),Mt=o("QkVN"),ve=o.n(Mt),ge=o("mpbz"),He=o.n(ge);function st(it,Ut){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(it);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(it,ne).enumerable})),$.push.apply($,Qe)}return $}function Oe(it){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?st(Object($),!0).forEach(function(Qe){m()(it,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):st(Object($)).forEach(function(Qe){Object.defineProperty(it,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return it}function gt(it){var Ut=C();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function C(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var R=function(it){Q()($,it);var Ut=gt($);function $(Qe){var ne,tt;return z()(this,$),tt=Ut.call(this),tt.markers=[],tt.markerLayerOption=void 0,tt.clusterIndex=void 0,tt.points=[],tt.clusterMarkers=[],tt.mapsService=void 0,tt.scene=void 0,tt.zoom=void 0,tt.bbox=void 0,tt.markerLayerOption=ve()(tt.getDefault(),Qe),Object(Ke.i)(["update"],De()(tt)),tt.zoom=((ne=tt.markerLayerOption.clusterOption)===null||ne===void 0?void 0:ne.zoom)||-99,tt}return W()($,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ne){return this.scene=ne,this.mapsService=ne.get(pe.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ne){var tt=this.markerLayerOption.cluster;tt&&this.addPoint(ne,this.markers.length),this.markers.push(ne)}},{key:"removeMarker",value:function(ne){this.markers.indexOf(ne);var tt=this.markers.indexOf(ne);tt>-1&&this.markers.splice(tt,1)}},{key:"getMarkers",value:function(){var ne=this.markerLayerOption.cluster;return ne?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ne=this;this.getMarkers().forEach(function(tt){tt.addTo(ne.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ne){ne.remove()}),this.clusterMarkers.forEach(function(ne){ne.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ne,tt){var kt=ne.getLnglat(),dr=kt.lng,Ye=kt.lat,xt={geometry:{type:"Point",coordinates:[dr,Ye]},properties:Oe(Oe({},ne.getExtData()),{},{marker_id:tt})};this.points.push(xt)}},{key:"initCluster",value:function(){if(!this.markerLayerOption.cluster)return;var ne=this.markerLayerOption.clusterOption,tt=ne.radius,kt=ne.minZoom,dr=kt===void 0?0:kt,Ye=ne.maxZoom;this.clusterIndex=new He.a({radius:tt,minZoom:dr,maxZoom:Ye}),this.clusterIndex.load(this.points)}},{key:"getClusterMarker",value:function(ne,tt){var kt=this,dr=ne[0].concat(ne[1]),Ye=this.clusterIndex.getClusters(dr,tt);this.clusterMarkers.forEach(function(xt){xt.remove()}),this.clusterMarkers=[],Ye.forEach(function(xt){var bt,Et=kt.markerLayerOption.clusterOption,ze=Et.field,vt=Et.method;if(xt.properties&&((bt=xt.properties)===null||bt===void 0?void 0:bt.cluster_id)){var yt,Ht=kt.getLeaves((yt=xt.properties)===null||yt===void 0?void 0:yt.cluster_id);if(xt.properties.clusterData=Ht,ze&&vt){var hr=Ht==null?void 0:Ht.map(function(oa){var $n=m()({},ze,oa.properties[ze]);return $n}),Hr=Ke.c.getColumn(hr,ze),gr=Ke.c.getSatByColumn(vt,Hr),Bn="point_"+vt;xt.properties[Bn]=gr.toFixed(2)}}var zn=kt.clusterMarker(xt);kt.clusterMarkers.push(zn),zn.addTo(kt.scene)})}},{key:"getLeaves",value:function(ne){var tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ne?this.clusterIndex.getLeaves(ne,tt,kt):null}},{key:"clusterMarker",value:function(ne){var tt=this.markerLayerOption.clusterOption,kt=tt,dr=kt.element,Ye=dr===void 0?this.generateElement.bind(this):dr,xt=new Jt({element:Ye(ne)}).setLnglat({lng:ne.geometry.coordinates[0],lat:ne.geometry.coordinates[1]});return xt}},{key:"normalMarker",value:function(ne){var tt=ne.properties.marker_id;return this.markers[tt]}},{key:"update",value:function(){var ne=this.mapsService.getZoom(),tt=this.mapsService.getBounds();(!this.bbox||Math.abs(ne-this.zoom)>=1||!Object(Ke.j)(this.bbox,tt))&&(this.bbox=Object(Ke.r)(tt,.5),this.zoom=Math.floor(ne),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ne){var tt=Ke.a.create("div","l7-marker-cluster"),kt=Ke.a.create("div","",tt),dr=Ke.a.create("span","",kt),Ye=this.markerLayerOption.clusterOption,xt=Ye.field,bt=Ye.method;ne.properties.point_count=ne.properties.point_count||1;var Et=xt&&bt?ne.properties["point_"+bt]||ne.properties[xt]:ne.properties.point_count;return dr.textContent=Et,tt}}]),$}(Pe.EventEmitter);function q(it,Ut){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(it);Ut&&(Qe=Qe.filter(function(ne){return Object.getOwnPropertyDescriptor(it,ne).enumerable})),$.push.apply($,Qe)}return $}function fe(it){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?q(Object($),!0).forEach(function(Qe){m()(it,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):q(Object($)).forEach(function(Qe){Object.defineProperty(it,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return it}function We(it){var Ut=qe();return function(){var Qe=je()(it),ne;if(Ut){var tt=je()(this).constructor;ne=Reflect.construct(Qe,arguments,tt)}else ne=Qe.apply(this,arguments);return ce()(this,ne)}}function qe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Tt=function(it){Q()($,it);var Ut=We($);function $(Qe){var ne;return z()(this,$),ne=Ut.call(this),ne.popupOption=void 0,ne.mapsService=void 0,ne.sceneSerive=void 0,ne.lngLat=void 0,ne.content=void 0,ne.closeButton=void 0,ne.timeoutInstance=void 0,ne.container=void 0,ne.tip=void 0,ne.scene=void 0,ne.popupOption=fe(fe({},ne.getdefault()),Qe),Object(Ke.i)(["update","onClickClose","remove"],De()(ne)),ne}return W()($,[{key:"addTo",value:function(ne){var tt=this;return this.mapsService=ne.get(pe.TYPES.IMapService),this.sceneSerive=ne.get(pe.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ne,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){tt.mapsService.on("click",tt.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ne){var tt=window.document.createDocumentFragment(),kt=window.document.createElement("body"),dr;for(kt.innerHTML=ne;!(dr=kt.firstChild,!dr);)tt.appendChild(dr);return this.setDOMContent(tt)}},{key:"setLnglat",value:function(ne){return this.lngLat=ne,Array.isArray(ne)&&(this.lngLat={lng:ne[0],lat:ne[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ne){return this.setDOMContent(window.document.createTextNode(ne))}},{key:"setMaxWidth",value:function(ne){return this.popupOption.maxWidth=ne,this.update(),this}},{key:"setDOMContent",value:function(ne){return this.createContent(),this.content.appendChild(ne),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&Ke.a.remove(this.content),this.content=Ke.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=Ke.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ne,tt,kt){var dr=window.document.createElement(ne);return tt!==void 0&&(dr.className=tt),kt&&kt.appendChild(dr),dr}},{key:"removeDom",value:function(ne){ne.parentNode&&ne.parentNode.removeChild(ne)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:Ke.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ne){ne.stopPropagation&&ne.stopPropagation(),this.remove()}},{key:"update",value:function(){var ne=this,tt=this.lngLat,kt=this.popupOption,dr=kt.className,Ye=kt.maxWidth,xt=kt.anchor;if(!this.mapsService||!tt||!this.content)return;var bt=this.mapsService.getMarkerContainer();if(!this.container&&bt){this.container=this.creatDom("div","l7-popup",bt),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),dr&&dr.split(" ").forEach(function(ze){return ne.container.classList.add(ze)});var Et=this.popupOption.stopPropagation;Et&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(ze){ne.container.addEventListener(ze,function(vt){vt.stopPropagation()})})}Ye&&this.container.style.maxWidth!==Ye&&(this.container.style.maxWidth=Ye),this.updatePosition(),Ke.a.setTransform(this.container,"".concat(Ke.e[xt])),Object(Ke.g)(this.container,xt,"popup")}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ne=this.lngLat,tt=ne.lng,kt=ne.lat,dr=this.popupOption.offsets,Ye=this.mapsService.lngLatToContainer([tt,kt]);this.container.style.left=Ye.x+dr[0]+"px",this.container.style.top=Ye.y-dr[1]+"px"}}]),$}(Pe.EventEmitter);o("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(Ue,y,o){"use strict";var x=o("/kpp");y.a=x.a},"kQ+U":function(Ue,y,o){"use strict";o.d(y,"a",function(){return xt});var x=o("lSNA"),m=o.n(x),Y=o("lwsE"),z=o.n(Y),i=o("W8MJ"),W=o.n(i),D=o("k5/I"),Q=o("h1nZ"),ee=o("o0o1"),ce=o.n(ee),K=o("yXPU"),je=o.n(K),pe=o("4cb6"),Ke=o("fbvF"),Pe=o.n(Ke),ht=function(){function bt(Et,ze){z()(this,bt),this.attribute=void 0,this.buffer=void 0;var vt=ze.buffer,yt=ze.offset,Ht=ze.stride,hr=ze.normalized,Hr=ze.size,gr=ze.divisor;this.buffer=vt,this.attribute={buffer:vt.get(),offset:yt||0,stride:Ht||0,normalized:hr||!1,divisor:gr||0},Hr&&(this.attribute.size=Hr)}return W()(bt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(ze){this.buffer.subData(ze)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),bt}(),Le,_t,ot,et,Ze,At,St,De,Ie,Ge,dt,we,pt,Wt,Qt=(Le={},m()(Le,Q.gl.POINTS,"points"),m()(Le,Q.gl.LINES,"lines"),m()(Le,Q.gl.LINE_LOOP,"line loop"),m()(Le,Q.gl.LINE_STRIP,"line strip"),m()(Le,Q.gl.TRIANGLES,"triangles"),m()(Le,Q.gl.TRIANGLE_FAN,"triangle fan"),m()(Le,Q.gl.TRIANGLE_STRIP,"triangle strip"),Le),ur=(_t={},m()(_t,Q.gl.STATIC_DRAW,"static"),m()(_t,Q.gl.DYNAMIC_DRAW,"dynamic"),m()(_t,Q.gl.STREAM_DRAW,"stream"),_t),oe=(ot={},m()(ot,Q.gl.BYTE,"int8"),m()(ot,Q.gl.UNSIGNED_INT,"int16"),m()(ot,Q.gl.INT,"int32"),m()(ot,Q.gl.UNSIGNED_BYTE,"uint8"),m()(ot,Q.gl.UNSIGNED_SHORT,"uint16"),m()(ot,Q.gl.UNSIGNED_INT,"uint32"),m()(ot,Q.gl.FLOAT,"float"),ot),J=(et={},m()(et,Q.gl.ALPHA,"alpha"),m()(et,Q.gl.LUMINANCE,"luminance"),m()(et,Q.gl.LUMINANCE_ALPHA,"luminance alpha"),m()(et,Q.gl.RGB,"rgb"),m()(et,Q.gl.RGBA,"rgba"),m()(et,Q.gl.RGBA4,"rgba4"),m()(et,Q.gl.RGB5_A1,"rgb5 a1"),m()(et,Q.gl.RGB565,"rgb565"),m()(et,Q.gl.DEPTH_COMPONENT,"depth"),m()(et,Q.gl.DEPTH_STENCIL,"depth stencil"),et),H=(Ze={},m()(Ze,Q.gl.DONT_CARE,"dont care"),m()(Ze,Q.gl.NICEST,"nice"),m()(Ze,Q.gl.FASTEST,"fast"),Ze),Se=(At={},m()(At,Q.gl.NEAREST,"nearest"),m()(At,Q.gl.LINEAR,"linear"),m()(At,Q.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),m()(At,Q.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),m()(At,Q.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),m()(At,Q.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),At),be=(St={},m()(St,Q.gl.REPEAT,"repeat"),m()(St,Q.gl.CLAMP_TO_EDGE,"clamp"),m()(St,Q.gl.MIRRORED_REPEAT,"mirror"),St),Te=(De={},m()(De,Q.gl.NONE,"none"),m()(De,Q.gl.BROWSER_DEFAULT_WEBGL,"browser"),De),me=(Ie={},m()(Ie,Q.gl.NEVER,"never"),m()(Ie,Q.gl.ALWAYS,"always"),m()(Ie,Q.gl.LESS,"less"),m()(Ie,Q.gl.LEQUAL,"lequal"),m()(Ie,Q.gl.GREATER,"greater"),m()(Ie,Q.gl.GEQUAL,"gequal"),m()(Ie,Q.gl.EQUAL,"equal"),m()(Ie,Q.gl.NOTEQUAL,"notequal"),Ie),at=(Ge={},m()(Ge,Q.gl.FUNC_ADD,"add"),m()(Ge,Q.gl.MIN_EXT,"min"),m()(Ge,Q.gl.MAX_EXT,"max"),m()(Ge,Q.gl.FUNC_SUBTRACT,"subtract"),m()(Ge,Q.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ge),Jt=(dt={},m()(dt,Q.gl.ZERO,"zero"),m()(dt,Q.gl.ONE,"one"),m()(dt,Q.gl.SRC_COLOR,"src color"),m()(dt,Q.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),m()(dt,Q.gl.SRC_ALPHA,"src alpha"),m()(dt,Q.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),m()(dt,Q.gl.DST_COLOR,"dst color"),m()(dt,Q.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),m()(dt,Q.gl.DST_ALPHA,"dst alpha"),m()(dt,Q.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),m()(dt,Q.gl.CONSTANT_COLOR,"constant color"),m()(dt,Q.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),m()(dt,Q.gl.CONSTANT_ALPHA,"constant alpha"),m()(dt,Q.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),m()(dt,Q.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),dt),Mt=(we={},m()(we,Q.gl.NEVER,"never"),m()(we,Q.gl.ALWAYS,"always"),m()(we,Q.gl.LESS,"less"),m()(we,Q.gl.LEQUAL,"lequal"),m()(we,Q.gl.GREATER,"greater"),m()(we,Q.gl.GEQUAL,"gequal"),m()(we,Q.gl.EQUAL,"equal"),m()(we,Q.gl.NOTEQUAL,"notequal"),we),ve=(pt={},m()(pt,Q.gl.ZERO,"zero"),m()(pt,Q.gl.KEEP,"keep"),m()(pt,Q.gl.REPLACE,"replace"),m()(pt,Q.gl.INVERT,"invert"),m()(pt,Q.gl.INCR,"increment"),m()(pt,Q.gl.DECR,"decrement"),m()(pt,Q.gl.INCR_WRAP,"increment wrap"),m()(pt,Q.gl.DECR_WRAP,"decrement wrap"),pt),ge=(Wt={},m()(Wt,Q.gl.FRONT,"front"),m()(Wt,Q.gl.BACK,"back"),Wt),He=function(){function bt(Et,ze){z()(this,bt),this.buffer=void 0;var vt=ze.data,yt=ze.usage,Ht=ze.type;this.buffer=Et.buffer({data:vt,usage:ur[yt||Q.gl.STATIC_DRAW],type:oe[Ht||Q.gl.UNSIGNED_BYTE]})}return W()(bt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(ze){var vt=ze.data,yt=ze.offset;this.buffer.subdata(vt,yt)}}]),bt}(),st=function(){function bt(Et,ze){z()(this,bt),this.elements=void 0;var vt=ze.data,yt=ze.usage,Ht=ze.type,hr=ze.count;this.elements=Et.elements({data:vt,usage:ur[yt||Q.gl.STATIC_DRAW],type:oe[Ht||Q.gl.UNSIGNED_BYTE],count:hr})}return W()(bt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(ze){var vt=ze.data;this.elements.subdata(vt)}},{key:"destroy",value:function(){}}]),bt}(),Oe=function(){function bt(Et,ze){z()(this,bt),this.framebuffer=void 0;var vt=ze.width,yt=ze.height,Ht=ze.color,hr=ze.colors,Hr=ze.depth,gr=ze.stencil,Bn={width:vt,height:yt};Array.isArray(hr)&&(Bn.colors=hr.map(function(zn){return zn.get()})),Ht&&typeof Ht!="boolean"&&(Bn.color=Ht.get()),this.framebuffer=Et.framebuffer(Bn)}return W()(bt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(ze){var vt=ze.width,yt=ze.height;this.framebuffer.resize(vt,yt)}}]),bt}(),gt=o("cDf5"),C=o.n(gt),R=o("c6wG"),q=o.n(R),fe=o("YO3V"),We=o.n(fe);function qe(bt,Et){var ze=Object.keys(bt);if(Object.getOwnPropertySymbols){var vt=Object.getOwnPropertySymbols(bt);Et&&(vt=vt.filter(function(yt){return Object.getOwnPropertyDescriptor(bt,yt).enumerable})),ze.push.apply(ze,vt)}return ze}function Tt(bt){for(var Et=1;Et<arguments.length;Et++){var ze=arguments[Et]!=null?arguments[Et]:{};Et%2?qe(Object(ze),!0).forEach(function(vt){m()(bt,vt,ze[vt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(bt,Object.getOwnPropertyDescriptors(ze)):qe(Object(ze)).forEach(function(vt){Object.defineProperty(bt,vt,Object.getOwnPropertyDescriptor(ze,vt))})}return bt}var it=function(){function bt(Et,ze){z()(this,bt),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=Et;var vt=ze.vs,yt=ze.fs,Ht=ze.attributes,hr=ze.uniforms,Hr=ze.primitive,gr=ze.count,Bn=ze.elements,zn=ze.depth,oa=ze.blend,$n=ze.stencil,Yn=ze.cull,On=ze.instances,U={};this.options=ze,hr&&(this.uniforms=this.extractUniforms(hr),Object.keys(hr).forEach(function(xe){U[xe]=Et.prop(xe)}));var Z={};Object.keys(Ht).forEach(function(xe){Z[xe]=Ht[xe].get()});var le={attributes:Z,frag:yt,uniforms:U,vert:vt,primitive:Qt[Hr===void 0?Q.gl.TRIANGLES:Hr]};On&&(le.instances=On),gr&&(le.count=gr),Bn&&(le.elements=Bn.get()),this.initDepthDrawParams({depth:zn},le),this.initBlendDrawParams({blend:oa},le),this.initStencilDrawParams({stencil:$n},le),this.initCullDrawParams({cull:Yn},le),this.drawCommand=Et(le),this.drawParams=le}return W()(bt,[{key:"addUniforms",value:function(ze){this.uniforms=Tt(Tt({},this.uniforms),this.extractUniforms(ze))}},{key:"draw",value:function(ze){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;var vt=Tt(Tt({},this.uniforms),this.extractUniforms(ze.uniforms||{})),yt={};Object.keys(vt).forEach(function(Ht){var hr=C()(vt[Ht]);hr==="boolean"||hr==="number"||Array.isArray(vt[Ht])||vt[Ht].BYTES_PER_ELEMENT?yt[Ht]=vt[Ht]:yt[Ht]=vt[Ht].get()}),this.drawCommand(yt)}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(ze){ze.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(ze,vt){var yt=ze.depth;yt&&(vt.depth={enable:yt.enable===void 0?!0:!!yt.enable,mask:yt.mask===void 0?!0:!!yt.mask,func:me[yt.func||Q.gl.LESS],range:yt.range||[0,1]})}},{key:"initBlendDrawParams",value:function(ze,vt){var yt=ze.blend;if(yt){var Ht=yt.enable,hr=yt.func,Hr=yt.equation,gr=yt.color,Bn=gr===void 0?[0,0,0,0]:gr;vt.blend={enable:!!Ht,func:{srcRGB:Jt[hr&&hr.srcRGB||Q.gl.SRC_ALPHA],srcAlpha:Jt[hr&&hr.srcAlpha||Q.gl.SRC_ALPHA],dstRGB:Jt[hr&&hr.dstRGB||Q.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Jt[hr&&hr.dstAlpha||Q.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:at[Hr&&Hr.rgb||Q.gl.FUNC_ADD],alpha:at[Hr&&Hr.alpha||Q.gl.FUNC_ADD]},color:Bn}}}},{key:"initStencilDrawParams",value:function(ze,vt){var yt=ze.stencil;if(yt){var Ht=yt.enable,hr=yt.mask,Hr=hr===void 0?-1:hr,gr=yt.func,Bn=gr===void 0?{cmp:Q.gl.ALWAYS,ref:0,mask:-1}:gr,zn=yt.opFront,oa=zn===void 0?{fail:Q.gl.KEEP,zfail:Q.gl.KEEP,zpass:Q.gl.KEEP}:zn,$n=yt.opBack,Yn=$n===void 0?{fail:Q.gl.KEEP,zfail:Q.gl.KEEP,zpass:Q.gl.KEEP}:$n;vt.stencil={enable:!!Ht,mask:Hr,func:Tt(Tt({},Bn),{},{cmp:Mt[Bn.cmp]}),opFront:{fail:ve[oa.fail],zfail:ve[oa.zfail],zpass:ve[oa.zpass]},opBack:{fail:ve[Yn.fail],zfail:ve[Yn.zfail],zpass:ve[Yn.zpass]}}}}},{key:"initCullDrawParams",value:function(ze,vt){var yt=ze.cull;if(yt){var Ht=yt.enable,hr=yt.face,Hr=hr===void 0?Q.gl.BACK:hr;vt.cull={enable:!!Ht,face:ge[Hr]}}}},{key:"extractUniforms",value:function(ze){var vt=this,yt={};return Object.keys(ze).forEach(function(Ht){vt.extractUniformsRecursively(Ht,ze[Ht],yt,"")}),yt}},{key:"extractUniformsRecursively",value:function(ze,vt,yt,Ht){var hr=this;if(vt===null||typeof vt=="number"||typeof vt=="boolean"||Array.isArray(vt)&&typeof vt[0]=="number"||q()(vt)||vt===""||"resize"in vt){yt["".concat(Ht&&Ht+".").concat(ze)]=vt;return}We()(vt)&&Object.keys(vt).forEach(function(Hr){hr.extractUniformsRecursively(Hr,vt[Hr],yt,"".concat(Ht&&Ht+".").concat(ze))}),Array.isArray(vt)&&vt.forEach(function(Hr,gr){Object.keys(Hr).forEach(function(Bn){hr.extractUniformsRecursively(Bn,Hr[Bn],yt,"".concat(Ht&&Ht+".").concat(ze,"[").concat(gr,"]"))})})}}]),bt}(),Ut=function(){function bt(Et,ze){z()(this,bt),this.texture=void 0,this.width=void 0,this.height=void 0;var vt=ze.data,yt=ze.type,Ht=yt===void 0?Q.gl.UNSIGNED_BYTE:yt,hr=ze.width,Hr=ze.height,gr=ze.flipY,Bn=gr===void 0?!1:gr,zn=ze.format,oa=zn===void 0?Q.gl.RGBA:zn,$n=ze.mipmap,Yn=$n===void 0?!1:$n,On=ze.wrapS,U=On===void 0?Q.gl.CLAMP_TO_EDGE:On,Z=ze.wrapT,le=Z===void 0?Q.gl.CLAMP_TO_EDGE:Z,xe=ze.aniso,ut=xe===void 0?0:xe,wt=ze.alignment,Bt=wt===void 0?1:wt,Xe=ze.premultiplyAlpha,Lt=Xe===void 0?!1:Xe,lr=ze.mag,zr=lr===void 0?Q.gl.NEAREST:lr,Vr=ze.min,cr=Vr===void 0?Q.gl.NEAREST:Vr,Ur=ze.colorSpace,Mn=Ur===void 0?Q.gl.BROWSER_DEFAULT_WEBGL:Ur;this.width=hr,this.height=Hr;var ln={width:hr,height:Hr,type:oe[Ht],format:J[oa],wrapS:be[U],wrapT:be[le],mag:Se[zr],min:Se[cr],alignment:Bt,flipY:Bn,colorSpace:Te[Mn],premultiplyAlpha:Lt,aniso:ut};vt&&(ln.data=vt),typeof Yn=="number"?ln.mipmap=H[Yn]:typeof Yn=="boolean"&&(ln.mipmap=Yn),this.texture=Et.texture(ln)}return W()(bt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(ze)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(ze){var vt=ze.width,yt=ze.height;this.texture.resize(vt,yt),this.width=vt,this.height=yt}},{key:"destroy",value:function(){this.texture.destroy()}}]),bt}(),$,Qe,ne,tt=($=Object(pe.injectable)(),$(Qe=(ne=function(){function bt(){var Et=this;z()(this,bt),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(ze){return new it(Et.gl,ze)},this.createAttribute=function(ze){return new ht(Et.gl,ze)},this.createBuffer=function(ze){return new He(Et.gl,ze)},this.createElements=function(ze){return new st(Et.gl,ze)},this.createTexture2D=function(ze){return new Ut(Et.gl,ze)},this.createFramebuffer=function(ze){return new Oe(Et.gl,ze)},this.useFramebuffer=function(ze,vt){Et.gl({framebuffer:ze?ze.get():null})(vt)},this.clear=function(ze){var vt=ze.color,yt=ze.depth,Ht=ze.stencil,hr=ze.framebuffer,Hr=hr===void 0?null:hr,gr={color:vt,depth:yt,stencil:Ht};gr.framebuffer=Hr===null?Hr:Hr.get(),Et.gl.clear(gr)},this.viewport=function(ze){var vt=ze.x,yt=ze.y,Ht=ze.width,hr=ze.height;Et.gl._gl.viewport(vt,yt,Ht,hr),Et.width=Ht,Et.height=hr,Et.gl._refresh()},this.readPixels=function(ze){var vt=ze.framebuffer,yt=ze.x,Ht=ze.y,hr=ze.width,Hr=ze.height,gr={x:yt,y:Ht,width:hr,height:Hr};return vt&&(gr.framebuffer=vt.get()),Et.gl.read(gr)},this.getViewportSize=function(){return{width:Et.gl._gl.drawingBufferWidth,height:Et.gl._gl.drawingBufferHeight}},this.getContainer=function(){var ze;return(ze=Et.canvas)===null||ze===void 0?void 0:ze.parentElement},this.getCanvas=function(){return Et.canvas},this.getGLContext=function(){return Et.gl._gl},this.destroy=function(){Et.gl.destroy()}}return W()(bt,[{key:"init",value:function(){var Et=je()(ce.a.mark(function vt(yt,Ht){var hr=this;return ce.a.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return this.canvas=yt,gr.next=3,new Promise(function(Bn,zn){Pe()({canvas:hr.canvas,attributes:{alpha:!0,antialias:Ht.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Ht.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function($n,Yn){($n||!Yn)&&zn($n),Bn(Yn)}})});case 3:this.gl=gr.sent;case 4:case"end":return gr.stop()}},vt,this)}));function ze(vt,yt){return Et.apply(this,arguments)}return ze}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var ze=this.getGLContext();ze.disable(ze.CULL_FACE)}},{key:"setDirty",value:function(ze){this.isDirty=ze}},{key:"getDirty",value:function(){return this.isDirty}}]),bt}(),ne))||Qe),kt=o("Hel2");function dr(bt,Et){var ze=Object.keys(bt);if(Object.getOwnPropertySymbols){var vt=Object.getOwnPropertySymbols(bt);Et&&(vt=vt.filter(function(yt){return Object.getOwnPropertyDescriptor(bt,yt).enumerable})),ze.push.apply(ze,vt)}return ze}function Ye(bt){for(var Et=1;Et<arguments.length;Et++){var ze=arguments[Et]!=null?arguments[Et]:{};Et%2?dr(Object(ze),!0).forEach(function(vt){m()(bt,vt,ze[vt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(bt,Object.getOwnPropertyDescriptors(ze)):dr(Object(ze)).forEach(function(vt){Object.defineProperty(bt,vt,Object.getOwnPropertyDescriptor(ze,vt))})}return bt}var xt=function(){function bt(Et){z()(this,bt),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var ze=Et.id,vt=Et.map,yt=Object(Q.createSceneContainer)();this.container=yt,vt.setContainer(yt,ze),yt.bind(Q.TYPES.IRendererService).to(tt).inSingletonScope(),this.sceneService=yt.get(Q.TYPES.ISceneService),this.mapService=yt.get(Q.TYPES.IMapService),this.iconService=yt.get(Q.TYPES.IIconService),this.fontService=yt.get(Q.TYPES.IFontService),this.controlService=yt.get(Q.TYPES.IControlService),this.layerService=yt.get(Q.TYPES.ILayerService),this.markerService=yt.get(Q.TYPES.IMarkerService),this.interactionService=yt.get(Q.TYPES.IInteractionService),this.popupService=yt.get(Q.TYPES.IPopupService),this.initComponent(ze),this.sceneService.init(Et),this.initControl()}return W()(bt,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(ze){return this.sceneService.exportPng(ze)}},{key:"exportMap",value:function(ze){return this.sceneService.exportPng(ze)}},{key:"registerRenderService",value:function(ze){var vt=this;if(this.sceneService.loaded){var yt=new ze(this);yt.init()}else this.on("loaded",function(){var Ht=new ze(vt);Ht.init()})}},{key:"addLayer",value:function(ze){var vt=Object(Q.createLayerContainer)(this.container);ze.setContainer(vt),this.sceneService.addLayer(ze)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(ze){return this.layerService.getLayer(ze)}},{key:"getLayerByName",value:function(ze){return this.layerService.getLayerByName(ze)}},{key:"removeLayer",value:function(ze){this.layerService.remove(ze)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(ze,vt){this.iconService.addImage(ze,vt)}},{key:"hasImage",value:function(ze){return this.iconService.hasImage(ze)}},{key:"removeImage",value:function(ze){this.iconService.removeImage(ze)}},{key:"addIconFontGlyphs",value:function(ze,vt){this.fontService.addIconGlyphs(vt)}},{key:"addControl",value:function(ze){this.controlService.addControl(ze,this.container)}},{key:"removeControl",value:function(ze){this.controlService.removeControl(ze)}},{key:"getControlByName",value:function(ze){return this.controlService.getControlByName(ze)}},{key:"addMarker",value:function(ze){this.markerService.addMarker(ze)}},{key:"addMarkerLayer",value:function(ze){this.markerService.addMarkerLayer(ze)}},{key:"removeMarkerLayer",value:function(ze){this.markerService.removeMarkerLayer(ze)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(ze){this.popupService.addPopup(ze)}},{key:"on",value:function(ze,vt){Q.SceneEventList.indexOf(ze)===-1?this.mapService.on(ze,vt):this.sceneService.on(ze,vt)}},{key:"off",value:function(ze,vt){Q.SceneEventList.indexOf(ze)===-1?this.mapService.off(ze,vt):this.sceneService.off(ze,vt)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(ze){return this.mapService.setCenter(ze)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(ze){return this.mapService.setPitch(ze)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(ze){this.mapService.setRotation(ze)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(ze){this.mapService.panTo(ze)}},{key:"panBy",value:function(ze){this.mapService.panBy(ze)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(ze){this.mapService.setZoom(ze)}},{key:"fitBounds",value:function(ze,vt){var yt=this.sceneService.getSceneConfig(),Ht=yt.fitBoundsOptions,hr=yt.animate;this.mapService.fitBounds(ze,vt||Ye(Ye({},Ht),{},{animate:hr}))}},{key:"setZoomAndCenter",value:function(ze,vt){this.mapService.setZoomAndCenter(ze,vt)}},{key:"setMapStyle",value:function(ze){this.mapService.setMapStyle(ze)}},{key:"setMapStatus",value:function(ze){this.mapService.setMapStatus(ze)}},{key:"pixelToLngLat",value:function(ze){return this.mapService.pixelToLngLat(ze)}},{key:"lngLatToPixel",value:function(ze){return this.mapService.lngLatToPixel(ze)}},{key:"containerToLngLat",value:function(ze){return this.mapService.containerToLngLat(ze)}},{key:"lngLatToContainer",value:function(ze){return this.mapService.lngLatToContainer(ze)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(ze,vt){this.container.bind(Q.TYPES.IPostProcessingPass).to(ze).whenTargetNamed(vt)}},{key:"initComponent",value:function(ze){this.controlService.init({container:kt.a.getContainer(ze)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var ze=this.sceneService.getSceneConfig(),vt=ze.logoVisible,yt=ze.logoPosition;vt&&this.addControl(new D.b({position:yt}))}},{key:"map",get:function(){return this.mapService.map}}]),bt}()},l94r:function(Ue,y,o){"use strict";o.d(y,"a",function(){return J});var x=o("lSNA"),m=o.n(x),Y=o("lwsE"),z=o.n(Y),i=o("W8MJ"),W=o.n(i),D=o("7W2i"),Q=o.n(D),ee=o("a1gu"),ce=o.n(ee),K=o("Nsbk"),je=o.n(K),pe=o("4qC0"),Ke=o.n(pe),Pe=o("lSCD"),ht=o.n(Pe),Le=o("BkRI"),_t=o.n(Le),ot=o("xp6e"),et=o("Hel2"),Ze=o("uhBA"),At=o("rlAn"),St=o("qxNg");function De(H){if(H.length===0)throw new Error("max requires at least one data point");for(var Se=H[0],be=1;be<H.length;be++)H[be]>Se&&(Se=H[be]);return Se}function Ie(H){if(H.length===0)throw new Error("min requires at least one data point");for(var Se=H[0],be=1;be<H.length;be++)H[be]<Se&&(Se=H[be]);return Se}function Ge(H){if(H.length===0)return 0;for(var Se=H[0],be=0,Te,me=1;me<H.length;me++)Te=Se+H[me]*1,Math.abs(Se)>=Math.abs(H[me])?be+=Se-Te+H[me]:be+=H[me]-Te+Se,Se=Te;return Se+be*1}function dt(H){if(H.length===0)throw new Error("mean requires at least one data point");return Ge(H)/H.length}var we={min:Ie,max:De,mean:dt,sum:Ge};function pt(H,Se){return H.map(function(be){return be[Se]*1})}function Wt(H,Se){var be=Object.keys(H);if(Object.getOwnPropertySymbols){var Te=Object.getOwnPropertySymbols(H);Se&&(Te=Te.filter(function(me){return Object.getOwnPropertyDescriptor(H,me).enumerable})),be.push.apply(be,Te)}return be}function Qt(H){for(var Se=1;Se<arguments.length;Se++){var be=arguments[Se]!=null?arguments[Se]:{};Se%2?Wt(Object(be),!0).forEach(function(Te){m()(H,Te,be[Te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(be)):Wt(Object(be)).forEach(function(Te){Object.defineProperty(H,Te,Object.getOwnPropertyDescriptor(be,Te))})}return H}function ur(H){var Se=oe();return function(){var Te=je()(H),me;if(Se){var at=je()(this).constructor;me=Reflect.construct(Te,arguments,at)}else me=Te.apply(this,arguments);return ce()(this,me)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(H){return!1}}var J=function(H){Q()(be,H);var Se=ur(be);function be(Te,me){var at;return z()(this,be),at=Se.call(this),at.data=void 0,at.extent=void 0,at.hooks={init:new ot.c},at.parser={type:"geojson"},at.transforms=[],at.cluster=!1,at.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},at.originData=void 0,at.rawData=void 0,at.clusterIndex=void 0,at.originData=Te,at.initCfg(me),at.hooks.init.tap("parser",function(){at.excuteParser()}),at.hooks.init.tap("cluster",function(){at.initCluster()}),at.hooks.init.tap("transform",function(){at.executeTrans()}),at.init(),at}return W()(be,[{key:"setData",value:function(me,at){this.rawData=me,this.originData=me,this.initCfg(at),this.init(),this.emit("update")}},{key:"getClusters",value:function(me){return this.clusterIndex.getClusters(this.extent,me)}},{key:"getClustersLeaves",value:function(me){return this.clusterIndex.getLeaves(me,Infinity)}},{key:"updateClusterData",value:function(me){var at=this,Jt=this.clusterOptions,Mt=Jt.method,ve=Mt===void 0?"sum":Mt,ge=Jt.field,He=Object(et.r)(Object(et.h)(this.extent),2),st=this.clusterIndex.getClusters(He[0].concat(He[1]),Math.floor(me));this.clusterOptions.zoom=me,st.forEach(function(Oe){Oe.id||(Oe.properties.point_count=1)}),(ge||ht()(ve))&&(st=st.map(function(Oe){var gt=Oe.id;if(gt){var C=at.clusterIndex.getLeaves(gt,Infinity),R=C.map(function(We){return We.properties}),q;if(Ke()(ve)&&ge){var fe=pt(R,ge);q=we[ve](fe)}ht()(ve)&&(q=ve(R)),Oe.properties.stat=q}else Oe.properties.point_count=1;return Oe})),this.data=Object(At.getParser)("geojson")({type:"FeatureCollection",features:st}),this.executeTrans()}},{key:"getFeatureById",value:function(me){var at=this.parser.type,Jt=at===void 0?"geojson":at;if(Jt==="geojson"&&!this.cluster){var Mt=me<this.originData.features.length?this.originData.features[me]:"null",ve=_t()(Mt);if(this.transforms.length!==0){var ge=this.data.dataArray.find(function(He){return He._id===me});ve.properties=ge}return ve}else return me<this.data.dataArray.length?this.data.dataArray[me]:"null"}},{key:"getFeatureId",value:function(me,at){var Jt=this.data.dataArray.find(function(Mt){return Mt[me]===name});return Jt==null?void 0:Jt._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(me){me&&(me.parser&&(this.parser=me.parser),me.transforms&&(this.transforms=me.transforms),this.cluster=me.cluster||!1,me.clusterOptions&&(this.cluster=!0,this.clusterOptions=Qt(Qt({},this.clusterOptions),me.clusterOptions)))}},{key:"excuteParser",value:function(){var me=this.parser,at=me.type||"geojson",Jt=Object(At.getParser)(at);this.data=Jt(this.originData,me),this.extent=Object(et.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var me=this,at=this.transforms;at.forEach(function(Jt){var Mt=Jt.type,ve=Object(At.getTransform)(Mt)(me.data,Jt);Object.assign(me.data,ve)})}},{key:"initCluster",value:function(){if(!this.cluster)return;var me=this.clusterOptions||{};this.clusterIndex=Object(St.a)(this.data,me)}},{key:"init",value:function(){this.hooks.init.call(this)}}]),be}(Ze.EventEmitter)},lJbI:function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});function x(m,Y){var z=Y.extent,i=Y.width,W=Y.height,D=Y.min,Q=Y.max,ee={_id:1,dataArray:[{_id:1,data:Array.from(m),width:i,height:W,min:D,max:Q,coordinates:[[z[0],z[1]],[z[2],z[3]]]}]};return ee}},mNvP:function(Ue,y,o){(function(x,m){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Y;(function(z){(function(i){var W=typeof m=="object"?m:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=Q(z);typeof W.Reflect=="undefined"?W.Reflect=z:D=Q(W.Reflect,D),i(D);function Q(ee,ce){return function(K,je){typeof ee[K]!="function"&&Object.defineProperty(ee,K,{configurable:!0,writable:!0,value:je}),ce&&ce(K,je)}}})(function(i){var W=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",Q=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",ee=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",ce=typeof Object.create=="function",K={__proto__:[]}instanceof Array,je=!ce&&!K,pe={create:ce?function(){return dr(Object.create(null))}:K?function(){return dr({__proto__:null})}:function(){return dr({})},has:je?function(Ye,xt){return W.call(Ye,xt)}:function(Ye,xt){return xt in Ye},get:je?function(Ye,xt){return W.call(Ye,xt)?Ye[xt]:void 0}:function(Ye,xt){return Ye[xt]}},Ke=Object.getPrototypeOf(Function),Pe=typeof x=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",ht=!Pe&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ne(),Le=!Pe&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:tt(),_t=!Pe&&typeof WeakMap=="function"?WeakMap:kt(),ot=new _t;function et(Ye,xt,bt,Et){if(Jt(bt)){if(!R(Ye))throw new TypeError;if(!fe(xt))throw new TypeError;return Wt(Ye,xt)}else{if(!R(Ye))throw new TypeError;if(!ge(xt))throw new TypeError;if(!ge(Et)&&!Jt(Et)&&!Mt(Et))throw new TypeError;return Mt(Et)&&(Et=void 0),bt=C(bt),Qt(Ye,xt,bt,Et)}}i("decorate",et);function Ze(Ye,xt){function bt(Et,ze){if(!ge(Et))throw new TypeError;if(!Jt(ze)&&!We(ze))throw new TypeError;be(Ye,xt,Et,ze)}return bt}i("metadata",Ze);function At(Ye,xt,bt,Et){if(!ge(bt))throw new TypeError;return Jt(Et)||(Et=C(Et)),be(Ye,xt,bt,Et)}i("defineMetadata",At);function St(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),oe(Ye,xt,bt)}i("hasMetadata",St);function De(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),J(Ye,xt,bt)}i("hasOwnMetadata",De);function Ie(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),H(Ye,xt,bt)}i("getMetadata",Ie);function Ge(Ye,xt,bt){if(!ge(xt))throw new TypeError;return Jt(bt)||(bt=C(bt)),Se(Ye,xt,bt)}i("getOwnMetadata",Ge);function dt(Ye,xt){if(!ge(Ye))throw new TypeError;return Jt(xt)||(xt=C(xt)),Te(Ye,xt)}i("getMetadataKeys",dt);function we(Ye,xt){if(!ge(Ye))throw new TypeError;return Jt(xt)||(xt=C(xt)),me(Ye,xt)}i("getOwnMetadataKeys",we);function pt(Ye,xt,bt){if(!ge(xt))throw new TypeError;Jt(bt)||(bt=C(bt));var Et=ur(xt,bt,!1);if(Jt(Et))return!1;if(!Et.delete(Ye))return!1;if(Et.size>0)return!0;var ze=ot.get(xt);return ze.delete(bt),ze.size>0||ot.delete(xt),!0}i("deleteMetadata",pt);function Wt(Ye,xt){for(var bt=Ye.length-1;bt>=0;--bt){var Et=Ye[bt],ze=Et(xt);if(!Jt(ze)&&!Mt(ze)){if(!fe(ze))throw new TypeError;xt=ze}}return xt}function Qt(Ye,xt,bt,Et){for(var ze=Ye.length-1;ze>=0;--ze){var vt=Ye[ze],yt=vt(xt,bt,Et);if(!Jt(yt)&&!Mt(yt)){if(!ge(yt))throw new TypeError;Et=yt}}return Et}function ur(Ye,xt,bt){var Et=ot.get(Ye);if(Jt(Et)){if(!bt)return;Et=new ht,ot.set(Ye,Et)}var ze=Et.get(xt);if(Jt(ze)){if(!bt)return;ze=new ht,Et.set(xt,ze)}return ze}function oe(Ye,xt,bt){var Et=J(Ye,xt,bt);if(Et)return!0;var ze=Qe(xt);return Mt(ze)?!1:oe(Ye,ze,bt)}function J(Ye,xt,bt){var Et=ur(xt,bt,!1);return Jt(Et)?!1:Oe(Et.has(Ye))}function H(Ye,xt,bt){var Et=J(Ye,xt,bt);if(Et)return Se(Ye,xt,bt);var ze=Qe(xt);return Mt(ze)?void 0:H(Ye,ze,bt)}function Se(Ye,xt,bt){var Et=ur(xt,bt,!1);return Jt(Et)?void 0:Et.get(Ye)}function be(Ye,xt,bt,Et){var ze=ur(bt,Et,!0);ze.set(Ye,xt)}function Te(Ye,xt){var bt=me(Ye,xt),Et=Qe(Ye);if(Et===null)return bt;var ze=Te(Et,xt);if(ze.length<=0)return bt;if(bt.length<=0)return ze;for(var vt=new Le,yt=[],Ht=0,hr=bt;Ht<hr.length;Ht++){var Hr=hr[Ht],gr=vt.has(Hr);gr||(vt.add(Hr),yt.push(Hr))}for(var Bn=0,zn=ze;Bn<zn.length;Bn++){var Hr=zn[Bn],gr=vt.has(Hr);gr||(vt.add(Hr),yt.push(Hr))}return yt}function me(Ye,xt){var bt=[],Et=ur(Ye,xt,!1);if(Jt(Et))return bt;for(var ze=Et.keys(),vt=Tt(ze),yt=0;;){var Ht=Ut(vt);if(!Ht)return bt.length=yt,bt;var hr=it(Ht);try{bt[yt]=hr}catch(Hr){try{$(vt)}finally{throw Hr}}yt++}}function at(Ye){if(Ye===null)return 1;switch(typeof Ye){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ye===null?1:6;default:return 6}}function Jt(Ye){return Ye===void 0}function Mt(Ye){return Ye===null}function ve(Ye){return typeof Ye=="symbol"}function ge(Ye){return typeof Ye=="object"?Ye!==null:typeof Ye=="function"}function He(Ye,xt){switch(at(Ye)){case 0:return Ye;case 1:return Ye;case 2:return Ye;case 3:return Ye;case 4:return Ye;case 5:return Ye}var bt=xt===3?"string":xt===5?"number":"default",Et=qe(Ye,Q);if(Et!==void 0){var ze=Et.call(Ye,bt);if(ge(ze))throw new TypeError;return ze}return st(Ye,bt==="default"?"number":bt)}function st(Ye,xt){if(xt==="string"){var bt=Ye.toString;if(q(bt)){var Et=bt.call(Ye);if(!ge(Et))return Et}var ze=Ye.valueOf;if(q(ze)){var Et=ze.call(Ye);if(!ge(Et))return Et}}else{var ze=Ye.valueOf;if(q(ze)){var Et=ze.call(Ye);if(!ge(Et))return Et}var vt=Ye.toString;if(q(vt)){var Et=vt.call(Ye);if(!ge(Et))return Et}}throw new TypeError}function Oe(Ye){return!!Ye}function gt(Ye){return""+Ye}function C(Ye){var xt=He(Ye,3);return ve(xt)?xt:gt(xt)}function R(Ye){return Array.isArray?Array.isArray(Ye):Ye instanceof Object?Ye instanceof Array:Object.prototype.toString.call(Ye)==="[object Array]"}function q(Ye){return typeof Ye=="function"}function fe(Ye){return typeof Ye=="function"}function We(Ye){switch(at(Ye)){case 3:return!0;case 4:return!0;default:return!1}}function qe(Ye,xt){var bt=Ye[xt];if(bt==null)return;if(!q(bt))throw new TypeError;return bt}function Tt(Ye){var xt=qe(Ye,ee);if(!q(xt))throw new TypeError;var bt=xt.call(Ye);if(!ge(bt))throw new TypeError;return bt}function it(Ye){return Ye.value}function Ut(Ye){var xt=Ye.next();return xt.done?!1:xt}function $(Ye){var xt=Ye.return;xt&&xt.call(Ye)}function Qe(Ye){var xt=Object.getPrototypeOf(Ye);if(typeof Ye!="function"||Ye===Ke)return xt;if(xt!==Ke)return xt;var bt=Ye.prototype,Et=bt&&Object.getPrototypeOf(bt);if(Et==null||Et===Object.prototype)return xt;var ze=Et.constructor;return typeof ze!="function"||ze===Ye?xt:ze}function ne(){var Ye={},xt=[],bt=function(){function yt(Ht,hr,Hr){this._index=0,this._keys=Ht,this._values=hr,this._selector=Hr}return yt.prototype["@@iterator"]=function(){return this},yt.prototype[ee]=function(){return this},yt.prototype.next=function(){var Ht=this._index;if(Ht>=0&&Ht<this._keys.length){var hr=this._selector(this._keys[Ht],this._values[Ht]);return Ht+1>=this._keys.length?(this._index=-1,this._keys=xt,this._values=xt):this._index++,{value:hr,done:!1}}return{value:void 0,done:!0}},yt.prototype.throw=function(Ht){throw this._index>=0&&(this._index=-1,this._keys=xt,this._values=xt),Ht},yt.prototype.return=function(Ht){return this._index>=0&&(this._index=-1,this._keys=xt,this._values=xt),{value:Ht,done:!0}},yt}();return function(){function yt(){this._keys=[],this._values=[],this._cacheKey=Ye,this._cacheIndex=-2}return Object.defineProperty(yt.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),yt.prototype.has=function(Ht){return this._find(Ht,!1)>=0},yt.prototype.get=function(Ht){var hr=this._find(Ht,!1);return hr>=0?this._values[hr]:void 0},yt.prototype.set=function(Ht,hr){var Hr=this._find(Ht,!0);return this._values[Hr]=hr,this},yt.prototype.delete=function(Ht){var hr=this._find(Ht,!1);if(hr>=0){for(var Hr=this._keys.length,gr=hr+1;gr<Hr;gr++)this._keys[gr-1]=this._keys[gr],this._values[gr-1]=this._values[gr];return this._keys.length--,this._values.length--,Ht===this._cacheKey&&(this._cacheKey=Ye,this._cacheIndex=-2),!0}return!1},yt.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ye,this._cacheIndex=-2},yt.prototype.keys=function(){return new bt(this._keys,this._values,Et)},yt.prototype.values=function(){return new bt(this._keys,this._values,ze)},yt.prototype.entries=function(){return new bt(this._keys,this._values,vt)},yt.prototype["@@iterator"]=function(){return this.entries()},yt.prototype[ee]=function(){return this.entries()},yt.prototype._find=function(Ht,hr){return this._cacheKey!==Ht&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ht)),this._cacheIndex<0&&hr&&(this._cacheIndex=this._keys.length,this._keys.push(Ht),this._values.push(void 0)),this._cacheIndex},yt}();function Et(yt,Ht){return yt}function ze(yt,Ht){return Ht}function vt(yt,Ht){return[yt,Ht]}}function tt(){return function(){function Ye(){this._map=new ht}return Object.defineProperty(Ye.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Ye.prototype.has=function(xt){return this._map.has(xt)},Ye.prototype.add=function(xt){return this._map.set(xt,xt),this},Ye.prototype.delete=function(xt){return this._map.delete(xt)},Ye.prototype.clear=function(){this._map.clear()},Ye.prototype.keys=function(){return this._map.keys()},Ye.prototype.values=function(){return this._map.values()},Ye.prototype.entries=function(){return this._map.entries()},Ye.prototype["@@iterator"]=function(){return this.keys()},Ye.prototype[ee]=function(){return this.keys()},Ye}()}function kt(){var Ye=16,xt=pe.create(),bt=Et();return function(){function hr(){this._key=Et()}return hr.prototype.has=function(Hr){var gr=ze(Hr,!1);return gr!==void 0?pe.has(gr,this._key):!1},hr.prototype.get=function(Hr){var gr=ze(Hr,!1);return gr!==void 0?pe.get(gr,this._key):void 0},hr.prototype.set=function(Hr,gr){var Bn=ze(Hr,!0);return Bn[this._key]=gr,this},hr.prototype.delete=function(Hr){var gr=ze(Hr,!1);return gr!==void 0?delete gr[this._key]:!1},hr.prototype.clear=function(){this._key=Et()},hr}();function Et(){var hr;do hr="@@WeakMap@@"+Ht();while(pe.has(xt,hr));return xt[hr]=!0,hr}function ze(hr,Hr){if(!W.call(hr,bt)){if(!Hr)return;Object.defineProperty(hr,bt,{value:pe.create()})}return hr[bt]}function vt(hr,Hr){for(var gr=0;gr<Hr;++gr)hr[gr]=Math.random()*255|0;return hr}function yt(hr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(hr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(hr)):vt(new Uint8Array(hr),hr):vt(new Array(hr),hr)}function Ht(){var hr=yt(Ye);hr[6]=hr[6]&79|64,hr[8]=hr[8]&191|128;for(var Hr="",gr=0;gr<Ye;++gr){var Bn=hr[gr];(gr===4||gr===6||gr===8)&&(Hr+="-"),Bn<16&&(Hr+="0"),Hr+=Bn.toString(16).toLowerCase()}return Hr}}function dr(Ye){return Ye.__=void 0,delete Ye.__,Ye}})})(Y||(Y={}))}).call(this,o("Q2Ig"),o("yLpj"))},mTTR:function(Ue,y,o){var x=o("b80T"),m=o("QcOe"),Y=o("MMmD");function z(i){return Y(i)?x(i,!0):m(i)}Ue.exports=z},mc0g:function(Ue,y){function o(x){return function(m,Y,z){for(var i=-1,W=Object(m),D=z(m),Q=D.length;Q--;){var ee=D[x?Q:++i];if(Y(W[ee],ee,W)===!1)break}return m}}Ue.exports=o},mhV4:function(Ue,y,o){var x=o("ZK94");Ue.exports.geometry=m,Ue.exports.ring=z;function m(W){var D=0,Q;switch(W.type){case"Polygon":return Y(W.coordinates);case"MultiPolygon":for(Q=0;Q<W.coordinates.length;Q++)D+=Y(W.coordinates[Q]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Q=0;Q<W.geometries.length;Q++)D+=m(W.geometries[Q]);return D}}function Y(W){var D=0;if(W&&W.length>0){D+=Math.abs(z(W[0]));for(var Q=1;Q<W.length;Q++)D-=Math.abs(z(W[Q]))}return D}function z(W){var D,Q,ee,ce,K,je,pe,Ke=0,Pe=W.length;if(Pe>2){for(pe=0;pe<Pe;pe++)pe===Pe-2?(ce=Pe-2,K=Pe-1,je=0):pe===Pe-1?(ce=Pe-1,K=0,je=1):(ce=pe,K=pe+1,je=pe+2),D=W[ce],Q=W[K],ee=W[je],Ke+=(i(ee[0])-i(D[0]))*Math.sin(i(Q[1]));Ke=Ke*x.RADIUS*x.RADIUS/2}return Ke}function i(W){return W*Math.PI/180}},mpbz:function(Ue,y,o){(function(x,m){Ue.exports=m()})(this,function(){"use strict";function x(De,Ie,Ge,dt,we,pt){if(we-dt<=Ge)return;var Wt=dt+we>>1;m(De,Ie,Wt,dt,we,pt%2),x(De,Ie,Ge,dt,Wt-1,pt+1),x(De,Ie,Ge,Wt+1,we,pt+1)}function m(De,Ie,Ge,dt,we,pt){for(;we>dt;){if(we-dt>600){var Wt=we-dt+1,Qt=Ge-dt+1,ur=Math.log(Wt),oe=.5*Math.exp(2*ur/3),J=.5*Math.sqrt(ur*oe*(Wt-oe)/Wt)*(Qt-Wt/2<0?-1:1),H=Math.max(dt,Math.floor(Ge-Qt*oe/Wt+J)),Se=Math.min(we,Math.floor(Ge+(Wt-Qt)*oe/Wt+J));m(De,Ie,Ge,H,Se,pt)}var be=Ie[2*Ge+pt],Te=dt,me=we;for(Y(De,Ie,dt,Ge),Ie[2*we+pt]>be&&Y(De,Ie,dt,we);Te<me;){for(Y(De,Ie,Te,me),Te++,me--;Ie[2*Te+pt]<be;)Te++;for(;Ie[2*me+pt]>be;)me--}Ie[2*dt+pt]===be?Y(De,Ie,dt,me):(me++,Y(De,Ie,me,we)),me<=Ge&&(dt=me+1),Ge<=me&&(we=me-1)}}function Y(De,Ie,Ge,dt){z(De,Ge,dt),z(Ie,2*Ge,2*dt),z(Ie,2*Ge+1,2*dt+1)}function z(De,Ie,Ge){var dt=De[Ie];De[Ie]=De[Ge],De[Ge]=dt}function i(De,Ie,Ge,dt,we,pt,Wt){for(var Qt=[0,De.length-1,0],ur=[],oe,J;Qt.length;){var H=Qt.pop(),Se=Qt.pop(),be=Qt.pop();if(Se-be<=Wt){for(var Te=be;Te<=Se;Te++)oe=Ie[2*Te],J=Ie[2*Te+1],oe>=Ge&&oe<=we&&J>=dt&&J<=pt&&ur.push(De[Te]);continue}var me=Math.floor((be+Se)/2);oe=Ie[2*me],J=Ie[2*me+1],oe>=Ge&&oe<=we&&J>=dt&&J<=pt&&ur.push(De[me]);var at=(H+1)%2;(H===0?Ge<=oe:dt<=J)&&(Qt.push(be),Qt.push(me-1),Qt.push(at)),(H===0?we>=oe:pt>=J)&&(Qt.push(me+1),Qt.push(Se),Qt.push(at))}return ur}function W(De,Ie,Ge,dt,we,pt){for(var Wt=[0,De.length-1,0],Qt=[],ur=we*we;Wt.length;){var oe=Wt.pop(),J=Wt.pop(),H=Wt.pop();if(J-H<=pt){for(var Se=H;Se<=J;Se++)D(Ie[2*Se],Ie[2*Se+1],Ge,dt)<=ur&&Qt.push(De[Se]);continue}var be=Math.floor((H+J)/2),Te=Ie[2*be],me=Ie[2*be+1];D(Te,me,Ge,dt)<=ur&&Qt.push(De[be]);var at=(oe+1)%2;(oe===0?Ge-we<=Te:dt-we<=me)&&(Wt.push(H),Wt.push(be-1),Wt.push(at)),(oe===0?Ge+we>=Te:dt+we>=me)&&(Wt.push(be+1),Wt.push(J),Wt.push(at))}return Qt}function D(De,Ie,Ge,dt){var we=De-Ge,pt=Ie-dt;return we*we+pt*pt}var Q=function(Ie){return Ie[0]},ee=function(Ie){return Ie[1]},ce=function(Ie,Ge,dt,we,pt){Ge===void 0&&(Ge=Q),dt===void 0&&(dt=ee),we===void 0&&(we=64),pt===void 0&&(pt=Float64Array),this.nodeSize=we,this.points=Ie;for(var Wt=Ie.length<65536?Uint16Array:Uint32Array,Qt=this.ids=new Wt(Ie.length),ur=this.coords=new pt(Ie.length*2),oe=0;oe<Ie.length;oe++)Qt[oe]=oe,ur[2*oe]=Ge(Ie[oe]),ur[2*oe+1]=dt(Ie[oe]);x(Qt,ur,we,0,Qt.length-1,0)};ce.prototype.range=function(Ie,Ge,dt,we){return i(this.ids,this.coords,Ie,Ge,dt,we,this.nodeSize)},ce.prototype.within=function(Ie,Ge,dt){return W(this.ids,this.coords,Ie,Ge,dt,this.nodeSize)};var K={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ie){return Ie}},je=function(Ie){this.options=Ze(Object.create(K),Ie),this.trees=new Array(this.options.maxZoom+1)};je.prototype.load=function(Ie){var Ge=this.options,dt=Ge.log,we=Ge.minZoom,pt=Ge.maxZoom,Wt=Ge.nodeSize;dt&&console.time("total time");var Qt="prepare "+Ie.length+" points";dt&&console.time(Qt),this.points=Ie;for(var ur=[],oe=0;oe<Ie.length;oe++){if(!Ie[oe].geometry)continue;ur.push(Ke(Ie[oe],oe))}this.trees[pt+1]=new ce(ur,At,St,Wt,Float32Array),dt&&console.timeEnd(Qt);for(var J=pt;J>=we;J--){var H=+Date.now();ur=this._cluster(ur,J),this.trees[J]=new ce(ur,At,St,Wt,Float32Array),dt&&console.log("z%d: %d clusters in %dms",J,ur.length,+Date.now()-H)}return dt&&console.timeEnd("total time"),this},je.prototype.getClusters=function(Ie,Ge){var dt=((Ie[0]+180)%360+360)%360-180,we=Math.max(-90,Math.min(90,Ie[1])),pt=Ie[2]===180?180:((Ie[2]+180)%360+360)%360-180,Wt=Math.max(-90,Math.min(90,Ie[3]));if(Ie[2]-Ie[0]>=360)dt=-180,pt=180;else if(dt>pt){var Qt=this.getClusters([dt,we,180,Wt],Ge),ur=this.getClusters([-180,we,pt,Wt],Ge);return Qt.concat(ur)}for(var oe=this.trees[this._limitZoom(Ge)],J=oe.range(Le(dt),_t(Wt),Le(pt),_t(we)),H=[],Se=0,be=J;Se<be.length;Se+=1){var Te=be[Se],me=oe.points[Te];H.push(me.numPoints?Pe(me):this.points[me.index])}return H},je.prototype.getChildren=function(Ie){var Ge=this._getOriginId(Ie),dt=this._getOriginZoom(Ie),we="No cluster with the specified id.",pt=this.trees[dt];if(!pt)throw new Error(we);var Wt=pt.points[Ge];if(!Wt)throw new Error(we);for(var Qt=this.options.radius/(this.options.extent*Math.pow(2,dt-1)),ur=pt.within(Wt.x,Wt.y,Qt),oe=[],J=0,H=ur;J<H.length;J+=1){var Se=H[J],be=pt.points[Se];be.parentId===Ie&&oe.push(be.numPoints?Pe(be):this.points[be.index])}if(oe.length===0)throw new Error(we);return oe},je.prototype.getLeaves=function(Ie,Ge,dt){Ge=Ge||10,dt=dt||0;var we=[];return this._appendLeaves(we,Ie,Ge,dt,0),we},je.prototype.getTile=function(Ie,Ge,dt){var we=this.trees[this._limitZoom(Ie)],pt=Math.pow(2,Ie),Wt=this.options,Qt=Wt.extent,ur=Wt.radius,oe=ur/Qt,J=(dt-oe)/pt,H=(dt+1+oe)/pt,Se={features:[]};return this._addTileFeatures(we.range((Ge-oe)/pt,J,(Ge+1+oe)/pt,H),we.points,Ge,dt,pt,Se),Ge===0&&this._addTileFeatures(we.range(1-oe/pt,J,1,H),we.points,pt,dt,pt,Se),Ge===pt-1&&this._addTileFeatures(we.range(0,J,oe/pt,H),we.points,-1,dt,pt,Se),Se.features.length?Se:null},je.prototype.getClusterExpansionZoom=function(Ie){for(var Ge=this._getOriginZoom(Ie)-1;Ge<=this.options.maxZoom;){var dt=this.getChildren(Ie);if(Ge++,dt.length!==1)break;Ie=dt[0].properties.cluster_id}return Ge},je.prototype._appendLeaves=function(Ie,Ge,dt,we,pt){for(var Wt=this.getChildren(Ge),Qt=0,ur=Wt;Qt<ur.length;Qt+=1){var oe=ur[Qt],J=oe.properties;if(J&&J.cluster?pt+J.point_count<=we?pt+=J.point_count:pt=this._appendLeaves(Ie,J.cluster_id,dt,we,pt):pt<we?pt++:Ie.push(oe),Ie.length===dt)break}return pt},je.prototype._addTileFeatures=function(Ie,Ge,dt,we,pt,Wt){for(var Qt=0,ur=Ie;Qt<ur.length;Qt+=1){var oe=ur[Qt],J=Ge[oe],H=J.numPoints,Se={type:1,geometry:[[Math.round(this.options.extent*(J.x*pt-dt)),Math.round(this.options.extent*(J.y*pt-we))]],tags:H?ht(J):this.points[J.index].properties},be=void 0;H?be=J.id:this.options.generateId?be=J.index:this.points[J.index].id&&(be=this.points[J.index].id),be!==void 0&&(Se.id=be),Wt.features.push(Se)}},je.prototype._limitZoom=function(Ie){return Math.max(this.options.minZoom,Math.min(+Ie,this.options.maxZoom+1))},je.prototype._cluster=function(Ie,Ge){for(var dt=[],we=this.options,pt=we.radius,Wt=we.extent,Qt=we.reduce,ur=we.minPoints,oe=pt/(Wt*Math.pow(2,Ge)),J=0;J<Ie.length;J++){var H=Ie[J];if(H.zoom<=Ge)continue;H.zoom=Ge;for(var Se=this.trees[Ge+1],be=Se.within(H.x,H.y,oe),Te=H.numPoints||1,me=Te,at=0,Jt=be;at<Jt.length;at+=1){var Mt=Jt[at],ve=Se.points[Mt];ve.zoom>Ge&&(me+=ve.numPoints||1)}if(me>=ur){for(var ge=H.x*Te,He=H.y*Te,st=Qt&&Te>1?this._map(H,!0):null,Oe=(J<<5)+(Ge+1)+this.points.length,gt=0,C=be;gt<C.length;gt+=1){var R=C[gt],q=Se.points[R];if(q.zoom<=Ge)continue;q.zoom=Ge;var fe=q.numPoints||1;ge+=q.x*fe,He+=q.y*fe,q.parentId=Oe,Qt&&(st||(st=this._map(H,!0)),Qt(st,this._map(q)))}H.parentId=Oe,dt.push(pe(ge/me,He/me,Oe,me,st))}else if(dt.push(H),me>1)for(var We=0,qe=be;We<qe.length;We+=1){var Tt=qe[We],it=Se.points[Tt];if(it.zoom<=Ge)continue;it.zoom=Ge,dt.push(it)}}return dt},je.prototype._getOriginId=function(Ie){return Ie-this.points.length>>5},je.prototype._getOriginZoom=function(Ie){return(Ie-this.points.length)%32},je.prototype._map=function(Ie,Ge){if(Ie.numPoints)return Ge?Ze({},Ie.properties):Ie.properties;var dt=this.points[Ie.index].properties,we=this.options.map(dt);return Ge&&we===dt?Ze({},we):we};function pe(De,Ie,Ge,dt,we){return{x:De,y:Ie,zoom:Infinity,id:Ge,parentId:-1,numPoints:dt,properties:we}}function Ke(De,Ie){var Ge=De.geometry.coordinates,dt=Ge[0],we=Ge[1];return{x:Le(dt),y:_t(we),zoom:Infinity,index:Ie,parentId:-1}}function Pe(De){return{type:"Feature",id:De.id,properties:ht(De),geometry:{type:"Point",coordinates:[ot(De.x),et(De.y)]}}}function ht(De){var Ie=De.numPoints,Ge=Ie>=1e4?Math.round(Ie/1e3)+"k":Ie>=1e3?Math.round(Ie/100)/10+"k":Ie;return Ze(Ze({},De.properties),{cluster:!0,cluster_id:De.id,point_count:Ie,point_count_abbreviated:Ge})}function Le(De){return De/360+.5}function _t(De){var Ie=Math.sin(De*Math.PI/180),Ge=.5-.25*Math.log((1+Ie)/(1-Ie))/Math.PI;return Ge<0?0:Ge>1?1:Ge}function ot(De){return(De-.5)*360}function et(De){var Ie=(180-De*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ie))/Math.PI-90}function Ze(De,Ie){for(var Ge in Ie)De[Ge]=Ie[Ge];return De}function At(De){return De.x}function St(De){return De.y}return je})},"mv/X":function(Ue,y,o){var x=o("ljhN"),m=o("MMmD"),Y=o("wJg7"),z=o("GoyQ");function i(W,D,Q){if(!z(Q))return!1;var ee=typeof D;return(ee=="number"?m(Q)&&Y(D,Q.length):ee=="string"&&D in Q)?x(Q[D],W):!1}Ue.exports=i},"n+fv":function(Ue,y,o){"use strict";o.r(y),o.d(y,"create",function(){return m}),o.d(y,"clone",function(){return Y}),o.d(y,"length",function(){return z}),o.d(y,"fromValues",function(){return i}),o.d(y,"copy",function(){return W}),o.d(y,"set",function(){return D}),o.d(y,"add",function(){return Q}),o.d(y,"subtract",function(){return ee}),o.d(y,"multiply",function(){return ce}),o.d(y,"divide",function(){return K}),o.d(y,"ceil",function(){return je}),o.d(y,"floor",function(){return pe}),o.d(y,"min",function(){return Ke}),o.d(y,"max",function(){return Pe}),o.d(y,"round",function(){return ht}),o.d(y,"scale",function(){return Le}),o.d(y,"scaleAndAdd",function(){return _t}),o.d(y,"distance",function(){return ot}),o.d(y,"squaredDistance",function(){return et}),o.d(y,"squaredLength",function(){return Ze}),o.d(y,"negate",function(){return At}),o.d(y,"inverse",function(){return St}),o.d(y,"normalize",function(){return De}),o.d(y,"dot",function(){return Ie}),o.d(y,"cross",function(){return Ge}),o.d(y,"lerp",function(){return dt}),o.d(y,"hermite",function(){return we}),o.d(y,"bezier",function(){return pt}),o.d(y,"random",function(){return Wt}),o.d(y,"transformMat4",function(){return Qt}),o.d(y,"transformMat3",function(){return ur}),o.d(y,"transformQuat",function(){return oe}),o.d(y,"rotateX",function(){return J}),o.d(y,"rotateY",function(){return H}),o.d(y,"rotateZ",function(){return Se}),o.d(y,"angle",function(){return be}),o.d(y,"zero",function(){return Te}),o.d(y,"str",function(){return me}),o.d(y,"exactEquals",function(){return at}),o.d(y,"equals",function(){return Jt}),o.d(y,"sub",function(){return Mt}),o.d(y,"mul",function(){return ve}),o.d(y,"div",function(){return ge}),o.d(y,"dist",function(){return He}),o.d(y,"sqrDist",function(){return st}),o.d(y,"len",function(){return Oe}),o.d(y,"sqrLen",function(){return gt}),o.d(y,"forEach",function(){return C});var x=o("yU0y");function m(){var R=new x.a(3);return x.a!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function Y(R){var q=new x.a(3);return q[0]=R[0],q[1]=R[1],q[2]=R[2],q}function z(R){var q=R[0],fe=R[1],We=R[2];return Math.hypot(q,fe,We)}function i(R,q,fe){var We=new x.a(3);return We[0]=R,We[1]=q,We[2]=fe,We}function W(R,q){return R[0]=q[0],R[1]=q[1],R[2]=q[2],R}function D(R,q,fe,We){return R[0]=q,R[1]=fe,R[2]=We,R}function Q(R,q,fe){return R[0]=q[0]+fe[0],R[1]=q[1]+fe[1],R[2]=q[2]+fe[2],R}function ee(R,q,fe){return R[0]=q[0]-fe[0],R[1]=q[1]-fe[1],R[2]=q[2]-fe[2],R}function ce(R,q,fe){return R[0]=q[0]*fe[0],R[1]=q[1]*fe[1],R[2]=q[2]*fe[2],R}function K(R,q,fe){return R[0]=q[0]/fe[0],R[1]=q[1]/fe[1],R[2]=q[2]/fe[2],R}function je(R,q){return R[0]=Math.ceil(q[0]),R[1]=Math.ceil(q[1]),R[2]=Math.ceil(q[2]),R}function pe(R,q){return R[0]=Math.floor(q[0]),R[1]=Math.floor(q[1]),R[2]=Math.floor(q[2]),R}function Ke(R,q,fe){return R[0]=Math.min(q[0],fe[0]),R[1]=Math.min(q[1],fe[1]),R[2]=Math.min(q[2],fe[2]),R}function Pe(R,q,fe){return R[0]=Math.max(q[0],fe[0]),R[1]=Math.max(q[1],fe[1]),R[2]=Math.max(q[2],fe[2]),R}function ht(R,q){return R[0]=Math.round(q[0]),R[1]=Math.round(q[1]),R[2]=Math.round(q[2]),R}function Le(R,q,fe){return R[0]=q[0]*fe,R[1]=q[1]*fe,R[2]=q[2]*fe,R}function _t(R,q,fe,We){return R[0]=q[0]+fe[0]*We,R[1]=q[1]+fe[1]*We,R[2]=q[2]+fe[2]*We,R}function ot(R,q){var fe=q[0]-R[0],We=q[1]-R[1],qe=q[2]-R[2];return Math.hypot(fe,We,qe)}function et(R,q){var fe=q[0]-R[0],We=q[1]-R[1],qe=q[2]-R[2];return fe*fe+We*We+qe*qe}function Ze(R){var q=R[0],fe=R[1],We=R[2];return q*q+fe*fe+We*We}function At(R,q){return R[0]=-q[0],R[1]=-q[1],R[2]=-q[2],R}function St(R,q){return R[0]=1/q[0],R[1]=1/q[1],R[2]=1/q[2],R}function De(R,q){var fe=q[0],We=q[1],qe=q[2],Tt=fe*fe+We*We+qe*qe;return Tt>0&&(Tt=1/Math.sqrt(Tt)),R[0]=q[0]*Tt,R[1]=q[1]*Tt,R[2]=q[2]*Tt,R}function Ie(R,q){return R[0]*q[0]+R[1]*q[1]+R[2]*q[2]}function Ge(R,q,fe){var We=q[0],qe=q[1],Tt=q[2],it=fe[0],Ut=fe[1],$=fe[2];return R[0]=qe*$-Tt*Ut,R[1]=Tt*it-We*$,R[2]=We*Ut-qe*it,R}function dt(R,q,fe,We){var qe=q[0],Tt=q[1],it=q[2];return R[0]=qe+We*(fe[0]-qe),R[1]=Tt+We*(fe[1]-Tt),R[2]=it+We*(fe[2]-it),R}function we(R,q,fe,We,qe,Tt){var it=Tt*Tt,Ut=it*(2*Tt-3)+1,$=it*(Tt-2)+Tt,Qe=it*(Tt-1),ne=it*(3-2*Tt);return R[0]=q[0]*Ut+fe[0]*$+We[0]*Qe+qe[0]*ne,R[1]=q[1]*Ut+fe[1]*$+We[1]*Qe+qe[1]*ne,R[2]=q[2]*Ut+fe[2]*$+We[2]*Qe+qe[2]*ne,R}function pt(R,q,fe,We,qe,Tt){var it=1-Tt,Ut=it*it,$=Tt*Tt,Qe=Ut*it,ne=3*Tt*Ut,tt=3*$*it,kt=$*Tt;return R[0]=q[0]*Qe+fe[0]*ne+We[0]*tt+qe[0]*kt,R[1]=q[1]*Qe+fe[1]*ne+We[1]*tt+qe[1]*kt,R[2]=q[2]*Qe+fe[2]*ne+We[2]*tt+qe[2]*kt,R}function Wt(R,q){q=q||1;var fe=x.c()*2*Math.PI,We=x.c()*2-1,qe=Math.sqrt(1-We*We)*q;return R[0]=Math.cos(fe)*qe,R[1]=Math.sin(fe)*qe,R[2]=We*q,R}function Qt(R,q,fe){var We=q[0],qe=q[1],Tt=q[2],it=fe[3]*We+fe[7]*qe+fe[11]*Tt+fe[15];return it=it||1,R[0]=(fe[0]*We+fe[4]*qe+fe[8]*Tt+fe[12])/it,R[1]=(fe[1]*We+fe[5]*qe+fe[9]*Tt+fe[13])/it,R[2]=(fe[2]*We+fe[6]*qe+fe[10]*Tt+fe[14])/it,R}function ur(R,q,fe){var We=q[0],qe=q[1],Tt=q[2];return R[0]=We*fe[0]+qe*fe[3]+Tt*fe[6],R[1]=We*fe[1]+qe*fe[4]+Tt*fe[7],R[2]=We*fe[2]+qe*fe[5]+Tt*fe[8],R}function oe(R,q,fe){var We=fe[0],qe=fe[1],Tt=fe[2],it=fe[3],Ut=q[0],$=q[1],Qe=q[2],ne=qe*Qe-Tt*$,tt=Tt*Ut-We*Qe,kt=We*$-qe*Ut,dr=qe*kt-Tt*tt,Ye=Tt*ne-We*kt,xt=We*tt-qe*ne,bt=it*2;return ne*=bt,tt*=bt,kt*=bt,dr*=2,Ye*=2,xt*=2,R[0]=Ut+ne+dr,R[1]=$+tt+Ye,R[2]=Qe+kt+xt,R}function J(R,q,fe,We){var qe=[],Tt=[];return qe[0]=q[0]-fe[0],qe[1]=q[1]-fe[1],qe[2]=q[2]-fe[2],Tt[0]=qe[0],Tt[1]=qe[1]*Math.cos(We)-qe[2]*Math.sin(We),Tt[2]=qe[1]*Math.sin(We)+qe[2]*Math.cos(We),R[0]=Tt[0]+fe[0],R[1]=Tt[1]+fe[1],R[2]=Tt[2]+fe[2],R}function H(R,q,fe,We){var qe=[],Tt=[];return qe[0]=q[0]-fe[0],qe[1]=q[1]-fe[1],qe[2]=q[2]-fe[2],Tt[0]=qe[2]*Math.sin(We)+qe[0]*Math.cos(We),Tt[1]=qe[1],Tt[2]=qe[2]*Math.cos(We)-qe[0]*Math.sin(We),R[0]=Tt[0]+fe[0],R[1]=Tt[1]+fe[1],R[2]=Tt[2]+fe[2],R}function Se(R,q,fe,We){var qe=[],Tt=[];return qe[0]=q[0]-fe[0],qe[1]=q[1]-fe[1],qe[2]=q[2]-fe[2],Tt[0]=qe[0]*Math.cos(We)-qe[1]*Math.sin(We),Tt[1]=qe[0]*Math.sin(We)+qe[1]*Math.cos(We),Tt[2]=qe[2],R[0]=Tt[0]+fe[0],R[1]=Tt[1]+fe[1],R[2]=Tt[2]+fe[2],R}function be(R,q){var fe=R[0],We=R[1],qe=R[2],Tt=q[0],it=q[1],Ut=q[2],$=Math.sqrt(fe*fe+We*We+qe*qe),Qe=Math.sqrt(Tt*Tt+it*it+Ut*Ut),ne=$*Qe,tt=ne&&Ie(R,q)/ne;return Math.acos(Math.min(Math.max(tt,-1),1))}function Te(R){return R[0]=0,R[1]=0,R[2]=0,R}function me(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"}function at(R,q){return R[0]===q[0]&&R[1]===q[1]&&R[2]===q[2]}function Jt(R,q){var fe=R[0],We=R[1],qe=R[2],Tt=q[0],it=q[1],Ut=q[2];return Math.abs(fe-Tt)<=x.b*Math.max(1,Math.abs(fe),Math.abs(Tt))&&Math.abs(We-it)<=x.b*Math.max(1,Math.abs(We),Math.abs(it))&&Math.abs(qe-Ut)<=x.b*Math.max(1,Math.abs(qe),Math.abs(Ut))}var Mt=ee,ve=ce,ge=K,He=ot,st=et,Oe=z,gt=Ze,C=function(){var R=m();return function(q,fe,We,qe,Tt,it){var Ut,$;for(fe||(fe=3),We||(We=0),qe?$=Math.min(qe*fe+We,q.length):$=q.length,Ut=We;Ut<$;Ut+=fe)R[0]=q[Ut],R[1]=q[Ut+1],R[2]=q[Ut+2],Tt(R,R,it),q[Ut]=R[0],q[Ut+1]=R[1],q[Ut+2]=R[2];return q}}()},n2J3:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.unmanaged=void 0;var x=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function z(){return function(i,W,D){var Q=new m.Metadata(x.UNMANAGED_TAG,!0);Y.tagParameter(i,W,D,Q)}}y.unmanaged=z},n3AX:function(Ue,y,o){var x=o("Nsbk");function m(Y,z){for(;!Object.prototype.hasOwnProperty.call(Y,z)&&!(Y=x(Y),Y===null););return Y}Ue.exports=m},"o+pz":function(Ue,y,o){"use strict";o.d(y,"a",function(){return x});var x;(function(m){m[m.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",m[m.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",m[m.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",m[m.POINTS=0]="POINTS",m[m.LINES=1]="LINES",m[m.LINE_LOOP=2]="LINE_LOOP",m[m.LINE_STRIP=3]="LINE_STRIP",m[m.TRIANGLES=4]="TRIANGLES",m[m.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",m[m.TRIANGLE_FAN=6]="TRIANGLE_FAN",m[m.ZERO=0]="ZERO",m[m.ONE=1]="ONE",m[m.SRC_COLOR=768]="SRC_COLOR",m[m.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",m[m.SRC_ALPHA=770]="SRC_ALPHA",m[m.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",m[m.DST_ALPHA=772]="DST_ALPHA",m[m.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",m[m.DST_COLOR=774]="DST_COLOR",m[m.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",m[m.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",m[m.FUNC_ADD=32774]="FUNC_ADD",m[m.BLEND_EQUATION=32777]="BLEND_EQUATION",m[m.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",m[m.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",m[m.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",m[m.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",m[m.MAX_EXT=32776]="MAX_EXT",m[m.MIN_EXT=32775]="MIN_EXT",m[m.BLEND_DST_RGB=32968]="BLEND_DST_RGB",m[m.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",m[m.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",m[m.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",m[m.CONSTANT_COLOR=32769]="CONSTANT_COLOR",m[m.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",m[m.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",m[m.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",m[m.BLEND_COLOR=32773]="BLEND_COLOR",m[m.ARRAY_BUFFER=34962]="ARRAY_BUFFER",m[m.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",m[m.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",m[m.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",m[m.STREAM_DRAW=35040]="STREAM_DRAW",m[m.STATIC_DRAW=35044]="STATIC_DRAW",m[m.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",m[m.BUFFER_SIZE=34660]="BUFFER_SIZE",m[m.BUFFER_USAGE=34661]="BUFFER_USAGE",m[m.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",m[m.FRONT=1028]="FRONT",m[m.BACK=1029]="BACK",m[m.FRONT_AND_BACK=1032]="FRONT_AND_BACK",m[m.CULL_FACE=2884]="CULL_FACE",m[m.BLEND=3042]="BLEND",m[m.DITHER=3024]="DITHER",m[m.STENCIL_TEST=2960]="STENCIL_TEST",m[m.DEPTH_TEST=2929]="DEPTH_TEST",m[m.SCISSOR_TEST=3089]="SCISSOR_TEST",m[m.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",m[m.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",m[m.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",m[m.NO_ERROR=0]="NO_ERROR",m[m.INVALID_ENUM=1280]="INVALID_ENUM",m[m.INVALID_VALUE=1281]="INVALID_VALUE",m[m.INVALID_OPERATION=1282]="INVALID_OPERATION",m[m.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",m[m.CW=2304]="CW",m[m.CCW=2305]="CCW",m[m.LINE_WIDTH=2849]="LINE_WIDTH",m[m.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",m[m.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",m[m.CULL_FACE_MODE=2885]="CULL_FACE_MODE",m[m.FRONT_FACE=2886]="FRONT_FACE",m[m.DEPTH_RANGE=2928]="DEPTH_RANGE",m[m.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",m[m.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",m[m.DEPTH_FUNC=2932]="DEPTH_FUNC",m[m.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",m[m.STENCIL_FUNC=2962]="STENCIL_FUNC",m[m.STENCIL_FAIL=2964]="STENCIL_FAIL",m[m.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",m[m.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",m[m.STENCIL_REF=2967]="STENCIL_REF",m[m.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",m[m.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",m[m.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",m[m.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",m[m.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",m[m.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",m[m.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",m[m.VIEWPORT=2978]="VIEWPORT",m[m.SCISSOR_BOX=3088]="SCISSOR_BOX",m[m.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",m[m.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",m[m.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",m[m.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",m[m.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",m[m.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",m[m.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",m[m.RED_BITS=3410]="RED_BITS",m[m.GREEN_BITS=3411]="GREEN_BITS",m[m.BLUE_BITS=3412]="BLUE_BITS",m[m.ALPHA_BITS=3413]="ALPHA_BITS",m[m.DEPTH_BITS=3414]="DEPTH_BITS",m[m.STENCIL_BITS=3415]="STENCIL_BITS",m[m.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",m[m.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",m[m.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",m[m.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",m[m.SAMPLES=32937]="SAMPLES",m[m.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",m[m.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",m[m.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",m[m.DONT_CARE=4352]="DONT_CARE",m[m.FASTEST=4353]="FASTEST",m[m.NICEST=4354]="NICEST",m[m.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",m[m.BYTE=5120]="BYTE",m[m.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",m[m.SHORT=5122]="SHORT",m[m.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",m[m.INT=5124]="INT",m[m.UNSIGNED_INT=5125]="UNSIGNED_INT",m[m.FLOAT=5126]="FLOAT",m[m.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",m[m.ALPHA=6406]="ALPHA",m[m.RGB=6407]="RGB",m[m.RGBA=6408]="RGBA",m[m.LUMINANCE=6409]="LUMINANCE",m[m.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",m[m.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",m[m.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",m[m.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",m[m.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",m[m.VERTEX_SHADER=35633]="VERTEX_SHADER",m[m.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",m[m.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",m[m.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",m[m.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",m[m.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",m[m.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",m[m.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",m[m.SHADER_TYPE=35663]="SHADER_TYPE",m[m.DELETE_STATUS=35712]="DELETE_STATUS",m[m.LINK_STATUS=35714]="LINK_STATUS",m[m.VALIDATE_STATUS=35715]="VALIDATE_STATUS",m[m.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",m[m.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",m[m.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",m[m.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",m[m.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",m[m.NEVER=512]="NEVER",m[m.LESS=513]="LESS",m[m.EQUAL=514]="EQUAL",m[m.LEQUAL=515]="LEQUAL",m[m.GREATER=516]="GREATER",m[m.NOTEQUAL=517]="NOTEQUAL",m[m.GEQUAL=518]="GEQUAL",m[m.ALWAYS=519]="ALWAYS",m[m.KEEP=7680]="KEEP",m[m.REPLACE=7681]="REPLACE",m[m.INCR=7682]="INCR",m[m.DECR=7683]="DECR",m[m.INVERT=5386]="INVERT",m[m.INCR_WRAP=34055]="INCR_WRAP",m[m.DECR_WRAP=34056]="DECR_WRAP",m[m.VENDOR=7936]="VENDOR",m[m.RENDERER=7937]="RENDERER",m[m.VERSION=7938]="VERSION",m[m.NEAREST=9728]="NEAREST",m[m.LINEAR=9729]="LINEAR",m[m.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",m[m.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",m[m.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",m[m.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",m[m.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",m[m.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",m[m.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",m[m.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",m[m.TEXTURE_2D=3553]="TEXTURE_2D",m[m.TEXTURE=5890]="TEXTURE",m[m.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",m[m.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",m[m.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",m[m.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",m[m.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",m[m.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",m[m.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",m[m.TEXTURE0=33984]="TEXTURE0",m[m.TEXTURE1=33985]="TEXTURE1",m[m.TEXTURE2=33986]="TEXTURE2",m[m.TEXTURE3=33987]="TEXTURE3",m[m.TEXTURE4=33988]="TEXTURE4",m[m.TEXTURE5=33989]="TEXTURE5",m[m.TEXTURE6=33990]="TEXTURE6",m[m.TEXTURE7=33991]="TEXTURE7",m[m.TEXTURE8=33992]="TEXTURE8",m[m.TEXTURE9=33993]="TEXTURE9",m[m.TEXTURE10=33994]="TEXTURE10",m[m.TEXTURE11=33995]="TEXTURE11",m[m.TEXTURE12=33996]="TEXTURE12",m[m.TEXTURE13=33997]="TEXTURE13",m[m.TEXTURE14=33998]="TEXTURE14",m[m.TEXTURE15=33999]="TEXTURE15",m[m.TEXTURE16=34e3]="TEXTURE16",m[m.TEXTURE17=34001]="TEXTURE17",m[m.TEXTURE18=34002]="TEXTURE18",m[m.TEXTURE19=34003]="TEXTURE19",m[m.TEXTURE20=34004]="TEXTURE20",m[m.TEXTURE21=34005]="TEXTURE21",m[m.TEXTURE22=34006]="TEXTURE22",m[m.TEXTURE23=34007]="TEXTURE23",m[m.TEXTURE24=34008]="TEXTURE24",m[m.TEXTURE25=34009]="TEXTURE25",m[m.TEXTURE26=34010]="TEXTURE26",m[m.TEXTURE27=34011]="TEXTURE27",m[m.TEXTURE28=34012]="TEXTURE28",m[m.TEXTURE29=34013]="TEXTURE29",m[m.TEXTURE30=34014]="TEXTURE30",m[m.TEXTURE31=34015]="TEXTURE31",m[m.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",m[m.REPEAT=10497]="REPEAT",m[m.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",m[m.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",m[m.FLOAT_VEC2=35664]="FLOAT_VEC2",m[m.FLOAT_VEC3=35665]="FLOAT_VEC3",m[m.FLOAT_VEC4=35666]="FLOAT_VEC4",m[m.INT_VEC2=35667]="INT_VEC2",m[m.INT_VEC3=35668]="INT_VEC3",m[m.INT_VEC4=35669]="INT_VEC4",m[m.BOOL=35670]="BOOL",m[m.BOOL_VEC2=35671]="BOOL_VEC2",m[m.BOOL_VEC3=35672]="BOOL_VEC3",m[m.BOOL_VEC4=35673]="BOOL_VEC4",m[m.FLOAT_MAT2=35674]="FLOAT_MAT2",m[m.FLOAT_MAT3=35675]="FLOAT_MAT3",m[m.FLOAT_MAT4=35676]="FLOAT_MAT4",m[m.SAMPLER_2D=35678]="SAMPLER_2D",m[m.SAMPLER_CUBE=35680]="SAMPLER_CUBE",m[m.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",m[m.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",m[m.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",m[m.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",m[m.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",m[m.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",m[m.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",m[m.COMPILE_STATUS=35713]="COMPILE_STATUS",m[m.LOW_FLOAT=36336]="LOW_FLOAT",m[m.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",m[m.HIGH_FLOAT=36338]="HIGH_FLOAT",m[m.LOW_INT=36339]="LOW_INT",m[m.MEDIUM_INT=36340]="MEDIUM_INT",m[m.HIGH_INT=36341]="HIGH_INT",m[m.FRAMEBUFFER=36160]="FRAMEBUFFER",m[m.RENDERBUFFER=36161]="RENDERBUFFER",m[m.RGBA4=32854]="RGBA4",m[m.RGB5_A1=32855]="RGB5_A1",m[m.RGB565=36194]="RGB565",m[m.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",m[m.STENCIL_INDEX=6401]="STENCIL_INDEX",m[m.STENCIL_INDEX8=36168]="STENCIL_INDEX8",m[m.DEPTH_STENCIL=34041]="DEPTH_STENCIL",m[m.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",m[m.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",m[m.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",m[m.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",m[m.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",m[m.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",m[m.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",m[m.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",m[m.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",m[m.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",m[m.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",m[m.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",m[m.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",m[m.NONE=0]="NONE",m[m.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",m[m.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",m[m.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",m[m.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",m[m.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",m[m.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",m[m.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",m[m.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",m[m.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",m[m.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",m[m.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",m[m.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(x||(x={}))},"oCl/":function(Ue,y,o){var x=o("CH3K"),m=o("LcsW"),Y=o("MvSz"),z=o("0ycA"),i=Object.getOwnPropertySymbols,W=i?function(D){for(var Q=[];D;)x(Q,Y(D)),D=m(D);return Q}:z;Ue.exports=W},oShl:function(Ue,y,o){var x=o("Nsbk"),m=o("SksO"),Y=o("xfeJ"),z=o("sXyB");function i(W){var D=typeof Map=="function"?new Map:void 0;return Ue.exports=i=function(ee){if(ee===null||!Y(ee))return ee;if(typeof ee!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(ee))return D.get(ee);D.set(ee,ce)}function ce(){return z(ee,arguments,x(this).constructor)}return ce.prototype=Object.create(ee.prototype,{constructor:{value:ce,enumerable:!1,writable:!0,configurable:!0}}),m(ce,ee)},i(W)}Ue.exports=i},oaX6:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.targetName=void 0;var x=o("xfSm"),m=o("GXnB"),Y=o("Ztfv");function z(i){return function(W,D,Q){var ee=new m.Metadata(x.NAME_TAG,i);Y.tagParameter(W,D,Q,ee)}}y.targetName=z},"otv/":function(Ue,y,o){var x=o("nmnc"),m=x?x.prototype:void 0,Y=m?m.valueOf:void 0;function z(i){return Y?Object(Y.call(i)):{}}Ue.exports=z},"oy+k":function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Context=void 0;var x=o("d9O0"),m=function(){function Y(z){this.id=x.id(),this.container=z}return Y.prototype.addPlan=function(z){this.plan=z},Y.prototype.setCurrentRequest=function(z){this.currentRequest=z},Y}();y.Context=m},pFRH:function(Ue,y,o){var x=o("cvCv"),m=o("O0oS"),Y=o("zZ0H"),z=m?function(i,W){return m(i,"toString",{configurable:!0,enumerable:!1,value:x(W),writable:!0})}:Y;Ue.exports=z},q4HE:function(Ue,y){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+m+Y,i="\\ufe0e\\ufe0f",W="["+o+"]",D="["+z+"]",Q="\\ud83c[\\udffb-\\udfff]",ee="(?:"+D+"|"+Q+")",ce="[^"+o+"]",K="(?:\\ud83c[\\udde6-\\uddff]){2}",je="[\\ud800-\\udbff][\\udc00-\\udfff]",pe="\\u200d",Ke=ee+"?",Pe="["+i+"]?",ht="(?:"+pe+"(?:"+[ce,K,je].join("|")+")"+Pe+Ke+")*",Le=Pe+Ke+ht,_t="(?:"+[ce+D+"?",D,K,je,W].join("|")+")",ot=RegExp(Q+"(?="+Q+")|"+_t+Le,"g");function et(Ze){for(var At=ot.lastIndex=0;ot.test(Ze);)++At;return At}Ue.exports=et},qK8v:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.isStackOverflowExeption=void 0;var x=o("MON2");function m(Y){return Y instanceof RangeError||Y.message===x.STACK_OVERFLOW}y.isStackOverflowExeption=m},qRkn:function(Ue,y,o){var x=o("3cYt"),m={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Y=x(m);Ue.exports=Y},qd8s:function(Ue,y,o){(function(x,m){var Y=200,z="__lodash_hash_undefined__",i=800,W=16,D=9007199254740991,Q="[object Arguments]",ee="[object Array]",ce="[object AsyncFunction]",K="[object Boolean]",je="[object Date]",pe="[object Error]",Ke="[object Function]",Pe="[object GeneratorFunction]",ht="[object Map]",Le="[object Number]",_t="[object Null]",ot="[object Object]",et="[object Proxy]",Ze="[object RegExp]",At="[object Set]",St="[object String]",De="[object Undefined]",Ie="[object WeakMap]",Ge="[object ArrayBuffer]",dt="[object DataView]",we="[object Float32Array]",pt="[object Float64Array]",Wt="[object Int8Array]",Qt="[object Int16Array]",ur="[object Int32Array]",oe="[object Uint8Array]",J="[object Uint8ClampedArray]",H="[object Uint16Array]",Se="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,Te=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,at={};at[we]=at[pt]=at[Wt]=at[Qt]=at[ur]=at[oe]=at[J]=at[H]=at[Se]=!0,at[Q]=at[ee]=at[Ge]=at[K]=at[dt]=at[je]=at[pe]=at[Ke]=at[ht]=at[Le]=at[ot]=at[Ze]=at[At]=at[St]=at[Ie]=!1;var Jt=typeof x=="object"&&x&&x.Object===Object&&x,Mt=typeof self=="object"&&self&&self.Object===Object&&self,ve=Jt||Mt||Function("return this")(),ge=y&&!y.nodeType&&y,He=ge&&typeof m=="object"&&m&&!m.nodeType&&m,st=He&&He.exports===ge,Oe=st&&Jt.process,gt=function(){try{var Rt=He&&He.require&&He.require("util").types;return Rt||Oe&&Oe.binding&&Oe.binding("util")}catch(fr){}}(),C=gt&&gt.isTypedArray;function R(Rt,fr,Mr){switch(Mr.length){case 0:return Rt.call(fr);case 1:return Rt.call(fr,Mr[0]);case 2:return Rt.call(fr,Mr[0],Mr[1]);case 3:return Rt.call(fr,Mr[0],Mr[1],Mr[2])}return Rt.apply(fr,Mr)}function q(Rt,fr){for(var Mr=-1,Zn=Array(Rt);++Mr<Rt;)Zn[Mr]=fr(Mr);return Zn}function fe(Rt){return function(fr){return Rt(fr)}}function We(Rt,fr){return Rt==null?void 0:Rt[fr]}function qe(Rt,fr){return function(Mr){return Rt(fr(Mr))}}var Tt=Array.prototype,it=Function.prototype,Ut=Object.prototype,$=ve["__core-js_shared__"],Qe=it.toString,ne=Ut.hasOwnProperty,tt=function(){var Rt=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return Rt?"Symbol(src)_1."+Rt:""}(),kt=Ut.toString,dr=Qe.call(Object),Ye=RegExp("^"+Qe.call(ne).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xt=st?ve.Buffer:void 0,bt=ve.Symbol,Et=ve.Uint8Array,ze=xt?xt.allocUnsafe:void 0,vt=qe(Object.getPrototypeOf,Object),yt=Object.create,Ht=Ut.propertyIsEnumerable,hr=Tt.splice,Hr=bt?bt.toStringTag:void 0,gr=function(){try{var Rt=Eu(Object,"defineProperty");return Rt({},"",{}),Rt}catch(fr){}}(),Bn=xt?xt.isBuffer:void 0,zn=Math.max,oa=Date.now,$n=Eu(ve,"Map"),Yn=Eu(Object,"create"),On=function(){function Rt(){}return function(fr){if(!Eo(fr))return{};if(yt)return yt(fr);Rt.prototype=fr;var Mr=new Rt;return Rt.prototype=void 0,Mr}}();function U(Rt){var fr=-1,Mr=Rt==null?0:Rt.length;for(this.clear();++fr<Mr;){var Zn=Rt[fr];this.set(Zn[0],Zn[1])}}function Z(){this.__data__=Yn?Yn(null):{},this.size=0}function le(Rt){var fr=this.has(Rt)&&delete this.__data__[Rt];return this.size-=fr?1:0,fr}function xe(Rt){var fr=this.__data__;if(Yn){var Mr=fr[Rt];return Mr===z?void 0:Mr}return ne.call(fr,Rt)?fr[Rt]:void 0}function ut(Rt){var fr=this.__data__;return Yn?fr[Rt]!==void 0:ne.call(fr,Rt)}function wt(Rt,fr){var Mr=this.__data__;return this.size+=this.has(Rt)?0:1,Mr[Rt]=Yn&&fr===void 0?z:fr,this}U.prototype.clear=Z,U.prototype.delete=le,U.prototype.get=xe,U.prototype.has=ut,U.prototype.set=wt;function Bt(Rt){var fr=-1,Mr=Rt==null?0:Rt.length;for(this.clear();++fr<Mr;){var Zn=Rt[fr];this.set(Zn[0],Zn[1])}}function Xe(){this.__data__=[],this.size=0}function Lt(Rt){var fr=this.__data__,Mr=Zi(fr,Rt);if(Mr<0)return!1;var Zn=fr.length-1;return Mr==Zn?fr.pop():hr.call(fr,Mr,1),--this.size,!0}function lr(Rt){var fr=this.__data__,Mr=Zi(fr,Rt);return Mr<0?void 0:fr[Mr][1]}function zr(Rt){return Zi(this.__data__,Rt)>-1}function Vr(Rt,fr){var Mr=this.__data__,Zn=Zi(Mr,Rt);return Zn<0?(++this.size,Mr.push([Rt,fr])):Mr[Zn][1]=fr,this}Bt.prototype.clear=Xe,Bt.prototype.delete=Lt,Bt.prototype.get=lr,Bt.prototype.has=zr,Bt.prototype.set=Vr;function cr(Rt){var fr=-1,Mr=Rt==null?0:Rt.length;for(this.clear();++fr<Mr;){var Zn=Rt[fr];this.set(Zn[0],Zn[1])}}function Ur(){this.size=0,this.__data__={hash:new U,map:new($n||Bt),string:new U}}function Mn(Rt){var fr=so(this,Rt).delete(Rt);return this.size-=fr?1:0,fr}function ln(Rt){return so(this,Rt).get(Rt)}function er(Rt){return so(this,Rt).has(Rt)}function tn(Rt,fr){var Mr=so(this,Rt),Zn=Mr.size;return Mr.set(Rt,fr),this.size+=Mr.size==Zn?0:1,this}cr.prototype.clear=Ur,cr.prototype.delete=Mn,cr.prototype.get=ln,cr.prototype.has=er,cr.prototype.set=tn;function hn(Rt){var fr=this.__data__=new Bt(Rt);this.size=fr.size}function xn(){this.__data__=new Bt,this.size=0}function yn(Rt){var fr=this.__data__,Mr=fr.delete(Rt);return this.size=fr.size,Mr}function vn(Rt){return this.__data__.get(Rt)}function Pn(Rt){return this.__data__.has(Rt)}function Va(Rt,fr){var Mr=this.__data__;if(Mr instanceof Bt){var Zn=Mr.__data__;if(!$n||Zn.length<Y-1)return Zn.push([Rt,fr]),this.size=++Mr.size,this;Mr=this.__data__=new cr(Zn)}return Mr.set(Rt,fr),this.size=Mr.size,this}hn.prototype.clear=xn,hn.prototype.delete=yn,hn.prototype.get=vn,hn.prototype.has=Pn,hn.prototype.set=Va;function va(Rt,fr){var Mr=Ml(Rt),Zn=!Mr&&Fu(Rt),Xa=!Mr&&!Zn&&Tu(Rt),vi=!Mr&&!Zn&&!Xa&&Ks(Rt),Ki=Mr||Zn||Xa||vi,Ya=Ki?q(Rt.length,String):[],Ii=Ya.length;for(var Go in Rt)(fr||ne.call(Rt,Go))&&!(Ki&&(Go=="length"||Xa&&(Go=="offset"||Go=="parent")||vi&&(Go=="buffer"||Go=="byteLength"||Go=="byteOffset")||ks(Go,Ii)))&&Ya.push(Go);return Ya}function Ma(Rt,fr,Mr){(Mr!==void 0&&!Oo(Rt[fr],Mr)||Mr===void 0&&!(fr in Rt))&&da(Rt,fr,Mr)}function Ia(Rt,fr,Mr){var Zn=Rt[fr];(!(ne.call(Rt,fr)&&Oo(Zn,Mr))||Mr===void 0&&!(fr in Rt))&&da(Rt,fr,Mr)}function Zi(Rt,fr){for(var Mr=Rt.length;Mr--;)if(Oo(Rt[Mr][0],fr))return Mr;return-1}function da(Rt,fr,Mr){fr=="__proto__"&&gr?gr(Rt,fr,{configurable:!0,enumerable:!0,value:Mr,writable:!0}):Rt[fr]=Mr}var di=oo();function ga(Rt){return Rt==null?Rt===void 0?De:_t:Hr&&Hr in Object(Rt)?$o(Rt):Qr(Rt)}function ya(Rt){return Fi(Rt)&&ga(Rt)==Q}function fa(Rt){if(!Eo(Rt)||Re(Rt))return!1;var fr=Mo(Rt)?Ye:Te;return fr.test(mo(Rt))}function Si(Rt){return Fi(Rt)&&zu(Rt.length)&&!!at[ga(Rt)]}function ns(Rt){if(!Eo(Rt))return mr(Rt);var fr=Dt(Rt),Mr=[];for(var Zn in Rt)Zn=="constructor"&&(fr||!ne.call(Rt,Zn))||Mr.push(Zn);return Mr}function Xi(Rt,fr,Mr,Zn,Xa){if(Rt===fr)return;di(fr,function(vi,Ki){if(Xa||(Xa=new hn),Eo(vi))Vo(Rt,fr,Ki,Mr,Xi,Zn,Xa);else{var Ya=Zn?Zn(Vn(Rt,Ki),vi,Ki+"",Rt,fr,Xa):void 0;Ya===void 0&&(Ya=vi),Ma(Rt,Ki,Ya)}},Ri)}function Vo(Rt,fr,Mr,Zn,Xa,vi,Ki){var Ya=Vn(Rt,Mr),Ii=Vn(fr,Mr),Go=Ki.get(Ii);if(Go){Ma(Rt,Mr,Go);return}var Cs=vi?vi(Ya,Ii,Mr+"",Rt,fr,Ki):void 0,pi=Cs===void 0;if(pi){var Pl=Ml(Ii),$s=!Pl&&Tu(Ii),Es=!Pl&&!$s&&Ks(Ii);Cs=Ii,Pl||$s||Es?Ml(Ya)?Cs=Ya:vc(Ya)?Cs=Yi(Ya):$s?(pi=!1,Cs=Ai(Ii,!0)):Es?(pi=!1,Cs=oi(Ii,!0)):Cs=[]:Ys(Ii)||Fu(Ii)?(Cs=Ya,Fu(Ya)?Cs=js(Ya):(!Eo(Ya)||Mo(Ya))&&(Cs=Kl(Ii))):pi=!1}pi&&(Ki.set(Ii,Cs),Xa(Cs,Ii,Zn,vi,Ki),Ki.delete(Ii)),Ma(Rt,Mr,Cs)}function ju(Rt,fr){return Ci(En(Rt,fr,vl),Rt+"")}var Ga=gr?function(Rt,fr){return gr(Rt,"toString",{configurable:!0,enumerable:!1,value:xs(fr),writable:!0})}:vl;function Ai(Rt,fr){if(fr)return Rt.slice();var Mr=Rt.length,Zn=ze?ze(Mr):new Rt.constructor(Mr);return Rt.copy(Zn),Zn}function Ko(Rt){var fr=new Rt.constructor(Rt.byteLength);return new Et(fr).set(new Et(Rt)),fr}function oi(Rt,fr){var Mr=fr?Ko(Rt.buffer):Rt.buffer;return new Rt.constructor(Mr,Rt.byteOffset,Rt.length)}function Yi(Rt,fr){var Mr=-1,Zn=Rt.length;for(fr||(fr=Array(Zn));++Mr<Zn;)fr[Mr]=Rt[Mr];return fr}function wo(Rt,fr,Mr,Zn){var Xa=!Mr;Mr||(Mr={});for(var vi=-1,Ki=fr.length;++vi<Ki;){var Ya=fr[vi],Ii=Zn?Zn(Mr[Ya],Rt[Ya],Ya,Mr,Rt):void 0;Ii===void 0&&(Ii=Rt[Ya]),Xa?da(Mr,Ya,Ii):Ia(Mr,Ya,Ii)}return Mr}function Ha(Rt){return ju(function(fr,Mr){var Zn=-1,Xa=Mr.length,vi=Xa>1?Mr[Xa-1]:void 0,Ki=Xa>2?Mr[2]:void 0;for(vi=Rt.length>3&&typeof vi=="function"?(Xa--,vi):void 0,Ki&&ho(Mr[0],Mr[1],Ki)&&(vi=Xa<3?void 0:vi,Xa=1),fr=Object(fr);++Zn<Xa;){var Ya=Mr[Zn];Ya&&Rt(fr,Ya,Zn,vi)}return fr})}function oo(Rt){return function(fr,Mr,Zn){for(var Xa=-1,vi=Object(fr),Ki=Zn(fr),Ya=Ki.length;Ya--;){var Ii=Ki[Rt?Ya:++Xa];if(Mr(vi[Ii],Ii,vi)===!1)break}return fr}}function so(Rt,fr){var Mr=Rt.__data__;return Vt(fr)?Mr[typeof fr=="string"?"string":"hash"]:Mr.map}function Eu(Rt,fr){var Mr=We(Rt,fr);return fa(Mr)?Mr:void 0}function $o(Rt){var fr=ne.call(Rt,Hr),Mr=Rt[Hr];try{Rt[Hr]=void 0;var Zn=!0}catch(vi){}var Xa=kt.call(Rt);return Zn&&(fr?Rt[Hr]=Mr:delete Rt[Hr]),Xa}function Kl(Rt){return typeof Rt.constructor=="function"&&!Dt(Rt)?On(vt(Rt)):{}}function ks(Rt,fr){var Mr=typeof Rt;return fr=fr==null?D:fr,!!fr&&(Mr=="number"||Mr!="symbol"&&me.test(Rt))&&Rt>-1&&Rt%1==0&&Rt<fr}function ho(Rt,fr,Mr){if(!Eo(Mr))return!1;var Zn=typeof fr;return(Zn=="number"?bs(Mr)&&ks(fr,Mr.length):Zn=="string"&&fr in Mr)?Oo(Mr[fr],Rt):!1}function Vt(Rt){var fr=typeof Rt;return fr=="string"||fr=="number"||fr=="symbol"||fr=="boolean"?Rt!=="__proto__":Rt===null}function Re(Rt){return!!tt&&tt in Rt}function Dt(Rt){var fr=Rt&&Rt.constructor,Mr=typeof fr=="function"&&fr.prototype||Ut;return Rt===Mr}function mr(Rt){var fr=[];if(Rt!=null)for(var Mr in Object(Rt))fr.push(Mr);return fr}function Qr(Rt){return kt.call(Rt)}function En(Rt,fr,Mr){return fr=zn(fr===void 0?Rt.length-1:fr,0),function(){for(var Zn=arguments,Xa=-1,vi=zn(Zn.length-fr,0),Ki=Array(vi);++Xa<vi;)Ki[Xa]=Zn[fr+Xa];Xa=-1;for(var Ya=Array(fr+1);++Xa<fr;)Ya[Xa]=Zn[Xa];return Ya[fr]=Mr(Ki),R(Rt,this,Ya)}}function Vn(Rt,fr){return fr==="constructor"&&typeof Rt[fr]=="function"||fr=="__proto__"?void 0:Rt[fr]}var Ci=po(Ga);function po(Rt){var fr=0,Mr=0;return function(){var Zn=oa(),Xa=W-(Zn-Mr);if(Mr=Zn,Xa>0){if(++fr>=i)return arguments[0]}else fr=0;return Rt.apply(void 0,arguments)}}function mo(Rt){if(Rt!=null){try{return Qe.call(Rt)}catch(fr){}try{return Rt+""}catch(fr){}}return""}function Oo(Rt,fr){return Rt===fr||Rt!==Rt&&fr!==fr}var Fu=ya(function(){return arguments}())?ya:function(Rt){return Fi(Rt)&&ne.call(Rt,"callee")&&!Ht.call(Rt,"callee")},Ml=Array.isArray;function bs(Rt){return Rt!=null&&zu(Rt.length)&&!Mo(Rt)}function vc(Rt){return Fi(Rt)&&bs(Rt)}var Tu=Bn||Qu;function Mo(Rt){if(!Eo(Rt))return!1;var fr=ga(Rt);return fr==Ke||fr==Pe||fr==ce||fr==et}function zu(Rt){return typeof Rt=="number"&&Rt>-1&&Rt%1==0&&Rt<=D}function Eo(Rt){var fr=typeof Rt;return Rt!=null&&(fr=="object"||fr=="function")}function Fi(Rt){return Rt!=null&&typeof Rt=="object"}function Ys(Rt){if(!Fi(Rt)||ga(Rt)!=ot)return!1;var fr=vt(Rt);if(fr===null)return!0;var Mr=ne.call(fr,"constructor")&&fr.constructor;return typeof Mr=="function"&&Mr instanceof Mr&&Qe.call(Mr)==dr}var Ks=C?fe(C):Si;function js(Rt){return wo(Rt,Ri(Rt))}function Ri(Rt){return bs(Rt)?va(Rt,!0):ns(Rt)}var Vi=Ha(function(Rt,fr,Mr,Zn){Xi(Rt,fr,Mr,Zn)});function xs(Rt){return function(){return Rt}}function vl(Rt){return Rt}function Qu(){return!1}m.exports=Vi}).call(this,o("yLpj"),o("YuTi")(Ue))},quyA:function(Ue,y){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+m+Y,i="\\ufe0e\\ufe0f",W="\\u200d",D=RegExp("["+W+o+z+i+"]");function Q(ee){return D.test(ee)}Ue.exports=Q},qxNg:function(Ue,y,o){"use strict";o.d(y,"a",function(){return D});var x=o("lSNA"),m=o.n(x),Y=o("mpbz"),z=o.n(Y);function i(ee,ce){var K=Object.keys(ee);if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(ee);ce&&(je=je.filter(function(pe){return Object.getOwnPropertyDescriptor(ee,pe).enumerable})),K.push.apply(K,je)}return K}function W(ee){for(var ce=1;ce<arguments.length;ce++){var K=arguments[ce]!=null?arguments[ce]:{};ce%2?i(Object(K),!0).forEach(function(je){m()(ee,je,K[je])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(K)):i(Object(K)).forEach(function(je){Object.defineProperty(ee,je,Object.getOwnPropertyDescriptor(K,je))})}return ee}function D(ee,ce){var K=ce.radius,je=K===void 0?40:K,pe=ce.maxZoom,Ke=pe===void 0?18:pe,Pe=ce.minZoom,ht=Pe===void 0?0:Pe,Le=ce.zoom,_t=Le===void 0?2:Le;if(ee.pointIndex){var ot=ee.pointIndex.getClusters(ee.extent,Math.floor(_t));return ee.dataArray=Q(ot),ee}var et=new z.a({radius:je,minZoom:ht,maxZoom:Ke}),Ze={type:"FeatureCollection",features:[]};return Ze.features=ee.dataArray.map(function(At){return{type:"Feature",geometry:{type:"Point",coordinates:At.coordinates},properties:W({},At)}}),et.load(Ze.features),et}function Q(ee){return ee.map(function(ce,K){return W({coordinates:ce.geometry.coordinates,_id:K+1},ce.properties)})}},riiI:function(Ue,y){},rlAn:function(Ue,y,o){"use strict";var x=o("ISu3"),m=o("gMG2"),Y=o("5gLl"),z=o("BpBL"),i=o("5zYK"),W=o("lJbI"),D=o("l94r"),Q=o("qxNg"),ee=o("Y8BV"),ce=o("VIsB"),K=o("+VLl"),je=o("aF1E"),pe=o("fdMe");o.d(y,"getTransform",function(){return x.b}),o.d(y,"getParser",function(){return x.a});var Ke=o("U1ZX"),Pe=o.n(Ke);y.default=D.a,Object(x.c)("geojson",Y.a),Object(x.c)("image",z.a),Object(x.c)("csv",m.a),Object(x.c)("json",i.a),Object(x.c)("raster",W.a),Object(x.d)("cluster",Q.a),Object(x.d)("filter",ee.a),Object(x.d)("join",je.a),Object(x.d)("map",pe.a),Object(x.d)("grid",ce.a),Object(x.d)("hexagon",K.a)},rxlC:function(Ue,y,o){"use strict";Ue.exports=m,Ue.exports.default=m;var x=1e20;function m(i,W,D,Q,ee,ce){this.fontSize=i||24,this.buffer=W===void 0?3:W,this.cutoff=Q||.25,this.fontFamily=ee||"sans-serif",this.fontWeight=ce||"normal",this.radius=D||8;var K=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=K,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(K*K),this.gridInner=new Float64Array(K*K),this.f=new Float64Array(K),this.d=new Float64Array(K),this.z=new Float64Array(K+1),this.v=new Int16Array(K),this.middle=Math.round(K/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}m.prototype.draw=function(i){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(i,this.buffer,this.middle);for(var W=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),Q=0;Q<this.size*this.size;Q++){var ee=W.data[Q*4+3]/255;this.gridOuter[Q]=ee===1?0:ee===0?x:Math.pow(Math.max(0,.5-ee),2),this.gridInner[Q]=ee===1?x:ee===0?0:Math.pow(Math.max(0,ee-.5),2)}for(Y(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Y(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),Q=0;Q<this.size*this.size;Q++){var ce=this.gridOuter[Q]-this.gridInner[Q];D[Q]=Math.max(0,Math.min(255,Math.round(255-255*(ce/this.radius+this.cutoff))))}return D};function Y(i,W,D,Q,ee,ce,K){for(var je=0;je<W;je++){for(var pe=0;pe<D;pe++)Q[pe]=i[pe*W+je];for(z(Q,ee,ce,K,D),pe=0;pe<D;pe++)i[pe*W+je]=ee[pe]}for(pe=0;pe<D;pe++){for(je=0;je<W;je++)Q[je]=i[pe*W+je];for(z(Q,ee,ce,K,W),je=0;je<W;je++)i[pe*W+je]=Math.sqrt(ee[je])}}function z(i,W,D,Q,ee){D[0]=0,Q[0]=-x,Q[1]=+x;for(var ce=1,K=0;ce<ee;ce++){for(var je=(i[ce]+ce*ce-(i[D[K]]+D[K]*D[K]))/(2*ce-2*D[K]);je<=Q[K];)K--,je=(i[ce]+ce*ce-(i[D[K]]+D[K]*D[K]))/(2*ce-2*D[K]);K++,D[K]=ce,Q[K]=je,Q[K+1]=+x}for(ce=0,K=0;ce<ee;ce++){for(;Q[K+1]<ce;)K++;W[ce]=(ce-D[K])*(ce-D[K])+i[D[K]]}}},sGsY:function(Ue,y,o){"use strict";var x=o("lSNA"),m=o.n(x),Y=o("pVnL"),z=o.n(Y),i=o("q1tI"),W=o("TSYQ"),D=o.n(W),Q=o("H84U"),ee=o("/ezw"),ce=o("B6l+"),K=o.n(ce),je=function(me){var at=me.value,Jt=me.formatter,Mt=me.precision,ve=me.decimalSeparator,ge=me.groupSeparator,He=ge===void 0?"":ge,st=me.prefixCls,Oe;if(typeof Jt=="function")Oe=Jt(at);else{var gt=String(at),C=gt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!C||gt==="-")Oe=gt;else{var R=C[1],q=C[2]||"0",fe=C[4]||"";q=q.replace(/\B(?=(\d{3})+(?!\d))/g,He),typeof Mt=="number"&&(fe=K()(fe,Mt,"0").slice(0,Mt)),fe&&(fe="".concat(ve).concat(fe)),Oe=[i.createElement("span",{key:"int",className:"".concat(st,"-content-value-int")},R,q),fe&&i.createElement("span",{key:"decimal",className:"".concat(st,"-content-value-decimal")},fe)]}}return i.createElement("span",{className:"".concat(st,"-content-value")},Oe)},pe=je,Ke=function(me){var at=me.prefixCls,Jt=me.className,Mt=me.style,ve=me.valueStyle,ge=me.value,He=ge===void 0?0:ge,st=me.title,Oe=me.valueRender,gt=me.prefix,C=me.suffix,R=me.loading,q=me.direction,fe=me.onMouseEnter,We=me.onMouseLeave,qe=i.createElement(pe,z()({},me,{value:He})),Tt=D()(at,m()({},"".concat(at,"-rtl"),q==="rtl"),Jt);return i.createElement("div",{className:Tt,style:Mt,onMouseEnter:fe,onMouseLeave:We},st&&i.createElement("div",{className:"".concat(at,"-title")},st),i.createElement(ee.a,{paragraph:!1,loading:R},i.createElement("div",{style:ve,className:"".concat(at,"-content")},gt&&i.createElement("span",{className:"".concat(at,"-content-prefix")},gt),Oe?Oe(qe):qe,C&&i.createElement("span",{className:"".concat(at,"-content-suffix")},C))))};Ke.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Pe=Object(Q.c)({prefixCls:"statistic"})(Ke),ht=Pe,Le=o("lwsE"),_t=o.n(Le),ot=o("W8MJ"),et=o.n(ot),Ze=o("7W2i"),At=o.n(Ze),St=o("LQ03"),De=o.n(St),Ie=o("J4zp"),Ge=o.n(Ie),dt=o("QQZ/"),we=o.n(dt),pt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Wt(Te,me){var at=Te,Jt=/\[[^\]]*]/g,Mt=(me.match(Jt)||[]).map(function(st){return st.slice(1,-1)}),ve=me.replace(Jt,"[]"),ge=pt.reduce(function(st,Oe){var gt=Ge()(Oe,2),C=gt[0],R=gt[1];if(st.indexOf(C)!==-1){var q=Math.floor(at/R);return at-=q*R,st.replace(new RegExp("".concat(C,"+"),"g"),function(fe){var We=fe.length;return we()(q.toString(),We,"0")})}return st},ve),He=0;return ge.replace(Jt,function(){var st=Mt[He];return He+=1,st})}function Qt(Te,me){var at=me.format,Jt=at===void 0?"":at,Mt=new Date(Te).getTime(),ve=Date.now(),ge=Math.max(Mt-ve,0);return Wt(ge,Jt)}var ur=o("0n0R"),oe=1e3/30;function J(Te){return new Date(Te).getTime()}var H=function(Te){At()(at,Te);var me=De()(at);function at(){var Jt;return _t()(this,at),Jt=me.apply(this,arguments),Jt.syncTimer=function(){var Mt=Jt.props.value,ve=J(Mt);ve>=Date.now()?Jt.startTimer():Jt.stopTimer()},Jt.startTimer=function(){if(Jt.countdownId)return;Jt.countdownId=window.setInterval(function(){Jt.forceUpdate()},oe)},Jt.stopTimer=function(){var Mt=Jt.props,ve=Mt.onFinish,ge=Mt.value;if(Jt.countdownId){clearInterval(Jt.countdownId),Jt.countdownId=void 0;var He=J(ge);ve&&He<Date.now()&&ve()}},Jt.formatCountdown=function(Mt,ve){var ge=Jt.props.format;return Qt(Mt,z()(z()({},ve),{format:ge}))},Jt.valueRender=function(Mt){return Object(ur.a)(Mt,{title:void 0})},Jt}return et()(at,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return i.createElement(ht,z()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),at}(i.Component);H.defaultProps={format:"HH:mm:ss"};var Se=H;ht.Countdown=Se;var be=y.a=ht},sKgW:function(Ue,y){var o=9007199254740991,x=Math.floor;function m(Y,z){var i="";if(!Y||z<1||z>o)return i;do z%2&&(i+=Y),z=x(z/2),z&&(Y+=Y);while(z);return i}Ue.exports=m},sXyB:function(Ue,y,o){var x=o("SksO"),m=o("b48C");function Y(z,i,W){return m()?Ue.exports=Y=Reflect.construct:Ue.exports=Y=function(Q,ee,ce){var K=[null];K.push.apply(K,ee);var je=Function.bind.apply(Q,K),pe=new je;return ce&&x(pe,ce.prototype),pe},Y.apply(null,arguments)}Ue.exports=Y},sgoq:function(Ue,y,o){var x=o("asDA"),m=o("TKrE"),Y=o("6nK8"),z="['\u2019]",i=RegExp(z,"g");function W(D){return function(Q){return x(Y(m(Q).replace(i,"")),D,"")}}Ue.exports=W},sxDa:function(Ue,y,o){"use strict";o.d(y,"e",function(){return ul}),o.d(y,"f",function(){return ro}),o.d(y,"d",function(){return Nc}),o.d(y,"a",function(){return so}),o.d(y,"c",function(){return Ii}),o.d(y,"g",function(){return Uc}),o.d(y,"b",function(){return vl});var x=o("h1nZ"),m=o("lwsE"),Y=o.n(m),z=o("W8MJ"),i=o.n(z),W=o("7W2i"),D=o.n(W),Q=o("a1gu"),ee=o.n(Q),ce=o("Nsbk"),K=o.n(ce),je=o("QILm"),pe=o.n(je),Ke=o("lSNA"),Pe=o.n(Ke),ht=o("yG8O"),Le=o.n(ht),_t=o("PJYZ"),ot=o.n(_t),et=o("U+yc"),Ze=o.n(et),At=o("1ABj"),St=o("GoyQ"),De=o.n(St),Ie=o("lSCD"),Ge=o.n(Ie),dt=o("xp6e"),we=o("Hel2"),pt=o("uhBA"),Wt=o("4U9+"),Qt=o.n(Wt),ur=o("4cb6"),oe,J,H,Se,be,Te;function me(h){return h.map(function(_){return typeof _=="string"&&(_=[_,{}]),_})}var at=(oe=Object(ur.injectable)(),J=Object(ur.inject)(x.TYPES.IGlobalConfigService),oe(H=(Se=(Te=function(){function h(){Y()(this,h),Le()(this,"configService",be,this),this.enabled=void 0}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.rendererService,B=b.postProcessingPassFactory,ie=b.normalPassFactory;E.hooks.init.tap("MultiPassRendererPlugin",function(){var de=E.getLayerConfig(),Ve=de.enableMultiPassRenderer,zt=de.passes,qt=zt===void 0?[]:zt;A.enabled=!!Ve&&E.getLayerConfig().enableMultiPassRenderer!==!1,A.enabled&&(E.multiPassRenderer=A.createMultiPassRenderer(E,qt,B,ie),E.multiPassRenderer.setRenderFlag(!0))}),E.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(E,b,A,M){var B=E.multiPassRenderer,ie=E.getLayerConfig(),de=ie.enablePicking,Ve=ie.enableTAA;return de&&B.add(M("pixelPicking")),B}}]),h}(),Te),be=Ze()(Se.prototype,"configService",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se))||H),Jt,Mt=(Jt={},Pe()(Jt,x.BlendType.additive,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE,srcAlpha:1,dstAlpha:1}}),Pe()(Jt,x.BlendType.none,{enable:!1}),Pe()(Jt,x.BlendType.normal,{enable:!0,func:{srcRGB:x.gl.SRC_ALPHA,dstRGB:x.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),Pe()(Jt,x.BlendType.subtractive,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE,srcAlpha:x.gl.ZERO,dstAlpha:x.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:x.gl.FUNC_SUBTRACT,alpha:x.gl.FUNC_SUBTRACT}}),Pe()(Jt,x.BlendType.max,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE},equation:{rgb:x.gl.MAX_EXT}}),Pe()(Jt,x.BlendType.min,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE},equation:{rgb:x.gl.MIN_EXT}}),Jt),ve={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},ge,He,st,Oe,gt,C,R,q;function fe(h,_){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=We(h))||_&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ve){throw Ve},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ve=E.next();return M=Ve.done,Ve},e:function(Ve){B=!0,ie=Ve},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(B)throw ie}}}}function We(h,_){if(!h)return;if(typeof h=="string")return qe(h,_);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return qe(h,_)}function qe(h,_){(_==null||_>h.length)&&(_=h.length);for(var E=0,b=new Array(_);E<_;E++)b[E]=h[E];return b}function Tt(h,_){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);_&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function it(h){for(var _=1;_<arguments.length;_++){var E=arguments[_]!=null?arguments[_]:{};_%2?Tt(Object(E),!0).forEach(function(b){Pe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Tt(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}function Ut(h){var _=$();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function $(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Qe=0,ne=(ge=Object(x.lazyInject)(x.TYPES.ILogService),He=Object(x.lazyInject)(x.TYPES.IGlobalConfigService),st=Object(x.lazyInject)(x.TYPES.IShaderModuleService),Oe=(q=function(h){D()(E,h);var _=Ut(E);function E(){var b,A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Y()(this,E),b=_.call(this),b.id="".concat(Qe++),b.name="".concat(Qe),b.type=void 0,b.visible=!0,b.zIndex=0,b.minZoom=void 0,b.maxZoom=void 0,b.inited=!1,b.layerModelNeedUpdate=!1,b.pickedFeatureID=null,b.selectedFeatureID=null,b.styleNeedUpdate=!1,b.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},b.hooks={init:new dt.b,afterInit:new dt.b,beforeRender:new dt.b,beforeRenderData:new dt.d,afterRender:new dt.c,beforePickingEncode:new dt.c,afterPickingEncode:new dt.c,beforeHighlight:new dt.c(["pickedColor"]),afterHighlight:new dt.c,beforeSelect:new dt.c(["pickedColor"]),afterSelect:new dt.c,beforeDestroy:new dt.c,afterDestroy:new dt.c},b.models=[],b.multiPassRenderer=void 0,b.plugins=void 0,b.sourceOption=void 0,b.layerModel=void 0,Le()(b,"logger",gt,ot()(b)),Le()(b,"configService",C,ot()(b)),Le()(b,"shaderModuleService",R,ot()(b)),b.cameraService=void 0,b.coordinateService=void 0,b.iconService=void 0,b.fontService=void 0,b.rendererService=void 0,b.layerService=void 0,b.interactionService=void 0,b.mapService=void 0,b.styleAttributeService=void 0,b.layerSource=void 0,b.postProcessingPassFactory=void 0,b.normalPassFactory=void 0,b.animateOptions={enable:!1},b.container=void 0,b.encodedData=void 0,b.configSchema=void 0,b.currentPickId=null,b.rawConfig=void 0,b.needUpdateConfig=void 0,b.pendingStyleAttributes=[],b.scaleOptions={},b.animateStartTime=void 0,b.aniamateStatus=!1,b.sourceEvent=function(){b.dataState.dataSourceNeedUpdate=!0;var M=b.getLayerConfig(),B=M.autoFit,ie=M.fitBoundsOptions;B&&b.fitBounds(ie),b.emit("dataUpdate"),b.reRender()},b.name=A.name||b.id,b.zIndex=A.zIndex||0,b.rawConfig=A,b}return i()(E,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(A){if(!this.inited)this.needUpdateConfig=it(it({},this.needUpdateConfig),A);else{var M=this.container.get(x.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,it(it(it({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),A)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(A){this.container=A}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(A){return this.plugins.push(A),this}},{key:"init",value:function(){var A=this,M=this.container.get(x.TYPES.SceneID),B=this.rawConfig.enableMultiPassRenderer,ie=B===void 0?!1:B;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ie}),this.iconService=this.container.get(x.TYPES.IIconService),this.fontService=this.container.get(x.TYPES.IFontService),this.rendererService=this.container.get(x.TYPES.IRendererService),this.layerService=this.container.get(x.TYPES.ILayerService),this.interactionService=this.container.get(x.TYPES.IInteractionService),this.mapService=this.container.get(x.TYPES.IMapService),this.cameraService=this.container.get(x.TYPES.ICameraService),this.coordinateService=this.container.get(x.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(x.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(x.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(x.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(x.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(qt){var Or=qt.attributeName,Nr=qt.attributeField,bn=qt.attributeValues,gn=qt.updateOptions;A.styleAttributeService.updateStyleAttribute(Or,{scale:it({field:Nr},A.splitValuesAndCallbackInAttribute(bn,A.getLayerConfig()[Or]))},gn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(x.TYPES.ILayerPlugin);var de=fe(this.plugins),Ve;try{for(de.s();!(Ve=de.n()).done;){var zt=Ve.value;zt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(qt){de.e(qt)}finally{de.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(it(it({},this.getDefaultConfig()),this.rawConfig));var A=this.getLayerConfig(),M=A.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(A,M,B){return this.updateStyleAttribute("color",A,M,B),this}},{key:"size",value:function(A,M,B){return this.updateStyleAttribute("size",A,M,B),this}},{key:"filter",value:function(A,M,B){return this.updateStyleAttribute("filter",A,M,B),this}},{key:"shape",value:function(A,M,B){return this.updateStyleAttribute("shape",A,M,B),this}},{key:"label",value:function(A,M,B){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:A,attributeValues:M,updateOptions:B}),this}},{key:"animate",value:function(A){var M={};return De()(A)?(M.enable=!0,M=it(it({},M),A)):M.enable=A,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(A,M){return this.sourceOption={data:A,options:M},this}},{key:"setData",value:function(A,M){var B=this;return this.inited?this.layerSource.setData(A,M):this.on("inited",function(){B.layerSource.setData(A,M)}),this}},{key:"style",value:function(A){var M=this,B=A.passes,ie=pe()(A,["passes"]);return B&&me(B).forEach(function(de){var Ve=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(de[0]);Ve&&Ve.updateOptions(de[1])}),this.rawConfig=it(it({},this.rawConfig),ie),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(A,M){return De()(A)?this.scaleOptions=it(it({},this.scaleOptions),A):this.scaleOptions[A]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(A){var M={};return M.enableHighlight=De()(A)?!0:A,De()(A)?(M.enableHighlight=!0,A.color&&(M.highlightColor=A.color)):M.enableHighlight=!!A,this.updateLayerConfig(M),this}},{key:"setActive",value:function(A,M){var B=this;if(De()(A)){var ie=A.x,de=ie===void 0?0:ie,Ve=A.y,zt=Ve===void 0?0:Ve;this.updateLayerConfig({highlightColor:De()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:de,y:zt})}else this.updateLayerConfig({pickedFeatureID:A,highlightColor:De()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(we.l)(A)).then(function(){setTimeout(function(){B.reRender()},1)})}},{key:"select",value:function(A){var M={};return M.enableSelect=De()(A)?!0:A,De()(A)?(M.enableSelect=!0,A.color&&(M.selectColor=A.color)):M.enableSelect=!!A,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(A,M){var B=this;if(De()(A)){var ie=A.x,de=ie===void 0?0:ie,Ve=A.y,zt=Ve===void 0?0:Ve;this.updateLayerConfig({selectColor:De()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:de,y:zt})}else this.updateLayerConfig({pickedFeatureID:A,selectColor:De()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(we.l)(A)).then(function(){setTimeout(function(){B.reRender()},1)})}},{key:"setBlend",value:function(A){this.updateLayerConfig({blend:A}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(A){return this.zIndex=A,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(A){this.currentPickId=A}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(A){this.selectedFeatureID=A}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var A=this.mapService.getZoom(),M=this.getLayerConfig(),B=M.visible,ie=M.minZoom,de=ie===void 0?-Infinity:ie,Ve=M.maxZoom,zt=Ve===void 0?Infinity:Ve;return!!B&&A>=de&&A<=zt}},{key:"setMinZoom",value:function(A){return this.updateLayerConfig({minZoom:A}),this}},{key:"getMinZoom",value:function(){var A=this.getLayerConfig(),M=A.minZoom;return M}},{key:"getMaxZoom",value:function(){var A=this.getLayerConfig(),M=A.maxZoom;return M}},{key:"get",value:function(A){var M=this.getLayerConfig();return M[A]}},{key:"setMaxZoom",value:function(A){return this.updateLayerConfig({maxZoom:A}),this}},{key:"fitBounds",value:function(A){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),B=M.extent,ie=B.some(function(de){return Math.abs(de)===Infinity});return ie?this:(this.mapService.fitBounds([[B[0],B[1]],[B[2],B[3]]],A),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(A){return A.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(A){return A.needRescale||A.needRemapping||A.needRegenerateVertices}).length}},{key:"setSource",value:function(A){this.layerSource=A;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(A){this.encodedData=A}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Qt()([ve,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(A){var M=this.styleAttributeService.getLayerAttributeScale(A);if(M){if(M.ticks){var B=M.ticks().map(function(de){return Pe()({value:de},A,M(de))});return B}else if(M.invertExtent){var ie=M.range().map(function(de){return Pe()({value:M.invertExtent(de)},A,de)});return ie}}else return[]}},{key:"pick",value:function(A){var M=A.x,B=A.y;this.interactionService.triggerHover({x:M,y:B})}},{key:"buildLayerModel",value:function(A){var M=A.moduleName,B=A.vertexShader,ie=A.fragmentShader,de=A.triangulation,Ve=pe()(A,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:B,fs:ie});var zt=this.shaderModuleService.getModule(M),qt=zt.vs,Or=zt.fs,Nr=zt.uniforms,bn=this.rendererService.createModel,gn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,de),Fn=gn.attributes,Ta=gn.elements;return bn(it({attributes:Fn,uniforms:Nr,fs:Or,vs:qt,elements:Ta,blend:Mt[x.BlendType.normal]},Ve))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(A){var M=this.getLayerConfig(),B=M.enableHighlight,ie=B===void 0?!0:B,de=M.enableSelect,Ve=de===void 0?!0:de,zt=this.eventNames().indexOf(A)!==-1||this.eventNames().indexOf("un"+A)!==-1;return(A==="click"||A==="dblclick")&&Ve&&(zt=!0),A==="mousemove"&&(ie||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(zt=!0),this.isVisible()&&zt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var A=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:A.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(A,M){return{values:Ge()(A)?void 0:A||M,callback:Ge()(A)?A:void 0}}},{key:"updateStyleAttribute",value:function(A,M,B,ie){this.inited?this.styleAttributeService.updateStyleAttribute(A,{scale:it({field:M},this.splitValuesAndCallbackInAttribute(B,this.getLayerConfig()[M]))},ie):this.pendingStyleAttributes.push({attributeName:A,attributeField:M,attributeValues:B,updateOptions:ie})}}]),E}(pt.EventEmitter),q),gt=Ze()(Oe.prototype,"logger",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Ze()(Oe.prototype,"configService",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Ze()(Oe.prototype,"shaderModuleService",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe),tt,kt,dr,Ye,xt,bt,Et=(tt=Object(x.lazyInject)(x.TYPES.IGlobalConfigService),kt=Object(x.lazyInject)(x.TYPES.IShaderModuleService),dr=(bt=function(){function h(_){Y()(this,h),this.triangulation=void 0,this.layer=void 0,Le()(this,"configService",Ye,this),Le()(this,"shaderModuleService",xt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=_,this.rendererService=_.getContainer().get(x.TYPES.IRendererService),this.styleAttributeService=_.getContainer().get(x.TYPES.IStyleAttributeService),this.mapService=_.getContainer().get(x.TYPES.IMapService),this.iconService=_.getContainer().get(x.TYPES.IIconService),this.fontService=_.getContainer().get(x.TYPES.IFontService),this.cameraService=_.getContainer().get(x.TYPES.ICameraService),this.layerService=_.getContainer().get(x.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return i()(h,[{key:"getBlend",value:function(){var E=this.layer.getLayerConfig(),b=E.blend,A=b===void 0?"normal":b;return Mt[x.BlendType[A]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){return}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(E){return[E.enable?0:1,E.duration||4,E.interval||.2,E.trailLength||.1]}},{key:"startModelAnimate",value:function(){var E=this.layer.getLayerConfig(),b=E.animateOption;b.enable&&this.layer.setAnimateStartTime()}}]),h}(),bt),Ye=Ze()(dr.prototype,"configService",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Ze()(dr.prototype,"shaderModuleService",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dr),ze=o("J4zp"),vt=o.n(ze),yt=o("RIqP"),Ht=o.n(yt),hr=o("VmRL"),Hr=o.n(hr),gr=o("IOcx"),Bn=gr.c.create(),zn=gr.c.create(),oa=gr.c.create(),$n=gr.c.create(),Yn=gr.c.create();function On(h,_,E,b,A){gr.c.add(h,E,b),gr.c.normalize(h,h),_=gr.c.fromValues(-h[1],h[0]);var M=gr.c.fromValues(-E[1],E[0]);return[A/gr.c.dot(_,M),_]}function U(h,_){return gr.c.set(h,-_[1],_[0])}function Z(h,_,E){return gr.c.sub(h,_,E),gr.c.normalize(h,h),h}function le(h,_){return h[0]===_[0]&&h[1]===_[1]}function xe(h){for(var _=new Map,E=0;E<h.length;E++){var b=h[0].toString()+"-"+h[1].toString();_.get(b)?(h.splice(E,1),E++):_.set(b,b)}return h}var ut=function(){function h(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Y()(this,h),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=gr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=_.join||"miter",this.cap=_.cap||"butt",this.miterLimit=_.miterLimit||10,this.thickness=_.thickness||1,this.dash=_.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return i()(h,[{key:"extrude",value:function(E){var b=this.complex;if(E.length<=1)return b;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var A=E.length,M=b.startIndex,B=1;B<A;B++){var ie=E[B-1],de=E[B],Ve=B<E.length-1?E[B+1]:null,zt=this.segment(b,M,ie,de,Ve);M+=zt}if(this.dash)for(var qt=0;qt<b.positions.length/6;qt++)b.positions[qt*6+5]=this.totalDistance;return b.startIndex=b.positions.length/6,b}},{key:"segment",value:function(E,b,A,M,B){var ie=0,de=E.indices,Ve=E.positions,zt=E.normals,qt=this.cap==="square",Or=this.join==="bevel",Nr=Object(we.d)([M[0],M[1]]),bn=Object(we.d)([A[0],A[1]]);Z(oa,Nr,bn);var gn=0;if(this.dash&&(gn=this.lineSegmentDistance(Nr,bn),this.totalDistance+=gn),this.normal||(this.normal=gr.c.create(),U(this.normal,oa)),!this.started)if(this.started=!0,qt){var Fn=gr.c.create(),Ta=gr.c.create();gr.c.add(Fn,this.normal,oa),gr.c.add(Ta,this.normal,oa),zt.push(Ta[0],Ta[1],0),zt.push(Fn[0],Fn[1],0),Ve.push(A[0],A[1],0,this.totalDistance-gn,-this.thickness,0),Ve.push(A[0],A[1],0,this.totalDistance-gn,this.thickness,0)}else this.extrusions(Ve,zt,A,this.normal,this.thickness,this.totalDistance-gn);if(de.push(b+0,b+1,b+2),B){var ai=Object(we.d)([B[0],B[1]]);le(Nr,ai)&&gr.c.add(ai,Nr,gr.c.normalize(ai,gr.c.subtract(ai,Nr,bn))),Z($n,ai,Nr);var ii=On(Yn,gr.c.create(),oa,$n,this.thickness),Qi=vt()(ii,2),wa=Qi[0],qi=Qi[1],xo=gr.c.dot(Yn,this.normal)<0?-1:1,Xs=Or;if(!Xs&&this.join==="miter"){var Za=wa;Za>this.miterLimit&&(Xs=!0)}Xs?(zt.push(this.normal[0],this.normal[1],0),zt.push(qi[0],qi[1],0),Ve.push(M[0],M[1],0,this.totalDistance,-this.thickness*xo,0),Ve.push(M[0],M[1],0,this.totalDistance,this.thickness*xo,0),de.push.apply(de,Ht()(this.lastFlip!==-xo?[b,b+2,b+3]:[b+2,b+1,b+3])),de.push(b+2,b+3,b+4),U(Bn,$n),gr.c.copy(this.normal,Bn),zt.push(this.normal[0],this.normal[1],0),Ve.push(M[0],M[1],0,this.totalDistance,-this.thickness*xo,0),ie+=3):(this.extrusions(Ve,zt,M,qi,wa,this.totalDistance),de.push.apply(de,Ht()(this.lastFlip===1?[b,b+2,b+3]:[b+2,b+1,b+3])),xo=-1,gr.c.copy(this.normal,qi),ie+=2),this.lastFlip=xo}else{if(U(this.normal,oa),qt){var Ca=gr.c.create(),Li=gr.c.create();gr.c.sub(Li,oa,this.normal),gr.c.add(Ca,oa,this.normal),zt.push(Li[0],Li[1],0),zt.push(Ca[0],Ca[1],0),Ve.push(M[0],M[1],0,this.totalDistance,this.thickness,0),Ve.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Ve,zt,M,this.normal,this.thickness,this.totalDistance);de.push.apply(de,Ht()(this.lastFlip===1?[b,b+2,b+3]:[b+2,b+1,b+3])),ie+=2}return ie}},{key:"extrusions",value:function(E,b,A,M,B,ie){b.push(M[0],M[1],0),b.push(M[0],M[1],0),E.push(A[0],A[1],0,ie,-B,0),E.push(A[0],A[1],0,ie,B,0)}},{key:"lineSegmentDistance",value:function(E,b){var A=b[0]-E[0],M=b[1]-E[1];return Math.sqrt(A*A+M*M)}}]),h}(),wt=o("UB5X"),Bt=o.n(wt);function Xe(h){if(Bt()(h[0]))return h;if(Bt()(h[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Bt()(h[0][0][0])){var _=h,E=0,b=0,A=0;return _.forEach(function(M){M.forEach(function(B){E+=B[0],b+=B[1],A++})}),[E/A,b/A,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Lt(h){var _=h[0][0],E=h[0][h[0].length-1];_[0]===E[0]&&_[1]===E[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var b=h[0].length,A=Hr.a.flatten(h),M=A.vertices,B=A.dimensions,ie=[],de=[],Ve=0;Ve<M.length/B;Ve++)B===2?ie.push(M[Ve*2],M[Ve*2+1],1):ie.push(M[Ve*3],M[Ve*3+1],1);var zt=Hr()(A.vertices,A.holes,A.dimensions);de.push.apply(de,Ht()(zt));for(var qt=function(bn){var gn=A.vertices.slice(bn*B,(bn+1)*B),Fn=A.vertices.slice((bn+1)*B,(bn+2)*B);Fn.length===0&&(Fn=A.vertices.slice(0,B));var Ta=ie.length/3;ie.push(gn[0],gn[1],1,Fn[0],Fn[1],1,gn[0],gn[1],0,Fn[0],Fn[1],0),de.push.apply(de,Ht()([0,2,1,2,3,1].map(function(Ca){return Ca+Ta})))},Or=0;Or<b;Or++)qt(Or);return{positions:ie,index:de}}function lr(h){var _=Hr.a.flatten(h),E=Hr()(_.vertices,_.holes,_.dimensions);return{positions:_.vertices,index:E}}function zr(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,E=h[0][0],b=h[0][h[0].length-1];E[0]===b[0]&&E[1]===b[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var A=h[0].length,M=Hr.a.flatten(h),B=M.vertices,ie=M.dimensions,de=[],Ve=[],zt=[],qt=0;qt<B.length/ie;qt++)ie===2?de.push(B[qt*2],B[qt*2+1],1,-1,-1):de.push(B[qt*3],B[qt*3+1],1,-1,-1),zt.push(0,0,1);var Or=Hr()(M.vertices,M.holes,M.dimensions);Ve.push.apply(Ve,Ht()(Or));for(var Nr=function(Fn){var Ta=M.vertices.slice(Fn*ie,(Fn+1)*ie),Ca=M.vertices.slice((Fn+1)*ie,(Fn+2)*ie);Ca.length===0&&(Ca=M.vertices.slice(0,ie));var Li=de.length/5;de.push(Ta[0],Ta[1],1,0,0,Ca[0],Ca[1],1,.1,0,Ta[0],Ta[1],0,0,.8,Ca[0],Ca[1],0,.1,.8);var ai=Vr([Ca[0],Ca[1],1],[Ta[0],Ta[1],0],[Ta[0],Ta[1],1],_);zt.push.apply(zt,Ht()(ai).concat(Ht()(ai),Ht()(ai),Ht()(ai))),Ve.push.apply(Ve,Ht()([1,2,0,3,2,1].map(function(ii){return ii+Li})))},bn=0;bn<A;bn++)Nr(bn);return{positions:de,index:Ve,normals:zt}}function Vr(h,_,E){var b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=gr.d.create(),M=gr.d.create(),B=gr.d.create();b&&(h=Object(we.p)(h),_=Object(we.p)(_),E=Object(we.p)(E));var ie=gr.d.fromValues.apply(gr.d,Ht()(h)),de=gr.d.fromValues.apply(gr.d,Ht()(_)),Ve=gr.d.fromValues.apply(gr.d,Ht()(E));gr.d.sub(A,Ve,de),gr.d.sub(M,ie,de),gr.d.cross(B,A,M);var zt=gr.d.create();return gr.d.normalize(zt,B),zt}var cr,Ur;(function(h){h.CYLINDER="cylinder",h.SQUARECOLUMN="squareColumn",h.TRIANGLECOLUMN="triangleColumn",h.HEXAGONCOLUMN="hexagonColumn",h.PENTAGONCOLUMN="pentagonColumn"})(Ur||(Ur={}));var Mn;(function(h){h.CIRCLE="circle",h.SQUARE="square",h.TRIANGLE="triangle",h.HEXAGON="hexagon",h.PENTAGON="pentagon"})(Mn||(Mn={}));function ln(h){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=Math.PI*2/h,b=[],A=0;A<h;A++)b.push(E*A+_*Math.PI/12);var M=b.map(function(B){var ie=Math.sin(B+Math.PI/4),de=Math.cos(B+Math.PI/4);return[ie,de,0]});return M}function er(){return ln(30)}function tn(){return ln(4)}function hn(){return ln(3)}function xn(){return ln(6,1)}function yn(){return ln(5)}var vn=(cr={},Pe()(cr,Mn.CIRCLE,er),Pe()(cr,Mn.HEXAGON,xn),Pe()(cr,Mn.TRIANGLE,hn),Pe()(cr,Mn.SQUARE,tn),Pe()(cr,Mn.PENTAGON,yn),Pe()(cr,Ur.CYLINDER,er),Pe()(cr,Ur.HEXAGONCOLUMN,xn),Pe()(cr,Ur.TRIANGLECOLUMN,hn),Pe()(cr,Ur.SQUARECOLUMN,tn),Pe()(cr,Ur.PENTAGONCOLUMN,yn),cr),Pn={};function Va(h){var _=Xe(h.coordinates);return{vertices:[].concat(Ht()(_),Ht()(_),Ht()(_),Ht()(_)),indices:[0,1,2,2,3,0],size:_.length}}function va(h){var _=h.shape,E=Si(_,!1),b=E.positions,A=E.index,M=E.normals;return{vertices:b,indices:A,normals:M,size:5}}function Ma(h){var _=Xe(h.coordinates);return{vertices:Ht()(_),indices:[0],size:_.length}}function Ia(h){var _=h.coordinates,E=_;Array.isArray(E[0][0])||(E=[_]);var b=new ut({dash:!0,join:"bevel"});E.forEach(function(M){b.extrude(M)});var A=b.complex;return{vertices:A.positions,indices:A.indices,normals:A.normals,size:6}}function Zi(h){var _=h.coordinates,E=Hr.a.flatten(_),b=E.vertices,A=E.dimensions,M=E.holes;return{indices:Hr()(b,M,A),vertices:b,size:A}}function da(h){var _=h.coordinates,E=zr(_,!0),b=E.positions,A=E.index,M=E.normals;return{vertices:b,indices:A,normals:M,size:5}}function di(h){var _=h.shape,E=ju(_),b=E.positions,A=E.index;return{vertices:b,indices:A,size:3}}function ga(h){var _=h.coordinates,E=[].concat(Ht()(_[0]),[0,0,1,_[1][0],_[0][1],0,1,1],Ht()(_[1]),[0,1,0],Ht()(_[0]),[0,0,1],Ht()(_[1]),[0,1,0,_[0][0],_[1][1],0,0,0]),b=[0,1,2,3,4,5];return{vertices:E,indices:b,size:5}}function ya(h){for(var _=30,E=h.coordinates,b=[],A=[],M=function(de){b.push(de,1,de,E[0][0],E[0][1],E[1][0],E[1][1],de,-1,de,E[0][0],E[0][1],E[1][0],E[1][1]),de!==_-1&&A.push.apply(A,Ht()([0,1,2,1,3,2].map(function(Ve){return de*2+Ve})))},B=0;B<_;B++)M(B);return{vertices:b,indices:A,size:7}}function fa(h){var _=h.coordinates;_.length===2&&_.push(0);var E=h.size,b=Ga(-1,1),A=Ga(1,1),M=Ga(-1,-1),B=Ga(1,-1),ie=[].concat(Ht()(_),Ht()(b),Ht()(_),Ht()(M),Ht()(_),Ht()(B),Ht()(_),Ht()(A)),de=[0,1,2,3,0,2];return{vertices:ie,indices:de,size:5}}function Si(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Pn&&Pn[h])return Pn[h];var E=vn[h]?vn[h]():vn.cylinder(),b=zr([E],_);return Pn[h]=b,b}function ns(h,_){for(var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=new Float32Array(h.length/E*3),M,B,ie,de=gr.d.create(),Ve=gr.d.create(),zt=gr.d.create(),qt=0,Or=_.length;qt<Or;qt+=3){M=_[qt+0]*3,B=_[qt+1]*3,ie=_[qt+2]*3;var Nr=[h[M],h[M+1]],bn=[h[B],h[B+1]],gn=[h[ie],h[ie+1]];b&&(Nr=Object(we.p)(Nr),bn=Object(we.p)(bn),gn=Object(we.p)(gn));var Fn=Nr,Ta=vt()(Fn,2),Ca=Ta[0],Li=Ta[1],ai=gr.d.fromValues(Ca,Li,h[M+2]),ii=bn,Qi=vt()(ii,2),wa=Qi[0],qi=Qi[1],xo=gr.d.fromValues(wa,qi,h[B+2]),Xs=gn,Za=vt()(Xs,2),As=Za[0],Yo=Za[1],df=gr.d.fromValues(As,Yo,h[ie+2]);gr.d.sub(de,df,xo),gr.d.sub(Ve,ai,xo),gr.d.cross(zt,de,Ve),A[M]+=de[0],A[M+1]+=de[1],A[M+2]+=de[2],A[B]+=de[0],A[B+1]+=de[1],A[B+2]+=de[2],A[ie]+=de[0],A[ie+1]+=de[1],A[ie+2]+=de[2]}return Xi(A),A}function Xi(h){for(var _=0,E=h.length;_<E;_+=3){var b=gr.d.fromValues(h[_],h[_+1],h[_+2]),A=gr.d.create();gr.d.normalize(A,b),h.set(A,_)}}function Vo(h){var _=h[0][0],E=h[0][h[0].length-1];return _[0]===E[0]&&_[1]===E[1]}function ju(h){var _=["cylinder","triangleColumn","hexagonColumn","squareColumn"],E=vn[h]?vn[h]():vn.circle(),b=_.indexOf(h)===-1?lr([E]):Lt([E]);return b}function Ga(h,_){var E=(h+1)/2,b=(_+1)/2;return[E,b]}function Ai(h){var _=Ko();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Ko(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var oi=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Yi=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,wo=function(h){D()(E,h);var _=Ai(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.baseColor,de=ie===void 0?"rgb(16,16,16)":ie,Ve=A.brightColor,zt=Ve===void 0?"rgb(255,176,38)":Ve,qt=A.windowColor,Or=qt===void 0?"rgb(30,60,89)":qt,Nr=A.time,bn=Nr===void 0?0:Nr;return{u_opacity:B,u_baseColor:Object(we.s)(de),u_brightColor:Object(we.s)(zt),u_windowColor:Object(we.s)(Or),u_time:this.layer.getLayerAnimateTime()||bn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Yi,fragmentShader:oi,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B,ie,de,Ve){return Ve}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?10:Ve;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,B,ie,de){var Ve=M.size;return[ie[3],ie[4]]}}})}}]),E}(Et);function Ha(h){var _=oo();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var so=function(h){D()(E,h);var _=Ha(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.type="PolygonLayer",b}return i()(E,[{key:"buildModels",value:function(){this.layerModel=new wo(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(A){this.updateLayerConfig({time:A})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),E}(ne);function Eu(h){var _=$o();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Kl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,ks=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ho=function(h){D()(E,h);var _=Eu(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:B||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Kl,fragmentShader:ks,triangulation:di,depth:{enable:!1},primitive:x.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),E}(Et);function Vt(h){var _=Re();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Re(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Dt=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,mr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Qr=function(h){D()(E,h);var _=Vt(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:B||1,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Dt,fragmentShader:mr,triangulation:va,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size;return Array.isArray(Ve)?[Ve[0]]:[Ve]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B,ie,de,Ve){return Ve}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),E}(Et);function En(h,_){for(var E=[],b=[],A=[],M=h+1,B=_+1,ie=h/2,de=_/2,Ve=0;Ve<B;Ve++)for(var zt=Ve-de,qt=0;qt<M;qt++){var Or=qt-ie;b.push(Or/ie,-zt/de,0),A.push(qt/h),A.push(1-Ve/_)}for(var Nr=0;Nr<_;Nr++)for(var bn=0;bn<h;bn++){var gn=bn+M*Nr,Fn=bn+M*(Nr+1),Ta=bn+1+M*(Nr+1),Ca=bn+1+M*Nr;E.push(gn,Fn,Ca),E.push(Fn,Ta,Ca)}return{vertices:b,indices:E,uvs:A}}function Vn(h,_){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);_&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function Ci(h){for(var _=1;_<arguments.length;_++){var E=arguments[_]!=null?arguments[_]:{};_%2?Vn(Object(E),!0).forEach(function(b){Pe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Vn(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}function po(h){var _=mo();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function mo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Oo=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Fu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Ml=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,bs=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,vc=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,Tu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Mo=function(h){D()(E,h);var _=po(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.texture=void 0,b.colorTexture=void 0,b.heatmapFramerBuffer=void 0,b.intensityModel=void 0,b.colorModel=void 0,b.shapeType=void 0,b}return i()(E,[{key:"render",value:function(){var A=this,M=this.rendererService,B=M.clear,ie=M.useFramebuffer;ie(this.heatmapFramerBuffer,function(){B({color:[0,0,0,0],depth:1,stencil:0,framebuffer:A.heatmapFramerBuffer}),A.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var A,M=this.rendererService,B=M.createFramebuffer,ie=M.clear,de=M.getViewportSize,Ve=M.createTexture2D,zt=M.useFramebuffer,qt=this.styleAttributeService.getLayerStyleAttribute("shape"),Or=(qt==null||((A=qt.scale)===null||A===void 0)?void 0:A.field)||"heatmap";this.shapeType=Or,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=Or==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Nr=this.layer.getLayerConfig(),bn=Nr.rampColors,gn=Object(we.n)(bn),Fn=de(),Ta=Fn.width,Ca=Fn.height;return this.heatmapFramerBuffer=B({color:Ve({width:Math.floor(Ta/4),height:Math.floor(Ca/4),wrapS:x.gl.CLAMP_TO_EDGE,wrapT:x.gl.CLAMP_TO_EDGE,min:x.gl.LINEAR,mag:x.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:x.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?1:Ve;return[zt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:vc,fragmentShader:bs,triangulation:fa,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:x.gl.ONE,srcAlpha:1,dstRGB:x.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:Tu,fs:Ml});var A=this.shaderModuleService.getModule("heatmapColor"),M=A.vs,B=A.fs,ie=A.uniforms,de=this.rendererService,Ve=de.createAttribute,zt=de.createElements,qt=de.createBuffer,Or=de.createModel;return Or({vs:M,fs:B,attributes:{a_Position:Ve({buffer:qt({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:x.gl.FLOAT}),size:3}),a_Uv:Ve({buffer:qt({data:[0,1,1,1,0,0,1,0],type:x.gl.FLOAT}),size:2})},uniforms:Ci({},ie),depth:{enable:!1},blend:this.getBlend(),count:6,elements:zt({data:[0,2,1,2,3,1],type:x.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.intensity,ie=B===void 0?10:B,de=A.radius,Ve=de===void 0?5:de;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:Ve,u_intensity:ie}})}},{key:"drawColorMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=gr.b.invert(gr.b.create(),gr.b.fromValues.apply(gr.b,Ht()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Ht()(B)}})}},{key:"build3dHeatMap",value:function(){var A=this.rendererService.getViewportSize,M=A(),B=M.width,ie=M.height,de=En(B/4,ie/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Fu,fs:Oo});var Ve=this.shaderModuleService.getModule("heatmap3dColor"),zt=Ve.vs,qt=Ve.fs,Or=Ve.uniforms,Nr=this.rendererService,bn=Nr.createAttribute,gn=Nr.createElements,Fn=Nr.createBuffer,Ta=Nr.createModel;return Ta({vs:zt,fs:qt,attributes:{a_Position:bn({buffer:Fn({data:de.vertices,type:x.gl.FLOAT}),size:3}),a_Uv:bn({buffer:Fn({data:de.uvs,type:x.gl.FLOAT}),size:2})},primitive:x.gl.TRIANGLES,uniforms:Ci({},Or),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:x.gl.SRC_ALPHA,srcAlpha:1,dstRGB:x.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:gn({data:de.indices,type:x.gl.UNSIGNED_INT,count:de.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var A=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),B=M.rampColors,ie=Object(we.n)(B);this.colorTexture=A({data:new Uint8Array(ie.data),width:ie.width,height:ie.height,wrapS:x.gl.CLAMP_TO_EDGE,wrapT:x.gl.CLAMP_TO_EDGE,min:x.gl.NEAREST,mag:x.gl.NEAREST,flipY:!1})}}]),E}(Et);function zu(h){var _=Eo();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Eo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fi=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ys=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,Ks=function(h){D()(E,h);var _=zu(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:B||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Ys,fragmentShader:Fi,triangulation:di,depth:{enable:!1},primitive:x.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),E}(Et),js={heatmap:Mo,heatmap3d:Mo,grid:ho,grid3d:Qr,hexagon:Ks},Ri=js;function Vi(h){var _=xs();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function xs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var vl=function(h){D()(E,h);var _=Vi(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.type="HeatMapLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new Ri[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var A=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(B){return B.draw({uniforms:A.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),B=this.getLayerConfig(),ie=B.shape3d,de=this.getSource(),Ve=de.data.type,zt=(M==null||((A=M.scale)===null||A===void 0)?void 0:A.field)||"heatmap";return zt==="heatmap"||zt==="heatmap3d"?"heatmap":Ve==="hexagon"?(ie==null?void 0:ie.indexOf(zt))===-1?"hexagon":"grid3d":Ve==="grid"?(ie==null?void 0:ie.indexOf(zt))===-1?"grid":"grid3d":"heatmap"}}]),E}(ne);function Qu(h){var _=Rt();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Rt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var fr=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Mr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Zn=function(h){D()(E,h);var _=Qu(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.texture=void 0,b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var A=this,M=this.layer.getSource(),B=this.rendererService.createTexture2D;return this.texture=B({height:0,width:0}),M.data.images.then(function(ie){A.texture=B({data:ie[0],width:ie[0].width,height:ie[0].height}),A.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Mr,fragmentShader:fr,triangulation:ga,primitive:x.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}})}}]),E}(Et),Xa={image:Zn},vi=Xa;function Ki(h){var _=Ya();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Ya(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ii=function(h){D()(E,h);var _=Ki(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.type="ImageLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new vi[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={image:{}};return M[A]}},{key:"getModelType",value:function(){return"image"}}]),E}(ne);function Go(h){var _=Cs();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Cs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var pi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Pl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,$s={solid:0,dash:1},Es=function(h){D()(E,h);var _=Go(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Ve=de===void 0?[10,5]:de;return Ve.length===2&&Ve.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:$s[ie||"solid"],u_dash_array:Ve,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Pl,fragmentShader:pi,triangulation:ya,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?1:Ve;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:x.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(M,B,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),E}(Et);function gl(h){var _=cu();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function cu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var _u=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,fu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Uu={solid:0,dash:1},Js=function(h){D()(E,h);var _=gl(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Ve=de===void 0?[10,5]:de;return Ve.length===2&&Ve.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:Uu[ie]||0,u_dash_array:Ve}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:_u,fragmentShader:fu,triangulation:ya,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?1:Ve;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:x.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(M,B,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),E}(Et);function Rc(h){var _=pf();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function pf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ci=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ic=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,gc={solid:0,dash:1},Qc=function(h){D()(E,h);var _=Rc(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Ve=de===void 0?[10,5]:de;return Ve.length===2&&Ve.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:gc[ie]||0,u_dash_array:Ve}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Ic,fragmentShader:ci,triangulation:ya,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?1:Ve;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:x.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(M,B,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),E}(Et);function yl(h){var _=qc();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function qc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var $i=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Su=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,bl={solid:0,dash:1},as=function(h){D()(E,h);var _=yl(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.lineType,ie=B===void 0?"solid":B,de=A.dashArray,Ve=de===void 0?[10,5,0,0]:de;return Ve.length===2&&Ve.push(0,0),{u_opacity:M||1,u_line_type:bl[ie],u_dash_array:Ve}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Su,fragmentShader:$i,triangulation:Ia,primitive:x.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var A=this.layer.getLayerConfig(),M=A.lineType,B=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:x.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(de,Ve,zt,qt){return[zt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:x.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(de,Ve,zt,qt){return[zt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(de,Ve,zt,qt){var Or=de.size,Nr=Or===void 0?1:Or;return Array.isArray(Nr)?[Nr[0],Nr[1]]:[Nr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(de,Ve,zt,qt,Or){return Or}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:x.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(de,Ve,zt,qt){return[zt[4]]}}})}}]),E}(Et),Dc={arc:Es,arc3d:Js,greatcircle:Qc,line:as},yc=Dc;function Ll(h){var _=qu();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function qu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nc=function(h){D()(E,h);var _=Ll(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.type="LineLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new yc[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[A]}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),B=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return B||"line"}}]),E}(ne);function hu(h){var _=Au();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Au(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ef=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,$l=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,Ti=function(h){D()(E,h);var _=hu(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.offsets;return{u_opacity:M||1,u_offsets:B||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:$l,fragmentShader:ef,triangulation:va,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B,ie,de){var Ve=M.size;if(Ve){var zt=[];return Array.isArray(Ve)&&(zt=Ve.length===2?[Ve[0],Ve[0],Ve[1]]:Ve),Array.isArray(Ve)||(zt=[Ve]),zt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B,ie,de,Ve){return Ve}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B){var ie=Xe(M.coordinates);return[ie[0],ie[1],0]}}})}}]),E}(Et);function tf(h){var _=mf();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function mf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Jl=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,kc=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,Ql=function(h){D()(E,h);var _=tf(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Ve=A.strokeWidth,zt=Ve===void 0?1:Ve,qt=A.strokeOpacity,Or=qt===void 0?1:qt,Nr=A.offsets,bn=Nr===void 0?[0,0]:Nr;return{u_opacity:B,u_stroke_width:zt,u_stroke_color:Object(we.s)(de),u_stroke_opacity:Or,u_offsets:[-bn[0],bn[1]]}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Va)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:kc,fragmentShader:Jl,triangulation:Va,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(A){return[A.enable?0:1,A.speed||1,A.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:x.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(B,ie,de,Ve){var zt=[1,1,-1,1,-1,-1,1,-1],qt=Ve%4*2;return[zt[qt],zt[qt+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(B,ie,de,Ve){var zt=B.size,qt=zt===void 0?5:zt;return Array.isArray(qt)?[qt[0]]:[qt]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:x.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(B,ie,de,Ve){var zt=B.shape,qt=zt===void 0?2:zt,Or=A.layer.getLayerConfig().shape2d,Nr=Or.indexOf(qt);return[Nr]}}})}}]),E}(Et);function el(h){var _=Bu();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Bu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var xl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Po=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,ql=function(h){D()(E,h);var _=el(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.texture=void 0,b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var A=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){A.updateTexture(),A.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Po,fragmentShader:xl,triangulation:Ma,primitive:x.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(B,ie,de,Ve){var zt=B.size;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(B,ie,de,Ve){var zt=A.fontService.mapping,qt=B.shape,Or=A.fontService.getGlyph(qt),Nr=zt[Or],bn=Nr.x,gn=Nr.y;return[bn,gn]}}})}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=A({data:M,mag:x.gl.LINEAR,min:x.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),B=M.fontWeight,ie=B===void 0?"normal":B,de=M.fontFamily,Ve=de===void 0?"sans-serif":de,zt=this.layer.getEncodedData(),qt=[];zt.forEach(function(Or){var Nr=Or.shape,bn=Nr===void 0?"":Nr;bn=bn.toString();var gn=A.fontService.getGlyph(bn);qt.indexOf(gn)===-1&&qt.push(gn)}),this.fontService.setFontOptions({characterSet:qt,fontWeight:ie,fontFamily:Ve,fontSize:48})}}]),E}(Et);function Rl(h){var _=Il();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Il(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,El=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Qs=function(h){D()(E,h);var _=Rl(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.texture=void 0,b.updateTexture=function(){var ie=b.rendererService.createTexture2D;if(b.texture){b.texture.update({data:b.iconService.getCanvas()}),b.layer.render();return}b.texture=ie({data:b.iconService.getCanvas(),mag:x.gl.LINEAR,min:x.gl.LINEAR,width:1024,height:b.iconService.canvasHeight||128})},b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=A.offsets,ie=B===void 0?[0,0]:B;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ie[0],ie[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:El,fragmentShader:jc,triangulation:Ma,primitive:x.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(B,ie,de,Ve){var zt=B.size,qt=zt===void 0?5:zt;return Array.isArray(qt)?[qt[0]]:[qt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(B,ie,de,Ve){var zt=A.iconService.getIconMap(),qt=B.shape,Or=zt[qt]||{x:0,y:0},Nr=Or.x,bn=Or.y;return[Nr,bn]}}})}}]),E}(Et);function eo(h){var _=vf();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function vf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var gf=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Tl=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function ec(h){var _=h.coordinates;return{vertices:Ht()(_),indices:[0],size:_.length}}var tl=function(h){D()(E,h);var _=eo(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Ve=A.strokeWidth,zt=Ve===void 0?1:Ve,qt=A.offsets,Or=qt===void 0?[0,0]:qt;return{u_opacity:B,u_stroke_width:zt,u_stroke_color:Object(we.s)(de),u_offsets:[-Or[0],Or[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:Tl,fragmentShader:gf,triangulation:ec,depth:{enable:!1},primitive:x.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?1:Ve;return Array.isArray(zt)?[zt[0]]:[zt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:x.BlendType.additive}}}]),E}(Et);function Dl(h,_){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=bc(h))||_&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ve){throw Ve},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ve=E.next();return M=Ve.done,Ve},e:function(Ve){B=!0,ie=Ve},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(B)throw ie}}}}function bc(h,_){if(!h)return;if(typeof h=="string")return xc(h,_);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return xc(h,_)}function xc(h,_){(_==null||_>h.length)&&(_=h.length);for(var E=0,b=new Array(_);E<_;E++)b[E]=h[E];return b}var rl=function(){function h(_,E,b){Y()(this,h),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var A=this.boxCells;this.xCellCount=Math.ceil(_/b),this.yCellCount=Math.ceil(E/b);for(var M=0;M<this.xCellCount*this.yCellCount;M++)A.push([]);this.boxKeys=[],this.bboxes=[],this.width=_,this.height=E,this.xScale=this.xCellCount/_,this.yScale=this.yCellCount/E,this.boxUid=0}return i()(h,[{key:"insert",value:function(E,b,A,M,B){this.forEachCell(b,A,M,B,this.insertBoxCell,this.boxUid++),this.boxKeys.push(E),this.bboxes.push(b),this.bboxes.push(A),this.bboxes.push(M),this.bboxes.push(B)}},{key:"query",value:function(E,b,A,M,B){return this.queryHitTest(E,b,A,M,!1,B)}},{key:"hitTest",value:function(E,b,A,M,B){return this.queryHitTest(E,b,A,M,!0,B)}},{key:"insertBoxCell",value:function(E,b,A,M,B,ie){this.boxCells[B].push(ie)}},{key:"queryHitTest",value:function(E,b,A,M,B,ie){if(A<0||E>this.width||M<0||b>this.height)return B?!1:[];var de=[];if(E<=0&&b<=0&&this.width<=A&&this.height<=M){if(B)return!0;for(var Ve=0;Ve<this.boxKeys.length;Ve++)de.push({key:this.boxKeys[Ve],x1:this.bboxes[Ve*4],y1:this.bboxes[Ve*4+1],x2:this.bboxes[Ve*4+2],y2:this.bboxes[Ve*4+3]});return ie?de.filter(ie):de}var zt={hitTest:B,seenUids:{box:{},circle:{}}};return this.forEachCell(E,b,A,M,this.queryCell,de,zt,ie),B?de.length>0:de}},{key:"queryCell",value:function(E,b,A,M,B,ie,de,Ve){var zt=de.seenUids,qt=this.boxCells[B];if(qt!==null){var Or=this.bboxes,Nr=Dl(qt),bn;try{for(Nr.s();!(bn=Nr.n()).done;){var gn=bn.value;if(!zt.box[gn]){zt.box[gn]=!0;var Fn=gn*4;if(E<=Or[Fn+2]&&b<=Or[Fn+3]&&A>=Or[Fn+0]&&M>=Or[Fn+1]&&(!Ve||Ve(this.boxKeys[gn]))){if(de.hitTest)return ie.push(!0),!0;ie.push({key:this.boxKeys[gn],x1:Or[Fn],y1:Or[Fn+1],x2:Or[Fn+2],y2:Or[Fn+3]})}}}}catch(Ta){Nr.e(Ta)}finally{Nr.f()}}return!1}},{key:"forEachCell",value:function(E,b,A,M,B,ie,de,Ve){for(var zt=this.convertToXCellCoord(E),qt=this.convertToYCellCoord(b),Or=this.convertToXCellCoord(A),Nr=this.convertToYCellCoord(M),bn=zt;bn<=Or;bn++)for(var gn=qt;gn<=Nr;gn++){var Fn=this.xCellCount*gn+bn;if(B.call(this,E,b,A,M,Fn,ie,de,Ve))return}}},{key:"convertToXCellCoord",value:function(E){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(E*this.xScale)))}},{key:"convertToYCellCoord",value:function(E){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(E*this.yScale)))}}]),h}(),rf=rl,nl=function(){function h(_,E){Y()(this,h),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=_,this.height=E,this.viewportPadding=Math.max(_,E),this.grid=new rf(_+this.viewportPadding,E+this.viewportPadding,25),this.screenRightBoundary=_+this.viewportPadding,this.screenBottomBoundary=E+this.viewportPadding,this.gridRightBoundary=_+2*this.viewportPadding,this.gridBottomBoundary=E+2*this.viewportPadding}return i()(h,[{key:"placeCollisionBox",value:function(E){var b=E.x1+E.anchorPointX+this.viewportPadding,A=E.y1+E.anchorPointY+this.viewportPadding,M=E.x2+E.anchorPointX+this.viewportPadding,B=E.y2+E.anchorPointY+this.viewportPadding;return!this.isInsideGrid(b,A,M,B)||this.grid.hitTest(b,A,M,B)?{box:[]}:{box:[b,A,M,B]}}},{key:"insertCollisionBox",value:function(E,b){var A={featureIndex:b};this.grid.insert(A,E[0],E[1],E[2],E[3])}},{key:"project",value:function(E,b,A){var M=gr.e.fromValues(b,A,0,1),B=gr.e.create(),ie=gr.b.fromValues.apply(gr.b,Ht()(E));return gr.e.transformMat4(B,M,ie),{x:(B[0]/B[3]+1)/2*this.width+this.viewportPadding,y:(-B[1]/B[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(E,b,A,M){return A>=0&&E<this.gridRightBoundary&&M>=0&&b<this.gridBottomBoundary}}]),h}();function qs(h,_){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=_l(h))||_&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ve){throw Ve},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ve=E.next();return M=Ve.done,Ve},e:function(Ve){B=!0,ie=Ve},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(B)throw ie}}}}function _l(h,_){if(!h)return;if(typeof h=="string")return tc(h,_);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return tc(h,_)}function tc(h,_){(_==null||_>h.length)&&(_=h.length);for(var E=0,b=new Array(_);E<_;E++)b[E]=h[E];return b}function Fc(h){var _=.5,E=.5;switch(h){case"right":case"top-right":case"bottom-right":_=1;break;case"left":case"top-left":case"bottom-left":_=0;break;default:_=.5}switch(h){case"bottom":case"bottom-right":case"bottom-left":E=1;break;case"top":case"top-right":case"top-left":E=0;break;default:E=.5}return{horizontalAlign:_,verticalAlign:E}}function nf(h,_,E,b,A){if(!A)return;var M=h[b],B=M.glyph;if(B)for(var ie=_[B].advance*M.scale,de=(h[b].x+ie)*A,Ve=E;Ve<=b;Ve++)h[Ve].x-=de}function Fs(h,_,E,b,A,M,B){var ie=(_-E)*A,de=(-b*B+.5)*M,Ve=qs(h),zt;try{for(Ve.s();!(zt=Ve.n()).done;){var qt=zt.value;qt.x+=ie,qt.y+=de}}catch(Or){Ve.e(Or)}finally{Ve.f()}}function yf(h,_,E,b,A,M,B){var ie=-8,de=0,Ve=ie,zt=0,qt=h.positionedGlyphs,Or=M==="right"?1:M==="left"?0:.5,Nr=qt.length;E.forEach(function(Ca){if(Ca.split("").forEach(function(ai){var ii=_[ai],Qi=0;ii&&(qt.push({glyph:ai,x:de,y:Ve+Qi,vertical:!1,scale:1,metrics:ii}),de+=ii.advance+B)}),qt.length!==Nr){var Li=de-B;zt=Math.max(Li,zt),nf(qt,_,Nr,qt.length-1,Or)}de=0,Ve+=b});var bn=Fc(A),gn=bn.horizontalAlign,Fn=bn.verticalAlign;Fs(qt,Or,gn,Fn,zt,b,E.length);var Ta=Ve-ie;h.top+=-Fn*Ta,h.bottom=h.top+Ta,h.left+=-gn*zt,h.right=h.left+zt}function al(h,_,E,b,A,M){var B=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ie=h.split(`
`),de=[],Ve={positionedGlyphs:de,top:B[1],bottom:B[1],left:B[0],right:B[0],lineCount:ie.length,text:h};return yf(Ve,_,ie,E,b,A,M),de.length?Ve:!1}function wi(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],E=arguments.length>2?arguments[2]:void 0,b=h.positionedGlyphs,A=b===void 0?[]:b,M=[],B=qs(A),ie;try{for(B.s();!(ie=B.n()).done;){var de=ie.value,Ve=de.metrics,zt=4,qt=Ve.advance*de.scale/2,Or=E?[de.x+qt,de.y]:[0,0],Nr=E?[0,0]:[de.x+qt+_[0],de.y+_[1]],bn=(0-zt)*de.scale-qt+Nr[0],gn=(0-zt)*de.scale+Nr[1],Fn=bn+Ve.width*de.scale,Ta=gn+Ve.height*de.scale,Ca={x:bn,y:gn},Li={x:Fn,y:gn},ai={x:bn,y:Ta},ii={x:Fn,y:Ta};M.push({tl:Ca,tr:Li,bl:ai,br:ii,tex:Ve,glyphOffset:Or})}}catch(Qi){B.e(Qi)}finally{B.f()}return M}function il(h,_){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=Vu(h))||_&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ve){throw Ve},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,B=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ve=E.next();return M=Ve.done,Ve},e:function(Ve){B=!0,ie=Ve},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(B)throw ie}}}}function Vu(h,_){if(!h)return;if(typeof h=="string")return ui(h,_);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return ui(h,_)}function ui(h,_){(_==null||_>h.length)&&(_=h.length);for(var E=0,b=new Array(_);E<_;E++)b[E]=h[E];return b}function kn(h){var _=Oi();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Oi(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ws=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Nl=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  gl_Position = vec4(projected_position.xy / projected_position.w
    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Gu(h){var _=this,E=h.id,b=[],A=[];if(!_.glyphInfoMap||!_.glyphInfoMap[E])return{vertices:[],indices:[],size:7};var M=_.glyphInfoMap[E].centroid,B=M.length===2?[M[0],M[1],0]:M;return _.glyphInfoMap[E].glyphQuads.forEach(function(ie,de){b.push.apply(b,Ht()(B).concat([ie.tex.x,ie.tex.y+ie.tex.height,ie.tl.x,ie.tl.y],Ht()(B),[ie.tex.x+ie.tex.width,ie.tex.y+ie.tex.height,ie.tr.x,ie.tr.y],Ht()(B),[ie.tex.x+ie.tex.width,ie.tex.y,ie.br.x,ie.br.y],Ht()(B),[ie.tex.x,ie.tex.y,ie.bl.x,ie.bl.y])),A.push(0+de*4,1+de*4,2+de*4,2+de*4,3+de*4,0+de*4)}),{vertices:b,indices:A,size:7}}var ol=function(h){D()(E,h);var _=kn(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.glyphInfo=void 0,b.glyphInfoMap={},b.texture=void 0,b.currentZoom=-1,b.extent=void 0,b.textureHeight=0,b.textCount=0,b.preTextStyle={},b.buildModels=function(){return b.initGlyph(),b.updateTexture(),b.filterGlyphs(),[b.layer.buildLayerModel({moduleName:"pointText",vertexShader:Nl,fragmentShader:ws,triangulation:Gu.bind(ot()(b)),depth:{enable:!1},blend:b.getBlend()})]},b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"#fff":ie,Ve=A.strokeWidth,zt=Ve===void 0?0:Ve,qt=A.strokeOpacity,Or=qt===void 0?1:qt,Nr=A.textAnchor,bn=Nr===void 0?"center":Nr,gn=A.textAllowOverlap,Fn=gn===void 0?!1:gn,Ta=A.halo,Ca=Ta===void 0?.5:Ta,Li=A.gamma,ai=Li===void 0?2:Li,ii=this.fontService,Qi=ii.canvas,wa=ii.mapping;return Object.keys(wa).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(wa).length),this.preTextStyle={textAnchor:bn,textAllowOverlap:Fn},{u_opacity:B,u_stroke_opacity:Or,u_sdf_map:this.texture,u_stroke:Object(we.s)(de),u_halo_blur:Ca,u_gamma_scale:ai,u_sdf_map_size:[Qi.width,Qi.height],u_strokeWidth:zt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var A=this.layer.getLayerConfig(),M=A.textAnchor,B=M===void 0?"center":M,ie=A.textAllowOverlap,de=ie===void 0?!0:ie;return this.preTextStyle={textAnchor:B,textAllowOverlap:de},this.buildModels()}},{key:"needUpdate",value:function(){var A=this.layer.getLayerConfig(),M=A.textAllowOverlap,B=M===void 0?!1:M,ie=this.mapService.getZoom(),de=this.mapService.getBounds(),Ve=Object(we.j)(this.extent,de);return!B&&(Math.abs(this.currentZoom-ie)>1||!Ve)||B!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:x.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[5],ie[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?12:Ve;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:x.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}})}},{key:"textExtent",value:function(){var A=this.mapService.getBounds();return Object(we.r)(A,.5)}},{key:"initTextFont",value:function(){var A=this.layer.getLayerConfig(),M=A.fontWeight,B=M===void 0?"400":M,ie=A.fontFamily,de=ie===void 0?"sans-serif":ie,Ve=this.layer.getEncodedData(),zt=[];Ve.forEach(function(qt){var Or=qt.shape,Nr=Or===void 0?"":Or;Nr=Nr.toString();var bn=il(Nr),gn;try{for(bn.s();!(gn=bn.n()).done;){var Fn=gn.value;zt.indexOf(Fn)===-1&&zt.push(Fn)}}catch(Ta){bn.e(Ta)}finally{bn.f()}}),this.fontService.setFontOptions({characterSet:zt,fontWeight:B,fontFamily:de})}},{key:"generateGlyphLayout",value:function(){var A=this,M=this.fontService.mapping,B=this.layer.getLayerConfig(),ie=B.spacing,de=ie===void 0?2:ie,Ve=B.textAnchor,zt=Ve===void 0?"center":Ve,qt=B.textOffset,Or=this.layer.getEncodedData();this.glyphInfo=Or.map(function(Nr){var bn=Nr.shape,gn=bn===void 0?"":bn,Fn=Nr.coordinates,Ta=Nr.id,Ca=Nr.size,Li=Ca===void 0?1:Ca,ai=al(gn.toString(),M,Li,zt,"center",de,qt),ii=wi(ai,qt,!1);return Nr.shaping=ai,Nr.glyphQuads=ii,Nr.centroid=Xe(Fn),A.glyphInfoMap[Ta]={shaping:ai,glyphQuads:ii,centroid:Xe(Fn)},Nr})}},{key:"filterGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),B=M.padding,ie=B===void 0?[4,4]:B,de=M.textAllowOverlap,Ve=de===void 0?!1:de;if(Ve)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var zt=this.rendererService.getViewportSize(),qt=zt.width,Or=zt.height,Nr=new nl(qt,Or),bn=this.glyphInfo.filter(function(gn){var Fn=gn.shaping,Ta=gn.id,Ca=Ta===void 0?0:Ta,Li=gn.centroid,ai=gn.size,ii=ai/24,Qi=A.mapService.lngLatToContainer(Li),wa=Nr.placeCollisionBox({x1:Fn.left*ii-ie[0],x2:Fn.right*ii+ie[0],y1:Fn.top*ii-ie[1],y2:Fn.bottom*ii+ie[1],anchorPointX:Qi.x,anchorPointY:Qi.y}),qi=wa.box;return qi&&qi.length?(Nr.insertCollisionBox(qi,Ca),!0):!1});bn.forEach(function(gn){A.glyphInfoMap[gn.id]=gn})}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=A({data:M,mag:x.gl.LINEAR,min:x.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Nl,fragmentShader:ws,triangulation:Gu.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),E}(Et),bf={fill:Ql,image:Qs,normal:tl,extrude:Ti,text:ol,icon:ql},is=bf;function Sl(h){var _=sl();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function sl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ul=function(h){D()(E,h);var _=Sl(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.type="PointLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new is[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[A]}},{key:"getModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),B=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Ve=A.find(function(qt){return qt.hasOwnProperty("shape")});if(Ve){var zt=Ve.shape;return zt==="dot"?"normal":(B==null?void 0:B.indexOf(zt))!==-1?"fill":(ie==null?void 0:ie.indexOf(zt))!==-1?"extrude":de.hasOwnProperty(zt)?"image":this.fontService.getGlyph(zt)!==""?"icon":"text"}else return"normal"}}]),E}(ne);function zi(h){var _=Ts();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Ts(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var kl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,to=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,In=function(h){D()(E,h);var _=zi(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M;return{u_opacity:B}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:to,fragmentShader:kl,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,B,ie,de,Ve){return Ve}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,B,ie,de){var Ve=M.size,zt=Ve===void 0?10:Ve;return Array.isArray(zt)?[zt[0]]:[zt]}}})}}]),E}(Et);function zs(h){var _=ti();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function ti(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,du=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,Us=function(h){D()(E,h);var _=zs(E);function E(){return Y()(this,E),_.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M;return{u_opacity:B}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:du,fragmentShader:jl,triangulation:Zi,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),E}(Et),ll={fill:Us,line:as,extrude:In,text:ol,point_fill:Ql,point_image:Qs,point_normal:tl,point_extrude:Ti},qr=ll;function Ec(h){var _=os();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function os(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ro=function(h){D()(E,h);var _=Ec(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.type="PolygonLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new qr[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),B=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return B==="fill"?"fill":B==="extrude"?"extrude":B==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),B=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Ve=A.find(function(qt){return qt.hasOwnProperty("shape")});if(Ve){var zt=Ve.shape;return zt==="dot"?"point_normal":(B==null?void 0:B.indexOf(zt))!==-1?"point_fill":(ie==null?void 0:ie.indexOf(zt))!==-1?"point_extrude":de.hasOwnProperty(zt)?"point_image":"text"}else return"fill"}}]),E}(ne);function Jo(h){var _=Os();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function Os(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fl=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,zc=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Bs=function(h){D()(E,h);var _=Jo(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.texture=void 0,b.colorTexture=void 0,b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,B=M===void 0?1:M,ie=A.clampLow,de=ie===void 0?!0:ie,Ve=A.clampHigh,zt=Ve===void 0?!0:Ve,qt=A.noDataValue,Or=qt===void 0?-9999999:qt,Nr=A.domain,bn=Nr===void 0?[0,1]:Nr;return this.updateColorTexure(),{u_opacity:B||1,u_texture:this.texture,u_domain:bn,u_clampLow:de,u_clampHigh:typeof zt!="undefined"?zt:de,u_noDataValue:Or,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var A=this.layer.getSource(),M=this.rendererService.createTexture2D,B=A.data.dataArray[0];this.texture=M({data:B.data,width:B.width,height:B.height,format:x.gl.LUMINANCE,type:x.gl.FLOAT});var ie=this.layer.getLayerConfig(),de=ie.rampColors,Ve=Object(we.n)(de);return this.colorTexture=M({data:Ve.data,width:Ve.width,height:Ve.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:zc,fragmentShader:Fl,triangulation:ga,primitive:x.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,B,ie,de){return[ie[3],ie[4]]}}})}},{key:"updateColorTexure",value:function(){var A=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),B=M.rampColors,ie=Object(we.n)(B);this.colorTexture=A({data:ie.data,width:ie.width,height:ie.height,flipY:!1})}}]),E}(Et),Cu={raster:Bs,raster3d:Bs},zl=Cu;function Ul(h){var _=af();return function(){var b=K()(h),A;if(_){var M=K()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return ee()(this,A)}}function af(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Uc=function(h){D()(E,h);var _=Ul(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),B=0;B<A;B++)M[B]=arguments[B];return b=_.call.apply(_,[this].concat(M)),b.type="RasterLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new zl[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={raster:{},raster3d:{}};return M[A]}},{key:"getModelType",value:function(){return"raster"}}]),E}(ne),Lo,ss,Pa,eu,Ro,To,Al,cl;function pu(h,_){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);_&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function _s(h){for(var _=1;_<arguments.length;_++){var E=arguments[_]!=null?arguments[_]:{};_%2?pu(Object(E),!0).forEach(function(b){Pe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):pu(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var Tc=(Lo=Object(ur.injectable)(),ss=Object(ur.inject)(x.TYPES.IGlobalConfigService),Pa=Object(ur.inject)(x.TYPES.ILogService),Lo(eu=(Ro=(cl=function(){function h(){Y()(this,h),Le()(this,"configService",To,this),Le()(this,"logger",Al,this)}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("DataMappingPlugin",function(){A.generateMaping(E,{styleAttributeService:M})}),E.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return E.dataState.dataMappingNeedUpdate=!1,A.generateMaping(E,{styleAttributeService:M}),!0}),E.hooks.beforeRender.tap("DataMappingPlugin",function(){if(E.layerModelNeedUpdate)return;var B=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=E.getSource().data.dataArray,Ve=B.filter(function(qt){return qt.needRemapping}),zt=de;(ie==null?void 0:ie.needRemapping)&&(ie==null?void 0:ie.scale)&&(zt=de.filter(function(qt){return A.applyAttributeMapping(ie,qt)[0]})),Ve.length&&((ie==null?void 0:ie.needRemapping)?(E.setEncodedData(A.mapping(B,zt)),ie.needRemapping=!1):E.setEncodedData(A.mapping(Ve,zt,E.getEncodedData())),A.logger.debug("remapping finished"),E.emit("remapping",null))})}},{key:"generateMaping",value:function(E,b){var A=this,M=b.styleAttributeService,B=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=E.getSource().data.dataArray,Ve=de;(ie==null?void 0:ie.scale)&&(Ve=de.filter(function(zt){return A.applyAttributeMapping(ie,zt)[0]})),E.setEncodedData(this.mapping(B,Ve))}},{key:"mapping",value:function(E,b,A){var M=this;return b.map(function(B,ie){var de=A?A[ie]:{},Ve=_s({id:B._id,coordinates:B.coordinates},de);return E.filter(function(zt){return zt.scale!==void 0}).forEach(function(zt){var qt=M.applyAttributeMapping(zt,B);zt.needRemapping=!1,zt.name==="color"&&(qt=qt.map(function(Or){return Object(we.s)(Or)})),Ve[zt.name]=Array.isArray(qt)&&qt.length===1?qt[0]:qt}),Ve})}},{key:"applyAttributeMapping",value:function(E,b){var A;if(!E.scale)return[];var M=(E==null||((A=E.scale)===null||A===void 0)?void 0:A.scalers)||[],B=[];return M.forEach(function(ie){var de,Ve=ie.field;(b.hasOwnProperty(Ve)||((de=E.scale)===null||de===void 0?void 0:de.type)==="variable")&&B.push(b[Ve])}),E.mapping?E.mapping(B):[]}}]),h}(),cl),To=Ze()(Ro.prototype,"configService",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Al=Ze()(Ro.prototype,"logger",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ro))||eu),Jn=o("rlAn"),jn,_c,us,Io=(jn=Object(ur.injectable)(),jn(_c=(us=function(){function h(){Y()(this,h),this.mapService=void 0}return i()(h,[{key:"apply",value:function(E){var b=this;this.mapService=E.getContainer().get(x.TYPES.IMapService),E.hooks.init.tap("DataSourcePlugin",function(){var A=E.sourceOption,M=A.data,B=A.options;E.setSource(new Jn.default(M,B)),b.updateClusterData(E)}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var A=b.updateClusterData(E),M=E.dataState.dataSourceNeedUpdate;return E.dataState.dataSourceNeedUpdate=!1,A||M})}},{key:"updateClusterData",value:function(E){var b=E.getSource(),A=b.cluster,M=b.clusterOptions,B=M.zoom,ie=B===void 0?0:B,de=M.maxZoom,Ve=de===void 0?16:de,zt=this.mapService.getZoom()-1;return A&&Math.abs(ie-zt)>1&&Ve>ie?(b.updateClusterData(Math.floor(zt)),!0):!1}}]),h}(),us))||_c),vo=o("7tbW"),Ss=o.n(vo),wu=o("4qC0"),rc=o.n(wu),Ka=o("J2iB"),no=o.n(Ka),fl=function(h,_){return h<_?-1:h>_?1:h>=_?0:NaN},mu=function(h){return h.length===1&&(h=hl(h)),{left:function(E,b,A,M){for(A==null&&(A=0),M==null&&(M=E.length);A<M;){var B=A+M>>>1;h(E[B],b)<0?A=B+1:M=B}return A},right:function(E,b,A,M){for(A==null&&(A=0),M==null&&(M=E.length);A<M;){var B=A+M>>>1;h(E[B],b)>0?M=B:A=B+1}return A}}};function hl(h){return function(_,E){return fl(h(_),E)}}var Ou=mu(fl),Ms=Ou.right,Bc=Ou.left,Vs=Ms,xf=function(h,_){_==null&&(_=Bl);for(var E=0,b=h.length-1,A=h[0],M=new Array(b<0?0:b);E<b;)M[E]=_(A,A=h[++E]);return M};function Bl(h,_){return[h,_]}var Vl=function(h,_,E){var b=h.length,A=_.length,M=new Array(b*A),B,ie,de,Ve;for(E==null&&(E=Bl),B=de=0;B<b;++B)for(Ve=h[B],ie=0;ie<A;++ie,++de)M[de]=E(Ve,_[ie]);return M},Sc=function(h,_){return _<h?-1:_>h?1:_>=h?0:NaN},ls=function(h){return h===null?NaN:+h},Hu=function(h,_){var E=h.length,b=0,A=-1,M=0,B,ie,de=0;if(_==null)for(;++A<E;)isNaN(B=ls(h[A]))||(ie=B-M,M+=ie/++b,de+=ie*(B-M));else for(;++A<E;)isNaN(B=ls(_(h[A],A,h)))||(ie=B-M,M+=ie/++b,de+=ie*(B-M));if(b>1)return de/(b-1)},Vc=function(h,_){var E=Hu(h,_);return E&&Math.sqrt(E)},Cl=function(h,_){var E=h.length,b=-1,A,M,B;if(_==null){for(;++b<E;)if((A=h[b])!=null&&A>=A)for(M=B=A;++b<E;)(A=h[b])!=null&&(M>A&&(M=A),B<A&&(B=A))}else for(;++b<E;)if((A=_(h[b],b,h))!=null&&A>=A)for(M=B=A;++b<E;)(A=_(h[b],b,h))!=null&&(M>A&&(M=A),B<A&&(B=A));return[M,B]},Wu=Array.prototype,nc=Wu.slice,Zu=Wu.map,Ps=function(h){return function(){return h}},of=function(h){return h},ac=function(h,_,E){h=+h,_=+_,E=(A=arguments.length)<2?(_=h,h=0,1):A<3?1:+E;for(var b=-1,A=Math.max(0,Math.ceil((_-h)/E))|0,M=new Array(A);++b<A;)M[b]=h+b*E;return M},ic=Math.sqrt(50),oc=Math.sqrt(10),s=Math.sqrt(2),a=function(h,_,E){var b,A=-1,M,B,ie;if(_=+_,h=+h,E=+E,h===_&&E>0)return[h];if((b=_<h)&&(M=h,h=_,_=M),(ie=n(h,_,E))===0||!isFinite(ie))return[];if(ie>0)for(h=Math.ceil(h/ie),_=Math.floor(_/ie),B=new Array(M=Math.ceil(_-h+1));++A<M;)B[A]=(h+A)*ie;else for(h=Math.floor(h*ie),_=Math.ceil(_*ie),B=new Array(M=Math.ceil(h-_+1));++A<M;)B[A]=(h-A)/ie;return b&&B.reverse(),B};function n(h,_,E){var b=(_-h)/Math.max(0,E),A=Math.floor(Math.log(b)/Math.LN10),M=b/Math.pow(10,A);return A>=0?(M>=ic?10:M>=oc?5:M>=s?2:1)*Math.pow(10,A):-Math.pow(10,-A)/(M>=ic?10:M>=oc?5:M>=s?2:1)}function l(h,_,E){var b=Math.abs(_-h)/Math.max(0,E),A=Math.pow(10,Math.floor(Math.log(b)/Math.LN10)),M=b/A;return M>=ic?A*=10:M>=oc?A*=5:M>=s&&(A*=2),_<h?-A:A}var g=function(h){return Math.ceil(Math.log(h.length)/Math.LN2)+1},w=function(){var h=of,_=Cl,E=g;function b(A){var M,B=A.length,ie,de=new Array(B);for(M=0;M<B;++M)de[M]=h(A[M],M,A);var Ve=_(de),zt=Ve[0],qt=Ve[1],Or=E(de,zt,qt);Array.isArray(Or)||(Or=l(zt,qt,Or),Or=ac(Math.ceil(zt/Or)*Or,qt,Or));for(var Nr=Or.length;Or[0]<=zt;)Or.shift(),--Nr;for(;Or[Nr-1]>qt;)Or.pop(),--Nr;var bn=new Array(Nr+1),gn;for(M=0;M<=Nr;++M)gn=bn[M]=[],gn.x0=M>0?Or[M-1]:zt,gn.x1=M<Nr?Or[M]:qt;for(M=0;M<B;++M)ie=de[M],zt<=ie&&ie<=qt&&bn[Vs(Or,ie,0,Nr)].push(A[M]);return bn}return b.value=function(A){return arguments.length?(h=typeof A=="function"?A:Ps(A),b):h},b.domain=function(A){return arguments.length?(_=typeof A=="function"?A:Ps([A[0],A[1]]),b):_},b.thresholds=function(A){return arguments.length?(E=typeof A=="function"?A:Array.isArray(A)?Ps(nc.call(A)):Ps(A),b):E},b},L=function(h,_,E){if(E==null&&(E=ls),!(b=h.length))return;if((_=+_)<=0||b<2)return+E(h[0],0,h);if(_>=1)return+E(h[b-1],b-1,h);var b,A=(b-1)*_,M=Math.floor(A),B=+E(h[M],M,h),ie=+E(h[M+1],M+1,h);return B+(ie-B)*(A-M)},F=function(h,_,E){return h=Zu.call(h,ls).sort(fl),Math.ceil((E-_)/(2*(L(h,.75)-L(h,.25))*Math.pow(h.length,-1/3)))},ue=function(h,_,E){return Math.ceil((E-_)/(3.5*Vc(h)*Math.pow(h.length,-1/3)))},Ee=function(h,_){var E=h.length,b=-1,A,M;if(_==null){for(;++b<E;)if((A=h[b])!=null&&A>=A)for(M=A;++b<E;)(A=h[b])!=null&&A>M&&(M=A)}else for(;++b<E;)if((A=_(h[b],b,h))!=null&&A>=A)for(M=A;++b<E;)(A=_(h[b],b,h))!=null&&A>M&&(M=A);return M},$e=function(h,_){var E=h.length,b=E,A=-1,M,B=0;if(_==null)for(;++A<E;)isNaN(M=ls(h[A]))?--b:B+=M;else for(;++A<E;)isNaN(M=ls(_(h[A],A,h)))?--b:B+=M;if(b)return B/b},rt=function(h,_){var E=h.length,b=-1,A,M=[];if(_==null)for(;++b<E;)isNaN(A=ls(h[b]))||M.push(A);else for(;++b<E;)isNaN(A=ls(_(h[b],b,h)))||M.push(A);return L(M.sort(fl),.5)},nt=function(h){for(var _=h.length,E,b=-1,A=0,M,B;++b<_;)A+=h[b].length;for(M=new Array(A);--_>=0;)for(B=h[_],E=B.length;--E>=0;)M[--A]=B[E];return M},Ft=function(h,_){var E=h.length,b=-1,A,M;if(_==null){for(;++b<E;)if((A=h[b])!=null&&A>=A)for(M=A;++b<E;)(A=h[b])!=null&&M>A&&(M=A)}else for(;++b<E;)if((A=_(h[b],b,h))!=null&&A>=A)for(M=A;++b<E;)(A=_(h[b],b,h))!=null&&M>A&&(M=A);return M},Nt=function(h,_){for(var E=_.length,b=new Array(E);E--;)b[E]=h[_[E]];return b},Kt=function(h,_){if(!(E=h.length))return;var E,b=0,A=0,M,B=h[A];for(_==null&&(_=fl);++b<E;)(_(M=h[b],B)<0||_(B,B)!==0)&&(B=M,A=b);if(_(B,B)===0)return A},jt=function(h,_,E){for(var b=(E==null?h.length:E)-(_=_==null?0:+_),A,M;b;)M=Math.random()*b--|0,A=h[b+_],h[b+_]=h[M+_],h[M+_]=A;return h},Gt=function(h,_){var E=h.length,b=-1,A,M=0;if(_==null)for(;++b<E;)(A=+h[b])&&(M+=A);else for(;++b<E;)(A=+_(h[b],b,h))&&(M+=A);return M},nr=function(h){if(!(M=h.length))return[];for(var _=-1,E=Ft(h,rr),b=new Array(E);++_<E;)for(var A=-1,M,B=b[_]=new Array(M);++A<M;)B[A]=h[A][_];return b};function rr(h){return h.length}var Lr=function(){return nr(arguments)};function vr(h,_){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(_).domain(h);break}return this}function Sr(h,_){switch(arguments.length){case 0:break;case 1:this.interpolator(h);break;default:this.interpolator(_).domain(h);break}return this}var Ar="$";function rn(){}rn.prototype=Xr.prototype={constructor:rn,has:function(_){return Ar+_ in this},get:function(_){return this[Ar+_]},set:function(_,E){return this[Ar+_]=E,this},remove:function(_){var E=Ar+_;return E in this&&delete this[E]},clear:function(){for(var _ in this)_[0]===Ar&&delete this[_]},keys:function(){var _=[];for(var E in this)E[0]===Ar&&_.push(E.slice(1));return _},values:function(){var _=[];for(var E in this)E[0]===Ar&&_.push(this[E]);return _},entries:function(){var _=[];for(var E in this)E[0]===Ar&&_.push({key:E.slice(1),value:this[E]});return _},size:function(){var _=0;for(var E in this)E[0]===Ar&&++_;return _},empty:function(){for(var _ in this)if(_[0]===Ar)return!1;return!0},each:function(_){for(var E in this)E[0]===Ar&&_(this[E],E.slice(1),this)}};function Xr(h,_){var E=new rn;if(h instanceof rn)h.each(function(ie,de){E.set(de,ie)});else if(Array.isArray(h)){var b=-1,A=h.length,M;if(_==null)for(;++b<A;)E.set(b,h[b]);else for(;++b<A;)E.set(_(M=h[b],b,h),M)}else if(h)for(var B in h)E.set(B,h[B]);return E}var mn=Xr,Ln=function(){var h=[],_=[],E,b,A;function M(ie,de,Ve,zt){if(de>=h.length)return E!=null&&ie.sort(E),b!=null?b(ie):ie;for(var qt=-1,Or=ie.length,Nr=h[de++],bn,gn,Fn=mn(),Ta,Ca=Ve();++qt<Or;)(Ta=Fn.get(bn=Nr(gn=ie[qt])+""))?Ta.push(gn):Fn.set(bn,[gn]);return Fn.each(function(Li,ai){zt(Ca,ai,M(Li,de,Ve,zt))}),Ca}function B(ie,de){if(++de>h.length)return ie;var Ve,zt=_[de-1];return b!=null&&de>=h.length?Ve=ie.entries():(Ve=[],ie.each(function(qt,Or){Ve.push({key:Or,values:B(qt,de)})})),zt!=null?Ve.sort(function(qt,Or){return zt(qt.key,Or.key)}):Ve}return A={object:function(de){return M(de,0,qn,sa)},map:function(de){return M(de,0,Sa,Wa)},entries:function(de){return B(M(de,0,Sa,Wa),0)},key:function(de){return h.push(de),A},sortKeys:function(de){return _[h.length-1]=de,A},sortValues:function(de){return E=de,A},rollup:function(de){return b=de,A}}};function qn(){return{}}function sa(h,_,E){h[_]=E}function Sa(){return mn()}function Wa(h,_,E){h.set(_,E)}function Sn(){}var ua=mn.prototype;Sn.prototype=ba.prototype={constructor:Sn,has:ua.has,add:function(_){return _+="",this[Ar+_]=_,this},remove:ua.remove,clear:ua.clear,values:ua.keys,size:ua.size,empty:ua.empty,each:ua.each};function ba(h,_){var E=new Sn;if(h instanceof Sn)h.each(function(M){E.add(M)});else if(h){var b=-1,A=h.length;if(_==null)for(;++b<A;)E.add(h[b]);else for(;++b<A;)E.add(_(h[b],b,h))}return E}var Wn=ba,Aa=function(h){var _=[];for(var E in h)_.push(E);return _},na=function(h){var _=[];for(var E in h)_.push(h[E]);return _},La=function(h){var _=[];for(var E in h)_.push({key:E,value:h[E]});return _},za=Array.prototype,Gi=za.map,_i=za.slice,Di={name:"implicit"};function gi(){var h=mn(),_=[],E=[],b=Di;function A(M){var B=M+"",ie=h.get(B);if(!ie){if(b!==Di)return b;h.set(B,ie=_.push(M))}return E[(ie-1)%E.length]}return A.domain=function(M){if(!arguments.length)return _.slice();_=[],h=mn();for(var B=-1,ie=M.length,de,Ve;++B<ie;)h.has(Ve=(de=M[B])+"")||h.set(Ve,_.push(de));return A},A.range=function(M){return arguments.length?(E=_i.call(M),A):E.slice()},A.unknown=function(M){return arguments.length?(b=M,A):b},A.copy=function(){return gi(_,E).unknown(b)},vr.apply(A,arguments),A}function Ui(){var h=gi().unknown(void 0),_=h.domain,E=h.range,b=[0,1],A,M,B=!1,ie=0,de=0,Ve=.5;delete h.unknown;function zt(){var qt=_().length,Or=b[1]<b[0],Nr=b[Or-0],bn=b[1-Or];A=(bn-Nr)/Math.max(1,qt-ie+de*2),B&&(A=Math.floor(A)),Nr+=(bn-Nr-A*(qt-ie))*Ve,M=A*(1-ie),B&&(Nr=Math.round(Nr),M=Math.round(M));var gn=ac(qt).map(function(Fn){return Nr+A*Fn});return E(Or?gn.reverse():gn)}return h.domain=function(qt){return arguments.length?(_(qt),zt()):_()},h.range=function(qt){return arguments.length?(b=[+qt[0],+qt[1]],zt()):b.slice()},h.rangeRound=function(qt){return b=[+qt[0],+qt[1]],B=!0,zt()},h.bandwidth=function(){return M},h.step=function(){return A},h.round=function(qt){return arguments.length?(B=!!qt,zt()):B},h.padding=function(qt){return arguments.length?(ie=Math.min(1,de=+qt),zt()):ie},h.paddingInner=function(qt){return arguments.length?(ie=Math.min(1,qt),zt()):ie},h.paddingOuter=function(qt){return arguments.length?(de=+qt,zt()):de},h.align=function(qt){return arguments.length?(Ve=Math.max(0,Math.min(1,qt)),zt()):Ve},h.copy=function(){return Ui(_(),b).round(B).paddingInner(ie).paddingOuter(de).align(Ve)},vr.apply(zt(),arguments)}function Qo(h){var _=h.copy;return h.padding=h.paddingOuter,delete h.paddingInner,delete h.paddingOuter,h.copy=function(){return Qo(_())},h}function qo(){return Qo(Ui.apply(null,arguments).paddingInner(1))}var vu=o("FmoU");function Mu(h,_,E,b,A){var M=h*h,B=M*h;return((1-3*h+3*M-B)*_+(4-6*M+3*B)*E+(1+3*h+3*M-3*B)*b+B*A)/6}var cs=function(h){var _=h.length-1;return function(E){var b=E<=0?E=0:E>=1?(E=1,_-1):Math.floor(E*_),A=h[b],M=h[b+1],B=b>0?h[b-1]:2*A-M,ie=b<_-1?h[b+2]:2*M-A;return Mu((E-b/_)*_,B,A,M,ie)}},Gs=function(h){var _=h.length;return function(E){var b=Math.floor(((E%=1)<0?++E:E)*_),A=h[(b+_-1)%_],M=h[b%_],B=h[(b+1)%_],ie=h[(b+2)%_];return Mu((E-b/_)*_,A,M,B,ie)}},Pu=function(h){return function(){return h}};function sc(h,_){return function(E){return h+E*_}}function tu(h,_,E){return h=Math.pow(h,E),_=Math.pow(_,E)-h,E=1/E,function(b){return Math.pow(h+b*_,E)}}function Xu(h,_){var E=_-h;return E?sc(h,E>180||E<-180?E-360*Math.round(E/360):E):Pu(isNaN(h)?_:h)}function uc(h){return(h=+h)===1?ru:function(_,E){return E-_?tu(_,E,h):Pu(isNaN(_)?E:_)}}function ru(h,_){var E=_-h;return E?sc(h,E):Pu(isNaN(h)?_:h)}var Lu=function h(_){var E=uc(_);function b(A,M){var B=E((A=Object(vu.b)(A)).r,(M=Object(vu.b)(M)).r),ie=E(A.g,M.g),de=E(A.b,M.b),Ve=ru(A.opacity,M.opacity);return function(zt){return A.r=B(zt),A.g=ie(zt),A.b=de(zt),A.opacity=Ve(zt),A+""}}return b.gamma=h,b}(1);function fs(h){return function(_){var E=_.length,b=new Array(E),A=new Array(E),M=new Array(E),B,ie;for(B=0;B<E;++B)ie=Object(vu.b)(_[B]),b[B]=ie.r||0,A[B]=ie.g||0,M[B]=ie.b||0;return b=h(b),A=h(A),M=h(M),ie.opacity=1,function(de){return ie.r=b(de),ie.g=A(de),ie.b=M(de),ie+""}}}var ao=fs(cs),Yu=fs(Gs),Gl=function(h,_){_||(_=[]);var E=h?Math.min(_.length,h.length):0,b=_.slice(),A;return function(M){for(A=0;A<E;++A)b[A]=h[A]*(1-M)+_[A]*M;return b}};function hs(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}var Do=function(h,_){return(hs(_)?Gl:No)(h,_)};function No(h,_){var E=_?_.length:0,b=h?Math.min(E,h.length):0,A=new Array(b),M=new Array(E),B;for(B=0;B<b;++B)A[B]=lc(h[B],_[B]);for(;B<E;++B)M[B]=_[B];return function(ie){for(B=0;B<b;++B)M[B]=A[B](ie);return M}}var Ho=function(h,_){var E=new Date;return h=+h,_=+_,function(b){return E.setTime(h*(1-b)+_*b),E}},_o=function(h,_){return h=+h,_=+_,function(E){return h*(1-E)+_*E}},uo=function(h,_){var E={},b={},A;(h===null||typeof h!="object")&&(h={}),(_===null||typeof _!="object")&&(_={});for(A in _)A in h?E[A]=lc(h[A],_[A]):b[A]=_[A];return function(M){for(A in E)b[A]=E[A](M);return b}},Ls=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nu=new RegExp(Ls.source,"g");function Hl(h){return function(){return h}}function Gc(h){return function(_){return h(_)+""}}var dl=function(h,_){var E=Ls.lastIndex=nu.lastIndex=0,b,A,M,B=-1,ie=[],de=[];for(h=h+"",_=_+"";(b=Ls.exec(h))&&(A=nu.exec(_));)(M=A.index)>E&&(M=_.slice(E,M),ie[B]?ie[B]+=M:ie[++B]=M),(b=b[0])===(A=A[0])?ie[B]?ie[B]+=A:ie[++B]=A:(ie[++B]=null,de.push({i:B,x:_o(b,A)})),E=nu.lastIndex;return E<_.length&&(M=_.slice(E),ie[B]?ie[B]+=M:ie[++B]=M),ie.length<2?de[0]?Gc(de[0].x):Hl(_):(_=de.length,function(Ve){for(var zt=0,qt;zt<_;++zt)ie[(qt=de[zt]).i]=qt.x(Ve);return ie.join("")})},lc=function(h,_){var E=typeof _,b;return _==null||E==="boolean"?Pu(_):(E==="number"?_o:E==="string"?(b=Object(vu.a)(_))?(_=b,Lu):dl:_ instanceof vu.a?Lu:_ instanceof Date?Ho:hs(_)?Gl:Array.isArray(_)?No:typeof _.valueOf!="function"&&typeof _.toString!="function"||isNaN(_)?uo:_o)(h,_)},pl=function(h,_){return h=+h,_=+_,function(E){return Math.round(h*(1-E)+_*E)}},Rs=function(h){return function(){return h}},go=function(h){return+h},Ac=[0,1];function ds(h){return h}function sf(h,_){return(_-=h=+h)?function(E){return(E-h)/_}:Rs(isNaN(_)?NaN:.5)}function Cf(h){var _=h[0],E=h[h.length-1],b;return _>E&&(b=_,_=E,E=b),function(A){return Math.max(_,Math.min(E,A))}}function wf(h,_,E){var b=h[0],A=h[1],M=_[0],B=_[1];return A<b?(b=sf(A,b),M=E(B,M)):(b=sf(b,A),M=E(M,B)),function(ie){return M(b(ie))}}function Cc(h,_,E){var b=Math.min(h.length,_.length)-1,A=new Array(b),M=new Array(b),B=-1;for(h[b]<h[0]&&(h=h.slice().reverse(),_=_.slice().reverse());++B<b;)A[B]=sf(h[B],h[B+1]),M[B]=E(_[B],_[B+1]);return function(ie){var de=Vs(h,ie,1,b)-1;return M[de](A[de](ie))}}function Ku(h,_){return _.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function Ef(){var h=Ac,_=Ac,E=lc,b,A,M,B=ds,ie,de,Ve;function zt(){return ie=Math.min(h.length,_.length)>2?Cc:wf,de=Ve=null,qt}function qt(Or){return isNaN(Or=+Or)?M:(de||(de=ie(h.map(b),_,E)))(b(B(Or)))}return qt.invert=function(Or){return B(A((Ve||(Ve=ie(_,h.map(b),_o)))(Or)))},qt.domain=function(Or){return arguments.length?(h=Gi.call(Or,go),B===ds||(B=Cf(h)),zt()):h.slice()},qt.range=function(Or){return arguments.length?(_=_i.call(Or),zt()):_.slice()},qt.rangeRound=function(Or){return _=_i.call(Or),E=pl,zt()},qt.clamp=function(Or){return arguments.length?(B=Or?Cf(h):ds,qt):B!==ds},qt.interpolate=function(Or){return arguments.length?(E=Or,zt()):E},qt.unknown=function(Or){return arguments.length?(M=Or,qt):M},function(Or,Nr){return b=Or,A=Nr,zt()}}function uf(h,_){return Ef()(h,_)}var Of=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ru(h){if(!(_=Of.exec(h)))throw new Error("invalid format: "+h);var _;return new cc({fill:_[1],align:_[2],sign:_[3],symbol:_[4],zero:_[5],width:_[6],comma:_[7],precision:_[8]&&_[8].slice(1),trim:_[9],type:_[10]})}Ru.prototype=cc.prototype;function cc(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}cc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var Df=function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)};function Hc(h,_){if((E=(h=_?h.toExponential(_-1):h.toExponential()).indexOf("e"))<0)return null;var E,b=h.slice(0,E);return[b.length>1?b[0]+b.slice(2):b,+h.slice(E+1)]}var wc=function(h){return h=Hc(Math.abs(h)),h?h[1]:NaN},Qf=function(h,_){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wc(_)/3)))*3-wc(Math.abs(h)))},qf=function(h,_){return function(E,b){for(var A=E.length,M=[],B=0,ie=h[0],de=0;A>0&&ie>0&&!(de+ie+1>b&&(ie=Math.max(1,b-de)),M.push(E.substring(A-=ie,A+ie)),(de+=ie+1)>b);)ie=h[B=(B+1)%h.length];return M.reverse().join(_)}},eh=function(h){return function(_){return _.replace(/[0-9]/g,function(E){return h[+E]})}},th=function(h){e:for(var _=h.length,E=1,b=-1,A;E<_;++E)switch(h[E]){case".":b=A=E;break;case"0":b===0&&(b=E),A=E;break;default:if(!+h[E])break e;b>0&&(b=0);break}return b>0?h.slice(0,b)+h.slice(A+1):h},Mf,rh=function(h,_){var E=Hc(h,_);if(!E)return h+"";var b=E[0],A=E[1],M=A-(Mf=Math.max(-8,Math.min(8,Math.floor(A/3)))*3)+1,B=b.length;return M===B?b:M>B?b+new Array(M-B+1).join("0"):M>0?b.slice(0,M)+"."+b.slice(M):"0."+new Array(1-M).join("0")+Hc(h,Math.max(0,_+M-1))[0]},Wl=function(h,_){var E=Hc(h,_);if(!E)return h+"";var b=E[0],A=E[1];return A<0?"0."+new Array(-A).join("0")+b:b.length>A+1?b.slice(0,A+1)+"."+b.slice(A+1):b+new Array(A-b.length+2).join("0")},lf={"%":function(_,E){return(_*100).toFixed(E)},b:function(_){return Math.round(_).toString(2)},c:function(_){return _+""},d:Df,e:function(_,E){return _.toExponential(E)},f:function(_,E){return _.toFixed(E)},g:function(_,E){return _.toPrecision(E)},o:function(_){return Math.round(_).toString(8)},p:function(_,E){return Wl(_*100,E)},r:Wl,s:rh,X:function(_){return Math.round(_).toString(16).toUpperCase()},x:function(_){return Math.round(_).toString(16)}},io=function(h){return h},fc=Array.prototype.map,Tf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Oc=function(h){var _=h.grouping===void 0||h.thousands===void 0?io:qf(fc.call(h.grouping,Number),h.thousands+""),E=h.currency===void 0?"":h.currency[0]+"",b=h.currency===void 0?"":h.currency[1]+"",A=h.decimal===void 0?".":h.decimal+"",M=h.numerals===void 0?io:eh(fc.call(h.numerals,String)),B=h.percent===void 0?"%":h.percent+"",ie=h.minus===void 0?"-":h.minus+"",de=h.nan===void 0?"NaN":h.nan+"";function Ve(qt){qt=Ru(qt);var Or=qt.fill,Nr=qt.align,bn=qt.sign,gn=qt.symbol,Fn=qt.zero,Ta=qt.width,Ca=qt.comma,Li=qt.precision,ai=qt.trim,ii=qt.type;ii==="n"?(Ca=!0,ii="g"):lf[ii]||(Li===void 0&&(Li=12),ai=!0,ii="g"),(Fn||Or==="0"&&Nr==="=")&&(Fn=!0,Or="0",Nr="=");var Qi=gn==="$"?E:gn==="#"&&/[boxX]/.test(ii)?"0"+ii.toLowerCase():"",wa=gn==="$"?b:/[%p]/.test(ii)?B:"",qi=lf[ii],xo=/[defgprs%]/.test(ii);Li=Li===void 0?6:/[gprs]/.test(ii)?Math.max(1,Math.min(21,Li)):Math.max(0,Math.min(20,Li));function Xs(Za){var As=Qi,Yo=wa,df,Ih,Pc;if(ii==="c")Yo=qi(Za)+Yo,Za="";else{Za=+Za;var xh=Za<0||1/Za<0;if(Za=isNaN(Za)?de:qi(Math.abs(Za),Li),ai&&(Za=th(Za)),xh&&+Za===0&&bn!=="+"&&(xh=!1),As=(xh?bn==="("?bn:ie:bn==="-"||bn==="("?"":bn)+As,Yo=(ii==="s"?Tf[8+Mf/3]:"")+Yo+(xh&&bn==="("?")":""),xo){for(df=-1,Ih=Za.length;++df<Ih;)if(Pc=Za.charCodeAt(df),48>Pc||Pc>57){Yo=(Pc===46?A+Za.slice(df+1):Za.slice(df))+Yo,Za=Za.slice(0,df);break}}}Ca&&!Fn&&(Za=_(Za,Infinity));var oh=As.length+Za.length+Yo.length,Kc=oh<Ta?new Array(Ta-oh+1).join(Or):"";Ca&&Fn&&(Za=_(Kc+Za,Kc.length?Ta-Yo.length:Infinity),Kc="");switch(Nr){case"<":Za=As+Za+Yo+Kc;break;case"=":Za=As+Kc+Za+Yo;break;case"^":Za=Kc.slice(0,oh=Kc.length>>1)+As+Za+Yo+Kc.slice(oh);break;default:Za=Kc+As+Za+Yo;break}return M(Za)}return Xs.toString=function(){return qt+""},Xs}function zt(qt,Or){var Nr=Ve((qt=Ru(qt),qt.type="f",qt)),bn=Math.max(-8,Math.min(8,Math.floor(wc(Or)/3)))*3,gn=Math.pow(10,-bn),Fn=Tf[8+bn/3];return function(Ta){return Nr(gn*Ta)+Fn}}return{format:Ve,formatPrefix:zt}},au,wl,_f;Nf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Nf(h){return au=Oc(h),wl=au.format,_f=au.formatPrefix,au}var Wc=function(h,_){return h=Math.abs(h),_=Math.abs(_)-h,Math.max(0,wc(_)-wc(h))+1},cf=function(h){return Math.max(0,-wc(Math.abs(h)))},Zc=function(h,_,E,b){var A=l(h,_,E),M;b=Ru(b==null?",f":b);switch(b.type){case"s":{var B=Math.max(Math.abs(h),Math.abs(_));return b.precision==null&&!isNaN(M=Qf(A,B))&&(b.precision=M),_f(b,B)}case"":case"e":case"g":case"p":case"r":{b.precision==null&&!isNaN(M=Wc(A,Math.max(Math.abs(h),Math.abs(_))))&&(b.precision=M-(b.type==="e"));break}case"f":case"%":{b.precision==null&&!isNaN(M=cf(A))&&(b.precision=M-(b.type==="%")*2);break}}return wl(b)};function ml(h){var _=h.domain;return h.ticks=function(E){var b=_();return a(b[0],b[b.length-1],E==null?10:E)},h.tickFormat=function(E,b){var A=_();return Zc(A[0],A[A.length-1],E==null?10:E,b)},h.nice=function(E){E==null&&(E=10);var b=_(),A=0,M=b.length-1,B=b[A],ie=b[M],de;return ie<B&&(de=B,B=ie,ie=de,de=A,A=M,M=de),de=n(B,ie,E),de>0?(B=Math.floor(B/de)*de,ie=Math.ceil(ie/de)*de,de=n(B,ie,E)):de<0&&(B=Math.ceil(B*de)/de,ie=Math.floor(ie*de)/de,de=n(B,ie,E)),de>0?(b[A]=Math.floor(B/de)*de,b[M]=Math.ceil(ie/de)*de,_(b)):de<0&&(b[A]=Math.ceil(B*de)/de,b[M]=Math.floor(ie*de)/de,_(b)),h},h}function re(){var h=uf(ds,ds);return h.copy=function(){return Ku(h,re())},vr.apply(h,arguments),ml(h)}function se(h){var _;function E(b){return isNaN(b=+b)?_:b}return E.invert=E,E.domain=E.range=function(b){return arguments.length?(h=Gi.call(b,go),E):h.slice()},E.unknown=function(b){return arguments.length?(_=b,E):_},E.copy=function(){return se(h).unknown(_)},h=arguments.length?Gi.call(h,go):[0,1],ml(E)}var N=function(h,_){h=h.slice();var E=0,b=h.length-1,A=h[E],M=h[b],B;return M<A&&(B=E,E=b,b=B,B=A,A=M,M=B),h[E]=_.floor(A),h[b]=_.ceil(M),h};function G(h){return Math.log(h)}function Ae(h){return Math.exp(h)}function ft(h){return-Math.log(-h)}function Xt(h){return-Math.exp(-h)}function sr(h){return isFinite(h)?+("1e"+h):h<0?0:h}function or(h){return h===10?sr:h===Math.E?Math.exp:function(_){return Math.pow(h,_)}}function Ir(h){return h===Math.E?Math.log:h===10&&Math.log10||h===2&&Math.log2||(h=Math.log(h),function(_){return Math.log(_)/h})}function an(h){return function(_){return-h(-_)}}function Gn(h){var _=h(G,Ae),E=_.domain,b=10,A,M;function B(){return A=Ir(b),M=or(b),E()[0]<0?(A=an(A),M=an(M),h(ft,Xt)):h(G,Ae),_}return _.base=function(ie){return arguments.length?(b=+ie,B()):b},_.domain=function(ie){return arguments.length?(E(ie),B()):E()},_.ticks=function(ie){var de=E(),Ve=de[0],zt=de[de.length-1],qt;(qt=zt<Ve)&&(Or=Ve,Ve=zt,zt=Or);var Or=A(Ve),Nr=A(zt),bn,gn,Fn,Ta=ie==null?10:+ie,Ca=[];if(!(b%1)&&Nr-Or<Ta)if(Or=Math.round(Or)-1,Nr=Math.round(Nr)+1,Ve>0)for(;Or<Nr;++Or)for(gn=1,bn=M(Or);gn<b;++gn){if(Fn=bn*gn,Fn<Ve)continue;if(Fn>zt)break;Ca.push(Fn)}else for(;Or<Nr;++Or)for(gn=b-1,bn=M(Or);gn>=1;--gn){if(Fn=bn*gn,Fn<Ve)continue;if(Fn>zt)break;Ca.push(Fn)}else Ca=a(Or,Nr,Math.min(Nr-Or,Ta)).map(M);return qt?Ca.reverse():Ca},_.tickFormat=function(ie,de){if(de==null&&(de=b===10?".0e":","),typeof de!="function"&&(de=wl(de)),ie===Infinity)return de;ie==null&&(ie=10);var Ve=Math.max(1,b*ie/_.ticks().length);return function(zt){var qt=zt/M(Math.round(A(zt)));return qt*b<b-.5&&(qt*=b),qt<=Ve?de(zt):""}},_.nice=function(){return E(N(E(),{floor:function(de){return M(Math.floor(A(de)))},ceil:function(de){return M(Math.ceil(A(de)))}}))},_}function ea(){var h=Gn(Ef()).domain([1,10]);return h.copy=function(){return Ku(h,ea()).base(h.base())},vr.apply(h,arguments),h}function la(h){return function(_){return Math.sign(_)*Math.log1p(Math.abs(_/h))}}function qa(h){return function(_){return Math.sign(_)*Math.expm1(Math.abs(_))*h}}function Fa(h){var _=1,E=h(la(_),qa(_));return E.constant=function(b){return arguments.length?h(la(_=+b),qa(_)):_},ml(E)}function yi(){var h=Fa(Ef());return h.copy=function(){return Ku(h,yi()).constant(h.constant())},vr.apply(h,arguments)}function Ja(h){return function(_){return _<0?-Math.pow(-_,h):Math.pow(_,h)}}function Bi(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function So(h){return h<0?-h*h:h*h}function yo(h){var _=h(ds,ds),E=1;function b(){return E===1?h(ds,ds):E===.5?h(Bi,So):h(Ja(E),Ja(1/E))}return _.exponent=function(A){return arguments.length?(E=+A,b()):E},ml(_)}function Hi(){var h=yo(Ef());return h.copy=function(){return Ku(h,Hi()).exponent(h.exponent())},vr.apply(h,arguments),h}function ko(){return Hi.apply(null,arguments).exponent(.5)}function Qa(){var h=[],_=[],E=[],b;function A(){var B=0,ie=Math.max(1,_.length);for(E=new Array(ie-1);++B<ie;)E[B-1]=L(h,B/ie);return M}function M(B){return isNaN(B=+B)?b:_[Vs(E,B)]}return M.invertExtent=function(B){var ie=_.indexOf(B);return ie<0?[NaN,NaN]:[ie>0?E[ie-1]:h[0],ie<E.length?E[ie]:h[h.length-1]]},M.domain=function(B){if(!arguments.length)return h.slice();h=[];for(var ie=0,de=B.length,Ve;ie<de;++ie)(Ve=B[ie],Ve!=null&&!isNaN(Ve=+Ve))&&h.push(Ve);return h.sort(fl),A()},M.range=function(B){return arguments.length?(_=_i.call(B),A()):_.slice()},M.unknown=function(B){return arguments.length?(b=B,M):b},M.quantiles=function(){return E.slice()},M.copy=function(){return Qa().domain(h).range(_).unknown(b)},vr.apply(M,arguments)}function lo(){var h=0,_=1,E=1,b=[.5],A=[0,1],M;function B(de){return de<=de?A[Vs(b,de,0,E)]:M}function ie(){var de=-1;for(b=new Array(E);++de<E;)b[de]=((de+1)*_-(de-E)*h)/(E+1);return B}return B.domain=function(de){return arguments.length?(h=+de[0],_=+de[1],ie()):[h,_]},B.range=function(de){return arguments.length?(E=(A=_i.call(de)).length-1,ie()):A.slice()},B.invertExtent=function(de){var Ve=A.indexOf(de);return Ve<0?[NaN,NaN]:Ve<1?[h,b[0]]:Ve>=E?[b[E-1],_]:[b[Ve-1],b[Ve]]},B.unknown=function(de){return arguments.length&&(M=de),B},B.thresholds=function(){return b.slice()},B.copy=function(){return lo().domain([h,_]).range(A).unknown(M)},vr.apply(ml(B),arguments)}function iu(){var h=[.5],_=[0,1],E,b=1;function A(M){return M<=M?_[Vs(h,M,0,b)]:E}return A.domain=function(M){return arguments.length?(h=_i.call(M),b=Math.min(h.length,_.length-1),A):h.slice()},A.range=function(M){return arguments.length?(_=_i.call(M),b=Math.min(h.length,_.length-1),A):_.slice()},A.invertExtent=function(M){var B=_.indexOf(M);return[h[B-1],h[B]]},A.unknown=function(M){return arguments.length?(E=M,A):E},A.copy=function(){return iu().domain(h).range(_).unknown(E)},vr.apply(A,arguments)}var bi=new Date,Ni=new Date;function xa(h,_,E,b){function A(M){return h(M=arguments.length===0?new Date:new Date(+M)),M}return A.floor=function(M){return h(M=new Date(+M)),M},A.ceil=function(M){return h(M=new Date(M-1)),_(M,1),h(M),M},A.round=function(M){var B=A(M),ie=A.ceil(M);return M-B<ie-M?B:ie},A.offset=function(M,B){return _(M=new Date(+M),B==null?1:Math.floor(B)),M},A.range=function(M,B,ie){var de=[],Ve;if(M=A.ceil(M),ie=ie==null?1:Math.floor(ie),!(M<B)||!(ie>0))return de;do de.push(Ve=new Date(+M)),_(M,ie),h(M);while(Ve<M&&M<B);return de},A.filter=function(M){return xa(function(B){if(B>=B)for(;h(B),!M(B);)B.setTime(B-1)},function(B,ie){if(B>=B)if(ie<0)for(;++ie<=0;)for(;_(B,-1),!M(B););else for(;--ie>=0;)for(;_(B,1),!M(B););})},E&&(A.count=function(M,B){return bi.setTime(+M),Ni.setTime(+B),h(bi),h(Ni),Math.floor(E(bi,Ni))},A.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?A.filter(b?function(B){return b(B)%M===0}:function(B){return A.count(0,B)%M===0}):A}),A}var Ao=xa(function(h){h.setMonth(0,1),h.setHours(0,0,0,0)},function(h,_){h.setFullYear(h.getFullYear()+_)},function(h,_){return _.getFullYear()-h.getFullYear()},function(h){return h.getFullYear()});Ao.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:xa(function(_){_.setFullYear(Math.floor(_.getFullYear()/h)*h),_.setMonth(0,1),_.setHours(0,0,0,0)},function(_,E){_.setFullYear(_.getFullYear()+E*h)})};var hc=Ao,kf=Ao.range,uh=xa(function(h){h.setDate(1),h.setHours(0,0,0,0)},function(h,_){h.setMonth(h.getMonth()+_)},function(h,_){return _.getMonth()-h.getMonth()+(_.getFullYear()-h.getFullYear())*12},function(h){return h.getMonth()}),jf=uh,Iu=uh.range,Ff=1e3,ff=6e4,zf=36e5,Th=864e5,lh=6048e5;function Sf(h){return xa(function(_){_.setDate(_.getDate()-(_.getDay()+7-h)%7),_.setHours(0,0,0,0)},function(_,E){_.setDate(_.getDate()+E*7)},function(_,E){return(E-_-(E.getTimezoneOffset()-_.getTimezoneOffset())*ff)/lh})}var Uf=Sf(0),Bf=Sf(1),ch=Sf(2),Vf=Sf(3),Pf=Sf(4),Zl=Sf(5),Dh=Sf(6),ye=Uf.range,Fe=Bf.range,Ot=ch.range,xr=Vf.range,Pr=Pf.range,Cr=Zl.range,Er=Dh.range,Wr=xa(function(h){h.setHours(0,0,0,0)},function(h,_){h.setDate(h.getDate()+_)},function(h,_){return(_-h-(_.getTimezoneOffset()-h.getTimezoneOffset())*ff)/Th},function(h){return h.getDate()-1}),on=Wr,en=Wr.range,Yr=xa(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Ff-h.getMinutes()*ff)},function(h,_){h.setTime(+h+_*zf)},function(h,_){return(_-h)/zf},function(h){return h.getHours()}),cn=Yr,Tn=Yr.range,dn=xa(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Ff)},function(h,_){h.setTime(+h+_*ff)},function(h,_){return(_-h)/ff},function(h){return h.getMinutes()}),nn=dn,Tr=dn.range,br=xa(function(h){h.setTime(h-h.getMilliseconds())},function(h,_){h.setTime(+h+_*Ff)},function(h,_){return(_-h)/Ff},function(h){return h.getUTCSeconds()}),Zr=br,wn=br.range,Rr=xa(function(){},function(h,_){h.setTime(+h+_)},function(h,_){return _-h});Rr.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?xa(function(_){_.setTime(Math.floor(_/h)*h)},function(_,E){_.setTime(+_+E*h)},function(_,E){return(E-_)/h}):Rr};var ta=Rr,Jr=Rr.range;function Br(h){return xa(function(_){_.setUTCDate(_.getUTCDate()-(_.getUTCDay()+7-h)%7),_.setUTCHours(0,0,0,0)},function(_,E){_.setUTCDate(_.getUTCDate()+E*7)},function(_,E){return(E-_)/lh})}var Fr=Br(0),Kr=Br(1),Hn=Br(2),aa=Br(3),sn=Br(4),Gr=Br(5),jr=Br(6),ha=Fr.range,pa=Kr.range,Un=Hn.range,Ua=aa.range,Oa=sn.range,Da=Gr.range,fi=jr.range,jo=xa(function(h){h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCDate(h.getUTCDate()+_)},function(h,_){return(_-h)/Th},function(h){return h.getUTCDate()-1}),ps=jo,ei=jo.range,co=xa(function(h){h.setUTCMonth(0,1),h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCFullYear(h.getUTCFullYear()+_)},function(h,_){return _.getUTCFullYear()-h.getUTCFullYear()},function(h){return h.getUTCFullYear()});co.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:xa(function(_){_.setUTCFullYear(Math.floor(_.getUTCFullYear()/h)*h),_.setUTCMonth(0,1),_.setUTCHours(0,0,0,0)},function(_,E){_.setUTCFullYear(_.getUTCFullYear()+E*h)})};var Mi=co,ms=co.range;function Wo(h){if(0<=h.y&&h.y<100){var _=new Date(-1,h.m,h.d,h.H,h.M,h.S,h.L);return _.setFullYear(h.y),_}return new Date(h.y,h.m,h.d,h.H,h.M,h.S,h.L)}function Zo(h){if(0<=h.y&&h.y<100){var _=new Date(Date.UTC(-1,h.m,h.d,h.H,h.M,h.S,h.L));return _.setUTCFullYear(h.y),_}return new Date(Date.UTC(h.y,h.m,h.d,h.H,h.M,h.S,h.L))}function es(h,_,E){return{y:h,m:_,d:E,H:0,M:0,S:0,L:0}}function Is(h){var _=h.dateTime,E=h.date,b=h.time,A=h.periods,M=h.days,B=h.shortDays,ie=h.months,de=h.shortMonths,Ve=Ba(A),zt=Xo(A),qt=Ba(M),Or=Xo(M),Nr=Ba(B),bn=Xo(B),gn=Ba(ie),Fn=Xo(ie),Ta=Ba(de),Ca=Xo(de),Li={a:xh,A:oh,b:Kc,B:dd,c:null,d:ar,e:ar,f:Cn,g:Ns,G:dc,H:tr,I:pr,j:wr,L:$r,m:un,M:_n,p:sd,q:pd,Q:rd,s:ld,S:Kn,u:ka,U:Ei,V:Du,w:ou,W:Xl,x:null,X:null,y:Ds,Y:Yl,Z:yu,"%":td},ai={a:md,A:ud,b:vd,B:Vh,c:null,d:Mc,e:Mc,f:fh,g:Hh,G:_h,H:Co,I:_a,j:Ol,L:nh,m:Nh,M:pc,p:gd,q:Qh,Q:rd,s:ld,S:Gf,u:ah,U:hh,V:Ws,w:kh,W:Hf,x:null,X:null,y:Gh,Y:ed,Z:Wf,"%":td},ii={a:Xs,A:Za,b:As,B:Yo,c:df,d:ae,e:ae,f:ct,g:j,G:T,H:Ne,I:Ne,j:Je,L:ke,m:X,M:Me,p:xo,q:k,Q:It,s:$t,S:mt,u:O,U:d,V:c,w:gu,W:p,x:Ih,X:Pc,y:j,Y:T,Z:I,"%":Be};Li.x=Qi(E,Li),Li.X=Qi(b,Li),Li.c=Qi(_,Li),ai.x=Qi(E,ai),ai.X=Qi(b,ai),ai.c=Qi(_,ai);function Qi(ja,ji){return function(si){var Dn=[],Lc=-1,ys=0,$c=ja.length,Jc,Eh,yd;for(si instanceof Date||(si=new Date(+si));++Lc<$c;)ja.charCodeAt(Lc)===37&&(Dn.push(ja.slice(ys,Lc)),(Eh=Wi[Jc=ja.charAt(++Lc)])!=null?Jc=ja.charAt(++Lc):Eh=Jc==="e"?" ":"0",(yd=ji[Jc])&&(Jc=yd(si,Eh)),Dn.push(Jc),ys=Lc+1);return Dn.push(ja.slice(ys,Lc)),Dn.join("")}}function wa(ja,ji){return function(si){var Dn=es(1900,void 0,1),Lc=qi(Dn,ja,si+="",0),ys,$c;if(Lc!=si.length)return null;if("Q"in Dn)return new Date(Dn.Q);if("s"in Dn)return new Date(Dn.s*1e3+("L"in Dn?Dn.L:0));if(ji&&!("Z"in Dn)&&(Dn.Z=0),"p"in Dn&&(Dn.H=Dn.H%12+Dn.p*12),Dn.m===void 0&&(Dn.m="q"in Dn?Dn.q:0),"V"in Dn){if(Dn.V<1||Dn.V>53)return null;"w"in Dn||(Dn.w=1),"Z"in Dn?(ys=Zo(es(Dn.y,0,1)),$c=ys.getUTCDay(),ys=$c>4||$c===0?Kr.ceil(ys):Kr(ys),ys=ps.offset(ys,(Dn.V-1)*7),Dn.y=ys.getUTCFullYear(),Dn.m=ys.getUTCMonth(),Dn.d=ys.getUTCDate()+(Dn.w+6)%7):(ys=Wo(es(Dn.y,0,1)),$c=ys.getDay(),ys=$c>4||$c===0?Bf.ceil(ys):Bf(ys),ys=on.offset(ys,(Dn.V-1)*7),Dn.y=ys.getFullYear(),Dn.m=ys.getMonth(),Dn.d=ys.getDate()+(Dn.w+6)%7)}else("W"in Dn||"U"in Dn)&&("w"in Dn||(Dn.w="u"in Dn?Dn.u%7:"W"in Dn?1:0),$c="Z"in Dn?Zo(es(Dn.y,0,1)).getUTCDay():Wo(es(Dn.y,0,1)).getDay(),Dn.m=0,Dn.d="W"in Dn?(Dn.w+6)%7+Dn.W*7-($c+5)%7:Dn.w+Dn.U*7-($c+6)%7);return"Z"in Dn?(Dn.H+=Dn.Z/100|0,Dn.M+=Dn.Z%100,Zo(Dn)):Wo(Dn)}}function qi(ja,ji,si,Dn){for(var Lc=0,ys=ji.length,$c=si.length,Jc,Eh;Lc<ys;){if(Dn>=$c)return-1;if(Jc=ji.charCodeAt(Lc++),Jc===37){if(Jc=ji.charAt(Lc++),Eh=ii[Jc in Wi?ji.charAt(Lc++):Jc],!Eh||(Dn=Eh(ja,si,Dn))<0)return-1}else if(Jc!=si.charCodeAt(Dn++))return-1}return Dn}function xo(ja,ji,si){var Dn=Ve.exec(ji.slice(si));return Dn?(ja.p=zt[Dn[0].toLowerCase()],si+Dn[0].length):-1}function Xs(ja,ji,si){var Dn=Nr.exec(ji.slice(si));return Dn?(ja.w=bn[Dn[0].toLowerCase()],si+Dn[0].length):-1}function Za(ja,ji,si){var Dn=qt.exec(ji.slice(si));return Dn?(ja.w=Or[Dn[0].toLowerCase()],si+Dn[0].length):-1}function As(ja,ji,si){var Dn=Ta.exec(ji.slice(si));return Dn?(ja.m=Ca[Dn[0].toLowerCase()],si+Dn[0].length):-1}function Yo(ja,ji,si){var Dn=gn.exec(ji.slice(si));return Dn?(ja.m=Fn[Dn[0].toLowerCase()],si+Dn[0].length):-1}function df(ja,ji,si){return qi(ja,_,ji,si)}function Ih(ja,ji,si){return qi(ja,E,ji,si)}function Pc(ja,ji,si){return qi(ja,b,ji,si)}function xh(ja){return B[ja.getDay()]}function oh(ja){return M[ja.getDay()]}function Kc(ja){return de[ja.getMonth()]}function dd(ja){return ie[ja.getMonth()]}function sd(ja){return A[+(ja.getHours()>=12)]}function pd(ja){return 1+~~(ja.getMonth()/3)}function md(ja){return B[ja.getUTCDay()]}function ud(ja){return M[ja.getUTCDay()]}function vd(ja){return de[ja.getUTCMonth()]}function Vh(ja){return ie[ja.getUTCMonth()]}function gd(ja){return A[+(ja.getUTCHours()>=12)]}function Qh(ja){return 1+~~(ja.getUTCMonth()/3)}return{format:function(ji){var si=Qi(ji+="",Li);return si.toString=function(){return ji},si},parse:function(ji){var si=wa(ji+="",!1);return si.toString=function(){return ji},si},utcFormat:function(ji){var si=Qi(ji+="",ai);return si.toString=function(){return ji},si},utcParse:function(ji){var si=wa(ji+="",!0);return si.toString=function(){return ji},si}}}var Wi={"-":"",_:" ","0":"0"},ia=/^\s*\d+/,Hs=/^%/,xi=/[\\^$*+?|[\]().{}]/g;function An(h,_,E){var b=h<0?"-":"",A=(b?-h:h)+"",M=A.length;return b+(M<E?new Array(E-M+1).join(_)+A:A)}function Ra(h){return h.replace(xi,"\\$&")}function Ba(h){return new RegExp("^(?:"+h.map(Ra).join("|")+")","i")}function Xo(h){for(var _={},E=-1,b=h.length;++E<b;)_[h[E].toLowerCase()]=E;return _}function gu(h,_,E){var b=ia.exec(_.slice(E,E+1));return b?(h.w=+b[0],E+b[0].length):-1}function O(h,_,E){var b=ia.exec(_.slice(E,E+1));return b?(h.u=+b[0],E+b[0].length):-1}function d(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.U=+b[0],E+b[0].length):-1}function c(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.V=+b[0],E+b[0].length):-1}function p(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.W=+b[0],E+b[0].length):-1}function T(h,_,E){var b=ia.exec(_.slice(E,E+4));return b?(h.y=+b[0],E+b[0].length):-1}function j(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.y=+b[0]+(+b[0]>68?1900:2e3),E+b[0].length):-1}function I(h,_,E){var b=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(_.slice(E,E+6));return b?(h.Z=b[1]?0:-(b[2]+(b[3]||"00")),E+b[0].length):-1}function k(h,_,E){var b=ia.exec(_.slice(E,E+1));return b?(h.q=b[0]*3-3,E+b[0].length):-1}function X(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.m=b[0]-1,E+b[0].length):-1}function ae(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.d=+b[0],E+b[0].length):-1}function Je(h,_,E){var b=ia.exec(_.slice(E,E+3));return b?(h.m=0,h.d=+b[0],E+b[0].length):-1}function Ne(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.H=+b[0],E+b[0].length):-1}function Me(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.M=+b[0],E+b[0].length):-1}function mt(h,_,E){var b=ia.exec(_.slice(E,E+2));return b?(h.S=+b[0],E+b[0].length):-1}function ke(h,_,E){var b=ia.exec(_.slice(E,E+3));return b?(h.L=+b[0],E+b[0].length):-1}function ct(h,_,E){var b=ia.exec(_.slice(E,E+6));return b?(h.L=Math.floor(b[0]/1e3),E+b[0].length):-1}function Be(h,_,E){var b=Hs.exec(_.slice(E,E+1));return b?E+b[0].length:-1}function It(h,_,E){var b=ia.exec(_.slice(E));return b?(h.Q=+b[0],E+b[0].length):-1}function $t(h,_,E){var b=ia.exec(_.slice(E));return b?(h.s=+b[0],E+b[0].length):-1}function ar(h,_){return An(h.getDate(),_,2)}function tr(h,_){return An(h.getHours(),_,2)}function pr(h,_){return An(h.getHours()%12||12,_,2)}function wr(h,_){return An(1+on.count(hc(h),h),_,3)}function $r(h,_){return An(h.getMilliseconds(),_,3)}function Cn(h,_){return $r(h,_)+"000"}function un(h,_){return An(h.getMonth()+1,_,2)}function _n(h,_){return An(h.getMinutes(),_,2)}function Kn(h,_){return An(h.getSeconds(),_,2)}function ka(h){var _=h.getDay();return _===0?7:_}function Ei(h,_){return An(Uf.count(hc(h)-1,h),_,2)}function Pi(h){var _=h.getDay();return _>=4||_===0?Pf(h):Pf.ceil(h)}function Du(h,_){return h=Pi(h),An(Pf.count(hc(h),h)+(hc(h).getDay()===4),_,2)}function ou(h){return h.getDay()}function Xl(h,_){return An(Bf.count(hc(h)-1,h),_,2)}function Ds(h,_){return An(h.getFullYear()%100,_,2)}function Ns(h,_){return h=Pi(h),An(h.getFullYear()%100,_,2)}function Yl(h,_){return An(h.getFullYear()%1e4,_,4)}function dc(h,_){var E=h.getDay();return h=E>=4||E===0?Pf(h):Pf.ceil(h),An(h.getFullYear()%1e4,_,4)}function yu(h){var _=h.getTimezoneOffset();return(_>0?"-":(_*=-1,"+"))+An(_/60|0,"0",2)+An(_%60,"0",2)}function Mc(h,_){return An(h.getUTCDate(),_,2)}function Co(h,_){return An(h.getUTCHours(),_,2)}function _a(h,_){return An(h.getUTCHours()%12||12,_,2)}function Ol(h,_){return An(1+ps.count(Mi(h),h),_,3)}function nh(h,_){return An(h.getUTCMilliseconds(),_,3)}function fh(h,_){return nh(h,_)+"000"}function Nh(h,_){return An(h.getUTCMonth()+1,_,2)}function pc(h,_){return An(h.getUTCMinutes(),_,2)}function Gf(h,_){return An(h.getUTCSeconds(),_,2)}function ah(h){var _=h.getUTCDay();return _===0?7:_}function hh(h,_){return An(Fr.count(Mi(h)-1,h),_,2)}function qh(h){var _=h.getUTCDay();return _>=4||_===0?sn(h):sn.ceil(h)}function Ws(h,_){return h=qh(h),An(sn.count(Mi(h),h)+(Mi(h).getUTCDay()===4),_,2)}function kh(h){return h.getUTCDay()}function Hf(h,_){return An(Kr.count(Mi(h)-1,h),_,2)}function Gh(h,_){return An(h.getUTCFullYear()%100,_,2)}function Hh(h,_){return h=qh(h),An(h.getUTCFullYear()%100,_,2)}function ed(h,_){return An(h.getUTCFullYear()%1e4,_,4)}function _h(h,_){var E=h.getUTCDay();return h=E>=4||E===0?sn(h):sn.ceil(h),An(h.getUTCFullYear()%1e4,_,4)}function Wf(){return"+0000"}function td(){return"%"}function rd(h){return+h}function ld(h){return Math.floor(+h/1e3)}var vs,Zf,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(h){return vs=Is(h),Zf=vs.format,cd=vs.parse,e=vs.utcFormat,t=vs.utcParse,vs}var u=1e3,f=u*60,v=f*60,S=v*24,P=S*7,V=S*30,te=S*365;function he(h){return new Date(h)}function _e(h){return h instanceof Date?+h:+new Date(+h)}function Ce(h,_,E,b,A,M,B,ie,de){var Ve=uf(ds,ds),zt=Ve.invert,qt=Ve.domain,Or=de(".%L"),Nr=de(":%S"),bn=de("%I:%M"),gn=de("%I %p"),Fn=de("%a %d"),Ta=de("%b %d"),Ca=de("%B"),Li=de("%Y"),ai=[[B,1,u],[B,5,5*u],[B,15,15*u],[B,30,30*u],[M,1,f],[M,5,5*f],[M,15,15*f],[M,30,30*f],[A,1,v],[A,3,3*v],[A,6,6*v],[A,12,12*v],[b,1,S],[b,2,2*S],[E,1,P],[_,1,V],[_,3,3*V],[h,1,te]];function ii(wa){return(B(wa)<wa?Or:M(wa)<wa?Nr:A(wa)<wa?bn:b(wa)<wa?gn:_(wa)<wa?E(wa)<wa?Fn:Ta:h(wa)<wa?Ca:Li)(wa)}function Qi(wa,qi,xo,Xs){if(wa==null&&(wa=10),typeof wa=="number"){var Za=Math.abs(xo-qi)/wa,As=mu(function(Yo){return Yo[2]}).right(ai,Za);As===ai.length?(Xs=l(qi/te,xo/te,wa),wa=h):As?(As=ai[Za/ai[As-1][2]<ai[As][2]/Za?As-1:As],Xs=As[1],wa=As[0]):(Xs=Math.max(l(qi,xo,wa),1),wa=ie)}return Xs==null?wa:wa.every(Xs)}return Ve.invert=function(wa){return new Date(zt(wa))},Ve.domain=function(wa){return arguments.length?qt(Gi.call(wa,_e)):qt().map(he)},Ve.ticks=function(wa,qi){var xo=qt(),Xs=xo[0],Za=xo[xo.length-1],As=Za<Xs,Yo;return As&&(Yo=Xs,Xs=Za,Za=Yo),Yo=Qi(wa,Xs,Za,qi),Yo=Yo?Yo.range(Xs,Za+1):[],As?Yo.reverse():Yo},Ve.tickFormat=function(wa,qi){return qi==null?ii:de(qi)},Ve.nice=function(wa,qi){var xo=qt();return(wa=Qi(wa,xo[0],xo[xo.length-1],qi))?qt(N(xo,wa)):Ve},Ve.copy=function(){return Ku(Ve,Ce(h,_,E,b,A,M,B,ie,de))},Ve}var lt=function(){return vr.apply(Ce(hc,jf,Uf,on,cn,nn,Zr,ta,Zf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Pt=xa(function(h){h.setUTCDate(1),h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCMonth(h.getUTCMonth()+_)},function(h,_){return _.getUTCMonth()-h.getUTCMonth()+(_.getUTCFullYear()-h.getUTCFullYear())*12},function(h){return h.getUTCMonth()}),Ct=Pt,Yt=Pt.range,Zt=xa(function(h){h.setUTCMinutes(0,0,0)},function(h,_){h.setTime(+h+_*zf)},function(h,_){return(_-h)/zf},function(h){return h.getUTCHours()}),ir=Zt,yr=Zt.range,_r=xa(function(h){h.setUTCSeconds(0,0)},function(h,_){h.setTime(+h+_*ff)},function(h,_){return(_-h)/ff},function(h){return h.getUTCMinutes()}),kr=_r,Dr=_r.range,pn=function(){return vr.apply(Ce(Mi,Ct,Fr,ps,ir,kr,Zr,ta,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function fn(){var h=0,_=1,E,b,A,M,B=ds,ie=!1,de;function Ve(zt){return isNaN(zt=+zt)?de:B(A===0?.5:(zt=(M(zt)-E)*A,ie?Math.max(0,Math.min(1,zt)):zt))}return Ve.domain=function(zt){return arguments.length?(E=M(h=+zt[0]),b=M(_=+zt[1]),A=E===b?0:1/(b-E),Ve):[h,_]},Ve.clamp=function(zt){return arguments.length?(ie=!!zt,Ve):ie},Ve.interpolator=function(zt){return arguments.length?(B=zt,Ve):B},Ve.unknown=function(zt){return arguments.length?(de=zt,Ve):de},function(zt){return M=zt,E=zt(h),b=zt(_),A=E===b?0:1/(b-E),Ve}}function Rn(h,_){return _.domain(h.domain()).interpolator(h.interpolator()).clamp(h.clamp()).unknown(h.unknown())}function Qn(){var h=ml(fn()(ds));return h.copy=function(){return Rn(h,Qn())},Sr.apply(h,arguments)}function Xn(){var h=Gn(fn()).domain([1,10]);return h.copy=function(){return Rn(h,Xn()).base(h.base())},Sr.apply(h,arguments)}function Nn(){var h=Fa(fn());return h.copy=function(){return Rn(h,Nn()).constant(h.constant())},Sr.apply(h,arguments)}function Ea(){var h=yo(fn());return h.copy=function(){return Rn(h,Ea()).exponent(h.exponent())},Sr.apply(h,arguments)}function ca(){return Ea.apply(null,arguments).exponent(.5)}function ra(){var h=[],_=ds;function E(b){if(!isNaN(b=+b))return _((Vs(h,b)-1)/(h.length-1))}return E.domain=function(b){if(!arguments.length)return h.slice();h=[];for(var A=0,M=b.length,B;A<M;++A)(B=b[A],B!=null&&!isNaN(B=+B))&&h.push(B);return h.sort(fl),E},E.interpolator=function(b){return arguments.length?(_=b,E):_},E.copy=function(){return ra(_).domain(h)},Sr.apply(E,arguments)}function $a(){var h=0,_=.5,E=1,b,A,M,B,ie,de=ds,Ve,zt=!1,qt;function Or(Nr){return isNaN(Nr=+Nr)?qt:(Nr=.5+((Nr=+Ve(Nr))-A)*(Nr<A?B:ie),de(zt?Math.max(0,Math.min(1,Nr)):Nr))}return Or.domain=function(Nr){return arguments.length?(b=Ve(h=+Nr[0]),A=Ve(_=+Nr[1]),M=Ve(E=+Nr[2]),B=b===A?0:.5/(A-b),ie=A===M?0:.5/(M-A),Or):[h,_,E]},Or.clamp=function(Nr){return arguments.length?(zt=!!Nr,Or):zt},Or.interpolator=function(Nr){return arguments.length?(de=Nr,Or):de},Or.unknown=function(Nr){return arguments.length?(qt=Nr,Or):qt},function(Nr){return Ve=Nr,b=Nr(h),A=Nr(_),M=Nr(E),B=b===A?0:.5/(A-b),ie=A===M?0:.5/(M-A),Or}}function Na(){var h=ml($a()(ds));return h.copy=function(){return Rn(h,Na())},Sr.apply(h,arguments)}function ki(){var h=Gn($a()).domain([.1,1,10]);return h.copy=function(){return Rn(h,ki()).base(h.base())},Sr.apply(h,arguments)}function ma(){var h=Fa($a());return h.copy=function(){return Rn(h,ma()).constant(h.constant())},Sr.apply(h,arguments)}function ri(){var h=yo($a());return h.copy=function(){return Rn(h,ri()).exponent(h.exponent())},Sr.apply(h,arguments)}function Fo(){return ri.apply(null,arguments).exponent(.5)}var mi,zo,Uo,ts,bu,rs,$u,su,Ju,uu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Zs=(mi={},Pe()(mi,x.ScaleTypes.LINEAR,re),Pe()(mi,x.ScaleTypes.POWER,Hi),Pe()(mi,x.ScaleTypes.LOG,ea),Pe()(mi,x.ScaleTypes.IDENTITY,se),Pe()(mi,x.ScaleTypes.TIME,lt),Pe()(mi,x.ScaleTypes.QUANTILE,Qa),Pe()(mi,x.ScaleTypes.QUANTIZE,lo),Pe()(mi,x.ScaleTypes.THRESHOLD,iu),Pe()(mi,x.ScaleTypes.CAT,gi),mi),lu=(zo=Object(ur.injectable)(),Uo=Object(ur.inject)(x.TYPES.IGlobalConfigService),ts=Object(ur.inject)(x.TYPES.ILogService),zo(bu=(rs=(Ju=function(){function h(){Y()(this,h),Le()(this,"configService",$u,this),Le()(this,"logger",su,this),this.scaleCache={},this.scaleOptions={}}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("FeatureScalePlugin",function(){A.scaleOptions=E.getScaleOptions();var B=M.getLayerStyleAttributes(),ie=E.getSource().data.dataArray;if(ie.length===0)return;A.caculateScalesForAttributes(B||[],ie)}),E.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){A.scaleOptions=E.getScaleOptions();var B=M.getLayerStyleAttributes(),ie=E.getSource().data.dataArray;return A.caculateScalesForAttributes(B||[],ie),E.layerModelNeedUpdate=!0,!0}),E.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(E.layerModelNeedUpdate)return;A.scaleOptions=E.getScaleOptions();var B=M.getLayerStyleAttributes();if(B){var ie=E.getSource().data.dataArray;if(ie.length===0)return;var de=B.filter(function(Ve){return Ve.needRescale});de.length&&(A.caculateScalesForAttributes(de,ie),A.logger.debug("rescale finished"))}})}},{key:"isNumber",value:function(E){return!isNaN(parseFloat(E))&&isFinite(E)}},{key:"caculateScalesForAttributes",value:function(E,b){var A=this;this.scaleCache={},E.forEach(function(M){if(M.scale){var B=M.scale,ie=M.name;B.names=A.parseFields(M.scale.field||[]);var de=[];B.names.forEach(function(Ve){de.push(A.getOrCreateScale(Ve,M,b))}),de.some(function(Ve){return Ve.type===x.StyleScaleType.VARIABLE})?(B.type=x.StyleScaleType.VARIABLE,de.forEach(function(Ve){if(!B.callback){var zt;if(B.values&&B.values!=="text"){var qt;if(((qt=Ve.option)===null||qt===void 0?void 0:qt.type)==="linear"&&B.values.length>2){var Or=Ve.scale.ticks(B.values.length);ie==="color"&&Ve.scale.domain(Or)}Ve.scale.range(B.values)}else((zt=Ve.option)===null||zt===void 0?void 0:zt.type)==="cat"&&Ve.scale.range(Ve.option.domain)}})):(B.type=x.StyleScaleType.CONSTANT,B.defaultValues=de.map(function(Ve,zt){return Ve.scale(B.names[zt])})),B.scalers=de.map(function(Ve){return{field:Ve.field,func:Ve.scale,option:Ve.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(E,b,A){var M,B=[E,b.name].join("_"),ie=(M=b.scale)===null||M===void 0?void 0:M.values,de=this.createScale(E,b.name,ie,A);return de}},{key:"parseFields",value:function(E){return Array.isArray(E)?E:rc()(E)?E.split("*"):[E]}},{key:"createScale",value:function(E,b,A,M){var B,ie=this.scaleOptions[b]&&this.scaleOptions[b].field===E?this.scaleOptions[b]:this.scaleOptions[E],de={field:E,scale:void 0,type:x.StyleScaleType.VARIABLE,option:ie};if(!M||!M.length)return ie&&ie.type?de.scale=this.createDefaultScale(ie):(de.scale=gi([E]),de.type=x.StyleScaleType.CONSTANT),de;var Ve=(B=M.find(function(Or){return!no()(Or[E])}))===null||B===void 0?void 0:B[E];if(this.isNumber(E)||no()(Ve)&&!ie)de.scale=gi([E]),de.type=x.StyleScaleType.CONSTANT;else{var zt=ie&&ie.type||this.getDefaultType(Ve);A==="text"&&(zt=x.ScaleTypes.CAT);var qt=this.createDefaultScaleConfig(zt,E,M);Object.assign(qt,ie),de.scale=this.createDefaultScale(qt),de.option=qt}return de}},{key:"getDefaultType",value:function(E){var b=x.ScaleTypes.LINEAR;return typeof E=="string"&&(b=uu.test(E)?x.ScaleTypes.TIME:x.ScaleTypes.CAT),b}},{key:"createDefaultScaleConfig",value:function(E,b,A){var M={type:E},B=(A==null?void 0:A.map(function(ie){return ie[b]}))||[];return E!==x.ScaleTypes.CAT&&E!==x.ScaleTypes.QUANTILE?M.domain=Cl(B):E===x.ScaleTypes.CAT?M.domain=Ss()(B):E===x.ScaleTypes.QUANTILE&&(M.domain=B),M}},{key:"createDefaultScale",value:function(E){var b=E.type,A=E.domain,M=Zs[b]();return A&&M.domain(A),M}}]),h}(),Ju),$u=Ze()(rs.prototype,"configService",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),su=Ze()(rs.prototype,"logger",[ts],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs))||bu),hi,ni,Ji,fo,xu,bo,Bo,Nu;function li(h,_){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);_&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function Xf(h){for(var _=1;_<arguments.length;_++){var E=arguments[_]!=null?arguments[_]:{};_%2?li(Object(E),!0).forEach(function(b){Pe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):li(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var Xc=(hi=Object(ur.injectable)(),ni=Object(ur.inject)(x.TYPES.ICameraService),Ji=Object(ur.inject)(x.TYPES.IRendererService),hi(fo=(xu=(Nu=function(){function h(){Y()(this,h),Le()(this,"cameraService",bo,this),Le()(this,"rendererService",Bo,this)}return i()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){E.models.forEach(function(b){b.addUniforms(Xf({},E.layerModel.getAnimateUniforms()))})})}}]),h}(),Nu),bo=Ze()(xu.prototype,"cameraService",[ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bo=Ze()(xu.prototype,"rendererService",[Ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xu))||fo),hf,mc,ku=(hf=Object(ur.injectable)(),hf(mc=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.init.tap("LayerModelPlugin",function(){E.prepareBuildModel(),E.buildModels(),E.styleNeedUpdate=!1}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return E.prepareBuildModel(),E.clearModels(),E.buildModels(),E.layerModelNeedUpdate=!1,!1})}}]),h}())||mc),Lf,Rf,Yf=(Lf=Object(ur.injectable)(),Lf(Rf=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.afterInit.tap("LayerStylePlugin",function(){E.updateLayerConfig({});var b=E.getLayerConfig(),A=b.autoFit,M=b.fitBoundsOptions;A&&setTimeout(function(){E.fitBounds(M)},100)})}}]),h}())||Rf),Sh,Af;function Ah(h,_){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);_&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function Kf(h){for(var _=1;_<arguments.length;_++){var E=arguments[_]!=null?arguments[_]:{};_%2?Ah(Object(E),!0).forEach(function(b){Pe()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Ah(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var dh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Wh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},jh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Zh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},ph=["ambient","diffuse","specular"];function Ch(h){var _={u_DirectionalLights:new Array(3).fill(Kf({},jh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Kf({},Zh)),u_NumOfSpotLights:0};return(!h||!h.length)&&(h=[Wh]),h.forEach(function(E,b){var A=E.type,M=A===void 0?"directional":A,B=pe()(E,["type"]),ie=dh[M].lights,de=dh[M].num,Ve=_[de];_[ie][Ve]=Kf(Kf({},_[ie][Ve]),B),_[de]++}),_}var Xh=(Sh=Object(ur.injectable)(),Sh(Af=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LightingPlugin",function(){var b=E.getLayerConfig(),A=b.enableLighting;A&&E.models.forEach(function(M){return M.addUniforms(Kf({},Ch()))})})}}]),h}())||Af),mh,$f,ih={NONE:0,ENCODE:1,HIGHLIGHT:2},Yh=(mh=Object(ur.injectable)(),mh($f=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E,b){var A=b.rendererService,M=b.styleAttributeService;E.hooks.init.tap("PixelPickingPlugin",function(){var B=E.getLayerConfig(),ie=B.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:x.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:x.gl.FLOAT},size:3,update:function(Ve,zt){var qt=Ve.id;return ie?Object(we.l)(qt):[0,0,0]}}})}),E.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var B=E.getLayerConfig(),ie=B.enablePicking;ie&&E.isVisible()&&E.models.forEach(function(de){return de.addUniforms({u_PickingStage:ih.ENCODE})})}),E.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var B=E.getLayerConfig(),ie=B.enablePicking;ie&&E.isVisible()&&E.models.forEach(function(de){return de.addUniforms({u_PickingStage:ih.HIGHLIGHT})})}),E.hooks.beforeHighlight.tap("PixelPickingPlugin",function(B){var ie=E.getLayerConfig(),de=ie.highlightColor,Ve=typeof de=="string"?Object(we.s)(de):de||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(we.k)(new Uint8Array(B))}),E.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:ih.HIGHLIGHT,u_PickingColor:B,u_HighlightColor:Ve.map(function(qt){return qt*255})})})}),E.hooks.beforeSelect.tap("PixelPickingPlugin",function(B){var ie=E.getLayerConfig(),de=ie.selectColor,Ve=typeof de=="string"?Object(we.s)(de):de||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(we.k)(new Uint8Array(B))}),E.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:ih.HIGHLIGHT,u_PickingColor:B,u_HighlightColor:Ve.map(function(qt){return qt*255})})})})}}]),h}())||$f),Fh,vh,zh,wh,gh,Uh,Bh=(Fh=Object(ur.injectable)(),vh=Object(ur.inject)(x.TYPES.ILogService),Fh(zh=(wh=(Uh=function(){function h(){Y()(this,h),Le()(this,"logger",gh,this)}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("RegisterStyleAttributePlugin",function(){A.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(E){E.registerStyleAttribute({name:"position",type:x.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:x.gl.FLOAT},size:3,update:function(A,M,B){return B.length===2?[B[0],B[1],0]:[B[0],B[1],B[2]]}}}),E.registerStyleAttribute({name:"filter",type:x.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(A,M){var B=A.filter;return B?[1]:[0]}}}),E.registerStyleAttribute({name:"color",type:x.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(A,M){var B=A.color;return!B||!B.length?[1,1,1,1]:B}}})}}]),h}(),Uh),gh=Ze()(wh.prototype,"logger",[vh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wh))||zh),Oh,Mh,yh,Ph,bh,If,Lh,Kh,$h,nd,ad=(Oh=Object(ur.injectable)(),Mh=Object(ur.inject)(x.TYPES.ICameraService),yh=Object(ur.inject)(x.TYPES.ICoordinateSystemService),Ph=Object(ur.inject)(x.TYPES.IRendererService),Oh(bh=(If=(nd=function(){function h(){Y()(this,h),Le()(this,"cameraService",Lh,this),Le()(this,"coordinateSystemService",Kh,this),Le()(this,"rendererService",$h,this)}return i()(h,[{key:"apply",value:function(E){var b=this;E.hooks.beforeRender.tap("ShaderUniformPlugin",function(){b.coordinateSystemService.refresh();var A=b.rendererService.getViewportSize(),M=A.width,B=A.height;E.models.forEach(function(ie){var de;return ie.addUniforms((de={},Pe()(de,x.CameraUniform.ProjectionMatrix,b.cameraService.getProjectionMatrix()),Pe()(de,x.CameraUniform.ViewMatrix,b.cameraService.getViewMatrix()),Pe()(de,x.CameraUniform.ViewProjectionMatrix,b.cameraService.getViewProjectionMatrix()),Pe()(de,x.CameraUniform.Zoom,b.cameraService.getZoom()),Pe()(de,x.CameraUniform.ZoomScale,b.cameraService.getZoomScale()),Pe()(de,x.CameraUniform.FocalDistance,b.cameraService.getFocalDistance()),Pe()(de,x.CameraUniform.CameraPosition,b.cameraService.getCameraPosition()),Pe()(de,x.CoordinateUniform.CoordinateSystem,b.coordinateSystemService.getCoordinateSystem()),Pe()(de,x.CoordinateUniform.ViewportCenter,b.coordinateSystemService.getViewportCenter()),Pe()(de,x.CoordinateUniform.ViewportCenterProjection,b.coordinateSystemService.getViewportCenterProjection()),Pe()(de,x.CoordinateUniform.PixelsPerDegree,b.coordinateSystemService.getPixelsPerDegree()),Pe()(de,x.CoordinateUniform.PixelsPerDegree2,b.coordinateSystemService.getPixelsPerDegree2()),Pe()(de,x.CoordinateUniform.PixelsPerMeter,b.coordinateSystemService.getPixelsPerMeter()),Pe()(de,"u_ViewportSize",[M,B]),Pe()(de,"u_DevicePixelRatio",window.devicePixelRatio),Pe()(de,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Pe()(de,"u_PickingBuffer",E.getLayerConfig().pickingBuffer||0),de))})})}}]),h}(),nd),Lh=Ze()(If.prototype,"cameraService",[Mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kh=Ze()(If.prototype,"coordinateSystemService",[yh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=Ze()(If.prototype,"rendererService",[Ph],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),If))||bh),id,Jh,Ed=(id=Object(ur.injectable)(),id(Jh=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("UpdateModelPlugin",function(){E.layerModel&&E.layerModel.needUpdate()})}}]),h}())||Jh),fd,Rh,gs,Yc,hd,Jf,od=(fd=Object(ur.injectable)(),Rh=Object(ur.inject)(x.TYPES.ILogService),fd(gs=(Yc=(Jf=function(){function h(){Y()(this,h),Le()(this,"logger",hd,this)}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("UpdateStyleAttributePlugin",function(){A.initStyleAttribute(E,{styleAttributeService:M})}),E.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){if(E.layerModelNeedUpdate)return;A.updateStyleAtrribute(E,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(E,b){var A=this,M=b.styleAttributeService,B=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=M.getLayerStyleAttribute("shape");if(ie&&ie.needRegenerateVertices||de&&de.needRegenerateVertices){E.layerModelNeedUpdate=!0,B.forEach(function(Ve){return Ve.needRegenerateVertices=!1});return}B.filter(function(Ve){return Ve.needRegenerateVertices}).forEach(function(Ve){M.updateAttributeByFeatureRange(Ve.name,E.getEncodedData(),Ve.featureRange.startIndex,Ve.featureRange.endIndex),Ve.needRegenerateVertices=!1,A.logger.debug("regenerate vertex attributes: ".concat(Ve.name," finished"))})}},{key:"initStyleAttribute",value:function(E,b){var A=this,M=b.styleAttributeService,B=M.getLayerStyleAttributes()||[];B.filter(function(ie){return ie.needRegenerateVertices}).forEach(function(ie){M.updateAttributeByFeatureRange(ie.name,E.getEncodedData(),ie.featureRange.startIndex,ie.featureRange.endIndex),ie.needRegenerateVertices=!1,A.logger.debug("init vertex attributes: ".concat(ie.name," finished"))})}}]),h}(),Jf),hd=Ze()(Yc.prototype,"logger",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yc))||gs);x.container.bind(x.TYPES.ILayerPlugin).to(Io).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Bh).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(lu).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Tc).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Yf).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(od).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Ed).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(at).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(ad).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Xc).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Xh).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Yh).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(ku).inRequestScope()},t2Dn:function(Ue,y,o){var x=o("hypo"),m=o("ljhN");function Y(z,i,W){(W!==void 0&&!m(z[i],W)||W===void 0&&!(i in z))&&x(z,i,W)}Ue.exports=Y},u6S6:function(Ue,y,o){var x=o("6acW"),m=o("sgoq"),Y=m(function(z,i,W){return i=i.toLowerCase(),z+(W?x(i):i)});Ue.exports=Y},uhBA:function(Ue,y,o){"use strict";var x=Object.prototype.hasOwnProperty,m="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(m=!1));function z(Q,ee,ce){this.fn=Q,this.context=ee,this.once=ce||!1}function i(Q,ee,ce,K,je){if(typeof ce!="function")throw new TypeError("The listener must be a function");var pe=new z(ce,K||Q,je),Ke=m?m+ee:ee;return Q._events[Ke]?Q._events[Ke].fn?Q._events[Ke]=[Q._events[Ke],pe]:Q._events[Ke].push(pe):(Q._events[Ke]=pe,Q._eventsCount++),Q}function W(Q,ee){--Q._eventsCount===0?Q._events=new Y:delete Q._events[ee]}function D(){this._events=new Y,this._eventsCount=0}D.prototype.eventNames=function(){var ee=[],ce,K;if(this._eventsCount===0)return ee;for(K in ce=this._events)x.call(ce,K)&&ee.push(m?K.slice(1):K);return Object.getOwnPropertySymbols?ee.concat(Object.getOwnPropertySymbols(ce)):ee},D.prototype.listeners=function(ee){var ce=m?m+ee:ee,K=this._events[ce];if(!K)return[];if(K.fn)return[K.fn];for(var je=0,pe=K.length,Ke=new Array(pe);je<pe;je++)Ke[je]=K[je].fn;return Ke},D.prototype.listenerCount=function(ee){var ce=m?m+ee:ee,K=this._events[ce];return K?K.fn?1:K.length:0},D.prototype.emit=function(ee,ce,K,je,pe,Ke){var Pe=m?m+ee:ee;if(!this._events[Pe])return!1;var ht=this._events[Pe],Le=arguments.length,_t,ot;if(ht.fn){ht.once&&this.removeListener(ee,ht.fn,void 0,!0);switch(Le){case 1:return ht.fn.call(ht.context),!0;case 2:return ht.fn.call(ht.context,ce),!0;case 3:return ht.fn.call(ht.context,ce,K),!0;case 4:return ht.fn.call(ht.context,ce,K,je),!0;case 5:return ht.fn.call(ht.context,ce,K,je,pe),!0;case 6:return ht.fn.call(ht.context,ce,K,je,pe,Ke),!0}for(ot=1,_t=new Array(Le-1);ot<Le;ot++)_t[ot-1]=arguments[ot];ht.fn.apply(ht.context,_t)}else{var et=ht.length,Ze;for(ot=0;ot<et;ot++){ht[ot].once&&this.removeListener(ee,ht[ot].fn,void 0,!0);switch(Le){case 1:ht[ot].fn.call(ht[ot].context);break;case 2:ht[ot].fn.call(ht[ot].context,ce);break;case 3:ht[ot].fn.call(ht[ot].context,ce,K);break;case 4:ht[ot].fn.call(ht[ot].context,ce,K,je);break;default:if(!_t)for(Ze=1,_t=new Array(Le-1);Ze<Le;Ze++)_t[Ze-1]=arguments[Ze];ht[ot].fn.apply(ht[ot].context,_t)}}}return!0},D.prototype.on=function(ee,ce,K){return i(this,ee,ce,K,!1)},D.prototype.once=function(ee,ce,K){return i(this,ee,ce,K,!0)},D.prototype.removeListener=function(ee,ce,K,je){var pe=m?m+ee:ee;if(!this._events[pe])return this;if(!ce)return W(this,pe),this;var Ke=this._events[pe];if(Ke.fn)Ke.fn===ce&&(!je||Ke.once)&&(!K||Ke.context===K)&&W(this,pe);else{for(var Pe=0,ht=[],Le=Ke.length;Pe<Le;Pe++)(Ke[Pe].fn!==ce||je&&!Ke[Pe].once||K&&Ke[Pe].context!==K)&&ht.push(Ke[Pe]);ht.length?this._events[pe]=ht.length===1?ht[0]:ht:W(this,pe)}return this},D.prototype.removeAllListeners=function(ee){var ce;return ee?(ce=m?m+ee:ee,this._events[ce]&&W(this,ce)):(this._events=new Y,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=m,D.EventEmitter=D,Ue.exports=D},ujMp:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.circularDependencyToException=y.listMetadataForTarget=y.listRegisteredBindingsForServiceIdentifier=y.getServiceIdentifierAsString=y.getFunctionName=void 0;var x=o("MON2");function m(ee){if(typeof ee=="function"){var ce=ee;return ce.name}else{if(typeof ee=="symbol")return ee.toString();var ce=ee;return ce}}y.getServiceIdentifierAsString=m;function Y(ee,ce,K){var je="",pe=K(ee,ce);return pe.length!==0&&(je=`
Registered bindings:`,pe.forEach(function(Ke){var Pe="Object";Ke.implementationType!==null&&(Pe=Q(Ke.implementationType)),je=je+`
 `+Pe,Ke.constraint.metaData&&(je=je+" - "+Ke.constraint.metaData)})),je}y.listRegisteredBindingsForServiceIdentifier=Y;function z(ee,ce){return ee.parentRequest===null?!1:ee.parentRequest.serviceIdentifier===ce?!0:z(ee.parentRequest,ce)}function i(ee){function ce(je,pe){pe===void 0&&(pe=[]);var Ke=m(je.serviceIdentifier);return pe.push(Ke),je.parentRequest!==null?ce(je.parentRequest,pe):pe}var K=ce(ee);return K.reverse().join(" --> ")}function W(ee){ee.childRequests.forEach(function(ce){if(z(ce,ce.serviceIdentifier)){var K=i(ce);throw new Error(x.CIRCULAR_DEPENDENCY+" "+K)}else W(ce)})}y.circularDependencyToException=W;function D(ee,ce){if(ce.isTagged()||ce.isNamed()){var K="",je=ce.getNamedTag(),pe=ce.getCustomTags();return je!==null&&(K+=je.toString()+`
`),pe!==null&&pe.forEach(function(Ke){K+=Ke.toString()+`
`})," "+ee+`
 `+ee+" - "+K}else return" "+ee}y.listMetadataForTarget=D;function Q(ee){if(ee.name)return ee.name;var ce=ee.toString(),K=ce.match(/^function\s*([^\s(]+)/);return K?K[1]:"Anonymous function: "+ce}y.getFunctionName=Q},"vN+2":function(Ue,y){function o(){}Ue.exports=o},"w/wX":function(Ue,y,o){var x=o("QqLw"),m=o("ExA7"),Y="[object Set]";function z(i){return m(i)&&x(i)==Y}Ue.exports=z},w26f:function(Ue,y,o){(function(x){var m=200,Y="__lodash_hash_undefined__",z=1/0,i="[object Function]",W="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,Q=/^\[object .+?Constructor\]$/,ee=typeof x=="object"&&x&&x.Object===Object&&x,ce=typeof self=="object"&&self&&self.Object===Object&&self,K=ee||ce||Function("return this")();function je(vt,yt){var Ht=vt?vt.length:0;return!!Ht&&Pe(vt,yt,0)>-1}function pe(vt,yt,Ht){for(var hr=-1,Hr=vt?vt.length:0;++hr<Hr;)if(Ht(yt,vt[hr]))return!0;return!1}function Ke(vt,yt,Ht,hr){for(var Hr=vt.length,gr=Ht+(hr?1:-1);hr?gr--:++gr<Hr;)if(yt(vt[gr],gr,vt))return gr;return-1}function Pe(vt,yt,Ht){if(yt!==yt)return Ke(vt,ht,Ht);for(var hr=Ht-1,Hr=vt.length;++hr<Hr;)if(vt[hr]===yt)return hr;return-1}function ht(vt){return vt!==vt}function Le(vt,yt){return vt.has(yt)}function _t(vt,yt){return vt==null?void 0:vt[yt]}function ot(vt){var yt=!1;if(vt!=null&&typeof vt.toString!="function")try{yt=!!(vt+"")}catch(Ht){}return yt}function et(vt){var yt=-1,Ht=Array(vt.size);return vt.forEach(function(hr){Ht[++yt]=hr}),Ht}var Ze=Array.prototype,At=Function.prototype,St=Object.prototype,De=K["__core-js_shared__"],Ie=function(){var vt=/[^.]+$/.exec(De&&De.keys&&De.keys.IE_PROTO||"");return vt?"Symbol(src)_1."+vt:""}(),Ge=At.toString,dt=St.hasOwnProperty,we=St.toString,pt=RegExp("^"+Ge.call(dt).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=Ze.splice,Qt=ne(K,"Map"),ur=ne(K,"Set"),oe=ne(Object,"create");function J(vt){var yt=-1,Ht=vt?vt.length:0;for(this.clear();++yt<Ht;){var hr=vt[yt];this.set(hr[0],hr[1])}}function H(){this.__data__=oe?oe(null):{}}function Se(vt){return this.has(vt)&&delete this.__data__[vt]}function be(vt){var yt=this.__data__;if(oe){var Ht=yt[vt];return Ht===Y?void 0:Ht}return dt.call(yt,vt)?yt[vt]:void 0}function Te(vt){var yt=this.__data__;return oe?yt[vt]!==void 0:dt.call(yt,vt)}function me(vt,yt){var Ht=this.__data__;return Ht[vt]=oe&&yt===void 0?Y:yt,this}J.prototype.clear=H,J.prototype.delete=Se,J.prototype.get=be,J.prototype.has=Te,J.prototype.set=me;function at(vt){var yt=-1,Ht=vt?vt.length:0;for(this.clear();++yt<Ht;){var hr=vt[yt];this.set(hr[0],hr[1])}}function Jt(){this.__data__=[]}function Mt(vt){var yt=this.__data__,Ht=Tt(yt,vt);if(Ht<0)return!1;var hr=yt.length-1;return Ht==hr?yt.pop():Wt.call(yt,Ht,1),!0}function ve(vt){var yt=this.__data__,Ht=Tt(yt,vt);return Ht<0?void 0:yt[Ht][1]}function ge(vt){return Tt(this.__data__,vt)>-1}function He(vt,yt){var Ht=this.__data__,hr=Tt(Ht,vt);return hr<0?Ht.push([vt,yt]):Ht[hr][1]=yt,this}at.prototype.clear=Jt,at.prototype.delete=Mt,at.prototype.get=ve,at.prototype.has=ge,at.prototype.set=He;function st(vt){var yt=-1,Ht=vt?vt.length:0;for(this.clear();++yt<Ht;){var hr=vt[yt];this.set(hr[0],hr[1])}}function Oe(){this.__data__={hash:new J,map:new(Qt||at),string:new J}}function gt(vt){return Qe(this,vt).delete(vt)}function C(vt){return Qe(this,vt).get(vt)}function R(vt){return Qe(this,vt).has(vt)}function q(vt,yt){return Qe(this,vt).set(vt,yt),this}st.prototype.clear=Oe,st.prototype.delete=gt,st.prototype.get=C,st.prototype.has=R,st.prototype.set=q;function fe(vt){var yt=-1,Ht=vt?vt.length:0;for(this.__data__=new st;++yt<Ht;)this.add(vt[yt])}function We(vt){return this.__data__.set(vt,Y),this}function qe(vt){return this.__data__.has(vt)}fe.prototype.add=fe.prototype.push=We,fe.prototype.has=qe;function Tt(vt,yt){for(var Ht=vt.length;Ht--;)if(xt(vt[Ht][0],yt))return Ht;return-1}function it(vt){if(!Et(vt)||kt(vt))return!1;var yt=bt(vt)||ot(vt)?pt:Q;return yt.test(dr(vt))}function Ut(vt,yt,Ht){var hr=-1,Hr=je,gr=vt.length,Bn=!0,zn=[],oa=zn;if(Ht)Bn=!1,Hr=pe;else if(gr>=m){var $n=yt?null:$(vt);if($n)return et($n);Bn=!1,Hr=Le,oa=new fe}else oa=yt?[]:zn;e:for(;++hr<gr;){var Yn=vt[hr],On=yt?yt(Yn):Yn;if(Yn=Ht||Yn!==0?Yn:0,Bn&&On===On){for(var U=oa.length;U--;)if(oa[U]===On)continue e;yt&&oa.push(On),zn.push(Yn)}else Hr(oa,On,Ht)||(oa!==zn&&oa.push(On),zn.push(Yn))}return zn}var $=ur&&1/et(new ur([,-0]))[1]==z?function(vt){return new ur(vt)}:ze;function Qe(vt,yt){var Ht=vt.__data__;return tt(yt)?Ht[typeof yt=="string"?"string":"hash"]:Ht.map}function ne(vt,yt){var Ht=_t(vt,yt);return it(Ht)?Ht:void 0}function tt(vt){var yt=typeof vt;return yt=="string"||yt=="number"||yt=="symbol"||yt=="boolean"?vt!=="__proto__":vt===null}function kt(vt){return!!Ie&&Ie in vt}function dr(vt){if(vt!=null){try{return Ge.call(vt)}catch(yt){}try{return vt+""}catch(yt){}}return""}function Ye(vt){return vt&&vt.length?Ut(vt):[]}function xt(vt,yt){return vt===yt||vt!==vt&&yt!==yt}function bt(vt){var yt=Et(vt)?we.call(vt):"";return yt==i||yt==W}function Et(vt){var yt=typeof vt;return!!vt&&(yt=="object"||yt=="function")}function ze(){}Ue.exports=Ye}).call(this,o("yLpj"))},wclG:function(Ue,y,o){var x=o("pFRH"),m=o("88Gu"),Y=m(x);Ue.exports=Y},wnjb:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MetadataReader=void 0;var x=o("xfSm"),m=function(){function Y(){}return Y.prototype.getConstructorMetadata=function(z){var i=Reflect.getMetadata(x.PARAM_TYPES,z),W=Reflect.getMetadata(x.TAGGED,z);return{compilerGeneratedMetadata:i,userGeneratedMetadata:W||{}}},Y.prototype.getPropertiesMetadata=function(z){var i=Reflect.getMetadata(x.TAGGED_PROP,z)||[];return i},Y}();y.MetadataReader=m},wrZu:function(Ue,y,o){var x=o("+K+b"),m=o("XYm9"),Y=o("b2z7"),z=o("otv/"),i=o("yP5f"),W="[object Boolean]",D="[object Date]",Q="[object Map]",ee="[object Number]",ce="[object RegExp]",K="[object Set]",je="[object String]",pe="[object Symbol]",Ke="[object ArrayBuffer]",Pe="[object DataView]",ht="[object Float32Array]",Le="[object Float64Array]",_t="[object Int8Array]",ot="[object Int16Array]",et="[object Int32Array]",Ze="[object Uint8Array]",At="[object Uint8ClampedArray]",St="[object Uint16Array]",De="[object Uint32Array]";function Ie(Ge,dt,we){var pt=Ge.constructor;switch(dt){case Ke:return x(Ge);case W:case D:return new pt(+Ge);case Pe:return m(Ge,we);case ht:case Le:case _t:case ot:case et:case Ze:case At:case St:case De:return i(Ge,we);case Q:return new pt;case ee:case je:return new pt(Ge);case ce:return Y(Ge);case K:return new pt;case pe:return z(Ge)}}Ue.exports=Ie},wy8a:function(Ue,y,o){var x=o("KxBF");function m(Y,z,i){var W=Y.length;return i=i===void 0?W:i,!z&&i>=W?Y:x(Y,z,i)}Ue.exports=m},xfSm:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.POST_CONSTRUCT=y.DESIGN_PARAM_TYPES=y.PARAM_TYPES=y.TAGGED_PROP=y.TAGGED=y.MULTI_INJECT_TAG=y.INJECT_TAG=y.OPTIONAL_TAG=y.UNMANAGED_TAG=y.NAME_TAG=y.NAMED_TAG=void 0,y.NAMED_TAG="named",y.NAME_TAG="name",y.UNMANAGED_TAG="unmanaged",y.OPTIONAL_TAG="optional",y.INJECT_TAG="inject",y.MULTI_INJECT_TAG="multi_inject",y.TAGGED="inversify:tagged",y.TAGGED_PROP="inversify:tagged_props",y.PARAM_TYPES="inversify:paramtypes",y.DESIGN_PARAM_TYPES="design:paramtypes",y.POST_CONSTRUCT="post_construct"},xfeJ:function(Ue,y){function o(x){return Function.toString.call(x).indexOf("[native code]")!==-1}Ue.exports=o},xiII:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Request=void 0;var x=o("d9O0"),m=function(){function Y(z,i,W,D,Q){this.id=x.id(),this.serviceIdentifier=z,this.parentContext=i,this.parentRequest=W,this.target=Q,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=W===null?new Map:null}return Y.prototype.addChildRequest=function(z,i,W){var D=new Y(z,this.parentContext,this,i,W);return this.childRequests.push(D),D},Y}();y.Request=m},xp6e:function(Ue,y,o){"use strict";(function(x){o.d(y,"a",function(){return be}),o.d(y,"b",function(){return Jt}),o.d(y,"c",function(){return oe}),o.d(y,"d",function(){return at});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function m(Mt,ve,ge,He){function st(Oe){return Oe instanceof ge?Oe:new ge(function(gt){gt(Oe)})}return new(ge||(ge=Promise))(function(Oe,gt){function C(fe){try{q(He.next(fe))}catch(We){gt(We)}}function R(fe){try{q(He.throw(fe))}catch(We){gt(We)}}function q(fe){fe.done?Oe(fe.value):st(fe.value).then(C,R)}q((He=He.apply(Mt,ve||[])).next())})}function Y(Mt,ve){var ge={label:0,sent:function(){if(Oe[0]&1)throw Oe[1];return Oe[1]},trys:[],ops:[]},He,st,Oe,gt;return gt={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(gt[Symbol.iterator]=function(){return this}),gt;function C(q){return function(fe){return R([q,fe])}}function R(q){if(He)throw new TypeError("Generator is already executing.");for(;ge;)try{if(He=1,st&&(Oe=q[0]&2?st.return:q[0]?st.throw||((Oe=st.return)&&Oe.call(st),0):st.next)&&!(Oe=Oe.call(st,q[1])).done)return Oe;(st=0,Oe)&&(q=[q[0]&2,Oe.value]);switch(q[0]){case 0:case 1:Oe=q;break;case 4:return ge.label++,{value:q[1],done:!1};case 5:ge.label++,st=q[1],q=[0];continue;case 7:q=ge.ops.pop(),ge.trys.pop();continue;default:if(!(Oe=ge.trys,Oe=Oe.length>0&&Oe[Oe.length-1])&&(q[0]===6||q[0]===2)){ge=0;continue}if(q[0]===3&&(!Oe||q[1]>Oe[0]&&q[1]<Oe[3])){ge.label=q[1];break}if(q[0]===6&&ge.label<Oe[1]){ge.label=Oe[1],Oe=q;break}if(Oe&&ge.label<Oe[2]){ge.label=Oe[2],ge.ops.push(q);break}Oe[2]&&ge.ops.pop(),ge.trys.pop();continue}q=ve.call(Mt,ge)}catch(fe){q=[6,fe],st=0}finally{He=Oe=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function z(Mt,ve){var ge=typeof Symbol=="function"&&Mt[Symbol.iterator];if(!ge)return Mt;var He=ge.call(Mt),st,Oe=[],gt;try{for(;(ve===void 0||ve-- >0)&&!(st=He.next()).done;)Oe.push(st.value)}catch(C){gt={error:C}}finally{try{st&&!st.done&&(ge=He.return)&&ge.call(He)}finally{if(gt)throw gt.error}}return Oe}function i(){for(var Mt=[],ve=0;ve<arguments.length;ve++)Mt=Mt.concat(z(arguments[ve]));return Mt}function W(Mt){return Mt&&Mt.__esModule&&Object.prototype.hasOwnProperty.call(Mt,"default")?Mt.default:Mt}function D(Mt,ve){return ve={exports:{}},Mt(ve,ve.exports),ve.exports}var Q=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He){return He&&typeof He.length=="number"&&He.length>=0&&He.length%1===0}Mt.exports=ve.default});W(Q);var ee=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=function(ge){return function(){for(var He=[],st=arguments.length;st--;)He[st]=arguments[st];var Oe=He.pop();return ge.call(this,He,Oe)}},Mt.exports=ve.default});W(ee);var ce=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.fallback=st,ve.wrap=Oe;var ge=ve.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,He=ve.hasNextTick=typeof x=="object"&&typeof x.nextTick=="function";function st(C){setTimeout(C,0)}function Oe(C){return function(R){for(var q=[],fe=arguments.length-1;fe-- >0;)q[fe]=arguments[fe+1];return C(function(){return R.apply(void 0,q)})}}var gt;ge?gt=setImmediate:He?gt=x.nextTick:gt=st,ve.default=Oe(gt)});W(ce);var K=ce.fallback,je=ce.wrap,pe=ce.hasSetImmediate,Ke=ce.hasNextTick,Pe=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=Oe;var ge=st(ee),He=st(ce);function st(R){return R&&R.__esModule?R:{default:R}}function Oe(R){return(0,ht.isAsync)(R)?function(){for(var q=[],fe=arguments.length;fe--;)q[fe]=arguments[fe];var We=q.pop(),qe=R.apply(this,q);return gt(qe,We)}:(0,ge.default)(function(q,fe){var We;try{We=R.apply(this,q)}catch(qe){return fe(qe)}if(We&&typeof We.then=="function")return gt(We,fe);fe(null,We)})}function gt(R,q){return R.then(function(fe){C(q,null,fe)},function(fe){C(q,fe&&fe.message?fe:new Error(fe))})}function C(R,q,fe){try{R(q,fe)}catch(We){(0,He.default)(function(qe){throw qe},We)}}Mt.exports=ve.default});W(Pe);var ht=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.isAsyncIterable=ve.isAsyncGenerator=ve.isAsync=void 0;var ge=He(Pe);function He(R){return R&&R.__esModule?R:{default:R}}function st(R){return R[Symbol.toStringTag]==="AsyncFunction"}function Oe(R){return R[Symbol.toStringTag]==="AsyncGenerator"}function gt(R){return typeof R[Symbol.asyncIterator]=="function"}function C(R){if(typeof R!="function")throw new Error("expected a function");return st(R)?(0,ge.default)(R):R}ve.default=C,ve.isAsync=st,ve.isAsyncGenerator=Oe,ve.isAsyncIterable=gt});W(ht);var Le=ht.isAsyncIterable,_t=ht.isAsyncGenerator,ot=ht.isAsync,et=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He,st){if(st===void 0&&(st=He.length),!st)throw new Error("arity is undefined");function Oe(){for(var gt=this,C=[],R=arguments.length;R--;)C[R]=arguments[R];return typeof C[st-1]=="function"?He.apply(this,C):new Promise(function(q,fe){C[st-1]=function(We){for(var qe=[],Tt=arguments.length-1;Tt-- >0;)qe[Tt]=arguments[Tt+1];if(We)return fe(We);q(qe.length>1?qe:qe[0])},He.apply(gt,C)})}return Object.defineProperty(Oe,"name",{configurable:!0,value:"awaitable("+He.name+")"}),Oe}Mt.exports=ve.default});W(et);var Ze=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=Oe(Q),He=Oe(ht),st=Oe(et);function Oe(gt){return gt&&gt.__esModule?gt:{default:gt}}ve.default=(0,st.default)(function(gt,C,R){var q=(0,ge.default)(C)?[]:{};gt(C,function(fe,We,qe){(0,He.default)(fe)(function(Tt){for(var it,Ut=[],$=arguments.length-1;$-- >0;)Ut[$]=arguments[$+1];Ut.length<2&&(it=Ut,Ut=it[0]),q[We]=Ut,qe(Tt)})},function(fe){return R(fe,q)})},3),Mt.exports=ve.default});W(Ze);var At=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He){function st(){for(var Oe=[],gt=arguments.length;gt--;)Oe[gt]=arguments[gt];if(He===null)return;var C=He;He=null,C.apply(this,Oe)}return Object.assign(st,He),st}Mt.exports=ve.default});W(At);var St=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=function(ge){return ge[Symbol.iterator]&&ge[Symbol.iterator]()},Mt.exports=ve.default});W(St);var De=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=R;var ge=st(Q),He=st(St);function st(q){return q&&q.__esModule?q:{default:q}}function Oe(q){var fe=-1,We=q.length;return function(){return++fe<We?{value:q[fe],key:fe}:null}}function gt(q){var fe=-1;return function(){var qe=q.next();return qe.done?null:(fe++,{value:qe.value,key:fe})}}function C(q){var fe=q?Object.keys(q):[],We=-1,qe=fe.length;return function(){var it=fe[++We];return We<qe?{value:q[it],key:it}:null}}function R(q){if((0,ge.default)(q))return Oe(q);var fe=(0,He.default)(q);return fe?gt(fe):C(q)}Mt.exports=ve.default});W(De);var Ie=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(He){return function(){for(var st=[],Oe=arguments.length;Oe--;)st[Oe]=arguments[Oe];if(He===null)throw new Error("Callback was already called.");var gt=He;He=null,gt.apply(this,st)}}Mt.exports=ve.default});W(Ie);var Ge=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge={};ve.default=ge,Mt.exports=ve.default});W(Ge);var dt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=st;var ge=He(Ge);function He(Oe){return Oe&&Oe.__esModule?Oe:{default:Oe}}function st(Oe,gt,C,R){var q=!1,fe=!1,We=!1,qe=0,Tt=0;function it(){if(qe>=gt||We||q)return;We=!0,Oe.next().then(function(Qe){var ne=Qe.value,tt=Qe.done;if(fe||q)return;if(We=!1,tt){q=!0,qe<=0&&R(null);return}qe++,C(ne,Tt,Ut),Tt++,it()}).catch($)}function Ut(Qe,ne){if(qe-=1,fe)return;if(Qe)return $(Qe);if(Qe===!1){q=!0,fe=!0;return}if(ne===ge.default||q&&qe<=0)return q=!0,R(null);it()}function $(Qe){if(fe)return;We=!1,q=!0,R(Qe)}it()}Mt.exports=ve.default});W(dt);var we=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=C(At),He=C(De),st=C(Ie),Oe=C(dt),gt=C(Ge);function C(R){return R&&R.__esModule?R:{default:R}}ve.default=function(R){return function(q,fe,We){if(We=(0,ge.default)(We),R<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return We(null);if((0,ht.isAsyncGenerator)(q))return(0,Oe.default)(q,R,fe,We);if((0,ht.isAsyncIterable)(q))return(0,Oe.default)(q[Symbol.asyncIterator](),R,fe,We);var qe=(0,He.default)(q),Tt=!1,it=!1,Ut=0,$=!1;function Qe(tt,kt){if(it)return;if(Ut-=1,tt)Tt=!0,We(tt);else if(tt===!1)Tt=!0,it=!0;else{if(kt===gt.default||Tt&&Ut<=0)return Tt=!0,We(null);$||ne()}}function ne(){for($=!0;Ut<R&&!Tt;){var tt=qe();if(tt===null){Tt=!0,Ut<=0&&We(null);return}Ut+=1,fe(tt.value,tt.key,(0,st.default)(Qe))}$=!1}ne()}},Mt.exports=ve.default});W(we);var pt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=Oe(we),He=Oe(ht),st=Oe(et);function Oe(C){return C&&C.__esModule?C:{default:C}}function gt(C,R,q,fe){return(0,ge.default)(R)(C,(0,He.default)(q),fe)}ve.default=(0,st.default)(gt,4),Mt.exports=ve.default});W(pt);var Wt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=st(pt),He=st(et);function st(gt){return gt&&gt.__esModule?gt:{default:gt}}function Oe(gt,C,R){return(0,ge.default)(gt,1,C,R)}ve.default=(0,He.default)(Oe,3),Mt.exports=ve.default});W(Wt);var Qt=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=Oe;var ge=st(Ze),He=st(Wt);function st(gt){return gt&&gt.__esModule?gt:{default:gt}}function Oe(gt,C){return(0,ge.default)(He.default,gt,C)}Mt.exports=ve.default}),ur=W(Qt),oe=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.args=[],this.tasks=[]}return Mt.prototype.call=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return this.args=ge,ur(this.tasks)},Mt.prototype.tap=function(ve,ge){var He=this;this.tasks.push(function(st){ge.apply(void 0,i(He.args)),st(null,ve)})},Mt}(),J=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=q(Q),He=q(Ge),st=q(pt),Oe=q(At),gt=q(Ie),C=q(ht),R=q(et);function q(Tt){return Tt&&Tt.__esModule?Tt:{default:Tt}}function fe(Tt,it,Ut){Ut=(0,Oe.default)(Ut);var $=0,Qe=0,ne=Tt.length,tt=!1;ne===0&&Ut(null);function kt(dr,Ye){if(dr===!1&&(tt=!0),tt===!0)return;dr?Ut(dr):(++Qe===ne||Ye===He.default)&&Ut(null)}for(;$<ne;$++)it(Tt[$],$,(0,gt.default)(kt))}function We(Tt,it,Ut){return(0,st.default)(Tt,Infinity,it,Ut)}function qe(Tt,it,Ut){var $=(0,ge.default)(Tt)?fe:We;return $(Tt,(0,C.default)(it),Ut)}ve.default=(0,R.default)(qe,3),Mt.exports=ve.default});W(J);var H=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=Oe;var ge=st(J),He=st(Ze);function st(gt){return gt&&gt.__esModule?gt:{default:gt}}function Oe(gt,C){return(0,He.default)(ge.default,gt,C)}Mt.exports=ve.default}),Se=W(H),be=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.tasks=[]}return Mt.prototype.promise=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return Se(this.tasks)},Mt.prototype.tapPromise=function(ve,ge){var He=this;this.tasks.push(function(st){return m(He,void 0,void 0,function(){return Y(this,function(Oe){switch(Oe.label){case 0:return[4,ge()];case 1:return Oe.sent(),st(null,ve),[2]}})})})},Mt}(),Te=D(function(Mt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=gt(At),He=gt(Ie),st=gt(ht),Oe=gt(et);function gt(R){return R&&R.__esModule?R:{default:R}}function C(R,q){if(q=(0,ge.default)(q),!Array.isArray(R))return q(new Error("First argument to waterfall must be an array of functions"));if(!R.length)return q();var fe=0;function We(Tt){var it=(0,st.default)(R[fe++]);it.apply(void 0,Tt.concat([(0,He.default)(qe)]))}function qe(Tt){for(var it=[],Ut=arguments.length-1;Ut-- >0;)it[Ut]=arguments[Ut+1];if(Tt===!1)return;if(Tt||fe===R.length)return q.apply(void 0,[Tt].concat(it));We(it)}We([])}ve.default=(0,Oe.default)(C),Mt.exports=ve.default}),me=W(Te),at=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.tasks=[]}return Mt.prototype.call=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return me(this.tasks)},Mt.prototype.tap=function(ve,ge){this.tasks.length===0?this.tasks.push(function(He){var st=ge();He(st?null:!1,st)}):this.tasks.push(function(He,st){var Oe=ge();st(Oe?null:!1,ve)})},Mt}(),Jt=function(){function Mt(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];this.tasks=[]}return Mt.prototype.call=function(){for(var ve=arguments,ge=[],He=0;He<arguments.length;He++)ge[He]=ve[He];return ur(this.tasks)},Mt.prototype.tap=function(ve,ge){this.tasks.push(function(He){var st=ge();He(st,ve)})},Mt}()}).call(this,o("Q2Ig"))},yG8O:function(Ue,y){function o(x,m,Y,z){if(!Y)return;Object.defineProperty(x,m,{enumerable:Y.enumerable,configurable:Y.configurable,writable:Y.writable,value:Y.initializer?Y.initializer.call(z):void 0})}Ue.exports=o},yHx3:function(Ue,y){var o=Object.prototype,x=o.hasOwnProperty;function m(Y){var z=Y.length,i=new Y.constructor(z);return z&&typeof Y[0]=="string"&&x.call(Y,"index")&&(i.index=Y.index,i.input=Y.input),i}Ue.exports=m},yLV6:function(Ue,y,o){var x;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(m,Y,z,i){"use strict";var W=["","webkit","Moz","MS","ms","o"],D=Y.createElement("div"),Q="function",ee=Math.round,ce=Math.abs,K=Date.now;function je(Vt,Re,Dt){return setTimeout(et(Vt,Dt),Re)}function pe(Vt,Re,Dt){return Array.isArray(Vt)?(Ke(Vt,Dt[Re],Dt),!0):!1}function Ke(Vt,Re,Dt){var mr;if(!Vt)return;if(Vt.forEach)Vt.forEach(Re,Dt);else if(Vt.length!==i)for(mr=0;mr<Vt.length;)Re.call(Dt,Vt[mr],mr,Vt),mr++;else for(mr in Vt)Vt.hasOwnProperty(mr)&&Re.call(Dt,Vt[mr],mr,Vt)}function Pe(Vt,Re,Dt){var mr="DEPRECATED METHOD: "+Re+`
`+Dt+` AT 
`;return function(){var Qr=new Error("get-stack-trace"),En=Qr&&Qr.stack?Qr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Vn=m.console&&(m.console.warn||m.console.log);return Vn&&Vn.call(m.console,mr,En),Vt.apply(this,arguments)}}var ht;typeof Object.assign!="function"?ht=function(Re){if(Re===i||Re===null)throw new TypeError("Cannot convert undefined or null to object");for(var Dt=Object(Re),mr=1;mr<arguments.length;mr++){var Qr=arguments[mr];if(Qr!==i&&Qr!==null)for(var En in Qr)Qr.hasOwnProperty(En)&&(Dt[En]=Qr[En])}return Dt}:ht=Object.assign;var Le=Pe(function(Re,Dt,mr){for(var Qr=Object.keys(Dt),En=0;En<Qr.length;)(!mr||mr&&Re[Qr[En]]===i)&&(Re[Qr[En]]=Dt[Qr[En]]),En++;return Re},"extend","Use `assign`."),_t=Pe(function(Re,Dt){return Le(Re,Dt,!0)},"merge","Use `assign`.");function ot(Vt,Re,Dt){var mr=Re.prototype,Qr;Qr=Vt.prototype=Object.create(mr),Qr.constructor=Vt,Qr._super=mr,Dt&&ht(Qr,Dt)}function et(Vt,Re){return function(){return Vt.apply(Re,arguments)}}function Ze(Vt,Re){return typeof Vt==Q?Vt.apply(Re&&Re[0]||i,Re):Vt}function At(Vt,Re){return Vt===i?Re:Vt}function St(Vt,Re,Dt){Ke(dt(Re),function(mr){Vt.addEventListener(mr,Dt,!1)})}function De(Vt,Re,Dt){Ke(dt(Re),function(mr){Vt.removeEventListener(mr,Dt,!1)})}function Ie(Vt,Re){for(;Vt;){if(Vt==Re)return!0;Vt=Vt.parentNode}return!1}function Ge(Vt,Re){return Vt.indexOf(Re)>-1}function dt(Vt){return Vt.trim().split(/\s+/g)}function we(Vt,Re,Dt){if(Vt.indexOf&&!Dt)return Vt.indexOf(Re);for(var mr=0;mr<Vt.length;){if(Dt&&Vt[mr][Dt]==Re||!Dt&&Vt[mr]===Re)return mr;mr++}return-1}function pt(Vt){return Array.prototype.slice.call(Vt,0)}function Wt(Vt,Re,Dt){for(var mr=[],Qr=[],En=0;En<Vt.length;){var Vn=Re?Vt[En][Re]:Vt[En];we(Qr,Vn)<0&&mr.push(Vt[En]),Qr[En]=Vn,En++}return Dt&&(Re?mr=mr.sort(function(po,mo){return po[Re]>mo[Re]}):mr=mr.sort()),mr}function Qt(Vt,Re){for(var Dt,mr,Qr=Re[0].toUpperCase()+Re.slice(1),En=0;En<W.length;){if(Dt=W[En],mr=Dt?Dt+Qr:Re,mr in Vt)return mr;En++}return i}var ur=1;function oe(){return ur++}function J(Vt){var Re=Vt.ownerDocument||Vt;return Re.defaultView||Re.parentWindow||m}var H=/mobile|tablet|ip(ad|hone|od)|android/i,Se="ontouchstart"in m,be=Qt(m,"PointerEvent")!==i,Te=Se&&H.test(navigator.userAgent),me="touch",at="pen",Jt="mouse",Mt="kinect",ve=25,ge=1,He=2,st=4,Oe=8,gt=1,C=2,R=4,q=8,fe=16,We=C|R,qe=q|fe,Tt=We|qe,it=["x","y"],Ut=["clientX","clientY"];function $(Vt,Re){var Dt=this;this.manager=Vt,this.callback=Re,this.element=Vt.element,this.target=Vt.options.inputTarget,this.domHandler=function(mr){Ze(Vt.options.enable,[Vt])&&Dt.handler(mr)},this.init()}$.prototype={handler:function(){},init:function(){this.evEl&&St(this.element,this.evEl,this.domHandler),this.evTarget&&St(this.target,this.evTarget,this.domHandler),this.evWin&&St(J(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&De(this.element,this.evEl,this.domHandler),this.evTarget&&De(this.target,this.evTarget,this.domHandler),this.evWin&&De(J(this.element),this.evWin,this.domHandler)}};function Qe(Vt){var Re,Dt=Vt.options.inputClass;return Dt?Re=Dt:be?Re=On:Te?Re=Xe:Se?Re=Vr:Re=Bn,new Re(Vt,ne)}function ne(Vt,Re,Dt){var mr=Dt.pointers.length,Qr=Dt.changedPointers.length,En=Re&ge&&mr-Qr===0,Vn=Re&(st|Oe)&&mr-Qr===0;Dt.isFirst=!!En,Dt.isFinal=!!Vn,En&&(Vt.session={}),Dt.eventType=Re,tt(Vt,Dt),Vt.emit("hammer.input",Dt),Vt.recognize(Dt),Vt.session.prevInput=Dt}function tt(Vt,Re){var Dt=Vt.session,mr=Re.pointers,Qr=mr.length;Dt.firstInput||(Dt.firstInput=Ye(Re)),Qr>1&&!Dt.firstMultiple?Dt.firstMultiple=Ye(Re):Qr===1&&(Dt.firstMultiple=!1);var En=Dt.firstInput,Vn=Dt.firstMultiple,Ci=Vn?Vn.center:En.center,po=Re.center=xt(mr);Re.timeStamp=K(),Re.deltaTime=Re.timeStamp-En.timeStamp,Re.angle=vt(Ci,po),Re.distance=ze(Ci,po),kt(Dt,Re),Re.offsetDirection=Et(Re.deltaX,Re.deltaY);var mo=bt(Re.deltaTime,Re.deltaX,Re.deltaY);Re.overallVelocityX=mo.x,Re.overallVelocityY=mo.y,Re.overallVelocity=ce(mo.x)>ce(mo.y)?mo.x:mo.y,Re.scale=Vn?Ht(Vn.pointers,mr):1,Re.rotation=Vn?yt(Vn.pointers,mr):0,Re.maxPointers=Dt.prevInput?Re.pointers.length>Dt.prevInput.maxPointers?Re.pointers.length:Dt.prevInput.maxPointers:Re.pointers.length,dr(Dt,Re);var Oo=Vt.element;Ie(Re.srcEvent.target,Oo)&&(Oo=Re.srcEvent.target),Re.target=Oo}function kt(Vt,Re){var Dt=Re.center,mr=Vt.offsetDelta||{},Qr=Vt.prevDelta||{},En=Vt.prevInput||{};(Re.eventType===ge||En.eventType===st)&&(Qr=Vt.prevDelta={x:En.deltaX||0,y:En.deltaY||0},mr=Vt.offsetDelta={x:Dt.x,y:Dt.y}),Re.deltaX=Qr.x+(Dt.x-mr.x),Re.deltaY=Qr.y+(Dt.y-mr.y)}function dr(Vt,Re){var Dt=Vt.lastInterval||Re,mr=Re.timeStamp-Dt.timeStamp,Qr,En,Vn,Ci;if(Re.eventType!=Oe&&(mr>ve||Dt.velocity===i)){var po=Re.deltaX-Dt.deltaX,mo=Re.deltaY-Dt.deltaY,Oo=bt(mr,po,mo);En=Oo.x,Vn=Oo.y,Qr=ce(Oo.x)>ce(Oo.y)?Oo.x:Oo.y,Ci=Et(po,mo),Vt.lastInterval=Re}else Qr=Dt.velocity,En=Dt.velocityX,Vn=Dt.velocityY,Ci=Dt.direction;Re.velocity=Qr,Re.velocityX=En,Re.velocityY=Vn,Re.direction=Ci}function Ye(Vt){for(var Re=[],Dt=0;Dt<Vt.pointers.length;)Re[Dt]={clientX:ee(Vt.pointers[Dt].clientX),clientY:ee(Vt.pointers[Dt].clientY)},Dt++;return{timeStamp:K(),pointers:Re,center:xt(Re),deltaX:Vt.deltaX,deltaY:Vt.deltaY}}function xt(Vt){var Re=Vt.length;if(Re===1)return{x:ee(Vt[0].clientX),y:ee(Vt[0].clientY)};for(var Dt=0,mr=0,Qr=0;Qr<Re;)Dt+=Vt[Qr].clientX,mr+=Vt[Qr].clientY,Qr++;return{x:ee(Dt/Re),y:ee(mr/Re)}}function bt(Vt,Re,Dt){return{x:Re/Vt||0,y:Dt/Vt||0}}function Et(Vt,Re){return Vt===Re?gt:ce(Vt)>=ce(Re)?Vt<0?C:R:Re<0?q:fe}function ze(Vt,Re,Dt){Dt||(Dt=it);var mr=Re[Dt[0]]-Vt[Dt[0]],Qr=Re[Dt[1]]-Vt[Dt[1]];return Math.sqrt(mr*mr+Qr*Qr)}function vt(Vt,Re,Dt){Dt||(Dt=it);var mr=Re[Dt[0]]-Vt[Dt[0]],Qr=Re[Dt[1]]-Vt[Dt[1]];return Math.atan2(Qr,mr)*180/Math.PI}function yt(Vt,Re){return vt(Re[1],Re[0],Ut)+vt(Vt[1],Vt[0],Ut)}function Ht(Vt,Re){return ze(Re[0],Re[1],Ut)/ze(Vt[0],Vt[1],Ut)}var hr={mousedown:ge,mousemove:He,mouseup:st},Hr="mousedown",gr="mousemove mouseup";function Bn(){this.evEl=Hr,this.evWin=gr,this.pressed=!1,$.apply(this,arguments)}ot(Bn,$,{handler:function(Re){var Dt=hr[Re.type];if(Dt&ge&&Re.button===0&&(this.pressed=!0),Dt&He&&Re.which!==1&&(Dt=st),!this.pressed)return;Dt&st&&(this.pressed=!1),this.callback(this.manager,Dt,{pointers:[Re],changedPointers:[Re],pointerType:Jt,srcEvent:Re})}});var zn={pointerdown:ge,pointermove:He,pointerup:st,pointercancel:Oe,pointerout:Oe},oa={2:me,3:at,4:Jt,5:Mt},$n="pointerdown",Yn="pointermove pointerup pointercancel";m.MSPointerEvent&&!m.PointerEvent&&($n="MSPointerDown",Yn="MSPointerMove MSPointerUp MSPointerCancel");function On(){this.evEl=$n,this.evWin=Yn,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ot(On,$,{handler:function(Re){var Dt=this.store,mr=!1,Qr=Re.type.toLowerCase().replace("ms",""),En=zn[Qr],Vn=oa[Re.pointerType]||Re.pointerType,Ci=Vn==me,po=we(Dt,Re.pointerId,"pointerId");if(En&ge&&(Re.button===0||Ci)?po<0&&(Dt.push(Re),po=Dt.length-1):En&(st|Oe)&&(mr=!0),po<0)return;Dt[po]=Re,this.callback(this.manager,En,{pointers:Dt,changedPointers:[Re],pointerType:Vn,srcEvent:Re}),mr&&Dt.splice(po,1)}});var U={touchstart:ge,touchmove:He,touchend:st,touchcancel:Oe},Z="touchstart",le="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=Z,this.evWin=le,this.started=!1,$.apply(this,arguments)}ot(xe,$,{handler:function(Re){var Dt=U[Re.type];if(Dt===ge&&(this.started=!0),!this.started)return;var mr=ut.call(this,Re,Dt);Dt&(st|Oe)&&mr[0].length-mr[1].length===0&&(this.started=!1),this.callback(this.manager,Dt,{pointers:mr[0],changedPointers:mr[1],pointerType:me,srcEvent:Re})}});function ut(Vt,Re){var Dt=pt(Vt.touches),mr=pt(Vt.changedTouches);return Re&(st|Oe)&&(Dt=Wt(Dt.concat(mr),"identifier",!0)),[Dt,mr]}var wt={touchstart:ge,touchmove:He,touchend:st,touchcancel:Oe},Bt="touchstart touchmove touchend touchcancel";function Xe(){this.evTarget=Bt,this.targetIds={},$.apply(this,arguments)}ot(Xe,$,{handler:function(Re){var Dt=wt[Re.type],mr=Lt.call(this,Re,Dt);if(!mr)return;this.callback(this.manager,Dt,{pointers:mr[0],changedPointers:mr[1],pointerType:me,srcEvent:Re})}});function Lt(Vt,Re){var Dt=pt(Vt.touches),mr=this.targetIds;if(Re&(ge|He)&&Dt.length===1)return mr[Dt[0].identifier]=!0,[Dt,Dt];var Qr,En,Vn=pt(Vt.changedTouches),Ci=[],po=this.target;if(En=Dt.filter(function(mo){return Ie(mo.target,po)}),Re===ge)for(Qr=0;Qr<En.length;)mr[En[Qr].identifier]=!0,Qr++;for(Qr=0;Qr<Vn.length;)mr[Vn[Qr].identifier]&&Ci.push(Vn[Qr]),Re&(st|Oe)&&delete mr[Vn[Qr].identifier],Qr++;return Ci.length?[Wt(En.concat(Ci),"identifier",!0),Ci]:void 0}var lr=2500,zr=25;function Vr(){$.apply(this,arguments);var Vt=et(this.handler,this);this.touch=new Xe(this.manager,Vt),this.mouse=new Bn(this.manager,Vt),this.primaryTouch=null,this.lastTouches=[]}ot(Vr,$,{handler:function(Re,Dt,mr){var Qr=mr.pointerType==me,En=mr.pointerType==Jt;if(En&&mr.sourceCapabilities&&mr.sourceCapabilities.firesTouchEvents)return;if(Qr)cr.call(this,Dt,mr);else if(En&&Mn.call(this,mr))return;this.callback(Re,Dt,mr)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function cr(Vt,Re){Vt&ge?(this.primaryTouch=Re.changedPointers[0].identifier,Ur.call(this,Re)):Vt&(st|Oe)&&Ur.call(this,Re)}function Ur(Vt){var Re=Vt.changedPointers[0];if(Re.identifier===this.primaryTouch){var Dt={x:Re.clientX,y:Re.clientY};this.lastTouches.push(Dt);var mr=this.lastTouches,Qr=function(){var Vn=mr.indexOf(Dt);Vn>-1&&mr.splice(Vn,1)};setTimeout(Qr,lr)}}function Mn(Vt){for(var Re=Vt.srcEvent.clientX,Dt=Vt.srcEvent.clientY,mr=0;mr<this.lastTouches.length;mr++){var Qr=this.lastTouches[mr],En=Math.abs(Re-Qr.x),Vn=Math.abs(Dt-Qr.y);if(En<=zr&&Vn<=zr)return!0}return!1}var ln=Qt(D.style,"touchAction"),er=ln!==i,tn="compute",hn="auto",xn="manipulation",yn="none",vn="pan-x",Pn="pan-y",Va=Ia();function va(Vt,Re){this.manager=Vt,this.set(Re)}va.prototype={set:function(Re){Re==tn&&(Re=this.compute()),er&&this.manager.element.style&&Va[Re]&&(this.manager.element.style[ln]=Re),this.actions=Re.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Re=[];return Ke(this.manager.recognizers,function(Dt){Ze(Dt.options.enable,[Dt])&&(Re=Re.concat(Dt.getTouchAction()))}),Ma(Re.join(" "))},preventDefaults:function(Re){var Dt=Re.srcEvent,mr=Re.offsetDirection;if(this.manager.session.prevented){Dt.preventDefault();return}var Qr=this.actions,En=Ge(Qr,yn)&&!Va[yn],Vn=Ge(Qr,Pn)&&!Va[Pn],Ci=Ge(Qr,vn)&&!Va[vn];if(En){var po=Re.pointers.length===1,mo=Re.distance<2,Oo=Re.deltaTime<250;if(po&&mo&&Oo)return}if(Ci&&Vn)return;if(En||Vn&&mr&We||Ci&&mr&qe)return this.preventSrc(Dt)},preventSrc:function(Re){this.manager.session.prevented=!0,Re.preventDefault()}};function Ma(Vt){if(Ge(Vt,yn))return yn;var Re=Ge(Vt,vn),Dt=Ge(Vt,Pn);return Re&&Dt?yn:Re||Dt?Re?vn:Pn:Ge(Vt,xn)?xn:hn}function Ia(){if(!er)return!1;var Vt={},Re=m.CSS&&m.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Dt){Vt[Dt]=Re?m.CSS.supports("touch-action",Dt):!0}),Vt}var Zi=1,da=2,di=4,ga=8,ya=ga,fa=16,Si=32;function ns(Vt){this.options=ht({},this.defaults,Vt||{}),this.id=oe(),this.manager=null,this.options.enable=At(this.options.enable,!0),this.state=Zi,this.simultaneous={},this.requireFail=[]}ns.prototype={defaults:{},set:function(Re){return ht(this.options,Re),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Re){if(pe(Re,"recognizeWith",this))return this;var Dt=this.simultaneous;return Re=ju(Re,this),Dt[Re.id]||(Dt[Re.id]=Re,Re.recognizeWith(this)),this},dropRecognizeWith:function(Re){return pe(Re,"dropRecognizeWith",this)?this:(Re=ju(Re,this),delete this.simultaneous[Re.id],this)},requireFailure:function(Re){if(pe(Re,"requireFailure",this))return this;var Dt=this.requireFail;return Re=ju(Re,this),we(Dt,Re)===-1&&(Dt.push(Re),Re.requireFailure(this)),this},dropRequireFailure:function(Re){if(pe(Re,"dropRequireFailure",this))return this;Re=ju(Re,this);var Dt=we(this.requireFail,Re);return Dt>-1&&this.requireFail.splice(Dt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Re){return!!this.simultaneous[Re.id]},emit:function(Re){var Dt=this,mr=this.state;function Qr(En){Dt.manager.emit(En,Re)}mr<ga&&Qr(Dt.options.event+Xi(mr)),Qr(Dt.options.event),Re.additionalEvent&&Qr(Re.additionalEvent),mr>=ga&&Qr(Dt.options.event+Xi(mr))},tryEmit:function(Re){if(this.canEmit())return this.emit(Re);this.state=Si},canEmit:function(){for(var Re=0;Re<this.requireFail.length;){if(!(this.requireFail[Re].state&(Si|Zi)))return!1;Re++}return!0},recognize:function(Re){var Dt=ht({},Re);if(!Ze(this.options.enable,[this,Dt])){this.reset(),this.state=Si;return}this.state&(ya|fa|Si)&&(this.state=Zi),this.state=this.process(Dt),this.state&(da|di|ga|fa)&&this.tryEmit(Dt)},process:function(Re){},getTouchAction:function(){},reset:function(){}};function Xi(Vt){return Vt&fa?"cancel":Vt&ga?"end":Vt&di?"move":Vt&da?"start":""}function Vo(Vt){return Vt==fe?"down":Vt==q?"up":Vt==C?"left":Vt==R?"right":""}function ju(Vt,Re){var Dt=Re.manager;return Dt?Dt.get(Vt):Vt}function Ga(){ns.apply(this,arguments)}ot(Ga,ns,{defaults:{pointers:1},attrTest:function(Re){var Dt=this.options.pointers;return Dt===0||Re.pointers.length===Dt},process:function(Re){var Dt=this.state,mr=Re.eventType,Qr=Dt&(da|di),En=this.attrTest(Re);return Qr&&(mr&Oe||!En)?Dt|fa:Qr||En?mr&st?Dt|ga:Dt&da?Dt|di:da:Si}});function Ai(){Ga.apply(this,arguments),this.pX=null,this.pY=null}ot(Ai,Ga,{defaults:{event:"pan",threshold:10,pointers:1,direction:Tt},getTouchAction:function(){var Re=this.options.direction,Dt=[];return Re&We&&Dt.push(Pn),Re&qe&&Dt.push(vn),Dt},directionTest:function(Re){var Dt=this.options,mr=!0,Qr=Re.distance,En=Re.direction,Vn=Re.deltaX,Ci=Re.deltaY;return En&Dt.direction||(Dt.direction&We?(En=Vn===0?gt:Vn<0?C:R,mr=Vn!=this.pX,Qr=Math.abs(Re.deltaX)):(En=Ci===0?gt:Ci<0?q:fe,mr=Ci!=this.pY,Qr=Math.abs(Re.deltaY))),Re.direction=En,mr&&Qr>Dt.threshold&&En&Dt.direction},attrTest:function(Re){return Ga.prototype.attrTest.call(this,Re)&&(this.state&da||!(this.state&da)&&this.directionTest(Re))},emit:function(Re){this.pX=Re.deltaX,this.pY=Re.deltaY;var Dt=Vo(Re.direction);Dt&&(Re.additionalEvent=this.options.event+Dt),this._super.emit.call(this,Re)}});function Ko(){Ga.apply(this,arguments)}ot(Ko,Ga,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[yn]},attrTest:function(Re){return this._super.attrTest.call(this,Re)&&(Math.abs(Re.scale-1)>this.options.threshold||this.state&da)},emit:function(Re){if(Re.scale!==1){var Dt=Re.scale<1?"in":"out";Re.additionalEvent=this.options.event+Dt}this._super.emit.call(this,Re)}});function oi(){ns.apply(this,arguments),this._timer=null,this._input=null}ot(oi,ns,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hn]},process:function(Re){var Dt=this.options,mr=Re.pointers.length===Dt.pointers,Qr=Re.distance<Dt.threshold,En=Re.deltaTime>Dt.time;if(this._input=Re,!Qr||!mr||Re.eventType&(st|Oe)&&!En)this.reset();else if(Re.eventType&ge)this.reset(),this._timer=je(function(){this.state=ya,this.tryEmit()},Dt.time,this);else if(Re.eventType&st)return ya;return Si},reset:function(){clearTimeout(this._timer)},emit:function(Re){if(this.state!==ya)return;Re&&Re.eventType&st?this.manager.emit(this.options.event+"up",Re):(this._input.timeStamp=K(),this.manager.emit(this.options.event,this._input))}});function Yi(){Ga.apply(this,arguments)}ot(Yi,Ga,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[yn]},attrTest:function(Re){return this._super.attrTest.call(this,Re)&&(Math.abs(Re.rotation)>this.options.threshold||this.state&da)}});function wo(){Ga.apply(this,arguments)}ot(wo,Ga,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:We|qe,pointers:1},getTouchAction:function(){return Ai.prototype.getTouchAction.call(this)},attrTest:function(Re){var Dt=this.options.direction,mr;return Dt&(We|qe)?mr=Re.overallVelocity:Dt&We?mr=Re.overallVelocityX:Dt&qe&&(mr=Re.overallVelocityY),this._super.attrTest.call(this,Re)&&Dt&Re.offsetDirection&&Re.distance>this.options.threshold&&Re.maxPointers==this.options.pointers&&ce(mr)>this.options.velocity&&Re.eventType&st},emit:function(Re){var Dt=Vo(Re.offsetDirection);Dt&&this.manager.emit(this.options.event+Dt,Re),this.manager.emit(this.options.event,Re)}});function Ha(){ns.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ot(Ha,ns,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xn]},process:function(Re){var Dt=this.options,mr=Re.pointers.length===Dt.pointers,Qr=Re.distance<Dt.threshold,En=Re.deltaTime<Dt.time;if(this.reset(),Re.eventType&ge&&this.count===0)return this.failTimeout();if(Qr&&En&&mr){if(Re.eventType!=st)return this.failTimeout();var Vn=this.pTime?Re.timeStamp-this.pTime<Dt.interval:!0,Ci=!this.pCenter||ze(this.pCenter,Re.center)<Dt.posThreshold;this.pTime=Re.timeStamp,this.pCenter=Re.center,!Ci||!Vn?this.count=1:this.count+=1,this._input=Re;var po=this.count%Dt.taps;if(po===0)return this.hasRequireFailures()?(this._timer=je(function(){this.state=ya,this.tryEmit()},Dt.interval,this),da):ya}return Si},failTimeout:function(){return this._timer=je(function(){this.state=Si},this.options.interval,this),Si},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ya&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function oo(Vt,Re){return Re=Re||{},Re.recognizers=At(Re.recognizers,oo.defaults.preset),new $o(Vt,Re)}oo.VERSION="2.0.7",oo.defaults={domEvents:!1,touchAction:tn,enable:!0,inputTarget:null,inputClass:null,preset:[[Yi,{enable:!1}],[Ko,{enable:!1},["rotate"]],[wo,{direction:We}],[Ai,{direction:We},["swipe"]],[Ha],[Ha,{event:"doubletap",taps:2},["tap"]],[oi]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var so=1,Eu=2;function $o(Vt,Re){this.options=ht({},oo.defaults,Re||{}),this.options.inputTarget=this.options.inputTarget||Vt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Vt,this.input=Qe(this),this.touchAction=new va(this,this.options.touchAction),Kl(this,!0),Ke(this.options.recognizers,function(Dt){var mr=this.add(new Dt[0](Dt[1]));Dt[2]&&mr.recognizeWith(Dt[2]),Dt[3]&&mr.requireFailure(Dt[3])},this)}$o.prototype={set:function(Re){return ht(this.options,Re),Re.touchAction&&this.touchAction.update(),Re.inputTarget&&(this.input.destroy(),this.input.target=Re.inputTarget,this.input.init()),this},stop:function(Re){this.session.stopped=Re?Eu:so},recognize:function(Re){var Dt=this.session;if(Dt.stopped)return;this.touchAction.preventDefaults(Re);var mr,Qr=this.recognizers,En=Dt.curRecognizer;(!En||En&&En.state&ya)&&(En=Dt.curRecognizer=null);for(var Vn=0;Vn<Qr.length;)mr=Qr[Vn],Dt.stopped!==Eu&&(!En||mr==En||mr.canRecognizeWith(En))?mr.recognize(Re):mr.reset(),!En&&mr.state&(da|di|ga)&&(En=Dt.curRecognizer=mr),Vn++},get:function(Re){if(Re instanceof ns)return Re;for(var Dt=this.recognizers,mr=0;mr<Dt.length;mr++)if(Dt[mr].options.event==Re)return Dt[mr];return null},add:function(Re){if(pe(Re,"add",this))return this;var Dt=this.get(Re.options.event);return Dt&&this.remove(Dt),this.recognizers.push(Re),Re.manager=this,this.touchAction.update(),Re},remove:function(Re){if(pe(Re,"remove",this))return this;if(Re=this.get(Re),Re){var Dt=this.recognizers,mr=we(Dt,Re);mr!==-1&&(Dt.splice(mr,1),this.touchAction.update())}return this},on:function(Re,Dt){if(Re===i)return;if(Dt===i)return;var mr=this.handlers;return Ke(dt(Re),function(Qr){mr[Qr]=mr[Qr]||[],mr[Qr].push(Dt)}),this},off:function(Re,Dt){if(Re===i)return;var mr=this.handlers;return Ke(dt(Re),function(Qr){Dt?mr[Qr]&&mr[Qr].splice(we(mr[Qr],Dt),1):delete mr[Qr]}),this},emit:function(Re,Dt){this.options.domEvents&&ks(Re,Dt);var mr=this.handlers[Re]&&this.handlers[Re].slice();if(!mr||!mr.length)return;Dt.type=Re,Dt.preventDefault=function(){Dt.srcEvent.preventDefault()};for(var Qr=0;Qr<mr.length;)mr[Qr](Dt),Qr++},destroy:function(){this.element&&Kl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Kl(Vt,Re){var Dt=Vt.element;if(!Dt.style)return;var mr;Ke(Vt.options.cssProps,function(Qr,En){mr=Qt(Dt.style,En),Re?(Vt.oldCssProps[mr]=Dt.style[mr],Dt.style[mr]=Qr):Dt.style[mr]=Vt.oldCssProps[mr]||""}),Re||(Vt.oldCssProps={})}function ks(Vt,Re){var Dt=Y.createEvent("Event");Dt.initEvent(Vt,!0,!0),Dt.gesture=Re,Re.target.dispatchEvent(Dt)}ht(oo,{INPUT_START:ge,INPUT_MOVE:He,INPUT_END:st,INPUT_CANCEL:Oe,STATE_POSSIBLE:Zi,STATE_BEGAN:da,STATE_CHANGED:di,STATE_ENDED:ga,STATE_RECOGNIZED:ya,STATE_CANCELLED:fa,STATE_FAILED:Si,DIRECTION_NONE:gt,DIRECTION_LEFT:C,DIRECTION_RIGHT:R,DIRECTION_UP:q,DIRECTION_DOWN:fe,DIRECTION_HORIZONTAL:We,DIRECTION_VERTICAL:qe,DIRECTION_ALL:Tt,Manager:$o,Input:$,TouchAction:va,TouchInput:Xe,MouseInput:Bn,PointerEventInput:On,TouchMouseInput:Vr,SingleTouchInput:xe,Recognizer:ns,AttrRecognizer:Ga,Tap:Ha,Pan:Ai,Swipe:wo,Pinch:Ko,Rotate:Yi,Press:oi,on:St,off:De,each:Ke,merge:_t,extend:Le,assign:ht,inherit:ot,bindFn:et,prefixed:Qt});var ho=typeof m!="undefined"?m:typeof self!="undefined"?self:{};ho.Hammer=oo,!(x=function(){return oo}.call(y,o,y,Ue),x!==i&&(Ue.exports=x))})(window,document,"Hammer")},yMAV:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Plan=void 0;var x=function(){function m(Y,z){this.parentContext=Y,this.rootRequest=z}return m}();y.Plan=x},yP5f:function(Ue,y,o){var x=o("+K+b");function m(Y,z){var i=z?x(Y.buffer):Y.buffer;return new Y.constructor(i,Y.byteOffset,Y.length)}Ue.exports=m},yU0y:function(Ue,y,o){"use strict";o.d(y,"b",function(){return x}),o.d(y,"a",function(){return m}),o.d(y,"c",function(){return Y});var x=1e-6,m=typeof Float32Array!="undefined"?Float32Array:Array,Y=Math.random;function z(Q){m=Q}var i=Math.PI/180;function W(Q){return Q*i}function D(Q,ee){return Math.abs(Q-ee)<=x*Math.max(1,Math.abs(Q),Math.abs(ee))}Math.hypot||(Math.hypot=function(){for(var Q=0,ee=arguments.length;ee--;)Q+=arguments[ee]*arguments[ee];return Math.sqrt(Q)})},yXPU:function(Ue,y){function o(m,Y,z,i,W,D,Q){try{var ee=m[D](Q),ce=ee.value}catch(K){z(K);return}ee.done?Y(ce):Promise.resolve(ce).then(i,W)}function x(m){return function(){var Y=this,z=arguments;return new Promise(function(i,W){var D=m.apply(Y,z);function Q(ce){o(D,i,W,Q,ee,"next",ce)}function ee(ce){o(D,i,W,Q,ee,"throw",ce)}Q(void 0)})}}Ue.exports=x},ycre:function(Ue,y,o){var x=o("711d"),m=x("length");Ue.exports=m},z4Hk:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BindingWhenSyntax=void 0;var x=o("406g"),m=o("RR/i"),Y=function(){function z(i){this._binding=i}return z.prototype.when=function(i){return this._binding.constraint=i,new x.BindingOnSyntax(this._binding)},z.prototype.whenTargetNamed=function(i){return this._binding.constraint=m.namedConstraint(i),new x.BindingOnSyntax(this._binding)},z.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(i){var W=i.target!==null&&!i.target.isNamed()&&!i.target.isTagged();return W},new x.BindingOnSyntax(this._binding)},z.prototype.whenTargetTagged=function(i,W){return this._binding.constraint=m.taggedConstraint(i)(W),new x.BindingOnSyntax(this._binding)},z.prototype.whenInjectedInto=function(i){return this._binding.constraint=function(W){return m.typeConstraint(i)(W.parentRequest)},new x.BindingOnSyntax(this._binding)},z.prototype.whenParentNamed=function(i){return this._binding.constraint=function(W){return m.namedConstraint(i)(W.parentRequest)},new x.BindingOnSyntax(this._binding)},z.prototype.whenParentTagged=function(i,W){return this._binding.constraint=function(D){return m.taggedConstraint(i)(W)(D.parentRequest)},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorIs=function(i){return this._binding.constraint=function(W){return m.traverseAncerstors(W,m.typeConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorIs=function(i){return this._binding.constraint=function(W){return!m.traverseAncerstors(W,m.typeConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorNamed=function(i){return this._binding.constraint=function(W){return m.traverseAncerstors(W,m.namedConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorNamed=function(i){return this._binding.constraint=function(W){return!m.traverseAncerstors(W,m.namedConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorTagged=function(i,W){return this._binding.constraint=function(D){return m.traverseAncerstors(D,m.taggedConstraint(i)(W))},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorTagged=function(i,W){return this._binding.constraint=function(D){return!m.traverseAncerstors(D,m.taggedConstraint(i)(W))},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorMatches=function(i){return this._binding.constraint=function(W){return m.traverseAncerstors(W,i)},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorMatches=function(i){return this._binding.constraint=function(W){return!m.traverseAncerstors(W,i)},new x.BindingOnSyntax(this._binding)},z}();y.BindingWhenSyntax=Y},zEVN:function(Ue,y,o){var x=o("Gi0A"),m=o("sEf8"),Y=o("mdPL"),z=Y&&Y.isMap,i=z?m(z):x;Ue.exports=i},zZ0H:function(Ue,y){function o(x){return x}Ue.exports=o},zZPE:function(Ue,y){var o="[object Object]";function x(je){var pe=!1;if(je!=null&&typeof je.toString!="function")try{pe=!!(je+"")}catch(Ke){}return pe}function m(je,pe){return function(Ke){return je(pe(Ke))}}var Y=Function.prototype,z=Object.prototype,i=Y.toString,W=z.hasOwnProperty,D=i.call(Object),Q=z.toString,ee=m(Object.getPrototypeOf,Object);function ce(je){return!!je&&typeof je=="object"}function K(je){if(!ce(je)||Q.call(je)!=o||x(je))return!1;var pe=ee(je);if(pe===null)return!0;var Ke=W.call(pe,"constructor")&&pe.constructor;return typeof Ke=="function"&&Ke instanceof Ke&&i.call(Ke)==D}Ue.exports=K},zoYe:function(Ue,y,o){var x=o("nmnc"),m=o("eUgh"),Y=o("Z0cm"),z=o("/9aa"),i=1/0,W=x?x.prototype:void 0,D=W?W.toString:void 0;function Q(ee){if(typeof ee=="string")return ee;if(Y(ee))return m(ee,Q)+"";if(z(ee))return D?D.call(ee):"";var ce=ee+"";return ce=="0"&&1/ee==-i?"-0":ce}Ue.exports=Q},zvhG:function(Ue,y){Ue.exports=o;function o(x,m,Y,z){this.cx=3*x,this.bx=3*(Y-x)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*m,this.by=3*(z-m)-this.cy,this.ay=1-this.cy-this.by,this.p1x=x,this.p1y=z,this.p2x=Y,this.p2y=z}o.prototype.sampleCurveX=function(x){return((this.ax*x+this.bx)*x+this.cx)*x},o.prototype.sampleCurveY=function(x){return((this.ay*x+this.by)*x+this.cy)*x},o.prototype.sampleCurveDerivativeX=function(x){return(3*this.ax*x+2*this.bx)*x+this.cx},o.prototype.solveCurveX=function(x,m){typeof m=="undefined"&&(m=1e-6);var Y,z,i,W,D;for(i=x,D=0;D<8;D++){if(W=this.sampleCurveX(i)-x,Math.abs(W)<m)return i;var Q=this.sampleCurveDerivativeX(i);if(Math.abs(Q)<1e-6)break;i=i-W/Q}if(Y=0,z=1,i=x,i<Y)return Y;if(i>z)return z;for(;Y<z;){if(W=this.sampleCurveX(i),Math.abs(W-x)<m)return i;x>W?Y=i:z=i,i=(z-Y)*.5+Y}return i},o.prototype.solve=function(x,m){return this.sampleCurveY(this.solveCurveX(x,m))}},zxMA:function(Ue,y,o){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.QueryableString=void 0;var x=function(){function m(Y){this.str=Y}return m.prototype.startsWith=function(Y){return this.str.indexOf(Y)===0},m.prototype.endsWith=function(Y){var z="",i=Y.split("").reverse().join("");return z=this.str.split("").reverse().join(""),this.startsWith.call({str:z},i)},m.prototype.contains=function(Y){return this.str.indexOf(Y)!==-1},m.prototype.equals=function(Y){return this.str===Y},m.prototype.value=function(){return this.str},m}();y.QueryableString=x}}]);
